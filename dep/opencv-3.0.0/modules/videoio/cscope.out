cscope 15 $HOME/opencv-3.0.0/modules/videoio               0001087653
	@include/opencv2/videoio/cap_ios.h

29 #imp‹à<
UIKô
/UIKô.
h
>

30 #imp‹à<
Ac˚Àøã
/Ac˚Àøã.
h
>

31 #imp‹à<
AVFound©i⁄
/AVFound©i⁄.
h
>

32 #imp‹à<
ImageIO
/ImageIO.
h
>

33 
	~"›ícv2/c‹e.hµ
"

40 @
˛ass
 
	gCvAb°ø˘Camîa
;

42 @
öãrÁ˚
 
	gCvAb°ø˘Camîa
 : 
NSObje˘


44 
AVC≠tuªSessi⁄
* 
ˇ±uªSessi⁄
;

45 
AVC≠tuªC⁄√˘i⁄
* 
	gvideoC≠tuªC⁄√˘i⁄
;

46 
AVC≠tuªVideoPªvõwLayî
 *
	gˇ±uªVideoPªvõwLayî
;

48 
UIDevi˚Orõ¡©i⁄
 
	gcuºítDevi˚Orõ¡©i⁄
;

50 
BOOL
 
	gˇmîaAvaûabÀ
;

51 
BOOL
 
	gˇ±uªSessi⁄Lﬂded
;

52 
BOOL
 
	gru¬ög
;

53 
BOOL
 
	gu£AVC≠tuªVideoPªvõwLayî
;

55 
AVC≠tuªDevi˚Posôi⁄
 
	gdeÁu…AVC≠tuªDevi˚Posôi⁄
;

56 
AVC≠tuªVideoOrõ¡©i⁄
 
	gdeÁu…AVC≠tuªVideoOrõ¡©i⁄
;

57 
NSSåög
 *c⁄° 
	gdeÁu…AVC≠tuªSessi⁄Pª£t
;

59 
	gdeÁu…FPS
;

61 
UIVõw
* 
	g∑ª¡Võw
;

63 
	gimageWidth
;

64 
	gimageHeight
;

67 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
AVC≠tuªSessi⁄
* 
ˇ±uªSessi⁄
;

68 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
AVC≠tuªC⁄√˘i⁄
* 
videoC≠tuªC⁄√˘i⁄
;

70 @
	$¥›îty
 (
n⁄©omic
, 
ªad⁄ly
Ë
BOOL
 
ru¬ög
;

71 @
	$¥›îty
 (
n⁄©omic
, 
ªad⁄ly
Ë
BOOL
 
ˇ±uªSessi⁄Lﬂded
;

73 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
deÁu…FPS
;

74 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
AVC≠tuªDevi˚Posôi⁄
 
deÁu…AVC≠tuªDevi˚Posôi⁄
;

75 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
AVC≠tuªVideoOrõ¡©i⁄
 
deÁu…AVC≠tuªVideoOrõ¡©i⁄
;

76 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
BOOL
 
u£AVC≠tuªVideoPªvõwLayî
;

77 @
	$¥›îty
 (
n⁄©omic
, 
°r⁄g
Ë
NSSåög
 *c⁄° 
deÁu…AVC≠tuªSessi⁄Pª£t
;

79 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
imageWidth
;

80 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
imageHeight
;

82 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
UIVõw
* 
∑ª¡Võw
;

84 - ()
°¨t
;

85 - ()
°›
;

86 - ()
swôchCamîas
;

88 - (
id
)
öôWôhP¨ítVõw
:(
UIVõw
*)
∑ª¡
;

90 - ()
¸óãC≠tuªOuçut
;

91 - ()
¸óãVideoPªvõwLayî
;

92 - ()
upd©eOrõ¡©i⁄
;

94 - ()
lockFocus
;

95 - ()
u∆ockFocus
;

96 - ()
lockExposuª
;

97 - ()
u∆ockExposuª
;

98 - ()
lockBÆ™˚
;

99 - ()
u∆ockBÆ™˚
;

101 @
íd


105 @
˛ass
 
CvVideoCamîa
;

107 @
¥Ÿocﬁ
 
CvVideoCamîaDñeg©e
 <
NSObje˘
>

109 #ifde‡
__˝lu•lus


111 - ()
¥o˚ssImage
:(
cv
::
M©
&)
image
;

114 @
íd


116 @
öãrÁ˚
 
CvVideoCamîa
 : 
CvAb°ø˘Camîa
<
AVC≠tuªVideoD©aOuçutSam∂eBuf„rDñeg©e
>

118 
AVC≠tuªVideoD©aOuçut
 *
videoD©aOuçut
;

120 
di•©ch_queue_t
 
videoD©aOuçutQueue
;

121 
CALayî
 *
cu°omPªvõwLayî
;

123 
BOOL
 
gøysˇÀMode
;

125 
BOOL
 
ªc‹dVideo
;

126 
BOOL
 
rŸ©eVideo
;

127 
AVAs£tWrôîI≈ut
* 
ªc‹dAs£tWrôîI≈ut
;

128 
AVAs£tWrôîI≈utPixñBuf„rAd≠t‹
* 
ªc‹dPixñBuf„rAd≠t‹
;

129 
AVAs£tWrôî
* 
ªc‹dAs£tWrôî
;

131 
CMTime
 
œ°Sam∂eTime
;

133 
	}
}

135 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
id
<
CvVideoCamîaDñeg©e
> 
dñeg©e
;

136 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
BOOL
 
gøysˇÀMode
;

138 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
BOOL
 
ªc‹dVideo
;

139 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
BOOL
 
rŸ©eVideo
;

140 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
AVAs£tWrôîI≈ut
* 
ªc‹dAs£tWrôîI≈ut
;

141 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
AVAs£tWrôîI≈utPixñBuf„rAd≠t‹
* 
ªc‹dPixñBuf„rAd≠t‹
;

142 @
	$¥›îty
 (
n⁄©omic
, 
ªèö
Ë
AVAs£tWrôî
* 
ªc‹dAs£tWrôî
;

144 - ()
adju°LayoutToI¡îÁ˚Orõ¡©i⁄
:(
UII¡îÁ˚Orõ¡©i⁄
)
öãrÁ˚Orõ¡©i⁄
;

145 - ()
œyoutPªvõwLayî
;

146 - ()
ßveVideo
;

147 - (
NSURL
 *)
videoFûeURL
;

150 @
íd


154 @
˛ass
 
CvPhŸoCamîa
;

156 @
¥Ÿocﬁ
 
CvPhŸoCamîaDñeg©e
 <
NSObje˘
>

158 - ()
phŸoCamîa
:(
CvPhŸoCamîa
*ÌhŸoCamî®
ˇ±uªdImage
:(
UIImage
 *)
image
;

159 - ()
phŸoCamîaC™˚l
:(
CvPhŸoCamîa
*)
phŸoCamîa
;

161 @
íd


163 @
öãrÁ˚
 
CvPhŸoCamîa
 : 
CvAb°ø˘Camîa


165 
AVC≠tuªStûlImageOuçut
 *
°ûlImageOuçut
;

166 
	}
}

168 @
	$¥›îty
 (
n⁄©omic
, 
assign
Ë
id
<
CvPhŸoCamîaDñeg©e
> 
dñeg©e
;

170 - ()
èkePi˘uª
;

172 @
íd


	@include/opencv2/videoio/videoio_c.h

42 #i‚de‡
__OPENCV_VIDEOIO_H__


43 
	#__OPENCV_VIDEOIO_H__


	)

45 
	~"›ícv2/c‹e/c‹e_c.h
"

47 #ifde‡
__˝lu•lus


61 
CvC≠tuª
 
	tCvC≠tuª
;

64 
CVAPI
(
CvC≠tuª
*Ë
cvCª©eFûeC≠tuª
–c⁄° * 
fûíame
 );

68 
CV_CAP_ANY
 =0,

70 
CV_CAP_MIL
 =100,

72 
CV_CAP_VFW
 =200,

73 
CV_CAP_V4L
 =200,

74 
CV_CAP_V4L2
 =200,

76 
CV_CAP_FIREWARE
 =300,

77 
CV_CAP_FIREWIRE
 =300,

78 
CV_CAP_IEEE1394
 =300,

79 
CV_CAP_DC1394
 =300,

80 
CV_CAP_CMU1394
 =300,

82 
CV_CAP_STEREO
 =400,

83 
CV_CAP_TYZX
 =400,

84 
CV_TYZX_LEFT
 =400,

85 
CV_TYZX_RIGHT
 =401,

86 
CV_TYZX_COLOR
 =402,

87 
CV_TYZX_Z
 =403,

89 
CV_CAP_QT
 =500,

91 
CV_CAP_UNICAP
 =600,

93 
CV_CAP_DSHOW
 =700,

94 
CV_CAP_MSMF
 =1400,

96 
CV_CAP_PVAPI
 =800,

98 
CV_CAP_OPENNI
 =900,

99 
CV_CAP_OPENNI_ASUS
 =910,

101 
CV_CAP_ANDROID
 =1000,

102 
CV_CAP_ANDROID_BACK
 =
CV_CAP_ANDROID
+99,

103 
CV_CAP_ANDROID_FRONT
 =
CV_CAP_ANDROID
+98,

105 
CV_CAP_XIAPI
 =1100,

107 
CV_CAP_AVFOUNDATION
 = 1200,

109 
CV_CAP_GIGANETIX
 = 1300,

111 
CV_CAP_INTELPERC
 = 1500,

113 
CV_CAP_OPENNI2
 = 1600,

115 
CV_CAP_GPHOTO2
 = 1700

119 
CVAPI
(
CvC≠tuª
*Ë
cvCª©eCamîaC≠tuª
–
ödex
 );

123 
CVAPI
(Ë
cvGøbFøme
–
CvC≠tuª
* 
ˇ±uª
 );

129 
CVAPI
(
I∂Image
*Ë
cvRërõveFøme
–
CvC≠tuª
* 
ˇ±uª
, 
°ªamIdx
 
CV_DEFAULT
(0) );

133 
CVAPI
(
I∂Image
*Ë
cvQuîyFøme
–
CvC≠tuª
* 
ˇ±uª
 );

136 
CVAPI
(Ë
cvRñó£C≠tuª
–
CvC≠tuª
** 
ˇ±uª
 );

142 
CV_CAP_PROP_DC1394_OFF
 = -4,

143 
CV_CAP_PROP_DC1394_MODE_MANUAL
 = -3,

144 
CV_CAP_PROP_DC1394_MODE_AUTO
 = -2,

145 
CV_CAP_PROP_DC1394_MODE_ONE_PUSH_AUTO
 = -1,

146 
CV_CAP_PROP_POS_MSEC
 =0,

147 
CV_CAP_PROP_POS_FRAMES
 =1,

148 
CV_CAP_PROP_POS_AVI_RATIO
 =2,

149 
CV_CAP_PROP_FRAME_WIDTH
 =3,

150 
CV_CAP_PROP_FRAME_HEIGHT
 =4,

151 
CV_CAP_PROP_FPS
 =5,

152 
CV_CAP_PROP_FOURCC
 =6,

153 
CV_CAP_PROP_FRAME_COUNT
 =7,

154 
CV_CAP_PROP_FORMAT
 =8,

155 
CV_CAP_PROP_MODE
 =9,

156 
CV_CAP_PROP_BRIGHTNESS
 =10,

157 
CV_CAP_PROP_CONTRAST
 =11,

158 
CV_CAP_PROP_SATURATION
 =12,

159 
CV_CAP_PROP_HUE
 =13,

160 
CV_CAP_PROP_GAIN
 =14,

161 
CV_CAP_PROP_EXPOSURE
 =15,

162 
CV_CAP_PROP_CONVERT_RGB
 =16,

163 
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
 =17,

164 
CV_CAP_PROP_RECTIFICATION
 =18,

165 
CV_CAP_PROP_MONOCHROME
 =19,

166 
CV_CAP_PROP_SHARPNESS
 =20,

167 
CV_CAP_PROP_AUTO_EXPOSURE
 =21,

170 
CV_CAP_PROP_GAMMA
 =22,

171 
CV_CAP_PROP_TEMPERATURE
 =23,

172 
CV_CAP_PROP_TRIGGER
 =24,

173 
CV_CAP_PROP_TRIGGER_DELAY
 =25,

174 
CV_CAP_PROP_WHITE_BALANCE_RED_V
 =26,

175 
CV_CAP_PROP_ZOOM
 =27,

176 
CV_CAP_PROP_FOCUS
 =28,

177 
CV_CAP_PROP_GUID
 =29,

178 
CV_CAP_PROP_ISO_SPEED
 =30,

179 
CV_CAP_PROP_MAX_DC1394
 =31,

180 
CV_CAP_PROP_BACKLIGHT
 =32,

181 
CV_CAP_PROP_PAN
 =33,

182 
CV_CAP_PROP_TILT
 =34,

183 
CV_CAP_PROP_ROLL
 =35,

184 
CV_CAP_PROP_IRIS
 =36,

185 
CV_CAP_PROP_SETTINGS
 =37,

186 
CV_CAP_PROP_BUFFERSIZE
 =38,

188 
CV_CAP_PROP_AUTOGRAB
 =1024,

189 
CV_CAP_PROP_SUPPORTED_PREVIEW_SIZES_STRING
=1025,

190 
CV_CAP_PROP_PREVIEW_FORMAT
=1026,

193 
CV_CAP_OPENNI_DEPTH_GENERATOR
 = 1 << 31,

194 
CV_CAP_OPENNI_IMAGE_GENERATOR
 = 1 << 30,

195 
CV_CAP_OPENNI_GENERATORS_MASK
 = 
CV_CAP_OPENNI_DEPTH_GENERATOR
 + 
CV_CAP_OPENNI_IMAGE_GENERATOR
,

198 
CV_CAP_PROP_OPENNI_OUTPUT_MODE
 = 100,

199 
CV_CAP_PROP_OPENNI_FRAME_MAX_DEPTH
 = 101,

200 
CV_CAP_PROP_OPENNI_BASELINE
 = 102,

201 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
 = 103,

202 
CV_CAP_PROP_OPENNI_REGISTRATION
 = 104,

203 
CV_CAP_PROP_OPENNI_REGISTRATION_ON
 = 
CV_CAP_PROP_OPENNI_REGISTRATION
,

206 
CV_CAP_PROP_OPENNI_APPROX_FRAME_SYNC
 = 105,

207 
CV_CAP_PROP_OPENNI_MAX_BUFFER_SIZE
 = 106,

208 
CV_CAP_PROP_OPENNI_CIRCLE_BUFFER
 = 107,

209 
CV_CAP_PROP_OPENNI_MAX_TIME_DURATION
 = 108,

211 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 = 109,

212 
CV_CAP_PROP_OPENNI2_SYNC
 = 110,

213 
CV_CAP_PROP_OPENNI2_MIRROR
 = 111,

215 
CV_CAP_OPENNI_IMAGE_GENERATOR_PRESENT
 = 
CV_CAP_OPENNI_IMAGE_GENERATOR
 + 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
,

216 
CV_CAP_OPENNI_IMAGE_GENERATOR_OUTPUT_MODE
 = 
CV_CAP_OPENNI_IMAGE_GENERATOR
 + 
CV_CAP_PROP_OPENNI_OUTPUT_MODE
,

217 
CV_CAP_OPENNI_DEPTH_GENERATOR_BASELINE
 = 
CV_CAP_OPENNI_DEPTH_GENERATOR
 + 
CV_CAP_PROP_OPENNI_BASELINE
,

218 
CV_CAP_OPENNI_DEPTH_GENERATOR_FOCAL_LENGTH
 = 
CV_CAP_OPENNI_DEPTH_GENERATOR
 + 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
,

219 
CV_CAP_OPENNI_DEPTH_GENERATOR_REGISTRATION
 = 
CV_CAP_OPENNI_DEPTH_GENERATOR
 + 
CV_CAP_PROP_OPENNI_REGISTRATION
,

220 
CV_CAP_OPENNI_DEPTH_GENERATOR_REGISTRATION_ON
 = 
CV_CAP_OPENNI_DEPTH_GENERATOR_REGISTRATION
,

223 
CV_CAP_GSTREAMER_QUEUE_LENGTH
 = 200,

226 
CV_CAP_PROP_PVAPI_MULTICASTIP
 = 300,

227 
CV_CAP_PROP_PVAPI_FRAMESTARTTRIGGERMODE
 = 301,

228 
CV_CAP_PROP_PVAPI_DECIMATIONHORIZONTAL
 = 302,

229 
CV_CAP_PROP_PVAPI_DECIMATIONVERTICAL
 = 303,

230 
CV_CAP_PROP_PVAPI_BINNINGX
 = 304,

231 
CV_CAP_PROP_PVAPI_BINNINGY
 = 305,

232 
CV_CAP_PROP_PVAPI_PIXELFORMAT
 = 306,

235 
CV_CAP_PROP_XI_DOWNSAMPLING
 = 400,

236 
CV_CAP_PROP_XI_DATA_FORMAT
 = 401,

237 
CV_CAP_PROP_XI_OFFSET_X
 = 402,

238 
CV_CAP_PROP_XI_OFFSET_Y
 = 403,

239 
CV_CAP_PROP_XI_TRG_SOURCE
 = 404,

240 
CV_CAP_PROP_XI_TRG_SOFTWARE
 = 405,

241 
CV_CAP_PROP_XI_GPI_SELECTOR
 = 406,

242 
CV_CAP_PROP_XI_GPI_MODE
 = 407,

243 
CV_CAP_PROP_XI_GPI_LEVEL
 = 408,

244 
CV_CAP_PROP_XI_GPO_SELECTOR
 = 409,

245 
CV_CAP_PROP_XI_GPO_MODE
 = 410,

246 
CV_CAP_PROP_XI_LED_SELECTOR
 = 411,

247 
CV_CAP_PROP_XI_LED_MODE
 = 412,

248 
CV_CAP_PROP_XI_MANUAL_WB
 = 413,

249 
CV_CAP_PROP_XI_AUTO_WB
 = 414,

250 
CV_CAP_PROP_XI_AEAG
 = 415,

251 
CV_CAP_PROP_XI_EXP_PRIORITY
 = 416,

252 
CV_CAP_PROP_XI_AE_MAX_LIMIT
 = 417,

253 
CV_CAP_PROP_XI_AG_MAX_LIMIT
 = 418,

254 
CV_CAP_PROP_XI_AEAG_LEVEL
 = 419,

255 
CV_CAP_PROP_XI_TIMEOUT
 = 420,

258 
CV_CAP_PROP_ANDROID_FLASH_MODE
 = 8001,

259 
CV_CAP_PROP_ANDROID_FOCUS_MODE
 = 8002,

260 
CV_CAP_PROP_ANDROID_WHITE_BALANCE
 = 8003,

261 
CV_CAP_PROP_ANDROID_ANTIBANDING
 = 8004,

262 
CV_CAP_PROP_ANDROID_FOCAL_LENGTH
 = 8005,

263 
CV_CAP_PROP_ANDROID_FOCUS_DISTANCE_NEAR
 = 8006,

264 
CV_CAP_PROP_ANDROID_FOCUS_DISTANCE_OPTIMAL
 = 8007,

265 
CV_CAP_PROP_ANDROID_FOCUS_DISTANCE_FAR
 = 8008,

266 
CV_CAP_PROP_ANDROID_EXPOSE_LOCK
 = 8009,

267 
CV_CAP_PROP_ANDROID_WHITEBALANCE_LOCK
 = 8010,

270 
CV_CAP_PROP_IOS_DEVICE_FOCUS
 = 9001,

271 
CV_CAP_PROP_IOS_DEVICE_EXPOSURE
 = 9002,

272 
CV_CAP_PROP_IOS_DEVICE_FLASH
 = 9003,

273 
CV_CAP_PROP_IOS_DEVICE_WHITEBALANCE
 = 9004,

274 
CV_CAP_PROP_IOS_DEVICE_TORCH
 = 9005,

278 
CV_CAP_PROP_GIGA_FRAME_OFFSET_X
 = 10001,

279 
CV_CAP_PROP_GIGA_FRAME_OFFSET_Y
 = 10002,

280 
CV_CAP_PROP_GIGA_FRAME_WIDTH_MAX
 = 10003,

281 
CV_CAP_PROP_GIGA_FRAME_HEIGH_MAX
 = 10004,

282 
CV_CAP_PROP_GIGA_FRAME_SENS_WIDTH
 = 10005,

283 
CV_CAP_PROP_GIGA_FRAME_SENS_HEIGH
 = 10006,

285 
CV_CAP_PROP_INTELPERC_PROFILE_COUNT
 = 11001,

286 
CV_CAP_PROP_INTELPERC_PROFILE_IDX
 = 11002,

287 
CV_CAP_PROP_INTELPERC_DEPTH_LOW_CONFIDENCE_VALUE
 = 11003,

288 
CV_CAP_PROP_INTELPERC_DEPTH_SATURATION_VALUE
 = 11004,

289 
CV_CAP_PROP_INTELPERC_DEPTH_CONFIDENCE_THRESHOLD
 = 11005,

290 
CV_CAP_PROP_INTELPERC_DEPTH_FOCAL_LENGTH_HORZ
 = 11006,

291 
CV_CAP_PROP_INTELPERC_DEPTH_FOCAL_LENGTH_VERT
 = 11007,

294 
CV_CAP_INTELPERC_DEPTH_GENERATOR
 = 1 << 29,

295 
CV_CAP_INTELPERC_IMAGE_GENERATOR
 = 1 << 28,

296 
CV_CAP_INTELPERC_GENERATORS_MASK
 = 
CV_CAP_INTELPERC_DEPTH_GENERATOR
 + 
CV_CAP_INTELPERC_IMAGE_GENERATOR


303 
CV_CAP_MODE_BGR
 = 0,

304 
CV_CAP_MODE_RGB
 = 1,

305 
CV_CAP_MODE_GRAY
 = 2,

306 
CV_CAP_MODE_YUYV
 = 3

312 
CV_CAP_OPENNI_DEPTH_MAP
 = 0,

313 
CV_CAP_OPENNI_POINT_CLOUD_MAP
 = 1,

314 
CV_CAP_OPENNI_DISPARITY_MAP
 = 2,

315 
CV_CAP_OPENNI_DISPARITY_MAP_32F
 = 3,

316 
CV_CAP_OPENNI_VALID_DEPTH_MASK
 = 4,

319 
CV_CAP_OPENNI_BGR_IMAGE
 = 5,

320 
CV_CAP_OPENNI_GRAY_IMAGE
 = 6

326 
CV_CAP_OPENNI_VGA_30HZ
 = 0,

327 
CV_CAP_OPENNI_SXGA_15HZ
 = 1,

328 
CV_CAP_OPENNI_SXGA_30HZ
 = 2,

329 
CV_CAP_OPENNI_QVGA_30HZ
 = 3,

330 
CV_CAP_OPENNI_QVGA_60HZ
 = 4

335 
CV_CAP_INTELPERC_DEPTH_MAP
 = 0,

336 
CV_CAP_INTELPERC_UVDEPTH_MAP
 = 1,

337 
CV_CAP_INTELPERC_IR_MAP
 = 2,

338 
CV_CAP_INTELPERC_IMAGE
 = 3

346 
CV_CAP_PROP_GPHOTO2_PREVIEW
 = 17001,

347 
CV_CAP_PROP_GPHOTO2_WIDGET_ENUMERATE
 = 17002,

348 
CV_CAP_PROP_GPHOTO2_RELOAD_CONFIG
 = 17003,

349 
CV_CAP_PROP_GPHOTO2_RELOAD_ON_CHANGE
 = 17004,

350 
CV_CAP_PROP_GPHOTO2_COLLECT_MSGS
 = 17005,

351 
CV_CAP_PROP_GPHOTO2_FLUSH_MSGS
 = 17006,

352 
CV_CAP_PROP_SPEED
 = 17007,

353 
CV_CAP_PROP_APERTURE
 = 17008,

354 
CV_CAP_PROP_EXPOSUREPROGRAM
 = 17009,

355 
CV_CAP_PROP_VIEWFINDER
 = 17010

359 
CVAPI
(Ë
cvGëC≠tuªPr›îty
–
CvC≠tuª
* 
ˇ±uª
, 
¥›îty_id
 );

360 
CVAPI
(Ë
cvSëC≠tuªPr›îty
–
CvC≠tuª
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
 );

363 
CVAPI
(Ë
cvGëC≠tuªDomaö
–
CvC≠tuª
* 
ˇ±uª
);

366 
CvVideoWrôî
 
	tCvVideoWrôî
;

368 
	#CV_FOURCC_MACRO
(
c1
, 
c2
, 
c3
, 
c4
Ë(((c1Ë& 255Ë+ (((c2Ë& 255Ë<< 8Ë+ (((c3Ë& 255Ë<< 16Ë+ (((c4Ë& 255Ë<< 24))

	)

370 
CV_INLINE
 
CV_FOURCC
(
c1
, 
c2
, 
c3
, 
c4
)

372  
CV_FOURCC_MACRO
(
c1
, 
c2
, 
c3
, 
c4
);

375 
	#CV_FOURCC_PROMPT
 -1

	)

376 
	#CV_FOURCC_DEFAULT
 
	`CV_FOURCC
('I', 'Y', 'U', 'V'Ë

	)

379 
CVAPI
(
CvVideoWrôî
*Ë
cvCª©eVideoWrôî
–c⁄° * 
fûíame
, 
fourcc
,

380 
Âs
, 
CvSize
 
‰ame_size
,

381 
is_cﬁ‹
 
CV_DEFAULT
(1));

384 
CVAPI
(Ë
cvWrôeFøme
–
CvVideoWrôî
* 
wrôî
, c⁄° 
I∂Image
* 
image
 );

387 
CVAPI
(Ë
cvRñó£VideoWrôî
–
CvVideoWrôî
** 
wrôî
 );

393 
	#cvC≠tuªFromFûe
 
cvCª©eFûeC≠tuª


	)

394 
	#cvC≠tuªFromCAM
 
cvCª©eCamîaC≠tuª


	)

395 
	#cvC≠tuªFromAVI
 
cvC≠tuªFromFûe


	)

396 
	#cvCª©eAVIWrôî
 
cvCª©eVideoWrôî


	)

397 
	#cvWrôeToAVI
 
cvWrôeFøme


	)

401 #ifde‡
__˝lu•lus


	@perf/perf_input.cpp

1 
	~"≥rf_¥ecomp.hµ
"

3 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT


5 
usög
 
«me•a˚
 
	g°d
;

6 
usög
 
«me•a˚
 
	gcv
;

7 
usög
 
«me•a˚
 
	g≥rf
;

8 
usög
 
	g°d
::
å1
::
make_tu∂e
;

9 
usög
 
	g°d
::
å1
::
gë
;

12 
	g≥rf
::
	tTe°Ba£WôhP¨am
<
	t°d
::
	t°rög
> 
	tVideoC≠tuª_Ródög
;

14 #i‡
deföed
(
HAVE_MSMF
)

17 
PERF_TEST_P
(
VideoC≠tuª_Ródög
, 
RódFûe
, 
ã°ög
::
VÆues
( "highgui/video/big_buck_bunny.avi",

23 
PERF_TEST_P
(
VideoC≠tuª_Ródög
, 
RódFûe
, 
ã°ög
::
VÆues
( "highgui/video/big_buck_bunny.avi",

30 
°rög
 
	gfûíame
 = 
gëD©aP©h
(
GëP¨am
());

32 
VideoC≠tuª
 
	gˇp
;

34 
TEST_CYCLE
(Ë
	gˇp
.
›í
(
fûíame
);

36 
boﬁ
 
	gdummy
 = 
ˇp
.
isO≥√d
();

37 
SANITY_CHECK
(
dummy
);

	@perf/perf_main.cpp

1 
	~"≥rf_¥ecomp.hµ
"

3 
CV_PERF_TEST_MAIN
(
videoio
)

	@perf/perf_output.cpp

1 
	~"≥rf_¥ecomp.hµ
"

3 #i‡
BUILD_WITH_VIDEO_OUTPUT_SUPPORT


5 
usög
 
«me•a˚
 
	g°d
;

6 
usög
 
«me•a˚
 
	gcv
;

7 
usög
 
«me•a˚
 
	g≥rf
;

8 
usög
 
	g°d
::
å1
::
make_tu∂e
;

9 
usög
 
	g°d
::
å1
::
gë
;

11 
	g°d
::
	tå1
::
	ttu∂e
<
	t°d
::
	t°rög
, 
	tboﬁ
> 
	tVideoWrôî_Wrôög_t
;

12 
	g≥rf
::
	tTe°Ba£WôhP¨am
<
	tVideoWrôî_Wrôög_t
> 
	tVideoWrôî_Wrôög
;

14 
PERF_TEST_P
(
VideoWrôî_Wrôög
, 
WrôeFøme
,

15 
ã°ög
::
Comböe
–ã°ög::
VÆues
( "python/images/QCIF_00.bmp",

21 
ã°ög
::
	$Boﬁ
()))

23 
°rög
 
fûíame
 = 
	`gëD©aP©h
(
gë
<0>(
	`GëP¨am
()));

24 
boﬁ
 
isCﬁ‹
 = 
gë
<1>(
	`GëP¨am
());

25 
M©
 
image
 = 
	`imªad
(
fûíame
, 1);

26 #i‡
	`deföed
(
HAVE_MSMF
Ë&& !deföed(
HAVE_VFW
Ë&& !deföed(
HAVE_FFMPEG
)

27 
VideoWrôî
 
	`wrôî
(
cv
::
	`ãmpfûe
(".wmv"), VideoWrôî::
	`fourcc
('W', 'M', 'V', '3'),

28 25, 
cv
::
	`Size
(
image
.
cﬁs
, image.
rows
), 
isCﬁ‹
);

30 
VideoWrôî
 
	`wrôî
(
cv
::
	`ãmpfûe
(".avi"), VideoWrôî::
	`fourcc
('X', 'V', 'I', 'D'),

31 25, 
cv
::
	`Size
(
image
.
cﬁs
, image.
rows
), 
isCﬁ‹
);

34 
	`TEST_CYCLE
(Ë{ 
image
 = 
	`imªad
(
fûíame
, 1); 
wrôî
 << image; }

36 
boﬁ
 
dummy
 = 
wrôî
.
	`isO≥√d
();

37 
	`SANITY_CHECK
(
dummy
);

38 
	}
}

	@src/cap.cpp

42 
	~"¥ecomp.hµ
"

43 
	~"ˇp_öãÕîc.hµ
"

44 
	~"ˇp_dshow.hµ
"

47 #i‡
deföed
(
WINRT
Ë&& !deföed(
WINRT_8_0
)

48 
	~"ˇp_wöπ_ˇ±uª.hµ
"

49 
	~"ˇp_wöπ_bridge.hµ
"

50 
	#WINRT_VIDEO


	)

53 #i‡
deföed
 
_M_X64
 && deföed 
_MSC_VER
 && !deföed 
CV_ICC


54 #¥agm®
›timize
("",
off
)

55 #¥agm®
w¨nög
(
dißbÀ
: 4748)

58 
«me•a˚
 
	gcv


61 
	gãm∂©e
<> 
	gDeÁu…Dñëî
<
	gCvC≠tuª
>::
›î©‹
 ()(
CvC≠tuª
* 
obj
) const

62 { 
cvRñó£C≠tuª
(&
obj
); }

64 
	gãm∂©e
<> 
	gDeÁu…Dñëî
<
	gCvVideoWrôî
>::
›î©‹
 ()(
CvVideoWrôî
* 
obj
) const

65 { 
cvRñó£VideoWrôî
(&
obj
); }

71 
ölöe
 
	$icvGëC≠tuªPr›îty
–c⁄° 
CvC≠tuª
* 
ˇ±uª
, 
id
 )

73  
ˇ±uª
 ? c≠tuª->
	`gëPr›îty
(
id
) : 0;

74 
	}
}

76 
CV_IMPL
 
	$cvRñó£C≠tuª
–
CvC≠tuª
** 
pˇ±uª
 )

78 if–
pˇ±uª
 && *pcapture )

80 
dñëe
 *
pˇ±uª
;

81 *
pˇ±uª
 = 0;

83 
	}
}

85 
CV_IMPL
 
I∂Image
* 
	$cvQuîyFøme
–
CvC≠tuª
* 
ˇ±uª
 )

87 if(!
ˇ±uª
)

89 if(!
ˇ±uª
->
	`gøbFøme
())

91  
ˇ±uª
->
	`ªåõveFøme
(0);

92 
	}
}

95 
CV_IMPL
 
	$cvGøbFøme
–
CvC≠tuª
* 
ˇ±uª
 )

97  
ˇ±uª
 ? c≠tuª->
	`gøbFøme
() : 0;

98 
	}
}

100 
CV_IMPL
 
I∂Image
* 
	$cvRërõveFøme
–
CvC≠tuª
* 
ˇ±uª
, 
idx
 )

102  
ˇ±uª
 ? c≠tuª->
	`ªåõveFøme
(
idx
) : 0;

103 
	}
}

105 
CV_IMPL
 
	$cvGëC≠tuªPr›îty
–
CvC≠tuª
* 
ˇ±uª
, 
id
 )

107  
	`icvGëC≠tuªPr›îty
(
ˇ±uª
, 
id
);

108 
	}
}

110 
CV_IMPL
 
	$cvSëC≠tuªPr›îty
–
CvC≠tuª
* 
ˇ±uª
, 
id
, 
vÆue
 )

112  
ˇ±uª
 ? c≠tuª->
	`£tPr›îty
(
id
, 
vÆue
) : 0;

113 
	}
}

115 
CV_IMPL
 
	$cvGëC≠tuªDomaö
–
CvC≠tuª
* 
ˇ±uª
)

117  
ˇ±uª
 ? c≠tuª->
	`gëC≠tuªDomaö
() : 0;

118 
	}
}

127 
CV_IMPL
 
CvC≠tuª
 * 
	$cvCª©eCamîaC≠tuª
 (
ödex
)

129 
domaös
[] =

131 #ifde‡
HAVE_MSMF


132 
CV_CAP_MSMF
,

135 
CV_CAP_IEEE1394
,

137 #ifde‡
HAVE_TYZX


138 
CV_CAP_STEREO
,

140 #ifde‡
HAVE_PVAPI


141 
CV_CAP_PVAPI
,

144 
CV_CAP_VFW
,

146 #ifde‡
HAVE_MIL


147 
CV_CAP_MIL
,

149 #i‡
	`deföed
(
HAVE_QUICKTIME
Ë|| deföed(
HAVE_QTKIT
)

150 
CV_CAP_QT
,

152 #ifde‡
HAVE_UNICAP


153 
CV_CAP_UNICAP
,

155 #ifde‡
HAVE_OPENNI


156 
CV_CAP_OPENNI
,

158 #ifde‡
HAVE_OPENNI2


159 
CV_CAP_OPENNI2
,

161 #ifde‡
HAVE_XIMEA


162 
CV_CAP_XIAPI
,

164 #ifde‡
HAVE_AVFOUNDATION


165 
CV_CAP_AVFOUNDATION
,

167 #ifde‡
HAVE_GIGE_API


168 
CV_CAP_GIGANETIX
,

170 #ifde‡
HAVE_INTELPERC


171 
CV_CAP_INTELPERC
,

177 
¥ef
 = (
ödex
 / 100) * 100;

178 i‡(
¥ef
)

180 
domaös
[0]=
¥ef
;

181 
ödex
 %= 100;

182 
domaös
[1]=-1;

186 
i
 = 0; 
domaös
[i] >= 0; i++)

188 #i‡
	`deföed
(
HAVE_MSMF
) || \

189 
	`deföed
(
HAVE_TYZX
) || \

190 
	`deföed
(
HAVE_VFW
) || \

191 
	`deföed
(
HAVE_LIBV4L
) || \

192 
	`deföed
(
HAVE_CAMV4L
) || \

193 
	`deföed
(
HAVE_CAMV4L2
) || \

194 
	`deföed
(
HAVE_VIDEOIO
) || \

195 
	`deföed
(
HAVE_GSTREAMER
) || \

196 
	`deföed
(
HAVE_DC1394_2
) || \

197 
	`deföed
(
HAVE_DC1394
) || \

198 
	`deföed
(
HAVE_CMU1394
) || \

199 
	`deföed
(
HAVE_MIL
) || \

200 
	`deföed
(
HAVE_QUICKTIME
) || \

201 
	`deföed
(
HAVE_QTKIT
) || \

202 
	`deföed
(
HAVE_UNICAP
) || \

203 
	`deföed
(
HAVE_PVAPI
) || \

204 
	`deföed
(
HAVE_OPENNI
) || \

205 
	`deföed
(
HAVE_OPENNI2
) || \

206 
	`deföed
(
HAVE_XIMEA
) || \

207 
	`deföed
(
HAVE_AVFOUNDATION
) || \

208 
	`deföed
(
HAVE_GIGE_API
) || \

209 
	`deföed
(
HAVE_INTELPERC
) || \

212 
CvC≠tuª
 *
ˇ±uª
;

215 
domaös
[
i
])

217 #ifde‡
HAVE_MSMF


218 
CV_CAP_MSMF
:

219 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_MSMF
 (
ödex
);

220 i‡(
ˇ±uª
)

221  
ˇ±uª
;

224 #ifde‡
HAVE_TYZX


225 
CV_CAP_STEREO
:

226 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_TYZX
 (
ödex
);

227 i‡(
ˇ±uª
)

228  
ˇ±uª
;

231 
CV_CAP_VFW
:

232 #ifde‡
HAVE_VFW


233 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_VFW
 (
ödex
);

234 i‡(
ˇ±uª
)

235  
ˇ±uª
;

237 #i‡
deföed
 
HAVE_LIBV4L
 || deföed 
HAVE_CAMV4L
 || deföed 
HAVE_CAMV4L2
 || deföed 
HAVE_VIDEOIO


238 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_V4L
 (
ödex
);

239 i‡(
ˇ±uª
)

240  
ˇ±uª
;

243 #ifde‡
HAVE_GSTREAMER


244 
ˇ±uª
 = 
	`cvCª©eC≠tuª_GSåómî
(
CV_CAP_GSTREAMER_V4L2
, 0);

245 i‡(
ˇ±uª
)

246  
ˇ±uª
;

247 
ˇ±uª
 = 
	`cvCª©eC≠tuª_GSåómî
(
CV_CAP_GSTREAMER_V4L
, 0);

248 i‡(
ˇ±uª
)

249  
ˇ±uª
;

253 
CV_CAP_FIREWIRE
:

254 #ifde‡
HAVE_DC1394_2


255 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_DC1394_2
 (
ödex
);

256 i‡(
ˇ±uª
)

257  
ˇ±uª
;

260 #ifde‡
HAVE_DC1394


261 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_DC1394
 (
ödex
);

262 i‡(
ˇ±uª
)

263  
ˇ±uª
;

266 #ifde‡
HAVE_CMU1394


267 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_CMU
 (
ödex
);

268 i‡(
ˇ±uª
)

269  
ˇ±uª
;

272 #i‡
	`deföed
(
HAVE_GSTREAMER
) && 0

274 
ˇ±uª
 = 
	`cvCª©eC≠tuª_GSåómî
(
CV_CAP_GSTREAMER_1394
, 0);

275 i‡(
ˇ±uª
)

276  
ˇ±uª
;

280 #ifde‡
HAVE_MIL


281 
CV_CAP_MIL
:

282 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_MIL
 (
ödex
);

283 i‡(
ˇ±uª
)

284  
ˇ±uª
;

288 #i‡
	`deföed
(
HAVE_QUICKTIME
Ë|| deföed(
HAVE_QTKIT
)

289 
CV_CAP_QT
:

290 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_QT
 (
ödex
);

291 i‡(
ˇ±uª
)

292  
ˇ±uª
;

296 #ifde‡
HAVE_UNICAP


297 
CV_CAP_UNICAP
:

298 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_Uniˇp
 (
ödex
);

299 i‡(
ˇ±uª
)

300  
ˇ±uª
;

304 #ifde‡
HAVE_PVAPI


305 
CV_CAP_PVAPI
:

306 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_PvAPI
 (
ödex
);

307 i‡(
ˇ±uª
)

308  
ˇ±uª
;

312 #ifde‡
HAVE_OPENNI


313 
CV_CAP_OPENNI
:

314 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_O≥nNI
 (
ödex
);

315 i‡(
ˇ±uª
)

316  
ˇ±uª
;

320 #ifde‡
HAVE_OPENNI2


321 
CV_CAP_OPENNI2
:

322 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_O≥nNI
(
ödex
);

323 i‡(
ˇ±uª
)

324  
ˇ±uª
;

328 #ifde‡
HAVE_XIMEA


329 
CV_CAP_XIAPI
:

330 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_XIMEA
 (
ödex
);

331 i‡(
ˇ±uª
)

332  
ˇ±uª
;

336 #ifde‡
HAVE_AVFOUNDATION


337 
CV_CAP_AVFOUNDATION
:

338 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_AVFound©i⁄
 (
ödex
);

339 i‡(
ˇ±uª
)

340  
ˇ±uª
;

344 #ifde‡
HAVE_GIGE_API


345 
CV_CAP_GIGANETIX
:

346 
ˇ±uª
 = 
	`cvCª©eCamîaC≠tuª_Gig™ëix
 (
ödex
);

347 i‡(
ˇ±uª
)

348  
ˇ±uª
;

356 
	}
}

362 
CV_IMPL
 
CvC≠tuª
 * 
	$cvCª©eFûeC≠tuª
 (c⁄° * 
fûíame
)

364 
CvC≠tuª
 * 
ªsu…
 = 0;

366 #ifde‡
HAVE_FFMPEG


367 i‡(! 
ªsu…
)

368 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_FFMPEG_¥oxy
 (
fûíame
);

371 #ifde‡
HAVE_VFW


372 i‡(! 
ªsu…
)

373 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_VFW
 (
fûíame
);

376 #ifde‡
HAVE_MSMF


377 i‡(! 
ªsu…
)

378 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_MSMF
 (
fûíame
);

381 #ifde‡
HAVE_XINE


382 i‡(! 
ªsu…
)

383 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_XINE
 (
fûíame
);

386 #ifde‡
HAVE_GSTREAMER


387 i‡(! 
ªsu…
)

388 
ªsu…
 = 
	`cvCª©eC≠tuª_GSåómî
 (
CV_CAP_GSTREAMER_FILE
, 
fûíame
);

391 #i‡
	`deföed
(
HAVE_QUICKTIME
Ë|| deföed(
HAVE_QTKIT
)

392 i‡(! 
ªsu…
)

393 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_QT
 (
fûíame
);

396 #ifde‡
HAVE_AVFOUNDATION


397 i‡(! 
ªsu…
)

398 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_AVFound©i⁄
 (
fûíame
);

401 #ifde‡
HAVE_OPENNI


402 i‡(! 
ªsu…
)

403 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_O≥nNI
 (
fûíame
);

406 i‡(! 
ªsu…
)

407 
ªsu…
 = 
	`cvCª©eFûeC≠tuª_Images
 (
fûíame
);

409  
ªsu…
;

410 
	}
}

416 
CV_IMPL
 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî
–c⁄° * 
fûíame
, 
fourcc
,

417 
Âs
, 
CvSize
 
‰ameSize
, 
is_cﬁ‹
 )

421 
CvVideoWrôî
 *
ªsu…
 = 0;

423 if(!
fourcc
 || !
Âs
)

424 
ªsu…
 = 
	`cvCª©eVideoWrôî_Images
(
fûíame
);

426 #ifde‡
HAVE_FFMPEG


427 if(!
ªsu…
)

428 
ªsu…
 = 
	`cvCª©eVideoWrôî_FFMPEG_¥oxy
 (
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

431 #ifde‡
HAVE_VFW


432 if(!
ªsu…
)

433 
ªsu…
 = 
	`cvCª©eVideoWrôî_VFW
(
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

436 #ifde‡
HAVE_MSMF


437 i‡(!
ªsu…
)

438 
ªsu…
 = 
	`cvCª©eVideoWrôî_MSMF
(
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

446 #ifde‡
HAVE_AVFOUNDATION


447 i‡(! 
ªsu…
)

448 
ªsu…
 = 
	`cvCª©eVideoWrôî_AVFound©i⁄
(
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

451 #i‡
	`deföed
(
HAVE_QUICKTIME
Ë|| deföed(
HAVE_QTKIT
)

452 if(!
ªsu…
)

453 
ªsu…
 = 
	`cvCª©eVideoWrôî_QT
(
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

456 #ifde‡
HAVE_GSTREAMER


457 i‡(! 
ªsu…
)

458 
ªsu…
 = 
	`cvCª©eVideoWrôî_GSåómî
(
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
is_cﬁ‹
);

461 #i‡!
	`deföed
(
HAVE_FFMPEG
) && \

462 !
	`deföed
(
HAVE_VFW
) && \

463 !
	`deföed
(
HAVE_MSMF
) && \

464 !
	`deföed
(
HAVE_AVFOUNDATION
) && \

465 !
	`deföed
(
HAVE_QUICKTIME
) && \

466 !
	`deföed
(
HAVE_QTKIT
) && \

467 !
	`deföed
(
HAVE_GSTREAMER
)

470 ()
‰ameSize
;

471 ()
is_cﬁ‹
;

474 if(!
ªsu…
)

475 
ªsu…
 = 
	`cvCª©eVideoWrôî_Images
(
fûíame
);

477  
ªsu…
;

478 
	}
}

480 
CV_IMPL
 
	$cvWrôeFøme
–
CvVideoWrôî
* 
wrôî
, c⁄° 
I∂Image
* 
image
 )

482  
wrôî
 ? wrôî->
	`wrôeFøme
(
image
) : 0;

483 
	}
}

485 
CV_IMPL
 
	$cvRñó£VideoWrôî
–
CvVideoWrôî
** 
pwrôî
 )

487 if–
pwrôî
 && *pwriter )

489 
dñëe
 *
pwrôî
;

490 *
pwrôî
 = 0;

492 
	}
}

494 
«me•a˚
 
	gcv


497 
	gPå
<
	gIVideoC≠tuª
> 
IVideoC≠tuª_¸óã
(
ödex
)

499 
	gdomaös
[] =

501 #ifde‡
HAVE_DSHOW


502 
CV_CAP_DSHOW
,

504 #ifde‡
HAVE_INTELPERC


505 
CV_CAP_INTELPERC
,

507 #ifde‡
WINRT_VIDEO


508 
CAP_WINRT
,

510 #ifde‡
HAVE_GPHOTO2


511 
CV_CAP_GPHOTO2
,

517 
	g¥ef
 = (
ödex
 / 100) * 100;

518 i‡(
	g¥ef
)

520 
	gdomaös
[0]=
¥ef
;

521 
	gödex
 %= 100;

522 
	gdomaös
[1]=-1;

526 
	gi
 = 0; 
	gdomaös
[
i
] >= 0; i++)

528 #i‡
deföed
(
HAVE_DSHOW
) || \

529 
deföed
(
HAVE_INTELPERC
) || \

530 
deföed
(
WINRT_VIDEO
) || \

531 
deföed
(
HAVE_GPHOTO2
) || \

533 
	gPå
<
	gIVideoC≠tuª
> 
	gˇ±uª
;

535 
	gdomaös
[
i
])

537 #ifde‡
HAVE_DSHOW


538 
	gCV_CAP_DSHOW
:

539 
ˇ±uª
 = 
makePå
<
VideoC≠tuª_DShow
>(
ödex
);

542 #ifde‡
HAVE_INTELPERC


543 
	gCV_CAP_INTELPERC
:

544 
ˇ±uª
 = 
makePå
<
VideoC≠tuª_I¡ñPîC
>();

547 #ifde‡
WINRT_VIDEO


548 
	gCAP_WINRT
:

549 
ˇ±uª
 = 
På
<
IVideoC≠tuª
>(
√w
 
cv
::
VideoC≠tuª_WöRT
(
ödex
));

550 i‡(
	gˇ±uª
)

551  
	gˇ±uª
;

554 #ifde‡
HAVE_GPHOTO2


555 
	gCV_CAP_GPHOTO2
:

556 
ˇ±uª
 = 
¸óãGPhŸo2C≠tuª
(
ödex
);

560 i‡(
	gˇ±uª
 && c≠tuª->
isO≥√d
())

561  
	gˇ±uª
;

566  
	gPå
<
	gIVideoC≠tuª
>();

570 
	gPå
<
	gIVideoC≠tuª
> 
IVideoC≠tuª_¸óã
(c⁄° 
Såög
& 
fûíame
)

572 
	gdomaös
[] =

574 
CV_CAP_ANY
,

575 #ifde‡
HAVE_GPHOTO2


576 
CV_CAP_GPHOTO2
,

582 
	gi
 = 0; 
	gdomaös
[
i
] >= 0; i++)

584 
	gPå
<
	gIVideoC≠tuª
> 
	gˇ±uª
;

586 
	gdomaös
[
i
])

588 
	gCV_CAP_ANY
:

589 
ˇ±uª
 = 
¸óãMŸi⁄J≥gC≠tuª
(
fûíame
);

591 #ifde‡
HAVE_GPHOTO2


592 
	gCV_CAP_GPHOTO2
:

593 
ˇ±uª
 = 
¸óãGPhŸo2C≠tuª
(
fûíame
);

598 i‡(
	gˇ±uª
 && c≠tuª->
isO≥√d
())

600  
	gˇ±uª
;

604  
	gPå
<
	gIVideoC≠tuª
>();

607 
	gPå
<
	gIVideoWrôî
> 
IVideoWrôî_¸óã
(c⁄° 
Såög
& 
fûíame
, 
_fourcc
, 
Âs
, 
Size
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
)

609 
	gPå
<
	gIVideoWrôî
> 
	giwrôî
;

610 if–
	g_fourcc
 =
CV_FOURCC
('M', 'J', 'P', 'G') )

611 
	giwrôî
 = 
¸óãMŸi⁄J≥gWrôî
(
fûíame
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
);

612  
	giwrôî
;

615 
	gVideoC≠tuª
::
VideoC≠tuª
()

618 
VideoC≠tuª
::VideoC≠tuª(c⁄° 
Såög
& 
fûíame
)

620 
›í
(
fûíame
);

623 
	gVideoC≠tuª
::
VideoC≠tuª
(
devi˚
)

625 
›í
(
devi˚
);

628 
	gVideoC≠tuª
::~
VideoC≠tuª
()

630 
iˇp
.
ªÀa£
();

631 
	gˇp
.
ªÀa£
();

634 
boﬁ
 
	gVideoC≠tuª
::
›í
(c⁄° 
Såög
& 
fûíame
)

636 i‡(
isO≥√d
()Ë
ªÀa£
();

637 
	giˇp
 = 
IVideoC≠tuª_¸óã
(
fûíame
);

638 i‡(!
	giˇp
.
em±y
())

639  
	gåue
;

641 
	gˇp
.
ª£t
(
cvCª©eFûeC≠tuª
(
fûíame
.
c_°r
()));

642  
isO≥√d
();

645 
boﬁ
 
	gVideoC≠tuª
::
›í
(
devi˚
)

647 i‡(
isO≥√d
()Ë
ªÀa£
();

648 
	giˇp
 = 
IVideoC≠tuª_¸óã
(
devi˚
);

649 i‡(!
	giˇp
.
em±y
())

650  
	gåue
;

651 
	gˇp
.
ª£t
(
cvCª©eCamîaC≠tuª
(
devi˚
));

652  
isO≥√d
();

655 
boﬁ
 
	gVideoC≠tuª
::
isO≥√d
() const

657  (!
ˇp
.
em±y
(Ë|| !
iˇp
.empty());

660 
	gVideoC≠tuª
::
ªÀa£
()

662 
iˇp
.
ªÀa£
();

663 
	gˇp
.
ªÀa£
();

666 
boﬁ
 
	gVideoC≠tuª
::
gøb
()

668 i‡(!
iˇp
.
em±y
())

669  
iˇp
->
gøbFøme
();

670  
cvGøbFøme
(
ˇp
) != 0;

673 
boﬁ
 
	gVideoC≠tuª
::
ªåõve
(
OuçutAºay
 
image
, 
ch™√l
)

675 i‡(!
	giˇp
.
em±y
())

676  
	giˇp
->
ªåõveFøme
(
ch™√l
, 
image
);

678 
I∂Image
* 
	g_img
 = 
cvRërõveFøme
(
ˇp
, 
ch™√l
);

679 if–!
	g_img
 )

681 
	gimage
.
ªÀa£
();

682  
	gÁl£
;

684 if(
	g_img
->
	g‹igö
 =
IPL_ORIGIN_TL
)

685 
cv
::
cv¨rToM©
(
_img
).
c›yTo
(
image
);

688 
M©
 
	gãmp
 = 
cv
::
cv¨rToM©
(
_img
);

689 
Êù
(
ãmp
, 
image
, 0);

691  
	gåue
;

694 
boﬁ
 
	gVideoC≠tuª
::
ªad
(
OuçutAºay
 
image
)

697 if(
gøb
())

698 
ªåõve
(
image
);

700 
	gimage
.
ªÀa£
();

701  !
	gimage
.
em±y
();

704 
	gVideoC≠tuª
& VideoC≠tuª::
›î©‹
 >> (
M©
& 
image
)

706 #ifde‡
WINRT_VIDEO


707 i‡(
gøb
())

709 i‡(
ªåõve
(
image
))

711 
°d
::
lock_gu¨d
<°d::
muãx
> 
lock
(
VideoioBridge
::
gëIn°™˚
().
öputBuf„rMuãx
);

712 
	gVideoioBridge
& 
	gbridge
 = 
VideoioBridge
::
gëIn°™˚
();

715 
	gbridge
.
sw≠I≈utBuf„rs
();

716 autÿ
	gp
 = 
bridge
.
‰⁄tI≈utPå
;

718 
	gbridge
.
	gbIsFømeNew
 = 
Ál£
;

721 
M©
 
m
(
bridge
.
gëHeight
(), bridge.
gëWidth
(), 
CV_8UC3
, 
p
);

722 
	gimage
 = 
m
;

726 
ªad
(
image
);

729  *
	gthis
;

732 
	gVideoC≠tuª
& VideoC≠tuª::
›î©‹
 >> (
UM©
& 
image
)

734 
ªad
(
image
);

735  *
	gthis
;

738 
boﬁ
 
	gVideoC≠tuª
::
£t
(
¥›Id
, 
vÆue
)

740 i‡(!
	giˇp
.
em±y
())

741  
	giˇp
->
£tPr›îty
(
¥›Id
, 
vÆue
);

742  
cvSëC≠tuªPr›îty
(
ˇp
, 
¥›Id
, 
vÆue
) != 0;

745 
	gVideoC≠tuª
::
gë
(
¥›Id
) const

747 i‡(!
iˇp
.
em±y
())

748  
iˇp
->
gëPr›îty
(
¥›Id
);

749  
icvGëC≠tuªPr›îty
(
ˇp
, 
¥›Id
);

753 
	gVideoWrôî
::
VideoWrôî
()

756 
VideoWrôî
::VideoWrôî(c⁄° 
Såög
& 
fûíame
, 
_fourcc
, 
Âs
, 
Size
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
)

758 
›í
(
fûíame
, 
_fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
);

761 
	gVideoWrôî
::
ªÀa£
()

763 
iwrôî
.
ªÀa£
();

764 
	gwrôî
.
ªÀa£
();

767 
	gVideoWrôî
::~
VideoWrôî
()

769 
ªÀa£
();

772 
boﬁ
 
	gVideoWrôî
::
›í
(c⁄° 
Såög
& 
fûíame
, 
_fourcc
, 
Âs
, 
Size
 
‰ameSize
, boﬁ 
isCﬁ‹
)

774 i‡(
isO≥√d
()Ë
ªÀa£
();

775 
	giwrôî
 = 
IVideoWrôî_¸óã
(
fûíame
, 
_fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
);

776 i‡(!
	giwrôî
.
em±y
())

777  
	gåue
;

778 
	gwrôî
.
ª£t
(
cvCª©eVideoWrôî
(
fûíame
.
c_°r
(), 
_fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
));

779  
isO≥√d
();

782 
boﬁ
 
	gVideoWrôî
::
isO≥√d
() const

784  !
iwrôî
.
em±y
(Ë|| !
wrôî
.empty();

788 
boﬁ
 
	gVideoWrôî
::
£t
(
¥›Id
, 
vÆue
)

790 i‡(!
	giwrôî
.
em±y
())

791  
	giwrôî
->
£tPr›îty
(
¥›Id
, 
vÆue
);

792  
	gÁl£
;

795 
	gVideoWrôî
::
gë
(
¥›Id
) const

797 i‡(!
iwrôî
.
em±y
())

798  
iwrôî
->
gëPr›îty
(
¥›Id
);

802 
	gVideoWrôî
::
wrôe
(c⁄° 
M©
& 
image
)

804 if–
iwrôî
 )

805 
iwrôî
->
wrôe
(
image
);

808 
I∂Image
 
	g_img
 = 
image
;

809 
cvWrôeFøme
(
wrôî
, &
_img
);

813 
	gVideoWrôî
& VideoWrôî::
›î©‹
 << (c⁄° 
M©
& 
image
)

815 
wrôe
(
image
);

816  *
	gthis
;

819 
	gVideoWrôî
::
fourcc
(
c1
, 
c2
, 
c3
, 
c4
)

821  (
	gc1
 & 255Ë+ ((
	gc2
 & 255Ë<< 8Ë+ ((
	gc3
 & 255Ë<< 16Ë+ ((
	gc4
 & 255) << 24);

	@src/cap_OPEL.cpp

2 
	~"¥ecomp.hµ
"

3 
	~<°dio.h
>

4 
	~<uni°d.h
>

5 
	~<f˙é.h
>

6 
	~<î∫o.h
>

7 
	~<sys/ty≥s.h
>

8 
	~<sys/mm™.h
>

9 
	~<°rög.h
>

10 
	~<°dlib.h
>

11 
	~<asm/ty≥s.h
>

12 
	~<as£π.h
>

13 
	~<sys/°©.h
>

14 
	~<sys/io˘l.h
>

15 
	~<sys/time.h
>

16 
	~<sys/mm™.h
>

17 
	~<sys/waô.h
>

18 
	~<sys/ùc.h
>

19 
	~<sys/shm.h
>

20 
	~<dbus/dbus.h
>

21 
	~<£m≠h‹e.h
>

22 
	~<löux/videodev2.h
>

24 
	~<libv4l1.h
>

25 
	~<libv4l2.h
>

27 
	#CLEAR
(
x
Ë
	`mem£t
(&(x), 0, (x))

	)

29 
	#SEM_KEY_FOR_PROPERTY
 49411

	)

30 
	#SEM_KEY_FOR_STATUS
 49441

	)

31 
	#SHM_KEY_FOR_STATUS
 4944

	)

32 
	#SHM_KEY_FOR_PROPERTY
 4941

	)

33 
	#SHM_KEY_FOR_BUFFER
 5315

	)

34 
	#OPENCV_DEFAULT_WIDTH
 640

	)

35 
	#OPENCV_DEFAULT_HEIGHT
 480

	)

37 
	#OPENCV_DEFAULT_BUF_SIZE
 921600

	)

38 
	#OPENCV_DEFAULT_BUF_INDEX
 4

	)

40 c⁄° * 
	gdev_«me
 = "/dev/video0";

41 
	gSEM_NAME
[] = "CCDSTATUS";

42 
	s°©us


44 
boﬁ
 
	misCCDRu¬ög
;

45 
boﬁ
 
	misO≥nCVRu¬ög
;

46 
boﬁ
 
	misO≥nCVInôülized
;

47 
boﬁ
 
	misRecRu¬ög
;

48 
boﬁ
 
	misRecInôülized
;

49 }
	t°©us
;

51 
	s¥›îty


53 
	mwidth
;

54 
	mheight
;

55 
	mbuf„r_size
;

56 
	mbuf„r_num
;

57 
	mn_buf„r
;

58 
boﬁ
 
	misPr›îtyCh™ged
;

59 
boﬁ
 
	mÆlowRu¬ög
;

60 }
	t¥›îty
;

61 
boﬁ
 
	$isRecRu¬ög
(
°©us
* 
°
, 
£m_t
* 
muãx
)

63 
boﬁ
 
ªtV¨

Ál£
;

64 
	`£m_waô
(
muãx
);

65 
ªtV¨
 = 
°
->
isRecRu¬ög
;

66 
	`£m_po°
(
muãx
);

67 if(
ªtV¨
)

68 
	`Ârötf
(
°dîr
, "Resource Busy\n");

70  
ªtV¨
;

71 
	}
}

72 
	$£ndDbusMsg
(
DBusC⁄√˘i⁄
* 
c⁄n
, c⁄° * 
msg
)

74 
DBusMesßge
* 
mesßge
;

75 
mesßge
 = 
	`dbus_mesßge_√w_sig«l
("/‹g/›ñ/ˇmîa/d´m⁄", "‹g.›ñ.ˇmîa.d´m⁄", 
msg
);

76 
	`dbus_c⁄√˘i⁄_£nd
(
c⁄n
, 
mesßge
, 
NULL
);

77 
	`dbus_mesßge_uƒef
(
mesßge
);

78 
	}
}

79 ˛as†
	cCvC≠tuªCAM_OPEL_CPP
 : 
CvC≠tuª


81 
public
:

82 
CvC≠tuªCAM_OPEL_CPP
();

83 
	mvútuÆ
 ~
CvC≠tuªCAM_OPEL_CPP
();

85 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

86 
vútuÆ
 
boﬁ
 
˛o£
();

87 
vútuÆ
 
	$gëPr›îty
() const;

88 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

89 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

90 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

92 
¥Ÿe˘ed
:

93 
I∂Image
 
‰ame
;

94 
fd
;

95 
shmid
;

96 * 
shmPå
;

97 
shmid_f‹_¥›îty
;

98 * 
shmPå_f‹_¥›îty
;

99 
shmid_f‹_°©us
;

100 * 
shmPå_f‹_°©us
;

101 
buf„r_size
;

102 
buf„r_ödex
;

103 
boﬁ
 
	`öô_Sh¨edMem‹yS∑˚
();

104 
boﬁ
 
	`öô_Sh¨edMem‹yS∑˚F‹Pr›îty
();

105 
boﬁ
 
	`uöô_Sh¨edMem‹yS∑˚F‹Pr›îty
();

106 
boﬁ
 
	`uöô_Sh¨edMem‹yS∑˚
();

107 
boﬁ
 
	`öô_Sem≠h‹e
();

108 
boﬁ
 
	`uöô_Sem≠h‹e
();

109 
boﬁ
 
	`öô_DBus
();

110 
boﬁ
 
	`ªadFøme
();

111 
£m_t
* 
°©usMuãx
;

112 
width
, 
height
;

113 
mode
;

114 
¥›îty
* 
¥›
;

115 
°©us
* 
°
;

116 
	`maöLo›
();

117 
£mid
;

120 
DBusC⁄√˘i⁄
* 
c⁄√˘i⁄
;

121 
DBusEº‹
 
îr‹
;

125 
boﬁ
 
CvC≠tuªCAM_OPEL_CPP
::
	$uöô_Sem≠h‹e
()

127 
	`£m_˛o£
(
this
->
°©usMuãx
);

128 
	`£m_u∆ök
(
SEM_NAME
);

129  
åue
;

130 
	}
}

131 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$öô_Sem≠h‹e
()

133 
this
->
°©usMuãx
 = 
	`£m_›í
(
SEM_NAME
, 0, 0666, 0);

134 if(
this
->
°©usMuãx
 =
SEM_FAILED
)

136 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::init_Semaphore] : Semaphore Initialization Error\n");

137 
	`£m_u∆ök
(
SEM_NAME
);

138  
Ál£
;

140  
åue
;

141 
	}
}

142 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$öô_DBus
()

144 
	`dbus_îr‹_öô
(&
îr‹
);

145 
c⁄√˘i⁄
 = 
	`dbus_bus_gë
(
DBUS_BUS_SYSTEM
, &
îr‹
);

146 if(!
c⁄√˘i⁄
)

148 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::init_DBus] : dbus_bus_get Error\n");

149 
	`dbus_îr‹_‰ì
(&
îr‹
);

150  
Ál£
;

152  
åue
;

153 
	}
}

154 
ölöe
 
	$ch™√ls_f‹_mode
(
mode
)

156 
mode
){

157 
CV_CAP_MODE_GRAY
:

159 
CV_CAP_MODE_YUYV
:

164 
	}
}

165 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$ªadFøme
()

169  
åue
;

171 
	}
}

172 
	gCvC≠tuªCAM_OPEL_CPP
::
	$maöLo›
()

174 
cou¡
;

175 
cou¡
 = 1;

176 
cou¡
-- > 0)

179 
fd_£t
 
fds
;

180 
timevÆ
 
tv
;

181 
r
;

182 
	`FD_ZERO
(&
fds
);

183 
	`FD_SET
(
fd
, &
fds
);

185 
tv
.
tv_£c
 = 10;

186 
tv
.
tv_u£c
 = 0;

187 
r
 = 
	`£À˘
(
fd
+1, &
fds
, 
NULL
, NULL, &
tv
);

188 if(-1 =
r
)

190 if(
EINTR
 =
î∫o
)

192 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::mainLoop] : Select Failed\n");

194 if(0 =
r
)

196 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::mainLoop] : selectÅimeout\n");

200 if(
	`ªadFøme
())

206 
	}
}

207 
	gCvC≠tuªCAM_OPEL_CPP
::
	$CvC≠tuªCAM_OPEL_CPP
()

209 
this
->
width
 = 
OPENCV_DEFAULT_WIDTH
;

210 
this
->
height
 = 
OPENCV_DEFAULT_HEIGHT
;

211 
this
->
buf„r_size
 = 
OPENCV_DEFAULT_BUF_SIZE
;

212 
this
->
buf„r_ödex
 = 
OPENCV_DEFAULT_BUF_INDEX
;

213 
this
->
mode
 = 
CV_CAP_MODE_RGB
;

214 
	}
}

216 
	gCvC≠tuªCAM_OPEL_CPP
::~
	$CvC≠tuªCAM_OPEL_CPP
()

220 
	}
}

222 
boﬁ
 
CvC≠tuªCAM_OPEL_CPP
::
	$öô_Sh¨edMem‹yS∑˚F‹Pr›îty
()

224 
shmid_f‹_°©us
 = 
	`shmgë
((
key_t
)
SHM_KEY_FOR_STATUS
, 0, 0);

225 if(
shmid_f‹_°©us
 == -1)

227 
	`Ârötf
(
°dîr
,"[CvCaptureCAM_OPEL_CPP::init_SharedMemorySpaceForProperty] : Shmget Error\n");

228  
Ál£
;

230 
shmPå_f‹_°©us
 = 
	`shm©
(
shmid_f‹_°©us
, (*)0, 0666|
IPC_CREAT
);

231 if(
shmPå_f‹_°©us
 == (*)-1)

233 
	`Ârötf
(
°dîr
,"[CvCaptureCAM_OPEL_CPP::init_SharedMemorySpaceForProperty] : Shmat Error\n");

234  
Ál£
;

236 
this
->
°
 = (
°©us
*)
shmPå_f‹_°©us
;

237  
åue
;

238 
	}
}

240 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$öô_Sh¨edMem‹yS∑˚
()

242 
shmid
 = 
	`shmgë
((
key_t
)
SHM_KEY_FOR_BUFFER
, 0, 0);

243 if(
shmid
 == -1)

246  
Ál£
;

248 
shmPå
 = 
	`shm©
(
shmid
, (*)0, 0666|
IPC_CREAT
);

249 if(
shmPå
 == (*)-1)

252  
Ál£
;

255  
åue
;

257 
	}
}

258 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$uöô_Sh¨edMem‹yS∑˚
()

261  
åue
;

262 
	}
}

263 
	$›í_devi˚
(* 
fd
)

265 *(
fd
Ë
	`›í
(
dev_«me
, 
O_RDWR
 | 
O_NONBLOCK
, 0);

266 if(-1 =(*
fd
))

268 
	`Ârötf
(
°dîr
, "[OPEN_DEVICE] : /dev/video0 Cannot Open\n");

271 
	}
}

272 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$›í
(
ödex
)

274 
boﬁ
 
ÆlowIsRu¬ög
;

275 
	`›í_devi˚
(&
fd
);

277 if(
this
->
fd
 == -1)

278  
Ál£
;

280 if(!(
this
->
	`öô_Sh¨edMem‹yS∑˚F‹Pr›îty
()))

281  
Ál£
;

283 if(!
	`öô_DBus
())

284  
Ál£
;

286 if(!
	`öô_Sem≠h‹e
())

287  
Ál£
;

289 if(
	`isRecRu¬ög
(
this
->
°
,Åhis->
°©usMuãx
))

292  
Ál£
;

294 
	`¥ötf
("******* CAMERA PROPERTY ********\n");

295 
	`¥ötf
("width = %d\n", 
this
->
width
);

296 
	`¥ötf
("heighà%d\n", 
this
->
height
);

297 
	`¥ötf
("buf„r_sizê%d\n", 
this
->
buf„r_size
);

298 
	`fÊush
(
°dout
);

300 
	`£ndDbusMsg
(
this
->
c⁄√˘i⁄
, "OpenCVInit");

302 
	`cvInôImageHódî
(&
‰ame
, 
	`cvSize
(
this
->
width
,Åhis->
height
), 
IPL_DEPTH_8U
, 
	`ch™√ls_f‹_mode
(
mode
), 
IPL_ORIGIN_TL
, 4);

303 
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(‰ame.
imageSize
);

304 if(!
‰ame
.
imageD©a
)

306 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::open] : cvAlloc Error\n");

307  
Ál£
;

311 if(
	`öô_Sh¨edMem‹yS∑˚
())

318 
	`£ndDbusMsg
(
this
->
c⁄√˘i⁄
, "OpenCVStart");

320  
åue
;

321 
	}
}

322 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$˛o£
()

326  
åue
;

327 
	}
}

329 
	gCvC≠tuªCAM_OPEL_CPP
::
	$gëPr›îty
() const

331  
Ál£
;

332 
	}
}

334 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$£tPr›îty
(, )

336 
	`Ârötf
(
°dîr
, "[CvCaptureCAM_OPEL_CPP::setProperty] : Cannot configureÅhe setProperty\n");

337  
Ál£
;

338 
	}
}

339 
boﬁ
 
	gCvC≠tuªCAM_OPEL_CPP
::
	$gøbFøme
()

342 if(
	`isRecRu¬ög
(
this
->
°
,Åhis->
°©usMuãx
))

345 
	`Ârötf
(
°dîr
, "Resource Busy\n");

346  
Ál£
;

348 
	`maöLo›
();

349  
åue
;

350 
	}
}

351 
I∂Image
* 
	gCvC≠tuªCAM_OPEL_CPP
::
	$ªåõveFøme
()

353 
off£t
;

354 
off£t
 = (
buf„r_ödex
-1)*
buf„r_size
;

357 if(
shmPå
)

359 
	`mem˝y
((*)
‰ame
.
imageD©a
, (*)
shmPå
+
off£t
, 
buf„r_size
);

361  &
‰ame
;

362 
	}
}

363 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_V4L
(
ödex
)

365 
CvC≠tuªCAM_OPEL_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_OPEL_CPP;

366 if–
ˇ±uª
->
	`›í
(
ödex
))

367  (
CvC≠tuª
*)
ˇ±uª
;

369 
dñëe
 
ˇ±uª
;

371 
	}
}

	@src/cap_cmu.cpp

42 
	~"¥ecomp.hµ
"

44 #ifde‡
WIN32


48 #ifde‡
HAVE_CMU1394


53 
	~"1394ˇmîa.h
"

55 ˛as†
	cCvC≠tuªCAM_CMU
 : 
public
 
CvC≠tuª


57 
public
:

58 
	$CvC≠tuªCAM_CMU
()

60 
ödex
 = -1;

61 
image
 = 0;

64 
vútuÆ
 ~
	$CvC≠tuªCAM_CMU
()

66 
	`˛o£
();

67 
	}
}

69 
vútuÆ
 
boﬁ
 
›í
(
ˇmîaId
);

70 
vútuÆ
 
˛o£
();

71 
vútuÆ
 
	$gëPr›îty
() const;

72 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

73 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

74 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

76 
¥Ÿe˘ed
:

77 
C1394Camîa
* 
	`ˇmîa
();

78 
CvSize
 
	`gëSize
();

79 
	`gëDïth
();

80 
	`gëNCh™√ls
();

82 
boﬁ
 
	`£tVideoSize
(, );

83 
boﬁ
 
	`£tMode
(
mode
);

84 
boﬁ
 
	`£tFømeR©e
(
øã
);

85 
boﬁ
 
	`£tF‹m©
(
f‹m©
);

87 
Âs
;

88 
mode
;

89 
f‹m©
;

90 
ödex
;

91 
I∂Image
* 
image
;

92 
	}
};

99 
	#CMU_MAX_CAMERAS
 20

	)

100 
	gCMU_numCamîas
 = 0;

101 
	gCMU_numA˘iveCamîas
 = 0;

102 
boﬁ
 
	gCMU_u£CamîaFœgs
[
CMU_MAX_CAMERAS
];

103 
C1394Camîa
 *
	gCMU_theCamîa
 = 0;

106 
	#CV_CAP_IEEE1394_FPS_1_875
 0

	)

107 
	#CV_CAP_IEEE1394_FPS_3_75
 1

	)

108 
	#CV_CAP_IEEE1394_FPS_7_5
 2

	)

109 
	#CV_CAP_IEEE1394_FPS_15
 3

	)

110 
	#CV_CAP_IEEE1394_FPS_30
 4

	)

111 
	#CV_CAP_IEEE1394_FPS_60
 5

	)

114 
	#CV_CAP_IEEE1394_COLOR_MONO
 0

	)

115 
	#CV_CAP_IEEE1394_COLOR_MONO16
 1

	)

116 
	#CV_CAP_IEEE1394_COLOR_YUV444
 2

	)

117 
	#CV_CAP_IEEE1394_COLOR_YUV422
 3

	)

118 
	#CV_CAP_IEEE1394_COLOR_YUV411
 4

	)

119 
	#CV_CAP_IEEE1394_COLOR_RGB
 5

	)

121 
	#CV_CAP_IEEE1394_SIZE_160X120
 0

	)

122 
	#CV_CAP_IEEE1394_SIZE_320X240
 1

	)

123 
	#CV_CAP_IEEE1394_SIZE_640X480
 2

	)

124 
	#CV_CAP_IEEE1394_SIZE_800X600
 3

	)

125 
	#CV_CAP_IEEE1394_SIZE_1024X768
 4

	)

126 
	#CV_CAP_IEEE1394_SIZE_1280X960
 5

	)

127 
	#CV_CAP_IEEE1394_SIZE_1600X1200
 6

	)

131 
	gCV_CAP_IEEE1394_FORMAT
[7][6] =

143 
	gCV_CAP_IEEE1394_MODE
[7][6] =

155 
	gCV_CAP_IEEE1394_COLOR
[2][8] =

158 
CV_CAP_IEEE1394_COLOR_YUV444
,

159 
CV_CAP_IEEE1394_COLOR_YUV422
,

160 
CV_CAP_IEEE1394_COLOR_YUV411
,

161 
CV_CAP_IEEE1394_COLOR_YUV422
,

162 
CV_CAP_IEEE1394_COLOR_RGB
,

163 
CV_CAP_IEEE1394_COLOR_MONO
,

164 
CV_CAP_IEEE1394_COLOR_MONO16


167 
CV_CAP_IEEE1394_COLOR_YUV422
,

168 
CV_CAP_IEEE1394_COLOR_RGB
,

169 
CV_CAP_IEEE1394_COLOR_MONO
,

170 
CV_CAP_IEEE1394_COLOR_YUV422
,

171 
CV_CAP_IEEE1394_COLOR_RGB
,

172 
CV_CAP_IEEE1394_COLOR_MONO
,

173 
CV_CAP_IEEE1394_COLOR_MONO16
,

174 
CV_CAP_IEEE1394_COLOR_MONO16


188 #i‡
_MSC_VER
 >= 1200

189 #¥agm®
commít
(
lib
,"1394camera.lib")

192 
C1394Camîa
* 
	gCvC≠tuªCAM_CMU
::
	$ˇmîa
()

194  
CMU_theCamîa
 && 
ödex
 >= 0 ? &CMU_theCamera[index] : 0;

195 
	}
}

198 
CvSize
 
	gCvC≠tuªCAM_CMU
::
	$gëSize
()

200 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

201 
width
 = 0, 
height
 = 0;

202 
cmuˇm
->
	`GëVideoFømeDimísi⁄s
–&
width
, &
height
 );

203  
	`cvSize
(()
width
, ()
height
);

204 
	}
}

207 
	gCvC≠tuªCAM_CMU
::
	$gëDïth
()

209 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

210 
f‹m©
 = 
cmuˇm
->
	`GëVideoF‹m©
();

211 
mode
 = 
cmuˇm
->
	`GëVideoMode
();

214 if–
f‹m©
==7 ) {

215 
	`as£π
(0);

219 if–
f‹m©
 > 1 )

220 
f‹m©
 = 1;

222 if–
CV_CAP_IEEE1394_COLOR
[
f‹m©
][
mode
]==
CV_CAP_IEEE1394_COLOR_MONO16
 )

223  
IPL_DEPTH_16S
;

225  
IPL_DEPTH_8U
;

226 
	}
}

229 
	gCvC≠tuªCAM_CMU
::
	$gëNCh™√ls
()

231 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

232 
f‹m©
 = 
cmuˇm
->
	`GëVideoF‹m©
();

233 
mode
 = 
cmuˇm
->
	`GëVideoMode
();

235 if–
f‹m©
==7 ){

236 
	`as£π
(0);

241 if–
f‹m©
 > 1 )

242 
f‹m©
 = 1;

244 
CV_CAP_IEEE1394_COLOR
[
f‹m©
][
mode
]){

245 
CV_CAP_IEEE1394_COLOR_RGB
:

247 
CV_CAP_IEEE1394_COLOR_MONO
:

248 
CV_CAP_IEEE1394_COLOR_MONO16
:

250 
CV_CAP_IEEE1394_COLOR_YUV422
:

251 
CV_CAP_IEEE1394_COLOR_YUV444
:

252 
CV_CAP_IEEE1394_COLOR_YUV411
:

258 
	}
}

260 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$›í
–
_ödex
 )

262 
	`˛o£
();

265 if–
CMU_numCamîas
 == 0 )

267 
CMU_numA˘iveCamîas
 = 0;

268 
CMU_theCamîa
 = 
√w
 
C1394Camîa
[
CMU_MAX_CAMERAS
];

272 
åy


275 if–
CMU_theCamîa
[0].
	`CheckLök
(Ë!
CAM_SUCCESS
 )

276 
throw
 1;

279 
CMU_numCamîas
 = 
CMU_theCamîa
[0].
	`GëNumbîCamîas
();

282 
i
 = 1; i < 
CMU_numCamîas
 && i<
CMU_MAX_CAMERAS
; i++ )

284 
CMU_u£CamîaFœgs
[
i
] = 
Ál£
;

285 i‡(
CMU_theCamîa
[
i
].
	`CheckLök
(Ë!
CAM_SUCCESS
)

286 
throw
 1;

289 
	`ˇtch
 (...)

293 
CMU_numCamîas
 = 0;

294  
Ál£
;

298 
åy


300 
CvSize
 
size
;

303 if(
_ödex
==-1){

304 
i
 = 0; i < 
CMU_numCamîas
; i++ )

306 if–!
CMU_u£CamîaFœgs
[
i
] ){

307 
_ödex
 = 
i
;

314 i‡(
_ödex
==-1)

315 
throw
 1;

317 i‡(
CMU_theCamîa
[
_ödex
].
	`Sñe˘Camîa
(_ödexË!
CAM_SUCCESS
)

318 
throw
 2;

320 i‡(
CMU_theCamîa
[
_ödex
].
	`InôCamîa
(Ë!
CAM_SUCCESS
)

321 
throw
 3;

324 
boﬁ
 
found_f‹m©
 = 
Ál£
;

325 
øã
=5;Ñ©e>=0 && !
found_f‹m©
;Ñate--)

327 
cﬁ‹
=
CV_CAP_IEEE1394_COLOR_RGB
; cﬁ‹>=0 && !
found_f‹m©
; color--)

329 
size
=
CV_CAP_IEEE1394_SIZE_1600X1200
; size>=0 && !
found_f‹m©
; size--)

331 
f‹m©
 = 
CV_CAP_IEEE1394_FORMAT
[
size
][
cﬁ‹
];

332 
mode
 = 
CV_CAP_IEEE1394_MODE
[
size
][
cﬁ‹
];

333 i‡(
f‹m©
!=-1 && 
mode
!=-1 &&

334 
CMU_theCamîa
[
_ödex
].
	`HasVideoFømeR©e
(
f‹m©
,
mode
,
øã
))

336 
CMU_theCamîa
[
_ödex
].
	`SëVideoF‹m©
(
f‹m©
);

337 
CMU_theCamîa
[
_ödex
].
	`SëVideoMode
(
mode
);

338 
CMU_theCamîa
[
_ödex
].
	`SëVideoFømeR©e
(
øã
);

339 
found_f‹m©
 = (
CMU_theCamîa
[
_ödex
].
	`SèπImageAcquisôi⁄
(Ë=
CAM_SUCCESS
);

346 if(!
found_f‹m©
){

347 
CMU_theCamîa
[
_ödex
].
	`SëVideoF‹m©
(7);

348 
CMU_theCamîa
[
_ödex
].
	`SëVideoMode
(0);

349 if(
CMU_theCamîa
[
_ödex
].
	`SèπImageAcquisôi⁄
(Ë!
CAM_SUCCESS
){

351 
throw
 9;

355 
ödex
 = 
_ödex
;

356 
size
 = 
	`gëSize
();

358 
image
 = 
	`cvCª©eImage
–
size
, 8, 3 );

359 
	`cvZîo
(
image
);

362 
CMU_numA˘iveCamîas
++;

363 
CMU_u£CamîaFœgs
[
_ödex
] = 
åue
;

365 
	`ˇtch
 ( )

367  
Ál£
;

370  
åue
;

371 
	}
}

373 
	gCvC≠tuªCAM_CMU
::
	$˛o£
()

375 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

376 if–
cmuˇm
 )

378 
	`cvRñó£Image
–&
image
 );

379 
cmuˇm
->
	`St›ImageAcquisôi⁄
();

380 
CMU_u£CamîaFœgs
[
ödex
] = 
Ál£
;

381 
ödex
 = -1;

383 if–--
CMU_numA˘iveCamîas
 == 0 )

385 
dñëe
[] 
CMU_theCamîa
;

386 
CMU_theCamîa
 = 0;

387 
CMU_numCamîas
 = 0;

390 
	}
}

393 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$gøbFøme
()

395 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

396  
cmuˇm
 ? cmuˇm->
	`AcquúeImage
(Ë=
CAM_SUCCESS
 : 
Ál£
;

397 
	}
}

414 
I∂Image
* 
	gCvC≠tuªCAM_CMU
::
	$ªåõveFøme
()

416 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

417 if–!
cmuˇm
 )

419 
cmuˇm
->
	`gëRGB
((
uch¨
*)
image
->
imageD©a
, image->
imageSize
);

420 
	`cvC⁄vîtImage
–
image
, image, 
CV_CVTIMG_SWAP_RB
 );

421  
image
;

422 
	}
}

425 
	gCvC≠tuªCAM_CMU
::
	$gëPr›îty
–
¥›îty_id
 ) const

427 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

428 if–!
cmuˇm
 )

430  
¥›îty_id
 )

432 
CV_CAP_PROP_FRAME_WIDTH
:

433  
image
->
width
;

434 
CV_CAP_PROP_FRAME_HEIGHT
:

435  
image
->
height
;

436 
CV_CAP_PROP_FPS
:

437  
cmuˇm
->
	`GëVideoFømeR©e
();

438 
CV_CAP_PROP_MODE
:

439  
cmuˇm
->
	`GëVideoMode
();

440 
CV_CAP_PROP_FORMAT
:

441  
cmuˇm
->
	`GëVideoF‹m©
();

444 
	}
}

446 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$£tVideoSize
(, )

448  
Ál£
;

449 
	}
}

451 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$£tMode
(
mode
)

453 
f‹m©
;

454 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

455 if–!
cmuˇm
 )

456  
Ál£
;

457 
f‹m©
 = 
cmuˇm
->
	`GëVideoF‹m©
();

458 if–
mode
 < 0 || modê> 7 || !
cmuˇm
->
	`HasVideoMode
(
f‹m©
, mode))

459  
Ál£
;

460 
cmuˇm
->
	`St›ImageAcquisôi⁄
();

461 
cmuˇm
->
	`SëVideoMode
(
mode
);

462 
cmuˇm
->
	`SèπImageAcquisôi⁄
();

463  
åue
;

464 
	}
}

466 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$£tFømeR©e
(
øã
)

468 
f‹m©
, 
mode
;

469 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

470 if–!
cmuˇm
 )

471  
Ál£
;

472 
mode
 = 
cmuˇm
->
	`GëVideoMode
();

473 
f‹m©
 = 
cmuˇm
->
	`GëVideoF‹m©
();

474 if–
øã
 < 0 ||Ñ©ê> 5 || !
cmuˇm
->
	`HasVideoFømeR©e
(
f‹m©
, 
mode
,Ñate) )

475  
Ál£
;

476 
cmuˇm
->
	`St›ImageAcquisôi⁄
();

477 
cmuˇm
->
	`SëVideoFømeR©e
(
øã
);

478 
cmuˇm
->
	`SèπImageAcquisôi⁄
();

479  
åue
;

480 
	}
}

482 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$£tF‹m©
(
f‹m©
)

484 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

485 if–!
cmuˇm
 )

486  
Ál£
;

487 if–
f‹m©
 < 0 || f‹m© > 2 || !
cmuˇm
->
	`HasVideoF‹m©
(format) )

488  
Ál£
;

489 
cmuˇm
->
	`St›ImageAcquisôi⁄
();

490 
cmuˇm
->
	`SëVideoF‹m©
(
f‹m©
);

491 
cmuˇm
->
	`SèπImageAcquisôi⁄
();

492  
åue
;

493 
	}
}

495 
boﬁ
 
	gCvC≠tuªCAM_CMU
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

497 
boﬁ
 
ªtvÆ
 = 
Ál£
;

498 
ivÆ
 = 
	`cvRound
(
vÆue
);

499 
C1394Camîa
* 
cmuˇm
 = 
	`ˇmîa
();

500 if–!
cmuˇm
 )

501  
Ál£
;

503 
¥›îty_id
) {

504 
CV_CAP_PROP_FRAME_WIDTH
:

505 
CV_CAP_PROP_FRAME_HEIGHT
:

507 
width
, 
height
;

508 i‡(
¥›îty_id
 =
CV_CAP_PROP_FRAME_WIDTH
)

510 
width
 = 
ivÆ
;

511 
height
 = 
width
*3/4;

514 
height
 = 
ivÆ
;

515 
width
 = 
height
*4/3;

517 
ªtvÆ
 = 
	`£tVideoSize
(
width
, 
height
);

520 
CV_CAP_PROP_FPS
:

521 
ªtvÆ
 = 
	`£tFømeR©e
(
ivÆ
);

523 
CV_CAP_PROP_MODE
:

524 
ªtvÆ
 = 
	`£tMode
(
ivÆ
);

526 
CV_CAP_PROP_FORMAT
:

527 
ªtvÆ
 = 
	`£tF‹m©
(
ivÆ
);

532 
CvSize
 
size
 = 
	`gëSize
();

533 if–!
image
 || image->
width
 !
size
.width || image->
height
 != size.height )

535 
	`cvRñó£Image
–&
image
 );

536 
image
 = 
	`cvCª©eImage
–
size
, 8, 3 );

538  
ªtvÆ
;

539 
	}
}

541 
CvC≠tuª
 * 
	$cvCª©eCamîaC≠tuª_CMU
 (
ödex
)

543 
CvC≠tuªCAM_CMU
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_CMU;

544 if–
ˇ±uª
->
	`›í
(
ödex
) )

545  
ˇ±uª
;

546 
dñëe
 
ˇ±uª
;

548 
	}
}

	@src/cap_dc1394.cpp

98 
	~"¥ecomp.hµ
"

100 #i‡!
deföed
 
WIN32
 && deföed 
HAVE_DC1394


102 
	~<uni°d.h
>

103 
	~<°döt.h
>

104 
	~<libøw1394/øw1394.h
>

105 
	~<libdc1394/dc1394_c⁄åﬁ.h
>

107 #ifde‡
NDEBUG


108 
	#CV_WARN
(
mesßge
)

	)

110 
	#CV_WARN
(
mesßge
Ë
	`Ârötf
(
°dîr
, "w¨nög: %†(%s:%d)\n", mesßge, 
__FILE__
, 
__LINE__
)

	)

113 
	#CV_DC1394_CALL
(
ex¥
) \

114 if((
ex¥
)<0){ \

115 
	`OPENCV_ERROR
(
CV_StsI¡î«l
, "", "libdc1394 function callÑeturned < 0"); \

116 }

	)

118 
	#DELAY
 50000

	)

121 
	#MONO16_BPP
 8

	)

124 
uyv2bgr
(c⁄° *
§c
, *
de°
, 
NumPixñs
);

125 
uyvy2bgr
(c⁄° *
§c
, *
de°
, 
NumPixñs
);

126 
uyyvyy2bgr
(c⁄° *
§c
, *
de°
, 
NumPixñs
);

127 
y2bgr
(c⁄° *
§c
, *
de°
, 
NumPixñs
);

128 
y162bgr
(c⁄° *
§c
, *
de°
, 
NumPixñs
, 
bôs
);

129 
rgb482bgr
(c⁄° *
§c8
, *
de°
, 
NumPixñs
, 
bôs
);

131 c⁄° * 
	gvideodev
[4]={

138 
	sCvC≠tuªCAM_DC1394


140 
øw1394h™dÀ_t
 
	mh™dÀ
;

141 
nodeid_t
 
	mˇmîa_node
;

142 
dc1394_ˇmîaˇ±uª
* 
	mˇmîa
;

143 
	mf‹m©
;

144 
	mmode
;

145 
	mcﬁ‹_mode
;

146 
	m‰ame_øã
;

147 c⁄° * 
	mdevi˚_«me
;

148 
I∂Image
 
	m‰ame
;

149 
	mc⁄vît
;

150 
	mbuf„r_is_wrôóbÀ
;

152 
	tCvC≠tuªCAM_DC1394
;

154 
icvClo£CAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
 );

156 
icvGøbFømeCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
 );

157 
I∂Image
* 
icvRërõveFømeCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, );

159 
icvGëPr›îtyCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, 
¥›îty_id
 );

160 
icvSëPr›îtyCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
 );

163 
icvF‹m©Suµ‹ãdCAM_DC1394
(
f‹m©
, 
quadÀt_t
 
f‹m©s
);

164 
icvModeSuµ‹ãdCAM_DC1394
(
f‹m©
, 
mode
, 
quadÀt_t
 
modes
);

165 
icvCﬁ‹Mode
–
mode
 );

166 
icvGëBe°FømeR©e
–
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
, 
f‹m©
, 
mode
);

167 
icvResizeFøme
(
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
);

170 
	#MAX_PORTS
 3

	)

171 
	#MAX_CAMERAS
 8

	)

172 
	#NUM_BUFFERS
 8

	)

173 
øw1394_p‹töfo
 
	gp‹ts
[
MAX_PORTS
];

174 
øw1394h™dÀ_t
 
	gh™dÀs
[
MAX_PORTS
];

175 
	gˇmCou¡
[
MAX_PORTS
];

176 
	gnumP‹ts
 = -1;

177 
	gnumCamîas
 = 0;

178 
nodeid_t
 *
	gˇmîa_nodes
;

179 
	sˇmnode
 {
dc1394_ˇmîaˇ±uª
 
	mˇm
;
	mp‹äum
;} 
	gˇmîas
[
MAX_CAMERAS
];

181 c⁄° 
	g¥e„ºed_modes
[]

185 
FORMAT_SVGA_NONCOMPRESSED_2
,

186 
MODE_1600x1200_RGB
, 
MODE_1600x1200_YUV422
, 
MODE_1280x960_RGB
, 
MODE_1280x960_YUV422
,

187 
MODE_1600x1200_MONO
, 
MODE_1280x960_MONO
, 
MODE_1600x1200_MONO16
, 
MODE_1280x960_MONO16
,

188 
FORMAT_SVGA_NONCOMPRESSED_1
,

189 
MODE_1024x768_RGB
, 
MODE_1024x768_YUV422
, 
MODE_800x600_RGB
, 
MODE_800x600_YUV422
,

190 
MODE_1024x768_MONO
, 
MODE_800x600_MONO
, 
MODE_1024x768_MONO16
, 
MODE_800x600_MONO16
,

191 
FORMAT_VGA_NONCOMPRESSED
,

192 
MODE_640x480_RGB
, 
MODE_640x480_YUV422
, 
MODE_640x480_YUV411
, 
MODE_320x240_YUV422
,

193 
MODE_160x120_YUV444
, 
MODE_640x480_MONO
, 
MODE_640x480_MONO16
,

194 
FORMAT_SCALABLE_IMAGE_SIZE
,

195 
MODE_FORMAT7_0
, 
MODE_FORMAT7_1
, 
MODE_FORMAT7_2
, 
MODE_FORMAT7_3
,

196 
MODE_FORMAT7_4
, 
MODE_FORMAT7_5
, 
MODE_FORMAT7_6
, 
MODE_FORMAT7_7
,

200 
	$icvInôC≠tuª_DC1394
(){

201 
p
;

203 
øw1394h™dÀ_t
 
øw_h™dÀ
 = 
	`øw1394_√w_h™dÀ
();

204 if–
øw_h™dÀ
 == 0 ) {

205 
numP‹ts
 = 0;

208 
numP‹ts
 = 
	`øw1394_gë_p‹t_öfo
(
øw_h™dÀ
, 
p‹ts
, 
MAX_PORTS
);

209 
	`øw1394_de°roy_h™dÀ
(
øw_h™dÀ
);

210 
p
 = 0;Ö < 
numP‹ts
;Ö++) {

211 
h™dÀs
[
p
] = 
	`dc1394_¸óã_h™dÀ
(p);

212 i‡(
h™dÀs
[
p
]==
NULL
Ë{ 
numP‹ts
=-1; ; }

215 
ˇmîa_nodes
 = 
	`dc1394_gë_ˇmîa_nodes
(
h™dÀs
[
p
], &
ˇmCou¡
[p], 0);

216 
i
=0;i<
ˇmCou¡
[
p
];i++) {

217 
ˇmîas
[
numCamîas
].
ˇm
.
node
 = 
ˇmîa_nodes
[
i
];

218 
ˇmîas
[
numCamîas
].
p‹äum
 = 
p
;

219 
	`dc1394_°›_iso_å™smissi⁄
(
h™dÀs
[
p
], 
ˇmîa_nodes
[
i
]);

220 
numCamîas
++;

223 
	}
};

225 
CvC≠tuªCAM_DC1394
 * 
	$icvC≠tuªFromCAM_DC1394
 (
ödex
)

227 
quadÀt_t
 
modes
[8], 
f‹m©s
;

228 
i
;

230 i‡(
numP‹ts
<0Ë
	`icvInôC≠tuª_DC1394
();

231 i‡(
numP‹ts
==0)

233 i‡(
numCamîas
<1)

235 i‡(
ödex
>=
numCamîas
)

237 i‡(
ödex
<0)

240 
CvC≠tuªCAM_DC1394
 * 
pˇp
 = (CvC≠tuªCAM_DC1394*)
	`cvAŒoc
((*pcap));

243 
pˇp
->
devi˚_«me
 = 
videodev
[
ˇmîas
[
ödex
].
p‹äum
];

244 
pˇp
->
h™dÀ
 = 
h™dÀs
[
ˇmîas
[
ödex
].
p‹äum
];

245 
pˇp
->
ˇmîa
 = &
ˇmîas
[
ödex
].
ˇm
;

248 i‡(
	`dc1394_quîy_suµ‹ãd_f‹m©s
(
pˇp
->
h™dÀ
,Öˇp->
ˇmîa
->
node
, &
f‹m©s
)<0) {

249 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ quîy suµ‹ãd f‹m©s\n",
__FILE__
,
__LINE__
);

250 
f‹m©s
=0x0;

252 
i
=0; i < 
NUM_FORMATS
; i++) {

253 
modes
[
i
]=0;

254 i‡(
	`icvF‹m©Suµ‹ãdCAM_DC1394
(
i
+
FORMAT_MIN
, 
f‹m©s
)){

255 i‡(
	`dc1394_quîy_suµ‹ãd_modes
(
pˇp
->
h™dÀ
,Öˇp->
ˇmîa
->
node
, 
i
+
FORMAT_MIN
, &
modes
[i])<0) {

256 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ quîy F‹m©%d modes\n",
__FILE__
,
__LINE__
,
i
);

261 
pˇp
->
f‹m©
 = 0;

262 
pˇp
->
mode
 = 0;

263 
pˇp
->
cﬁ‹_mode
 = 0;

264 
pˇp
->
‰ame_øã
 = 0;

266 
f‹m©_idx
 = -1;

269 
i
=0; (
pˇp
->
mode
 =0Ë&& (
¥e„ºed_modes
[i] != 0); i++) {

270 if((
¥e„ºed_modes
[
i
] >
FORMAT_MIN
Ë&& (¥e„ºed_modes[i] <
FORMAT_MAX
)) {

271 
pˇp
->
f‹m©
 = 
¥e„ºed_modes
[
i
];

272 
f‹m©_idx
 = 
¥e„ºed_modes
[
i
] - 
FORMAT_MIN
;

275 
	`as£π
(
f‹m©_idx
 != -1);

276 i‡–! 
	`icvF‹m©Suµ‹ãdCAM_DC1394
(
pˇp
->
f‹m©
, 
f‹m©s
) )

278 i‡–
	`icvModeSuµ‹ãdCAM_DC1394
(
pˇp
->
f‹m©
, 
¥e„ºed_modes
[
i
], 
modes
[
f‹m©_idx
]) ){

279 
pˇp
->
mode
 = 
¥e„ºed_modes
[
i
];

282 i‡(
pˇp
->
mode
 == 0) {

283 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ födá suµ‹ãd modêf‹Åhi†ˇmîa\n",
__FILE__
,
__LINE__
);

284 
ERROR
;

287 
pˇp
->
cﬁ‹_mode
 = 
	`icvCﬁ‹Mode
–pˇp->
mode
 );

288 if–
pˇp
->
cﬁ‹_mode
 == -1){

289 
	`Ârötf
(
°dîr
,"%s:%d: ERROR: BPP i†Unsuµ‹ãd!!\n",
__FILE__
,
__LINE__
);

290 
ERROR
;

294 
pˇp
->
‰ame_øã
 = 
	`icvGëBe°FømeR©e
’ˇp,Öˇp->
f‹m©
,Öˇp->
mode
);

296 i‡(
pˇp
->
f‹m©
!=
FORMAT_SCALABLE_IMAGE_SIZE
) {

297 i‡(
	`dc1394_dma_£tup_ˇ±uª
(
pˇp
->
h™dÀ
,Öˇp->
ˇmîa
->
node
, 
ödex
+1 ,

298 
pˇp
->
f‹m©
,Öˇp->
mode
, 
SPEED_400
,

299 
pˇp
->
‰ame_øã
, 
NUM_BUFFERS
, 1 ,

300 
pˇp
->
devi˚_«me
,Öˇp->
ˇmîa
Ë!
DC1394_SUCCESS
) {

301 
	`Ârötf
(
°dîr
,"%s:%d: FaûedÅÿ£tu∞DMA c≠tuª wôh VIDEO1394\n",
__FILE__
,
__LINE__
);

302 
ERROR
;

306 if(
	`dc1394_dma_£tup_f‹m©7_ˇ±uª
(
pˇp
->
h™dÀ
,pˇp->
ˇmîa
->
node
,
ödex
+1 ,

307 
pˇp
->
mode
, 
SPEED_400
, 
QUERY_FROM_CAMERA
,

308 ()
QUERY_FROM_CAMERA
, ()QUERY_FROM_CAMERA,

309 ()
QUERY_FROM_CAMERA
, ()QUERY_FROM_CAMERA,

310 
NUM_BUFFERS
, 1 ,

311 
pˇp
->
devi˚_«me
,Öˇp->
ˇmîa
Ë!
DC1394_SUCCESS
) {

312 
	`Ârötf
(
°dîr
,"%s:%d: FaûedÅÿ£tu∞DMA c≠tuª wôh VIDEO1394\n",
__FILE__
,
__LINE__
);

313 
ERROR
;

317 i‡(
	`dc1394_°¨t_iso_å™smissi⁄
(
pˇp
->
h™dÀ
,Öˇp->
ˇmîa
->
node
)!=
DC1394_SUCCESS
) {

318 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ sèπ ISOÅønsmissi⁄\n",
__FILE__
,
__LINE__
);

319 
ERROR
;

322 
	`u¶ìp
(
DELAY
);

324 
dc1394boﬁ_t
 
°©us
;

325 i‡(
	`dc1394_gë_iso_°©us
(
pˇp
->
h™dÀ
,Öˇp->
ˇmîa
->
node
, &
°©us
)!=
DC1394_SUCCESS
) {

326 
	`Ârötf
(
°dîr
,"%s:%d: Could gë ISO sètus",
__FILE__
,
__LINE__
);

327 
ERROR
;

329 i‡(
°©us
==
DC1394_FALSE
) {

330 
	`Ârötf
(
°dîr
,"%s:%d: ISOÅønsmissi⁄Ñefu£†tÿ°¨t",
__FILE__
,
__LINE__
);

331 
ERROR
;

335 
pˇp
->
c⁄vît
=1;

338 
pˇp
->
buf„r_is_wrôóbÀ
 = 0;

340 
	`mem£t
(&(
pˇp
->
‰ame
), 0, (
I∂Image
));

341 
	`icvResizeFøme
–
pˇp
 );

342  
pˇp
;

344 
ERROR
:

346 
	}
};

348 
	$icvClo£CAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
 ){

349 
	`dc1394_°›_iso_å™smissi⁄
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
);

350 
	`dc1394_dma_u∆i°í
 (
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
);

352 if(
ˇ±uª
->
c⁄vît
){

353 
	`cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

355 
	}
}

357 
	$icvGøbFømeCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
 ){

360 
waôög
 = 0;

362 
ªsu…
 = 
	`dc1394_dma_sögÀ_ˇ±uª_pﬁl
(
ˇ±uª
->
ˇmîa
);

363 if(
ªsu…
==
DC1394_SUCCESS
){

366 if(
ªsu…
==
DC1394_NO_FRAME
){

367 
	`u¶ìp
(1000000/120);

368 
waôög
 += 1.0/120.0;

371 
	`¥ötf
("dc1394_dma_single_capture_poll failed\n");

374 } 
waôög
<2);

375 
	`¥ötf
("dc1394_dma_single_capture_pollÅimed out\n");

377 
	}
}

379 
I∂Image
* 
	$icvRërõveFømeCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, ){

380 if(
ˇ±uª
->
ˇmîa
->
ˇ±uª_buf„r
 )

382 if(
ˇ±uª
->
c⁄vît
){

384 * 
§c
 = (*)
ˇ±uª
->
ˇmîa
->
ˇ±uª_buf„r
;

385 * 
d°
 = (*)
ˇ±uª
->
‰ame
.
imageD©a
;

386 
ˇ±uª
->
cﬁ‹_mode
) {

387 
COLOR_FORMAT7_RGB8
:

390 
i
=0;i<
ˇ±uª
->
‰ame
.
imageSize
;i+=6) {

391 
d°
[
i
] = 
§c
[i+2];

392 
d°
[
i
+1] = 
§c
[i+1];

393 
d°
[
i
+2] = 
§c
[i];

394 
d°
[
i
+3] = 
§c
[i+5];

395 
d°
[
i
+4] = 
§c
[i+4];

396 
d°
[
i
+5] = 
§c
[i+3];

399 
COLOR_FORMAT7_YUV422
:

401 
	`uyvy2bgr
(
§c
,

402 
d°
,

403 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
);

405 
COLOR_FORMAT7_MONO8
:

407 
	`y2bgr
(
§c
,

408 
d°
,

409 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
);

411 
COLOR_FORMAT7_YUV411
:

413 
	`uyyvyy2bgr
(
§c
,

414 
d°
,

415 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
);

417 
COLOR_FORMAT7_YUV444
:

419 
	`uyv2bgr
(
§c
,

420 
d°
,

421 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
);

423 
COLOR_FORMAT7_MONO16
:

425 
	`y162bgr
(
§c
,

426 
d°
,

427 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
, 
MONO16_BPP
);

429 
COLOR_FORMAT7_RGB16
:

431 
	`rgb482bgr
(
§c
,

432 
d°
,

433 
ˇ±uª
->
ˇmîa
->
‰ame_width
 * c≠tuª->ˇmîa->
‰ame_height
, 
MONO16_BPP
);

436 
	`Ârötf
(
°dîr
,"%s:%d: Unsuµ‹ãd cﬁ‹ modê%d\n",
__FILE__
,
__LINE__
,
ˇ±uª
->
cﬁ‹_mode
);

442 
ˇ±uª
->
‰ame
.
imageD©a
 = (*Ëˇ±uª->
ˇmîa
->
ˇ±uª_buf„r
;

443 
ˇ±uª
->
‰ame
.
imageD©aOrigö
 = (*Ëˇ±uª->
ˇmîa
->
ˇ±uª_buf„r
;

448 
	`dc1394_dma_d⁄e_wôh_buf„r
(
ˇ±uª
->
ˇmîa
);

450  &
ˇ±uª
->
‰ame
;

453 
	}
};

455 
	$icvGëPr›îtyCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, 
¥›îty_id
 ){

456 
ödex
=-1;

457  
¥›îty_id
 ) {

458 
CV_CAP_PROP_CONVERT_RGB
:

459  
ˇ±uª
->
c⁄vît
;

460 
CV_CAP_PROP_MODE
:

461  
ˇ±uª
->
mode
;

462 
CV_CAP_PROP_FORMAT
:

463  
ˇ±uª
->
f‹m©
;

464 
CV_CAP_PROP_FPS
:

465 
	`CV_DC1394_CALL
(
	`dc1394_gë_video_‰amî©e
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
,

466 (*Ë&
ˇ±uª
->
ˇmîa
->
‰ame_øã
));

467 
ˇ±uª
->
ˇmîa
->
‰ame_øã
) {

468 
FRAMERATE_1_875
:

470 
FRAMERATE_3_75
:

472 
FRAMERATE_7_5
:

474 
FRAMERATE_15
:

476 
FRAMERATE_30
:

478 
FRAMERATE_60
:

480 #i‡
NUM_FRAMERATES
 > 6

481 
FRAMERATE_120
:

484 #i‡
NUM_FRAMERATES
 > 7

485 
FRAMERATE_240
:

490 
ödex
 = 
¥›îty_id
;

493 if(
ödex
>=
FEATURE_MIN
 && index<=
FEATURE_MAX
){

494 
dc1394boﬁ_t
 
has_„©uª
;

495 
	`CV_DC1394_CALL
–
	`dc1394_is_„©uª_¥e£¡
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
,

496 
ödex
, &
has_„©uª
));

497 if(!
has_„©uª
){

498 
	`CV_WARN
("Feature isÇot supported byÅhis camera");

501 
vÆue
;

502 
	`dc1394_gë_„©uª_vÆue
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
ödex
, &
vÆue
);

503  (Ë
vÆue
;

508 
	}
};

511 
	$icvResizeFøme
(
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
){

512 if(
ˇ±uª
->
c⁄vît
){

515 if(
ˇ±uª
->
ˇmîa
->
‰ame_width
 !ˇ±uª->
‰ame
.
width
 ||

516 
ˇ±uª
->
ˇmîa
->
‰ame_height
 !ˇ±uª->
‰ame
.
height
 ||

517 
ˇ±uª
->
‰ame
.
dïth
 != 8 ||

518 
ˇ±uª
->
‰ame
.
nCh™√ls
 != 3 ||

519 
ˇ±uª
->
‰ame
.
imageD©a
 =
NULL
 ||

520 
ˇ±uª
->
buf„r_is_wrôóbÀ
 == 0)

522 if(
ˇ±uª
->
‰ame
.
imageD©a
 && c≠tuª->
buf„r_is_wrôóbÀ
){

523 
	`cvRñó£D©a
–&(
ˇ±uª
->
‰ame
));

525 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
, 
	`cvSize
–ˇ±uª->
ˇmîa
->
‰ame_width
,

526 
ˇ±uª
->
ˇmîa
->
‰ame_height
 ),

527 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_TL
, 4 );

528 
	`cvCª©eD©a
–&(
ˇ±uª
->
‰ame
) );

529 
ˇ±uª
->
buf„r_is_wrôóbÀ
 = 1;

535 if(
ˇ±uª
->
buf„r_is_wrôóbÀ
){

536 
	`cvRñó£D©a
(&(
ˇ±uª
->
‰ame
));

540 
bµ
 = 8;

541 
nch
 = 3;

542 
width
 = 
ˇ±uª
->
ˇmîa
->
‰ame_width
;

543 
height
 = 
ˇ±uª
->
ˇmîa
->
‰ame_height
;

544 
code
 = 
	`CV_FOURCC
('B','G','R',0);

545 
ˇ±uª
->
cﬁ‹_mode
){

546 
COLOR_FORMAT7_YUV422
:

547 
nch
 = 2;

548 
code
 = 
	`CV_FOURCC
('Y','4','2','2');

550 
COLOR_FORMAT7_MONO8
:

551 
code
 = 
	`CV_FOURCC
('Y',0,0,0);

552 
nch
 = 1;

554 
COLOR_FORMAT7_YUV411
:

555 
code
 = 
	`CV_FOURCC
('Y','4','1','1');

556 
width
 *= 2;

557 
nch
 = 3;

559 
COLOR_FORMAT7_YUV444
:

560 
code
 = 
	`CV_FOURCC
('Y','U','V',0);

561 
nch
 = 3;

563 
COLOR_FORMAT7_MONO16
:

564 
code
 = 
	`CV_FOURCC
('Y',0,0,0);

565 
bµ
 = 
IPL_DEPTH_16S
;

566 
nch
 = 1;

568 
COLOR_FORMAT7_RGB16
:

569 
bµ
 = 
IPL_DEPTH_16S
;

570 
nch
 = 3;

576 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,
	`cvSize
–
width
, 
height
 ), 
bµ
, 
nch
, 
IPL_ORIGIN_TL
, 4 );

578 
ˇ±uª
->
buf„r_is_wrôóbÀ
 = 0;

581 
	}
}

585 
	$icvSëC⁄vîtRGB
(
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
, 
c⁄vît
){

586 if(
c⁄vît
==
ˇ±uª
->convert){

590 
ˇ±uª
->
c⁄vît
 = convert;

591  
	`icvResizeFøme
–
ˇ±uª
 );

592 
	}
}

596 
	$icvF‹m©Suµ‹ãdCAM_DC1394
(
f‹m©
, 
quadÀt_t
 
f‹m©s
){

598 
shi·
 = 31 - (
f‹m©
 - 
FORMAT_MIN
);

599 
mask
 = 1 << 
shi·
;

600  (
f‹m©s
 & 
mask
) != 0;

601 
	}
}

605 
	$icvModeSuµ‹ãdCAM_DC1394
(
f‹m©
, 
mode
, 
quadÀt_t
 
modes
){

607 
f‹m©_idx
 = 
f‹m©
 - 
FORMAT_MIN
;

608 
mode_f‹m©_mö
 = 
MODE_FORMAT0_MIN
 + 32*
f‹m©_idx
;

609 
shi·
 = 31 - (
mode
 - 
mode_f‹m©_mö
);

610 
mask
 = 0x1 << 
shi·
;

611  (
modes
 & 
mask
) != 0;

612 
	}
}

616 
	$icvSëModeCAM_DC1394
–
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
, 
mode
 ){

617 
quadÀt_t
 
modes
, 
f‹m©s
;

621 
f‹m©
 = (
mode
 - 
MODE_FORMAT0_MIN
Ë/ 32 + 
FORMAT_MIN
;

624 i‡(
	`dc1394_quîy_suµ‹ãd_f‹m©s
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, &
f‹m©s
)<0) {

625 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ quîy suµ‹ãd f‹m©s\n",
__FILE__
,
__LINE__
);

630 if(
	`icvF‹m©Suµ‹ãdCAM_DC1394
(
f‹m©
, 
f‹m©s
)==0){

635 i‡(
	`dc1394_quîy_suµ‹ãd_modes
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
f‹m©
, &
modes
)<0){

636 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ quîy suµ‹ãd mode†f‹ f‹m© %d\n",
__FILE__
,
__LINE__
, 
ˇ±uª
->
f‹m©
);

641 if(! 
	`icvModeSuµ‹ãdCAM_DC1394
(
f‹m©
, 
mode
, 
modes
) ){

645 
cﬁ‹_mode
 = 
	`icvCﬁ‹Mode
–
mode
 );

647 if(
cﬁ‹_mode
 == -1){

651 
‰ame_øã
 = 
	`icvGëBe°FømeR©e
(
ˇ±uª
, 
f‹m©
, 
mode
);

653 
	`dc1394_dma_u∆i°í
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
);

654 i‡(
	`dc1394_dma_£tup_ˇ±uª
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, c≠tuª->ˇmîa->
ch™√l
 ,

655 
f‹m©
, 
mode
, 
SPEED_400
,

656 
‰ame_øã
, 
NUM_BUFFERS
, 1 ,

657 
ˇ±uª
->
devi˚_«me
, c≠tuª->
ˇmîa
Ë!
DC1394_SUCCESS
) {

658 
	`Ârötf
(
°dîr
,"%s:%d: FaûedÅÿ£tu∞DMA c≠tuª wôh VIDEO1394\n",
__FILE__
,
__LINE__
);

661 
	`dc1394_°¨t_iso_å™smissi⁄
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
);

663 
ˇ±uª
->
‰ame_øã
 = frame_rate;

664 
ˇ±uª
->
f‹m©
 = format;

665 
ˇ±uª
->
mode
 = mode;

666 
ˇ±uª
->
cﬁ‹_mode
 = color_mode;

669 
	`icvResizeFøme
–
ˇ±uª
 );

671 
	}
}

674 
	$icvGëBe°FømeR©e
–
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
, 
f‹m©
, 
mode
 ){

675 
quadÀt_t
 
‰amî©es
;

676 i‡(
	`dc1394_quîy_suµ‹ãd_‰amî©es
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
,

677 
f‹m©
, 
mode
, &
‰amî©es
)!=
DC1394_SUCCESS
)

679 
	`Ârötf
(
°dîr
,"%s:%d: CouldÇŸ quîy suµ‹ãd fømî©es\n",
__FILE__
,
__LINE__
);

680 
‰amî©es
 = 0;

683 
f
=
FRAMERATE_MAX
; f>=
FRAMERATE_MIN
; f--) {

684 i‡(
‰amî©es
 & (0x1<< (31-(
f
-
FRAMERATE_MIN
)))) {

685  
f
;

689 
	}
}

692 
	$icvSëFømeR©eCAM_DC1394
–
CvC≠tuªCAM_DC1394
 * 
ˇ±uª
, 
vÆue
 ){

693 
Âs
=15;

694 if(
ˇ±uª
->
f‹m©
 =
FORMAT_SCALABLE_IMAGE_SIZE
)

696 i‡(
vÆue
==-1){

697 
Âs
=
	`icvGëBe°FømeR©e
–
ˇ±uª
, c≠tuª->
f‹m©
, c≠tuª->
mode
 );

699 i‡(
vÆue
==1.875)

700 
Âs
=
FRAMERATE_1_875
;

701 i‡(
vÆue
==3.75)

702 
Âs
=
FRAMERATE_3_75
;

703 i‡(
vÆue
==7.5)

704 
Âs
=
FRAMERATE_7_5
;

705 i‡(
vÆue
==15)

706 
Âs
=
FRAMERATE_15
;

707 i‡(
vÆue
==30)

708 
Âs
=
FRAMERATE_30
;

709 i‡(
vÆue
==60)

710 
Âs
=
FRAMERATE_60
;

711 #i‡
NUM_FRAMERATES
 > 6

712 i‡(
vÆue
==120)

713 
Âs
=
FRAMERATE_120
;

715 #i‡
NUM_FRAMERATES
 > 7

716 i‡(
vÆue
==240)

717 
Âs
=
FRAMERATE_240
;

719 
	`dc1394_£t_video_‰amî©e
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
,
Âs
);

720 
	`dc1394_gë_video_‰amî©e
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
,

721 (*Ë&
ˇ±uª
->
ˇmîa
->
‰ame_øã
);

723  
Âs
==(Ë
ˇ±uª
->
ˇmîa
->
‰ame_øã
;

724 
	}
}

728 
	$icvCﬁ‹Mode
–
mode
 ){

729 
mode
) {

730 
MODE_160x120_YUV444
:

731  
COLOR_FORMAT7_YUV444
;

732 
MODE_320x240_YUV422
:

733 
MODE_640x480_YUV422
:

734 
MODE_800x600_YUV422
:

735 
MODE_1024x768_YUV422
:

736 
MODE_1280x960_YUV422
:

737 
MODE_1600x1200_YUV422
:

738  
COLOR_FORMAT7_YUV422
;

739 
MODE_640x480_YUV411
:

740  
COLOR_FORMAT7_YUV411
;

741 
MODE_640x480_RGB
:

742 
MODE_800x600_RGB
:

743 
MODE_1024x768_RGB
:

744 
MODE_1280x960_RGB
:

745 
MODE_1600x1200_RGB
:

746  
COLOR_FORMAT7_RGB8
;

747 
MODE_640x480_MONO
:

748 
MODE_800x600_MONO
:

749 
MODE_1024x768_MONO
:

750 
MODE_1280x960_MONO
:

751 
MODE_1600x1200_MONO
:

752  
COLOR_FORMAT7_MONO8
;

753 
MODE_640x480_MONO16
:

754 
MODE_800x600_MONO16
:

755 
MODE_1024x768_MONO16
:

756 
MODE_1280x960_MONO16
:

757 
MODE_1600x1200_MONO16
:

758  
COLOR_FORMAT7_MONO16
;

759 
MODE_FORMAT7_0
:

760 
MODE_FORMAT7_1
:

761 
MODE_FORMAT7_2
:

762 
MODE_FORMAT7_3
:

763 
MODE_FORMAT7_4
:

764 
MODE_FORMAT7_5
:

765 
MODE_FORMAT7_6
:

766 
MODE_FORMAT7_7
:

767 
	`Ârötf
(
°dîr
,"%s:%d: F‹m©7ÇŸ yë suµ‹ãd\n",
__FILE__
,
__LINE__
);

772 
	}
}

777 
	$icvSëFótuªCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, 
„©uª_id
, 
vÆ
){

778 
dc1394boﬁ_t
 
isOn
 = 
DC1394_FALSE
;

779 
dc1394boﬁ_t
 
hasAutoC≠abûôy
 = 
DC1394_FALSE
;

780 
dc1394boﬁ_t
 
isAutoOn
 = 
DC1394_FALSE
;

781 
nvÆ
;

782 
mövÆ
,
maxvÆ
;

785 if–
	`dc1394_is_„©uª_⁄
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
isOn
)

786 =
DC1394_FAILURE
 ) {

789 if–
isOn
 =
DC1394_FALSE
 ) {

791 if–
	`dc1394_„©uª_⁄_off
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, 1Ë=
DC1394_FAILURE
 ) {

792 
	`Ârötf
(
°dîr
, "îr‹Åu∫ög fótuª %d on!\n", 
„©uª_id
);

798 
	`dc1394_has_auto_mode
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
hasAutoC≠abûôy
);

799 if–
hasAutoC≠abûôy
 ) {

802 if–
	`dc1394_is_„©uª_auto
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
isAutoOn
 ) =
DC1394_FAILURE
 ) {

803 
	`Ârötf
(
°dîr
, "îr‹ dëîmöög i‡„©uª %d ha†autÿ⁄!\n", 
„©uª_id
);

808 if(
vÆ
==-1){

809 
	`Ârötf
(
°dîr
, "„©uª %d d€†nŸ suµ‹àautÿmode\n", 
„©uª_id
);

813 if(
vÆ
==-1){

815 if–
isAutoOn
 =
DC1394_FALSE
 ) {

816 if(
	`dc1394_auto_⁄_off
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, 1Ë=
DC1394_FAILURE
 ) {

817 
	`Ârötf
(
°dîr
, "îr‹Åu∫ög fótuª %dáutÿON!\n", 
„©uª_id
);

825 if–
isAutoOn
 =
DC1394_TRUE
 ) {

826 if(
	`dc1394_auto_⁄_off
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, 0Ë=
DC1394_FAILURE
 ) {

827 
	`Ârötf
(
°dîr
, "îr‹Åu∫ög fótuª %dáutÿOFF!\n", 
„©uª_id
);

833 
	`CV_DC1394_CALL
–
	`dc1394_gë_mö_vÆue
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
mövÆ
));

834 
	`CV_DC1394_CALL
–
	`dc1394_gë_max_vÆue
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
maxvÆ
));

835 
vÆ
 = ()
	`MIN
(
maxvÆ
, 
	`MAX
(()vÆ, 
mövÆ
));

838 i‡(
	`dc1394_£t_„©uª_vÆue
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, 
vÆ
) ==

839 
DC1394_FAILURE
){

840 
	`Ârötf
(
°dîr
, "error setting feature value\n");

843 i‡(
	`dc1394_gë_„©uª_vÆue
(
ˇ±uª
->
h™dÀ
, c≠tuª->
ˇmîa
->
node
, 
„©uª_id
, &
nvÆ
) ==

844 
DC1394_FAILURE
){

845 
	`Ârötf
(
°dîr
, "error setting feature value\n");

848  
nvÆ
==()
vÆ
;

850 
	}
}

854 
	$icvSëPr›îtyCAM_DC1394
–
CvC≠tuªCAM_DC1394
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
 ){

855 
ödex
=-1;

856  
¥›îty_id
 ) {

857 
CV_CAP_PROP_CONVERT_RGB
:

858  
	`icvSëC⁄vîtRGB
–
ˇ±uª
, 
vÆue
 != 0 );

859 
CV_CAP_PROP_MODE
:

860  
	`icvSëModeCAM_DC1394
–
ˇ±uª
, (Ë
vÆue
 );

861 
CV_CAP_PROP_FPS
:

862  
	`icvSëFømeR©eCAM_DC1394
–
ˇ±uª
, 
vÆue
 );

863 
CV_CAP_PROP_BRIGHTNESS
:

864 
ödex
 = 
FEATURE_BRIGHTNESS
;

866 
CV_CAP_PROP_CONTRAST
:

867 
ödex
 = 
FEATURE_GAMMA
;

869 
CV_CAP_PROP_SATURATION
:

870 
ödex
 = 
FEATURE_SATURATION
;

872 
CV_CAP_PROP_HUE
:

873 
ödex
 = 
FEATURE_HUE
;

875 
CV_CAP_PROP_GAIN
:

876 
ödex
 = 
FEATURE_GAIN
;

879 
ödex
 = 
¥›îty_id
;

882 if(
ödex
>=
FEATURE_MIN
 && index<=
FEATURE_MAX
){

883  
	`icvSëFótuªCAM_DC1394
(
ˇ±uª
, 
ödex
, (Ë
vÆue
);

886 
	}
};

895 
	#YUV2RGB
(
y
, 
u
, 
v
, 
r
, 
g
, 
b
)\

896 
r
 = 
y
 + ((
v
*1436) >> 10);\

897 
g
 = 
y
 - ((
u
*352 + 
v
*731) >> 10);\

898 
b
 = 
y
 + ((
u
*1814) >> 10);\

899 
r
 =Ñ < 0 ? 0 :Ñ;\

900 
g
 = g < 0 ? 0 : g;\

901 
b
 = b < 0 ? 0 : b;\

902 
r
 =Ñ > 255 ? 255 :Ñ;\

903 
g
 = g > 255 ? 255 : g;\

904 
b
 = b > 255 ? 255 : 
	)
b

907 
	$uyv2bgr
(c⁄° *
§c
, *
de°
,

908 
NumPixñs
)

910 
i
 = 
NumPixñs
 + (NumPixels << 1) - 1;

911 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

912 
y
, 
u
, 
v
;

913 
r
, 
g
, 
b
;

915 
i
 > 0) {

916 
v
 = 
§c
[
i
--] - 128;

917 
y
 = 
§c
[
i
--];

918 
u
 = 
§c
[
i
--] - 128;

919 
	`YUV2RGB
(
y
, 
u
, 
v
, 
r
, 
g
, 
b
);

920 
de°
[
j
--] = 
r
;

921 
de°
[
j
--] = 
g
;

922 
de°
[
j
--] = 
b
;

924 
	}
}

927 
	$uyvy2bgr
(c⁄° *
§c
, *
de°
,

928 
NumPixñs
)

930 
i
 = (
NumPixñs
 << 1) - 1;

931 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

932 
y0
, 
y1
, 
u
, 
v
;

933 
r
, 
g
, 
b
;

935 
i
 > 0) {

936 
y1
 = 
§c
[
i
--];

937 
v
 = 
§c
[
i
--] - 128;

938 
y0
 = 
§c
[
i
--];

939 
u
 = 
§c
[
i
--] - 128;

940 
	`YUV2RGB
(
y1
, 
u
, 
v
, 
r
, 
g
, 
b
);

941 
de°
[
j
--] = 
r
;

942 
de°
[
j
--] = 
g
;

943 
de°
[
j
--] = 
b
;

944 
	`YUV2RGB
(
y0
, 
u
, 
v
, 
r
, 
g
, 
b
);

945 
de°
[
j
--] = 
r
;

946 
de°
[
j
--] = 
g
;

947 
de°
[
j
--] = 
b
;

949 
	}
}

953 
	$uyyvyy2bgr
(c⁄° *
§c
, *
de°
,

954 
NumPixñs
)

956 
i
 = 
NumPixñs
 + (NumPixels >> 1) - 1;

957 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

958 
y0
, 
y1
, 
y2
, 
y3
, 
u
, 
v
;

959 
r
, 
g
, 
b
;

961 
i
 > 0) {

962 
y3
 = 
§c
[
i
--];

963 
y2
 = 
§c
[
i
--];

964 
v
 = 
§c
[
i
--] - 128;

965 
y1
 = 
§c
[
i
--];

966 
y0
 = 
§c
[
i
--];

967 
u
 = 
§c
[
i
--] - 128;

968 
	`YUV2RGB
(
y3
, 
u
, 
v
, 
r
, 
g
, 
b
);

969 
de°
[
j
--] = 
r
;

970 
de°
[
j
--] = 
g
;

971 
de°
[
j
--] = 
b
;

972 
	`YUV2RGB
(
y2
, 
u
, 
v
, 
r
, 
g
, 
b
);

973 
de°
[
j
--] = 
r
;

974 
de°
[
j
--] = 
g
;

975 
de°
[
j
--] = 
b
;

976 
	`YUV2RGB
(
y1
, 
u
, 
v
, 
r
, 
g
, 
b
);

977 
de°
[
j
--] = 
r
;

978 
de°
[
j
--] = 
g
;

979 
de°
[
j
--] = 
b
;

980 
	`YUV2RGB
(
y0
, 
u
, 
v
, 
r
, 
g
, 
b
);

981 
de°
[
j
--] = 
r
;

982 
de°
[
j
--] = 
g
;

983 
de°
[
j
--] = 
b
;

985 
	}
}

988 
	$y2bgr
(c⁄° *
§c
, *
de°
,

989 
NumPixñs
)

991 
i
 = 
NumPixñs
 - 1;

992 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

993 
y
;

995 
i
 > 0) {

996 
y
 = 
§c
[
i
--];

997 
de°
[
j
--] = 
y
;

998 
de°
[
j
--] = 
y
;

999 
de°
[
j
--] = 
y
;

1001 
	}
}

1004 
	$y162bgr
(c⁄° *
§c
, *
de°
,

1005 
NumPixñs
, 
bôs
)

1007 
i
 = (
NumPixñs
 << 1) - 1;

1008 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

1009 
y
;

1011 
i
 > 0) {

1012 
y
 = 
§c
[
i
--];

1013 
y
 = (y + (
§c
[
i
--] << 8)Ë>> (
bôs
 - 8);

1014 
de°
[
j
--] = 
y
;

1015 
de°
[
j
--] = 
y
;

1016 
de°
[
j
--] = 
y
;

1018 
	}
}

1022 
	$rgb482bgr
(c⁄° *
§c
, *
de°
,

1023 
NumPixñs
, 
bôs
)

1025 
i
 = (
NumPixñs
 << 1) - 1;

1026 
j
 = 
NumPixñs
 + (NumPixels << 1) - 1;

1027 
y
;

1029 
i
 > 0) {

1030 
y
 = 
§c
[
i
--];

1031 
de°
[
j
-2] = (
y
 + (
§c
[
i
--] << 8)Ë>> (
bôs
 - 8);

1032 
j
--;

1033 
y
 = 
§c
[
i
--];

1034 
de°
[
j
] = (
y
 + (
§c
[
i
--] << 8)Ë>> (
bôs
 - 8);

1035 
j
--;

1036 
y
 = 
§c
[
i
--];

1037 
de°
[
j
+2] = (
y
 + (
§c
[
i
--] << 8)Ë>> (
bôs
 - 8);

1038 
j
--;

1040 
	}
}

1043 ˛as†
	cCvC≠tuªCAM_DC1394_CPP
 : 
public
 
CvC≠tuª


1045 
public
:

1046 
	$CvC≠tuªCAM_DC1394_CPP
(Ë{ 
ˇ±uªDC1394
 = 0; }

1047 
vútuÆ
 ~
	$CvC≠tuªCAM_DC1394_CPP
(Ë{ 
	`˛o£
(); 
	}
}

1049 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

1050 
vútuÆ
 
˛o£
();

1052 
vútuÆ
 
	$gëPr›îty
() const;

1053 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

1054 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

1055 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

1056 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_DC1394
; 
	}
}

1057 
	g¥Ÿe˘ed
:

1059 
CvC≠tuªCAM_DC1394
* 
ˇ±uªDC1394
;

1062 
boﬁ
 
	gCvC≠tuªCAM_DC1394_CPP
::
	$›í
–
ödex
 )

1064 
	`˛o£
();

1065 
ˇ±uªDC1394
 = 
	`icvC≠tuªFromCAM_DC1394
(
ödex
);

1066  
ˇ±uªDC1394
 != 0;

1067 
	}
}

1069 
	gCvC≠tuªCAM_DC1394_CPP
::
	$˛o£
()

1071 if–
ˇ±uªDC1394
 )

1073 
	`icvClo£CAM_DC1394
–
ˇ±uªDC1394
 );

1074 
	`cvFªe
–&
ˇ±uªDC1394
 );

1076 
	}
}

1078 
boﬁ
 
	gCvC≠tuªCAM_DC1394_CPP
::
	$gøbFøme
()

1080  
ˇ±uªDC1394
 ? 
	`icvGøbFømeCAM_DC1394
–ˇ±uªDC1394 ) !0 : 
Ál£
;

1081 
	}
}

1083 
I∂Image
* 
	gCvC≠tuªCAM_DC1394_CPP
::
	$ªåõveFøme
()

1085  
ˇ±uªDC1394
 ? (
I∂Image
*)
	`icvRërõveFømeCAM_DC1394
( captureDC1394, 0 ) : 0;

1086 
	}
}

1088 
	gCvC≠tuªCAM_DC1394_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

1092 
CvC≠tuªCAM_DC1394
* 
ˇp
 = 
c⁄°_ˇ°
<CvC≠tuªCAM_DC1394*>(
ˇ±uªDC1394
);

1094  
ˇp
 ? 
	`icvGëPr›îtyCAM_DC1394
–ˇp, 
¥›Id
 ) : 0;

1095 
	}
}

1097 
boﬁ
 
	gCvC≠tuªCAM_DC1394_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

1099  
ˇ±uªDC1394
 ? 
	`icvSëPr›îtyCAM_DC1394
–ˇ±uªDC1394, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

1100 
	}
}

1102 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_DC1394
–
ödex
 )

1104 
CvC≠tuªCAM_DC1394_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_DC1394_CPP;

1106 if–
ˇ±uª
->
	`›í
–
ödex
 ))

1107  
ˇ±uª
;

1109 
dñëe
 
ˇ±uª
;

1111 
	}
}

	@src/cap_dc1394_v2.cpp

42 
	~"¥ecomp.hµ
"

44 #ifde‡
HAVE_DC1394_2


46 
	~<uni°d.h
>

47 
	~<°döt.h
>

48 #ifde‡
WIN32


51 #i‚de‡
__SYS_SELECT_H__


52 
	#__SYS_SELECT_H__
 1

	)

53 
	~<wösock2.h
>

56 
	~<sys/£À˘.h
>

58 
	~<dc1394/dc1394.h
>

59 
	~<°dlib.h
>

60 
	~<°rög.h
>

62 
dc1394îr‹_t
 
	$ad≠tBuf„rSãªoLoˇl
(
dc1394video_‰ame_t
 *
ö
, dc1394video_‰ame_à*
out
)

64 
uöt32_t
 
bµ
;

67 
out
->
size
[0] = 
ö
->size[0];

68 
out
->
size
[1] = 
ö
->size[1] * 2;

69 
out
->
posôi⁄
[0] = 
ö
->position[0];

70 
out
->
posôi⁄
[1] = 
ö
->position[1];

73 
ö
->
cﬁ‹_codög
)

75 
DC1394_COLOR_CODING_RAW16
:

76 
out
->
cﬁ‹_codög
 = 
DC1394_COLOR_CODING_RAW8
;

78 
DC1394_COLOR_CODING_MONO16
:

79 
DC1394_COLOR_CODING_YUV422
:

80 
out
->
cﬁ‹_codög
 = 
DC1394_COLOR_CODING_MONO8
;

83  
DC1394_INVALID_COLOR_CODING
;

87 
out
->
cﬁ‹_fûãr
 = 
ö
->color_filter;

93 
out
->
d©a_dïth
 = 8;

98 
out
->
video_mode
 = 
ö
->video_mode;

101 
out
->
∑ddög_byãs
 = 
ö
->padding_bytes;

104 
	`dc1394_gë_cﬁ‹_codög_bô_size
(
out
->
cﬁ‹_codög
, &
bµ
);

105 
out
->
image_byãs
 = (out->
size
[0] * out->size[1] * 
bµ
) / 8;

108 
out
->
tŸÆ_byãs
 = out->
image_byãs
 + out->
∑ddög_byãs
;

111 
out
->
∑ckë_size
 = 
ö
->packet_size;

112 
out
->
∑ckës_≥r_‰ame
 = 
ö
->packets_per_frame;

115 
out
->
time°amp
 = 
ö
->timestamp;

116 
out
->
‰ames_behöd
 = 
ö
->frames_behind;

117 
out
->
ˇmîa
 = 
ö
->camera;

118 
out
->
id
 = 
ö
->id;

121 i‡(
out
->
tŸÆ_byãs
 > out->
Æloˇãd_image_byãs
)

123 
	`‰ì
(
out
->
image
);

124 
out
->
image
 = (
uöt8_t
*)
	`mÆloc
(out->
tŸÆ_byãs
 * (uint8_t));

125 
out
->
Æloˇãd_image_byãs
 = out->
tŸÆ_byãs
;

129 
	`mem˝y
(&(
out
->
image
[out->
image_byãs
]), &(
ö
->image[ö->image_byãs]), out->
∑ddög_byãs
);

130 
out
->
lôée_ídün
 = 
DC1394_FALSE
;

131 
out
->
d©a_ö_∑ddög
 = 
DC1394_FALSE
;

132  
DC1394_SUCCESS
;

133 
	}
}

135 
dc1394îr‹_t
 
	$dc1394_deöãæa˚_°îeo_‰ames_fixed
(
dc1394video_‰ame_t
 *
ö
,

136 
dc1394video_‰ame_t
 *
out
, 
dc1394°îeo_mëhod_t
 
mëhod
)

138 if((
ö
->
cﬁ‹_codög
 =
DC1394_COLOR_CODING_RAW16
) ||

139 (
ö
->
cﬁ‹_codög
 =
DC1394_COLOR_CODING_MONO16
) ||

140 (
ö
->
cﬁ‹_codög
 =
DC1394_COLOR_CODING_YUV422
))

142 
mëhod
)

145 
DC1394_STEREO_METHOD_INTERLACED
:

146 
	`ad≠tBuf„rSãªoLoˇl
(
ö
, 
out
);

149 
	`dc1394_deöãæa˚_°îeo
(
ö
->
image
, 
out
->image, out->
size
[0], out->size[1]);

152 
DC1394_STEREO_METHOD_FIELD
:

153 
	`ad≠tBuf„rSãªoLoˇl
(
ö
, 
out
);

154 
	`mem˝y
(
out
->
image
, 
ö
->image, out->
image_byãs
);

158  
DC1394_INVALID_STEREO_METHOD
;

161  
DC1394_FUNCTION_NOT_SUPPORTED
;

162 
	}
}

164 
uöt32_t
 
	$gëC⁄åﬁRegi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
)

166 
uöt32_t
 
vÆue
 = 0;

167 
dc1394îr‹_t
 
îr
 = 
	`dc1394_gë_c⁄åﬁ_ªgi°î
(
ˇmîa
, 
off£t
, &
vÆue
);

169 
	`as£π
(
îr
 =
DC1394_SUCCESS
);

170  
îr
 =
DC1394_SUCCESS
 ? 
vÆue
 : 0xffffffff;

171 
	}
}

173 
	sCvDC1394


175 
CvDC1394
();

176 ~
CvDC1394
();

178 
dc1394_t
* 
	mdc
;

179 
fd_£t
 
	mˇmFds
;

182 
	gCvDC1394
::
	$CvDC1394
()

184 
dc
 = 
	`dc1394_√w
();

185 
	`FD_ZERO
(&
ˇmFds
);

186 
	}
}

188 
	gCvDC1394
::~
	$CvDC1394
()

190 i‡(
dc
)

191 
	`dc1394_‰ì
(
dc
);

192 
dc
 = 0;

193 
	}
}

195 
CvDC1394
 
	gdc1394
;

197 ˛as†
	cCvC≠tuªCAM_DC1394_v2_CPP
 : 
public
 
CvC≠tuª


199 
public
:

200 
dc1394¥›îtõs
[
CV_CAP_PROP_MAX_DC1394
];

201 
CvC≠tuªCAM_DC1394_v2_CPP
();

202 
	mvútuÆ
 ~
	$CvC≠tuªCAM_DC1394_v2_CPP
()

204 
	`˛o£
();

207 
vútuÆ
 
boﬁ
 
	`›í
(
ödex
);

208 
vútuÆ
 
	`˛o£
();

210 
vútuÆ
 
	$gëPr›îty
() const;

211 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

212 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

213 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

214 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_DC1394
; 
	}
}

217 
	g¥Ÿe˘ed
:

218 
vútuÆ
 
boﬁ
 
°¨tC≠tuª
();

219 
vútuÆ
 
boﬁ
 
gëVidîeCÆibøti⁄Info
–* 
buf
, 
bufSize
 );

220 
vútuÆ
 
boﬁ
 
öôVidîeRe˘ifyM≠s
–c⁄° * 
öfo
, 
I∂Image
* 
ml
[2], I∂Image* 
mr
[2] );

222 
uöt64_t
 
	gguid
;

223 
dc1394ˇmîa_t
* 
	gdcCam
;

224 
	gisoS≥ed
;

225 
	gvideoMode
;

226 
	g‰ameWidth
, 
	g‰ameHeight
;

227 
	gÂs
;

228 
	gnDMABufs
;

229 
boﬁ
 
	g°¨ãd
;

230 
	gu£rMode
;

232 íum { 
	gVIDERE
 = 0x5505 };

234 
	gˇmîaId
;

235 
boﬁ
 
	gcﬁ‹Sãªo
;

236 
dc1394bayî_mëhod_t
 
	gbayî
;

237 
dc1394cﬁ‹_fûãr_t
 
	gbayîFûãr
;

239 íum { 
	gNIMG
 = 2 };

240 
I∂Image
 *
	gimg
[
NIMG
];

241 
dc1394video_‰ame_t
* 
	g‰ameC
;

242 
	gnimages
;

244 
boﬁ
 
	gª˘ify
;

245 
boﬁ
 
	göô_ª˘ify
;

246 
I∂Image
 *
	gm≠s
[
NIMG
][2];

247 
dc1394„©uª£t_t
 
	g„©uª_£t
;

250 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
dc1394¥›îtõs
[
CV_CAP_PROP_MAX_DC1394
] = {

253 
DC1394_FEATURE_FRAME_RATE
,

255 
DC1394_FEATURE_BRIGHTNESS
,

257 
DC1394_FEATURE_SATURATION
,

258 
DC1394_FEATURE_HUE
,

259 
DC1394_FEATURE_GAIN
,

260 
DC1394_FEATURE_SHUTTER
,

262 
DC1394_FEATURE_WHITE_BALANCE
,

264 
DC1394_FEATURE_SHARPNESS
,

265 
DC1394_FEATURE_EXPOSURE
,

266 
DC1394_FEATURE_GAMMA
,

267 
DC1394_FEATURE_TEMPERATURE
,

268 
DC1394_FEATURE_TRIGGER
,

269 
DC1394_FEATURE_TRIGGER_DELAY
,

270 
DC1394_FEATURE_WHITE_BALANCE
,

271 
DC1394_FEATURE_ZOOM
,

272 
DC1394_FEATURE_FOCUS
,

275 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$CvC≠tuªCAM_DC1394_v2_CPP
()

277 
guid
 = 0;

278 
dcCam
 = 0;

279 
isoS≥ed
 = 400;

280 
Âs
 = 15;

282 
nDMABufs
 = 8;

283 
°¨ãd
 = 
Ál£
;

284 
ˇmîaId
 = 0;

285 
cﬁ‹Sãªo
 = 
Ál£
;

286 
bayî
 = 
DC1394_BAYER_METHOD_BILINEAR
;

287 
bayîFûãr
 = 
DC1394_COLOR_FILTER_GRBG
;

288 
‰ameWidth
 = 640;

289 
‰ameHeight
 = 480;

291 
i
 = 0; i < 
NIMG
; i++)

292 
img
[
i
] = 
m≠s
[i][0] = maps[i][1] = 0;

293 
‰ameC
 = 0;

294 
nimages
 = 1;

295 
ª˘ify
 = 
Ál£
;

296 
u£rMode
 = -1;

297 
	}
}

300 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$°¨tC≠tuª
()

302 
i
;

303 
code
 = 0;

304 i‡(!
dcCam
)

305  
Ál£
;

306 i‡(
isoS≥ed
 > 0)

309 i‡(
isoS≥ed
 > 400 && 
dcCam
->
bmode_ˇ∑bÀ
 =
DC1394_TRUE
)

311 
	`dc1394_video_£t_›î©i⁄_mode
(
dcCam
, 
DC1394_OPERATION_MODE_1394B
);

313 
code
 = 
	`dc1394_video_£t_iso_•ìd
(
dcCam
,

314 
isoS≥ed
 <100 ? 
DC1394_ISO_SPEED_100
 :

315 
isoS≥ed
 <200 ? 
DC1394_ISO_SPEED_200
 :

316 
isoS≥ed
 <400 ? 
DC1394_ISO_SPEED_400
 :

317 
isoS≥ed
 <800 ? 
DC1394_ISO_SPEED_800
 :

318 
isoS≥ed
 =1600 ? 
DC1394_ISO_SPEED_1600
 :

319 
DC1394_ISO_SPEED_3200
);

323 i‡(
u£rMode
 >= 0)

326 
dc1394video_mode_t
 
w™ãdMode
;

327 
dc1394video_modes_t
 
videoModes
;

328 
	`dc1394_video_gë_suµ‹ãd_modes
(
dcCam
, &
videoModes
);

332 i‡(
u£rMode
 < ()
videoModes
.
num
)

334 
w™ãdMode
 = 
videoModes
.
modes
[
u£rMode
];

338 i‡((
u£rMode
 >
DC1394_VIDEO_MODE_MIN
Ë&& (u£rModê<
DC1394_VIDEO_MODE_MAX
 ))

341 
j
 = 0;

342 (
j
< ()
videoModes
.
num
Ë&& videoModes.
modes
[j]!=
u£rMode
)

344 
j
++;

347 i‡(()
videoModes
.
modes
[
j
]==
u£rMode
)

349 
w™ãdMode
 = 
videoModes
.
modes
[
j
];

353 
u£rMode
 = -1;

358 
u£rMode
 = -1;

361 i‡(
u£rMode
 != -1)

363 
code
 = 
	`dc1394_video_£t_mode
(
dcCam
, 
w™ãdMode
);

364 
uöt32_t
 
width
, 
height
;

365 
	`dc1394_gë_image_size_‰om_video_mode
(
dcCam
, 
w™ãdMode
, &
width
, &
height
);

366 
‰ameWidth
 = ()
width
;

367 
‰ameHeight
 = ()
height
;

371 i‡(
u£rMode
 =-1 && (
‰ameWidth
 > 0 || 
‰ameHeight
 > 0))

373 
dc1394video_mode_t
 
be°Mode
 = (dc1394video_mode_t) - 1;

374 
dc1394video_modes_t
 
videoModes
;

375 
	`dc1394_video_gë_suµ‹ãd_modes
(
dcCam
, &
videoModes
);

376 
i
 = 0; i < ()
videoModes
.
num
; i++)

378 
dc1394video_mode_t
 
mode
 = 
videoModes
.
modes
[
i
];

379 i‡(
mode
 >
DC1394_VIDEO_MODE_FORMAT7_MIN
 && modê<
DC1394_VIDEO_MODE_FORMAT7_MAX
)

381 
¥ef
 = -1;

382 
dc1394cﬁ‹_codög_t
 
cﬁ‹Codög
;

383 
	`dc1394_gë_cﬁ‹_codög_‰om_video_mode
(
dcCam
, 
mode
, &
cﬁ‹Codög
);

385 
uöt32_t
 
width
, 
height
;

386 
	`dc1394_gë_image_size_‰om_video_mode
(
dcCam
, 
mode
, &
width
, &
height
);

387 i‡(()
width
 =
‰ameWidth
 || ()
height
 =
‰ameHeight
)

389 i‡(
cﬁ‹Codög
 =
DC1394_COLOR_CODING_RGB8
 ||

390 
cﬁ‹Codög
 =
DC1394_COLOR_CODING_RAW8
)

392 
be°Mode
 = 
mode
;

396 i‡(
cﬁ‹Codög
 =
DC1394_COLOR_CODING_YUV411
 ||

397 
cﬁ‹Codög
 =
DC1394_COLOR_CODING_YUV422
 ||

398 (
cﬁ‹Codög
 =
DC1394_COLOR_CODING_YUV444
 &&

399 
¥ef
 < 1))

401 
be°Mode
 = 
mode
;

402 
¥ef
 = 1;

406 i‡(
cﬁ‹Codög
 =
DC1394_COLOR_CODING_MONO8
)

408 
be°Mode
 = 
mode
;

409 
¥ef
 = 0;

413 i‡(()
be°Mode
 >= 0)

414 
code
 = 
	`dc1394_video_£t_mode
(
dcCam
, 
be°Mode
);

417 i‡(
Âs
 > 0)

419 
dc1394video_mode_t
 
mode
;

420 
dc1394‰amî©es_t
 
‰amî©es
;

421 
möDiff
 = 
DBL_MAX
;

422 
dc1394‰amî©e_t
 
be°Fps
 = (dc1394framerate_t) - 1;

424 
	`dc1394_video_gë_mode
(
dcCam
, &
mode
);

425 
	`dc1394_video_gë_suµ‹ãd_‰amî©es
(
dcCam
, 
mode
, &
‰amî©es
);

427 
i
 = 0; i < ()
‰amî©es
.
num
; i++)

429 
dc1394‰amî©e_t
 
iÂs
 = 
‰amî©es
.‰amî©es[
i
];

430 
Âs1
 = (1 << (
iÂs
 - 
DC1394_FRAMERATE_1_875
)) * 1.875;

431 
diff
 = 
	`Ábs
(
Âs1
 - 
Âs
);

432 i‡(
diff
 < 
möDiff
)

434 
möDiff
 = 
diff
;

435 
be°Fps
 = 
iÂs
;

438 i‡(()
be°Fps
 >= 0)

439 
code
 = 
	`dc1394_video_£t_‰amî©e
(
dcCam
, 
be°Fps
);

442 i‡(
ˇmîaId
 =
VIDERE
)

444 
bayîFûãr
 = 
DC1394_COLOR_FILTER_GBRG
;

445 
nimages
 = 2;

446 
uöt32_t
 
vÆue
 = 0;

447 
	`dc1394_gë_c⁄åﬁ_ªgi°î
(
dcCam
, 0x50c, &
vÆue
);

448 
cﬁ‹Sãªo
 = (
vÆue
 & 0x80000000) != 0;

451 
code
 = 
	`dc1394_ˇ±uª_£tup
(
dcCam
, 
nDMABufs
, 
DC1394_CAPTURE_FLAGS_DEFAULT
);

452 i‡(
code
 >= 0)

454 
	`FD_SET
(
	`dc1394_ˇ±uª_gë_fûío
(
dcCam
), &
dc1394
.
ˇmFds
);

455 
	`dc1394_video_£t_å™smissi⁄
(
dcCam
, 
DC1394_ON
);

456 i‡(
ˇmîaId
 =
VIDERE
)

458 íum { 
PROC_MODE_OFF
, 
PROC_MODE_NONE
, 
PROC_MODE_TEST
, 
PROC_MODE_RECTIFIED
, 
PROC_MODE_DISPARITY
, 
PROC_MODE_DISPARITY_RAW
 };

459 
¥ocMode
 = 
PROC_MODE_RECTIFIED
;

460 
	`u¶ìp
(100000);

461 
uöt32_t
 
qvÆ1
 = 0x08000000 | (0x90 << 16Ë| ((
¥ocMode
 & 0x7) << 16);

462 
uöt32_t
 
qvÆ2
 = 0x08000000 | (0x9C << 16);

463 
	`dc1394_£t_c⁄åﬁ_ªgi°î
(
dcCam
, 0xFF000, 
qvÆ1
);

464 
	`dc1394_£t_c⁄åﬁ_ªgi°î
(
dcCam
, 0xFF000, 
qvÆ2
);

466 
°¨ãd
 = 
åue
;

469  
code
 >= 0;

470 
	}
}

472 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$›í
(
ödex
)

474 
boﬁ
 
ªsu…
 = 
Ál£
;

475 
dc1394ˇmîa_li°_t
* 
ˇmîaLi°
 = 0;

476 
dc1394îr‹_t
 
îr
;

478 
	`˛o£
();

480 i‡(!
dc1394
.
dc
)

481 
_exô_
;

483 
îr
 = 
	`dc1394_ˇmîa_íumî©e
(
dc1394
.
dc
, &
ˇmîaLi°
);

484 i‡(
îr
 < 0 || !
ˇmîaLi°
 || ()
ödex
 >()ˇmîaLi°->
num
)

485 
_exô_
;

487 
guid
 = 
ˇmîaLi°
->
ids
[
ödex
].guid;

488 
dcCam
 = 
	`dc1394_ˇmîa_√w
(
dc1394
.
dc
, 
guid
);

489 i‡(!
dcCam
)

490 
_exô_
;

492 
ˇmîaId
 = 
dcCam
->
víd‹_id
;

494 i‡(
	`dc1394_„©uª_gë_Æl
(
dcCam
,&
„©uª_£t
Ë=
DC1394_SUCCESS
)

495 
ªsu…
 = 
åue
;

497 
ªsu…
 = 
Ál£
;

499 
_exô_
:

500 i‡(
ˇmîaLi°
)

501 
	`dc1394_ˇmîa_‰ì_li°
(
ˇmîaLi°
);

503  
ªsu…
;

504 
	}
}

506 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$˛o£
()

508 i‡(
dcCam
)

511 
fûío
=
	`dc1394_ˇ±uª_gë_fûío
(
dcCam
);

513 i‡(
fûío
>=0 && 
	`FD_ISSET
(fûío, &
dc1394
.
ˇmFds
))

514 
	`FD_CLR
(
fûío
, &
dc1394
.
ˇmFds
);

515 
	`dc1394_video_£t_å™smissi⁄
(
dcCam
, 
DC1394_OFF
);

516 
	`dc1394_ˇ±uª_°›
(
dcCam
);

517 
	`dc1394_ˇmîa_‰ì
(
dcCam
);

518 
dcCam
 = 0;

519 
°¨ãd
 = 
Ál£
;

522 
i
 = 0; i < 
NIMG
; i++)

524 
	`cvRñó£Image
(&
img
[
i
]);

525 
	`cvRñó£Image
(&
m≠s
[
i
][0]);

526 
	`cvRñó£Image
(&
m≠s
[
i
][1]);

528 i‡(
‰ameC
)

530 i‡(
‰ameC
->
image
)

531 
	`‰ì
(
‰ameC
->
image
);

532 
	`‰ì
(
‰ameC
);

533 
‰ameC
 = 0;

535 
	}
}

538 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$gøbFøme
()

540 
dc1394ˇ±uª_pﬁicy_t
 
pﬁicy
 = 
DC1394_CAPTURE_POLICY_WAIT
;

541 
boﬁ
 
code
 = 
Ál£
, 
isCﬁ‹
;

542 
dc1394video_‰ame_t
 *
dcFøme
 = 0, *
fs
 = 0;

543 
i
, 
nch
;

545 i‡(!
dcCam
 || (!
°¨ãd
 && !
	`°¨tC≠tuª
()))

546  
Ál£
;

548 
	`dc1394_ˇ±uª_dequeue
(
dcCam
, 
pﬁicy
, &
dcFøme
);

550 i‡(!
dcFøme
)

551  
Ál£
;

553 i‡–
	`dc1394_ˇ±uª_is_‰ame_c‹ru±
(
dcCam
, 
dcFøme
Ë=
DC1394_TRUE
)

555 
_exô_
;

558 
isCﬁ‹
 = 
dcFøme
->
cﬁ‹_codög
 !
DC1394_COLOR_CODING_MONO8
 &&

559 
dcFøme
->
cﬁ‹_codög
 !
DC1394_COLOR_CODING_MONO16
 &&

560 
dcFøme
->
cﬁ‹_codög
 !
DC1394_COLOR_CODING_MONO16S
;

562 i‡(
nimages
 == 2)

564 
fs
 = (
dc1394video_‰ame_t
*)
	`ˇŒoc
(1, (*fs));

567 
	`dc1394_deöãæa˚_°îeo_‰ames_fixed
(
dcFøme
, 
fs
, 
DC1394_STEREO_METHOD_INTERLACED
);

569 
	`dc1394_ˇ±uª_íqueue
(
dcCam
, 
dcFøme
);

570 
dcFøme
 = 0;

571 i‡(!
fs
->
image
)

572 
_exô_
;

573 
isCﬁ‹
 = 
cﬁ‹Sãªo
;

575 
nch
 = 
isCﬁ‹
 ? 3 : 1;

577 
i
 = 0; i < 
nimages
; i++)

579 
I∂Image
 
fhdr
;

580 
dc1394video_‰ame_t
 
f
 = 
fs
 ? *f†: *
dcFøme
, *
fc
 = &f;

581 
f
.
size
[1] /
nimages
;

582 
f
.
image
 +f.
size
[0] * f.size[1] * 
i
;

583 i‡(
isCﬁ‹
)

585 i‡(!
‰ameC
)

586 
‰ameC
 = (
dc1394video_‰ame_t
*)
	`ˇŒoc
(1, (*frameC));

587 
‰ameC
->
cﬁ‹_codög
 = 
nch
 =3 ? 
DC1394_COLOR_CODING_RGB8
 : 
DC1394_COLOR_CODING_MONO8
;

588 i‡(
nimages
 == 1)

590 
	`dc1394_c⁄vît_‰ames
(&
f
, 
‰ameC
);

591 
	`dc1394_ˇ±uª_íqueue
(
dcCam
, 
dcFøme
);

592 
dcFøme
 = 0;

596 
f
.
cﬁ‹_fûãr
 = 
bayîFûãr
;

597 
	`dc1394_debayî_‰ames
(&
f
, 
‰ameC
, 
bayî
);

599 
fc
 = 
‰ameC
;

601 i‡(!
img
[
i
])

602 
img
[
i
] = 
	`cvCª©eImage
(
	`cvSize
(
fc
->
size
[0], fc->size[1]), 8, 
nch
);

603 
	`cvInôImageHódî
(&
fhdr
, 
	`cvSize
(
fc
->
size
[0], fc->size[1]), 8, 
nch
);

604 
	`cvSëD©a
(&
fhdr
, 
fc
->
image
, fc->
size
[0]*
nch
);

607 i‡(
nch
==3)

608 
	`cvC⁄vîtImage
(&
fhdr
,&fhdr,
CV_CVTIMG_SWAP_RB
);

610 if–
ª˘ify
 && 
ˇmîaId
 =
VIDERE
 && 
nimages
 == 2 )

612 if–!
m≠s
[0][0] || m≠s[0][0]->
width
 !
img
[
i
]->width || m≠s[0][0]->
height
 != img[i]->height )

614 
CvSize
 
size
 = 
	`cvGëSize
(
img
[
i
]);

615 
	`cvRñó£Image
(&
m≠s
[0][0]);

616 
	`cvRñó£Image
(&
m≠s
[0][1]);

617 
	`cvRñó£Image
(&
m≠s
[1][0]);

618 
	`cvRñó£Image
(&
m≠s
[1][1]);

619 
m≠s
[0][0] = 
	`cvCª©eImage
(
size
, 
IPL_DEPTH_16S
, 2);

620 
m≠s
[0][1] = 
	`cvCª©eImage
(
size
, 
IPL_DEPTH_16S
, 1);

621 
m≠s
[1][0] = 
	`cvCª©eImage
(
size
, 
IPL_DEPTH_16S
, 2);

622 
m≠s
[1][1] = 
	`cvCª©eImage
(
size
, 
IPL_DEPTH_16S
, 1);

623 
buf
[4*4096];

624 if–
	`gëVidîeCÆibøti⁄Info
–
buf
, ()(buf) ) &&

625 
	`öôVidîeRe˘ifyM≠s
–
buf
, 
m≠s
[0], maps[1] ))

628 
ª˘ify
 = 
Ál£
;

630 
	`cvRem≠
(&
fhdr
, 
img
[
i
], 
m≠s
[i][0], maps[i][1]);

633 
	`cvC›y
(&
fhdr
, 
img
[
i
]);

636 
code
 = 
åue
;

638 
_exô_
:

639 i‡(
dcFøme
)

640 
	`dc1394_ˇ±uª_íqueue
(
dcCam
, 
dcFøme
);

641 i‡(
fs
)

643 i‡(
fs
->
image
)

644 
	`‰ì
(
fs
->
image
);

645 
	`‰ì
(
fs
);

648  
code
;

649 
	}
}

651 
I∂Image
* 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$ªåõveFøme
(
idx
)

653  0 <
idx
 && idx < 
nimages
 ? 
img
[idx] : 0;

654 
	}
}

656 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$gëPr›îty
(
¥›Id
) const

659 
dc1394„©uª£t_t
& 
fs
 = 
c⁄°_ˇ°
<dc1394„©uª£t_t&>(
„©uª_£t
);

661 
¥›Id
)

663 
CV_CAP_PROP_FRAME_WIDTH
:

664  
‰ameWidth
 ? fømeWidth : 
‰ameHeight
*4 / 3;

665 
CV_CAP_PROP_FRAME_HEIGHT
:

666  
‰ameHeight
 ? fømeHeighà: 
‰ameWidth
*3 / 4;

667 
CV_CAP_PROP_FPS
:

668  
Âs
;

669 
CV_CAP_PROP_RECTIFICATION
:

670  
ª˘ify
 ? 1 : 0;

671 
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
:

672 i‡(
	`dc1394_„©uª_whôebÆ™˚_gë_vÆue
(
dcCam
,

673 &
fs
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
BU_vÆue
,

674 &
fs
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
RV_vÆue
Ë=
DC1394_SUCCESS
)

675  
„©uª_£t
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
BU_vÆue
;

677 
CV_CAP_PROP_WHITE_BALANCE_RED_V
:

678 i‡(
	`dc1394_„©uª_whôebÆ™˚_gë_vÆue
(
dcCam
,

679 &
fs
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
BU_vÆue
,

680 &
fs
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
RV_vÆue
Ë=
DC1394_SUCCESS
)

681  
„©uª_£t
.
„©uª
[
DC1394_FEATURE_WHITE_BALANCE
-
DC1394_FEATURE_MIN
].
RV_vÆue
;

683 
CV_CAP_PROP_GUID
:

685  (Ë(
guid
 & 0x00000000FFFFFFFF);

687 
CV_CAP_PROP_MODE
:

688  (Ë
u£rMode
;

690 
CV_CAP_PROP_ISO_SPEED
:

691  (Ë
isoS≥ed
;

692 
CV_CAP_PROP_BUFFERSIZE
:

693  (Ë
nDMABufs
;

695 i‡(
¥›Id
<
CV_CAP_PROP_MAX_DC1394
 && 
dc1394¥›îtõs
[propId]!=-1

696 && 
dcCam
)

698 i‡(
	`dc1394_„©uª_gë_vÆue
(
dcCam
,(
dc1394„©uª_t
)
dc1394¥›îtõs
[
¥›Id
],

699 &
fs
.
„©uª
[
dc1394¥›îtõs
[
¥›Id
]-
DC1394_FEATURE_MIN
].
vÆue
Ë=
DC1394_SUCCESS
)

700  
„©uª_£t
.
„©uª
[
dc1394¥›îtõs
[
¥›Id
]-
DC1394_FEATURE_MIN
].
vÆue
;

703 
	}
}

705 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$£tPr›îty
(
¥›Id
, 
vÆue
)

707 
¥›Id
)

709 
CV_CAP_PROP_FRAME_WIDTH
:

710 if(
°¨ãd
)

711  
Ál£
;

712 
‰ameWidth
 = 
	`cvRound
(
vÆue
);

713 
‰ameHeight
 = 0;

715 
CV_CAP_PROP_FRAME_HEIGHT
:

716 if(
°¨ãd
)

717  
Ál£
;

718 
‰ameWidth
 = 0;

719 
‰ameHeight
 = 
	`cvRound
(
vÆue
);

721 
CV_CAP_PROP_FPS
:

722 if(
°¨ãd
)

723  
Ál£
;

724 
Âs
 = 
vÆue
;

726 
CV_CAP_PROP_RECTIFICATION
:

727 if–
ˇmîaId
 !
VIDERE
 )

728  
Ál£
;

729 
ª˘ify
 = 
	`Ábs
(
vÆue
Ë> 
FLT_EPSILON
;

731 
CV_CAP_PROP_MODE
:

732 if(
°¨ãd
)

733  
Ál£
;

734 
u£rMode
 = 
	`cvRound
(
vÆue
);

736 
CV_CAP_PROP_ISO_SPEED
:

737 if(
°¨ãd
)

738  
Ál£
;

739 
isoS≥ed
 = 
	`cvRound
(
vÆue
);

741 
CV_CAP_PROP_BUFFERSIZE
:

742 if(
°¨ãd
)

743  
Ál£
;

744 
nDMABufs
 = 
vÆue
;

748 i‡(
¥›Id
<
CV_CAP_PROP_MAX_DC1394
 && 
dc1394¥›îtõs
[propId]!=-1

749 && 
dcCam
)

752 
dc1394„©uª_öfo_t
 *
a˘_„©uª
 = &
„©uª_£t
.
„©uª
[
dc1394¥›îtõs
[
¥›Id
]-
DC1394_FEATURE_MIN
];

754 i‡(
	`cvRound
(
vÆue
Ë=
CV_CAP_PROP_DC1394_OFF
)

756 i‡–(
a˘_„©uª
->
⁄_off_ˇ∑bÀ
)

757 && (
	`dc1394_„©uª_£t_powî
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_OFF
Ë=
DC1394_SUCCESS
))

759 
a˘_„©uª
->
is_⁄
=
DC1394_OFF
;

760  
åue
;

762  
Ál£
;

765 i‡–(
a˘_„©uª
->
is_⁄
 =
DC1394_OFF
Ë&& (a˘_„©uª->
⁄_off_ˇ∑bÀ
 =
DC1394_TRUE
))

767 i‡(
	`dc1394_„©uª_£t_powî
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_ON
Ë=
DC1394_SUCCESS
)

768 
„©uª_£t
.
„©uª
[
dc1394¥›îtõs
[
¥›Id
]-
DC1394_FEATURE_MIN
].
is_⁄
=
DC1394_ON
;

772 i‡(
a˘_„©uª
->
absﬁuã_ˇ∑bÀ


773 && 
	`dc1394_„©uª_£t_absﬁuã_c⁄åﬁ
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_OFF
Ë!=
DC1394_SUCCESS
)

774  
Ál£
;

776 
a˘_„©uª
->
abs_c⁄åﬁ
=
DC1394_OFF
;

778 i‡(
	`cvRound
(
vÆue
Ë=
CV_CAP_PROP_DC1394_MODE_AUTO
)

780 i‡(
	`dc1394_„©uª_£t_mode
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_FEATURE_MODE_AUTO
)!=
DC1394_SUCCESS
)

781  
Ál£
;

782 
a˘_„©uª
->
cuºít_mode
=
DC1394_FEATURE_MODE_AUTO
;

783  
åue
;

786 i‡(
	`cvRound
(
vÆue
Ë=
CV_CAP_PROP_DC1394_MODE_ONE_PUSH_AUTO
)

789 i‡(
	`dc1394_„©uª_£t_mode
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_FEATURE_MODE_ONE_PUSH_AUTO
)!=
DC1394_SUCCESS
)

790  
Ál£
;

792 
a˘_„©uª
->
cuºít_mode
=
DC1394_FEATURE_MODE_ONE_PUSH_AUTO
;

793  
åue
;

796 i‡(
	`dc1394_„©uª_£t_mode
(
dcCam
, 
a˘_„©uª
->
id
, 
DC1394_FEATURE_MODE_MANUAL
)!=
DC1394_SUCCESS
)

797  
Ál£
;

799 
a˘_„©uª
->
cuºít_mode
=
DC1394_FEATURE_MODE_MANUAL
;

801 i‡(
¥›Id
 =
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
)

803 i‡(
	`dc1394_„©uª_whôebÆ™˚_£t_vÆue
(
dcCam
,
	`cvRound
(
vÆue
), 
a˘_„©uª
->
RV_vÆue
)!=
DC1394_SUCCESS
)

804  
Ál£
;

807 
a˘_„©uª
->
BU_vÆue
 = 
	`cvRound
(
vÆue
);

808  
åue
;

811 i‡(
¥›Id
 =
CV_CAP_PROP_WHITE_BALANCE_RED_V
)

813 i‡(
	`dc1394_„©uª_whôebÆ™˚_£t_vÆue
(
dcCam
, 
a˘_„©uª
->
BU_vÆue
, 
	`cvRound
(
vÆue
))!=
DC1394_SUCCESS
)

814  
Ál£
;

817 
a˘_„©uª
->
RV_vÆue
 = 
	`cvRound
(
vÆue
);

818  
åue
;

823 i‡(
vÆue
 < 
a˘_„©uª
->
mö
)

825 
vÆue
 = 
a˘_„©uª
->
mö
;

827 i‡(
vÆue
 > 
a˘_„©uª
->
max
)

829 
vÆue
 = 
a˘_„©uª
->
max
;

832 i‡(
	`dc1394_„©uª_£t_vÆue
(
dcCam
, 
a˘_„©uª
->
id
, 
	`cvRound
(
vÆue
)Ë=
DC1394_SUCCESS
)

834 
a˘_„©uª
->
vÆue
 = value;

835  
åue
;

838  
Ál£
;

840  
åue
;

841 
	}
}

844 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$gëVidîeCÆibøti⁄Info
–* 
buf
, 
bufSize
 )

846 
pos
;

848  
pos
 = 0;Öo†< 
bufSize
 - 4;Öos += 4 )

850 
uöt32_t
 
quad
 = 
	`gëC⁄åﬁRegi°î
(
dcCam
, 0xF0800 + 
pos
);

851 if–
quad
 == 0 || quad == 0xffffffff )

853 
buf
[
pos
] = (
uch¨
)(
quad
 >> 24);

854 
buf
[
pos
+1] = (
uch¨
)(
quad
 >> 16);

855 
buf
[
pos
+2] = (
uch¨
)(
quad
 >> 8);

856 
buf
[
pos
+3] = (
uch¨
)(
quad
);

859 if–
pos
 == 0 )

860  
Ál£
;

862 
buf
[
pos
] = '\0';

863  
åue
;

864 
	}
}

867 
boﬁ
 
	gCvC≠tuªCAM_DC1394_v2_CPP
::
	$öôVidîeRe˘ifyM≠s
–c⁄° * 
öfo
,

868 
I∂Image
* 
ml
[2], I∂Image* 
mr
[2] )

870 
idítôy_d©a
[] = {1, 0, 0, 0, 1, 0, 0, 0, 1};

871 
CvM©
 
l_ª˘
 = 
	`cvM©
(3, 3, 
CV_32F
, 
idítôy_d©a
), 
r_ª˘
 =Ü_rect;

872 
l_öåösic_d©a
[] = {1, 0, 0, 0, 1, 0, 0, 0, 1};

873 
r_öåösic_d©a
[] = {1, 0, 0, 0, 1, 0, 0, 0, 1};

874 
CvM©
 
l_öåösic
 = 
	`cvM©
(3, 3, 
CV_32F
, 
l_öåösic_d©a
);

875 
CvM©
 
r_öåösic
 = 
	`cvM©
(3, 3, 
CV_32F
, 
r_öåösic_d©a
);

876 
l_di°‹ti⁄_d©a
[] = {0,0,0,0,0}, 
r_di°‹ti⁄_d©a
[] = {0,0,0,0,0};

877 
CvM©
 
l_di°‹ti⁄
 = 
	`cvM©
(1, 5, 
CV_32F
, 
l_di°‹ti⁄_d©a
);

878 
CvM©
 
r_di°‹ti⁄
 = 
	`cvM©
(1, 5, 
CV_32F
, 
r_di°‹ti⁄_d©a
);

879 
I∂Image
* 
mx
 = 
	`cvCª©eImage
(
	`cvGëSize
(
ml
[0]), 
IPL_DEPTH_32F
, 1);

880 
I∂Image
* 
my
 = 
	`cvCª©eImage
(
	`cvGëSize
(
ml
[0]), 
IPL_DEPTH_32F
, 1);

881 
k
, 
j
;

883  
k
 = 0; k < 2; k++ )

885 c⁄° * 
£˘i⁄_«me
 = 
k
 == 0 ? "[left_camera]" : "[right_camera]";

886 c⁄° * 
∑øm_«mes
[] = { "f ", "fy", "Cx", "Cy" "kappa1", "kappa2", "tau1", "tau2", "kappa3", 0 };

887 c⁄° * 
£˘i⁄_°¨t
 = 
	`°r°r
–
öfo
, 
£˘i⁄_«me
 );

888 
CvM©
* 
öåösic
 = 
k
 =0 ? &
l_öåösic
 : &
r_öåösic
;

889 
CvM©
* 
di°‹ti⁄
 = 
k
 =0 ? &
l_di°‹ti⁄
 : &
r_di°‹ti⁄
;

890 
CvM©
* 
ª˘ifiˇti⁄
 = 
k
 =0 ? &
l_ª˘
 : &
r_ª˘
;

891 
I∂Image
** 
d°
 = 
k
 =0 ? 
ml
 : 
mr
;

892 if–!
£˘i⁄_°¨t
 )

894 
£˘i⁄_°¨t
 +
	`°æí
(
£˘i⁄_«me
);

895  
j
 = 0; 
∑øm_«mes
[j] != 0; j++ )

897 c⁄° * 
∑øm_vÆue_°¨t
 = 
	`°r°r
(
£˘i⁄_°¨t
, 
∑øm_«mes
[
j
]);

898 
vÆ
=0;

899 if(!
∑øm_vÆue_°¨t
)

901 
	`ssˇnf
(
∑øm_vÆue_°¨t
 + 
	`°æí
(
∑øm_«mes
[
j
]), "%f", &
vÆ
);

902 if–
j
 < 4 )

903 
öåösic
->
d©a
.
Ê
[
j
 =0 ? 0 : j =1 ? 4 : j =2 ? 2 : 5] = 
vÆ
;

905 
di°‹ti⁄
->
d©a
.
Ê
[
j
 - 4] = 
vÆ
;

907 if–
∑øm_«mes
[
j
] != 0 )

911 if–
	`Ábs
(
mx
->
width
*0.5 - 
öåösic
->
d©a
.
Ê
[2]) > mx->width*0.1 ||

912 
	`Ábs
(
my
->
height
*0.5 - 
öåösic
->
d©a
.
Ê
[5]) > my->height*0.1 )

914 
	`cvSˇÀ
–&
öåösic
, &intrinsic, 0.5 );

915 if–
	`Ábs
(
mx
->
width
*0.5 - 
öåösic
->
d©a
.
Ê
[2]) > mx->width*0.05 ||

916 
	`Ábs
(
my
->
height
*0.5 - 
öåösic
->
d©a
.
Ê
[5]) > my->height*0.05 )

917 
	`cvSˇÀ
–&
öåösic
, &intrinsic, 2 );

918 
öåösic
->
d©a
.
Ê
[8] = 1;

921 
	`cvInôUndi°‹tRe˘ifyM≠
–
öåösic
, 
di°‹ti⁄
,

922 
ª˘ifiˇti⁄
, 
öåösic
, 
mx
, 
my
 );

923 
	`cvC⁄vîtM≠s
–
mx
, 
my
, 
d°
[0], dst[1] );

926 
	`cvRñó£Image
–&
mx
 );

927 
	`cvRñó£Image
–&
my
 );

928  
k
 >= 2;

929 
	}
}

932 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_DC1394_2
(
ödex
)

934 
CvC≠tuªCAM_DC1394_v2_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_DC1394_v2_CPP;

936 i‡(
ˇ±uª
->
	`›í
(
ödex
))

937  
ˇ±uª
;

939 
dñëe
 
ˇ±uª
;

941 
	}
}

	@src/cap_dshow.cpp

42 
	~"¥ecomp.hµ
"

44 #i‡(
deföed
 
WIN32
 || deföed 
_WIN32
Ë&& deföed 
HAVE_DSHOW


45 
	~"ˇp_dshow.hµ
"

91 #i‡
deföed
 
_MSC_VER
 && _MSC_VER >= 100

93 #¥agm®
w¨nög
(
dißbÀ
: 4995)

96 
	~<tch¨.h
>

97 
	~<°dlib.h
>

98 
	~<°dio.h
>

99 
	~<m©h.h
>

100 
	~<°rög.h
>

101 
	~<wch¨.h
>

103 
	~<ve˘‹
>

106 #i‡
deföed
 
_MSC_VER
 && _MSC_VER >= 1500

107 
	~"DShow.h
"

108 
	~"°rmif.h
"

109 
	~"Avúiff.h
"

110 
	~"dvdmedü.h
"

111 
	~"bdaiÁ˚.h
"

113 #ifde‡
_MSC_VER


114 
	#__exãnsi⁄__


	)

115 
BOOL
 
	tWINBOOL
;

118 
	~"dshow/dshow.h
"

119 
	~"dshow/dvdmedü.h
"

120 
	~"dshow/bd©y≥s.h
"

122 
öãrÁ˚
 
	gIEnumPIDM≠
 : 
public
 
IUnknown


124 
public
:

125 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Next
(

126  
ULONG
 
cReque°
,

127  
PID_MAP
 *
pPIDM≠
,

128  
ULONG
 *
pcRe˚ived
) = 0;

130 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Skù
(

131  
ULONG
 
cRec‹ds
) = 0;

133 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Re£t
( ) = 0;

135 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Cl⁄e
(

136  
IEnumPIDM≠
 **
µIEnumPIDM≠
) = 0;

139 
öãrÁ˚
 
	gIMPEG2PIDM≠
 : 
public
 
IUnknown


141 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
M≠PID
(

142  
ULONG
 
culPID
,

143  
ULONG
 *
pulPID
,

144  
MEDIA_SAMPLE_CONTENT
 
MedüSam∂eC⁄ã¡
) = 0;

146 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Unm≠PID
(

147  
ULONG
 
culPID
,

148  
ULONG
 *
pulPID
) = 0;

150 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
EnumPIDM≠
(

151  
IEnumPIDM≠
 **
pIEnumPIDM≠
) = 0;

157 
	~<¥o˚ss.h
>

160 #i‚de‡
_WIN32_WINNT


161 
	#_WIN32_WINNT
 0x400

	)

175 
	~<öôguid.h
>

177 
DEFINE_GUID
(
MEDIASUBTYPE_GREY
, 0x59455247, 0x0000, 0x0010, 0x80, 0x00,

179 
DEFINE_GUID
(
MEDIASUBTYPE_Y8
, 0x20203859, 0x0000, 0x0010, 0x80, 0x00,

181 
DEFINE_GUID
(
MEDIASUBTYPE_Y800
, 0x30303859, 0x0000, 0x0010, 0x80, 0x00,

184 
DEFINE_GUID
(
CLSID_C≠tuªGøphBuûdî2
,0xbf87b6e1,0x8c27,0x11d0,0xb3,0xf0,0x00,0xaa,0x00,0x37,0x61,0xc5);

185 
DEFINE_GUID
(
CLSID_FûãrGøph
,0xe436ebb3,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70);

186 
DEFINE_GUID
(
CLSID_NuŒRídîî
,0xc1f400a4,0x3f08,0x11d3,0x9f,0x0b,0x00,0x60,0x08,0x03,0x9e,0x37);

187 
DEFINE_GUID
(
CLSID_Sam∂eGøbbî
,0xc1f400a0,0x3f08,0x11d3,0x9f,0x0b,0x00,0x60,0x08,0x03,0x9e,0x37);

188 
DEFINE_GUID
(
CLSID_Sy°emDevi˚Enum
,0x62be5d10,0x60eb,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86);

189 
DEFINE_GUID
(
CLSID_VideoI≈utDevi˚C©eg‹y
,0x860bb310,0x5d01,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86);

190 
DEFINE_GUID
(
FORMAT_VideoInfo
,0x05589f80,0xc356,0x11ce,0xbf,0x01,0x00,0xaa,0x00,0x55,0x59,0x5a);

191 
DEFINE_GUID
(
IID_IAMA«logVideoDecodî
,0xc6e13350,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56);

192 
DEFINE_GUID
(
IID_IAMCamîaC⁄åﬁ
,0xc6e13370,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56);

193 
DEFINE_GUID
(
IID_IAMCrossb¨
,0xc6e13380,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56);

194 
DEFINE_GUID
(
IID_IAMSåómC⁄fig
,0xc6e13340,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56);

195 
DEFINE_GUID
(
IID_IAMVideoProcAmp
,0xc6e13360,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56);

196 
DEFINE_GUID
(
IID_IBa£Fûãr
,0x56a86895,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70);

197 
DEFINE_GUID
(
IID_IC≠tuªGøphBuûdî2
,0x93e5a4e0,0x2d50,0x11d2,0xab,0xfa,0x00,0xa0,0xc9,0xc6,0xe3,0x8d);

198 
DEFINE_GUID
(
IID_ICª©eDevEnum
,0x29840822,0x5b84,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86);

199 
DEFINE_GUID
(
IID_IGøphBuûdî
,0x56a868a9,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70);

200 
DEFINE_GUID
(
IID_IMPEG2PIDM≠
,0xafb6c2a1,0x2c41,0x11d3,0x8a,0x60,0x00,0x00,0xf8,0x1e,0x0e,0x4a);

201 
DEFINE_GUID
(
IID_IMedüC⁄åﬁ
,0x56a868b1,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70);

202 
DEFINE_GUID
(
IID_IMedüFûãr
,0x56a86899,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70);

203 
DEFINE_GUID
(
IID_ISam∂eGøbbî
,0x6b652fff,0x11fe,0x4fce,0x92,0xad,0x02,0x66,0xb5,0xd7,0xc7,0x8f);

204 
DEFINE_GUID
(
LOOK_UPSTREAM_ONLY
,0xac798be0,0x98e3,0x11d1,0xb3,0xf1,0x00,0xaa,0x00,0x37,0x61,0xc5);

205 
DEFINE_GUID
(
MEDIASUBTYPE_AYUV
,0x56555941,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

206 
DEFINE_GUID
(
MEDIASUBTYPE_IYUV
,0x56555949,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

207 
DEFINE_GUID
(
MEDIASUBTYPE_RGB24
,0xe436eb7d,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70);

208 
DEFINE_GUID
(
MEDIASUBTYPE_RGB32
,0xe436eb7e,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70);

209 
DEFINE_GUID
(
MEDIASUBTYPE_RGB555
,0xe436eb7c,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70);

210 
DEFINE_GUID
(
MEDIASUBTYPE_RGB565
,0xe436eb7b,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70);

211 
DEFINE_GUID
(
MEDIASUBTYPE_I420
,0x30323449,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

212 
DEFINE_GUID
(
MEDIASUBTYPE_UYVY
,0x59565955,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

213 
DEFINE_GUID
(
MEDIASUBTYPE_Y211
,0x31313259,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

214 
DEFINE_GUID
(
MEDIASUBTYPE_Y411
,0x31313459,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

215 
DEFINE_GUID
(
MEDIASUBTYPE_Y41P
,0x50313459,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

216 
DEFINE_GUID
(
MEDIASUBTYPE_YUY2
,0x32595559,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

217 
DEFINE_GUID
(
MEDIASUBTYPE_YUYV
,0x56595559,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

218 
DEFINE_GUID
(
MEDIASUBTYPE_YV12
,0x32315659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

219 
DEFINE_GUID
(
MEDIASUBTYPE_YVU9
,0x39555659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

220 
DEFINE_GUID
(
MEDIASUBTYPE_YVYU
,0x55595659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

221 
DEFINE_GUID
(
MEDIASUBTYPE_MJPG
,0x47504A4D, 0x0000, 0x0010, 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71);

222 
DEFINE_GUID
(
MEDIATYPE_I¡îÀaved
,0x73766169,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

223 
DEFINE_GUID
(
MEDIATYPE_Video
,0x73646976,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71);

224 
DEFINE_GUID
(
PIN_CATEGORY_CAPTURE
,0xfb6c4281,0x0353,0x11d1,0x90,0x5f,0x00,0x00,0xc0,0xcc,0x16,0xba);

225 
DEFINE_GUID
(
PIN_CATEGORY_PREVIEW
,0xfb6c4282,0x0353,0x11d1,0x90,0x5f,0x00,0x00,0xc0,0xcc,0x16,0xba);

227 
öãrÁ˚
 
	gISam∂eGøbbîCB
 : 
public
 
IUnknown


229 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Sam∂eCB
(

230 
Sam∂eTime
,

231 
IMedüSam∂e
 *
pSam∂e
) = 0;

233 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
Buf„rCB
(

234 
Sam∂eTime
,

235 
BYTE
 *
pBuf„r
,

236 
LONG
 
Buf„rLí
) = 0;

239 
öãrÁ˚
 
	gISam∂eGøbbî
 : 
public
 
IUnknown


241 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
SëO√ShŸ
(

242 
BOOL
 
O√ShŸ
) = 0;

244 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
SëMedüTy≥
(

245 c⁄° 
AM_MEDIA_TYPE
 *
pTy≥
) = 0;

247 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
GëC⁄√˘edMedüTy≥
(

248 
AM_MEDIA_TYPE
 *
pTy≥
) = 0;

250 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
SëBuf„rSam∂es
(

251 
BOOL
 
Buf„rThem
) = 0;

253 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
GëCuºítBuf„r
(

254 
LONG
 *
pBuf„rSize
,

255 
LONG
 *
pBuf„r
) = 0;

257 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
GëCuºítSam∂e
(

258 
IMedüSam∂e
 **
µSam∂e
) = 0;

260 
vútuÆ
 
HRESULT
 
STDMETHODCALLTYPE
 
SëCÆlback
(

261 
ISam∂eGøbbîCB
 *
pCÆlback
,

262 
LONG
 
WhichMëhodToCÆlback
) = 0;

265 #i‚de‡
HEADER


266 
	#HEADER
(
p
Ë(&(((
VIDEOINFOHEADER
*)’))->
bmiHódî
))

	)

331 #ifde‡
_DEBUG


332 
	~<°rß„.h
>

335 
boﬁ
 
	ggs_vîbo£
 = 
åue
;

337 
	$DebugPrötOut
(c⁄° *
f‹m©
, ...)

339 i‡(
gs_vîbo£
)

341 
va_li°
 
¨gs
;

342 
	`va_°¨t
(
¨gs
, 
f‹m©
);

343 if–::
	`IsDebuggîPª£¡
() )

345 
CHAR
 
szMsg
[512];

346 ::
	`SåögCbVPrötfA
(
szMsg
, (szMsg), 
f‹m©
, 
¨gs
);

347 ::
	`OuçutDebugSåögA
(
szMsg
);

351 
	`v¥ötf
(
f‹m©
, 
¨gs
);

353 
	`va_íd
 (
¨gs
);

355 
	}
}

357 
	#DebugPrötOut
(...Ë()

	)

366 
	#VI_VERSION
 0.1995

	)

367 
	#VI_MAX_CAMERAS
 20

	)

368 
	#VI_NUM_TYPES
 20

369 
	#VI_NUM_FORMATS
 18

370 

	)

372 
	#VI_COMPOSITE
 0

	)

373 
	#VI_S_VIDEO
 1

	)

374 
	#VI_TUNER
 2

	)

375 
	#VI_USB
 3

	)

376 
	#VI_1394
 4

	)

379 
	#VI_NTSC_M
 0

	)

380 
	#VI_PAL_B
 1

	)

381 
	#VI_PAL_D
 2

	)

382 
	#VI_PAL_G
 3

	)

383 
	#VI_PAL_H
 4

	)

384 
	#VI_PAL_I
 5

	)

385 
	#VI_PAL_M
 6

	)

386 
	#VI_PAL_N
 7

	)

387 
	#VI_PAL_NC
 8

	)

388 
	#VI_SECAM_B
 9

	)

389 
	#VI_SECAM_D
 10

	)

390 
	#VI_SECAM_G
 11

	)

391 
	#VI_SECAM_H
 12

	)

392 
	#VI_SECAM_K
 13

	)

393 
	#VI_SECAM_K1
 14

	)

394 
	#VI_SECAM_L
 15

	)

395 
	#VI_NTSC_M_J
 16

	)

396 
	#VI_NTSC_433
 17

	)

400 
	gIC≠tuªGøphBuûdî2
;

401 
	gIGøphBuûdî
;

402 
	gIBa£Fûãr
;

403 
	gIAMCrossb¨
;

404 
	gIMedüC⁄åﬁ
;

405 
	gISam∂eGøbbî
;

406 
	gIMedüEvítEx
;

407 
	gIAMSåómC⁄fig
;

408 
	g_AMMedüTy≥
;

409 
˛ass
 
	gSam∂eGøbbîCÆlback
;

410 
_AMMedüTy≥
 
	tAM_MEDIA_TYPE
;

419 ˛as†
	cvideoDevi˚
{

422 
	mpublic
:

424 
videoDevi˚
();

425 
£tSize
(
w
, 
h
);

426 
NukeDown°ªam
(
IBa£Fûãr
 *
pBF
);

427 
de°royGøph
();

428 ~
videoDevi˚
();

430 
	mvideoSize
;

431 
	mwidth
;

432 
	mheight
;

434 
	måyWidth
;

435 
	måyHeight
;

436 
GUID
 
	måyVideoTy≥
;

438 
IC≠tuªGøphBuûdî2
 *
	mpC≠tuªGøph
;

439 
IGøphBuûdî
 *
	mpGøph
;

440 
IMedüC⁄åﬁ
 *
	mpC⁄åﬁ
;

441 
IBa£Fûãr
 *
	mpVideoI≈utFûãr
;

442 
IBa£Fûãr
 *
	mpGøbbîF
;

443 
IBa£Fûãr
 * 
	mpDe°Fûãr
;

444 
IAMSåómC⁄fig
 *
	m°ªamC⁄f
;

445 
ISam∂eGøbbî
 * 
	mpGøbbî
;

446 
AM_MEDIA_TYPE
 * 
	mpAmMedüTy≥
;

448 
IMedüEvítEx
 * 
	mpMedüEvít
;

450 
GUID
 
	mvideoTy≥
;

451 
	mf‹m©Ty≥
;

453 
Sam∂eGøbbîCÆlback
 * 
	msgCÆlback
;

455 
boﬁ
 
	måyDiffSize
;

456 
boﬁ
 
	mu£Crossb¨
;

457 
boﬁ
 
	mªadyToC≠tuª
;

458 
boﬁ
 
	msizeSë
;

459 
boﬁ
 
	m£tupSèπed
;

460 
boﬁ
 
	m•ecificF‹m©
;

461 
boﬁ
 
	mautoRec⁄√˘
;

462 
	mnFømesF‹Rec⁄√˘
;

463 
	mnFømesRu¬ög
;

464 
	mc⁄√˘i⁄
;

465 
	m°‹eC⁄n
;

466 
	mmyID
;

467 
	mªque°edFømeTime
;

469 
	mnDevi˚Name
[255];

470 
WCHAR
 
	mwDevi˚Name
[255];

472 * 
	mpixñs
;

473 * 
	mpBuf„r
;

478 ˛as†
	cvideoI≈ut
{

480 
	mpublic
:

481 
videoI≈ut
();

482 ~
videoI≈ut
();

485 
£tVîbo£
(
boﬁ
 
_vîbo£
);

488 
li°Devi˚s
(
boﬁ
 
sûít
 = 
Ál£
);

491 * 
gëDevi˚Name
(
devi˚ID
);

494 
£tU£CÆlback
(
boﬁ
 
u£CÆlback
);

498 
£tIdólFømî©e
(
devi˚ID
, 
idólFømî©e
);

503 
£tAutoRec⁄√˘OnFªeze
(
devi˚Numbî
, 
boﬁ
 
doRec⁄√˘
, 
numMis£dFømesBef‹eRec⁄√˘
);

506 
boﬁ
 
£tupDevi˚
(
devi˚ID
);

507 
boﬁ
 
£tupDevi˚
(
devi˚ID
, 
w
, 
h
);

508 
boﬁ
 
£tupDevi˚Fourcc
(
devi˚ID
, 
w
, 
h
,
fourcc
);

512 
boﬁ
 
£tupDevi˚
(
devi˚ID
, 
c⁄√˘i⁄
);

513 
boﬁ
 
£tupDevi˚
(
devi˚ID
, 
w
, 
h
, 
c⁄√˘i⁄
);

515 
boﬁ
 
£tFourcc
(
devi˚Numbî
, 
fourcc
);

522 
boﬁ
 
£tF‹m©
(
devi˚Numbî
, 
f‹m©
);

525 
boﬁ
 
isFømeNew
(
devi˚ID
);

527 
boﬁ
 
	$isDevi˚Sëup
(
devi˚ID
) const;

530 * 
	`gëPixñs
(
devi˚ID
, 
boﬁ
 
ÊùRedAndBlue
 = 
åue
, boﬁ 
ÊùImage
 = 
Ál£
);

533 
boﬁ
 
	`gëPixñs
(
id
, * 
pixñs
, boﬁ 
ÊùRedAndBlue
 = 
åue
, boﬁ 
ÊùImage
 = 
Ál£
);

537 
	`showSëtögsWödow
(
devi˚ID
);

541 
boﬁ
 
	`£tVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, 
lVÆue
, 
Fœgs
 = 0, boﬁ 
u£DeÁu…VÆue
 = 
Ál£
);

542 
boﬁ
 
	`£tVideoSëtögFûãrP˘
(
devi˚ID
, 
Pr›îty
, 
p˘VÆue
, 
Fœgs
 = 0);

543 
boﬁ
 
	`gëVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
cuºítVÆue
, &
Êags
, &
deÁu…VÆue
);

545 
boﬁ
 
	`£tVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, 
lVÆue
, 
Fœgs
 = 0, boﬁ 
u£DeÁu…VÆue
 = 
Ál£
);

546 
boﬁ
 
	`£tVideoSëtögCamîaP˘
(
devi˚ID
, 
Pr›îty
, 
p˘VÆue
, 
Fœgs
 = 0);

547 
boﬁ
 
	`gëVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
cuºítVÆue
, &
Êags
, &
deÁu…VÆue
);

552 
	$gëWidth
(
devi˚ID
) const;

553 
	$gëHeight
(
devi˚ID
) const;

554 
	$gëSize
(
devi˚ID
) const;

555 
	$gëFourcc
(
devi˚ID
) const;

556 
	$gëFPS
(
devi˚ID
) const;

559 
	`°›Devi˚
(
devi˚ID
);

562 
boﬁ
 
	`ª°¨tDevi˚
(
devi˚ID
);

565 
devi˚sFound
;

568 
	`gëVideoPr›îtyFromCV
(
cv_¥›îty
);

569 
	`gëCamîaPr›îtyFromCV
(
cv_¥›îty
);

571 
¥iv©e
:

572 
	`£tPhyC⁄
(
devi˚ID
, 
c⁄n
);

573 
	`£tAâem±C≠tuªSize
(
devi˚ID
, 
w
, 
h
,
GUID
 
medüTy≥
=
MEDIASUBTYPE_RGB24
);

574 
boﬁ
 
	`£tup
(
devi˚ID
);

575 
	`¥o˚ssPixñs
(* 
§c
, * 
d°
, 
width
, 
height
, 
boﬁ
 
bRGB
, boﬁ 
bFlù
);

576 
	`°¨t
(
devi˚ID
, 
videoDevi˚
 * 
VD
);

577 
	`gëDevi˚Cou¡
();

578 
	`gëMedüSubty≥AsSåög
(
GUID
 
ty≥
, * 
ty≥AsSåög
);

579 
GUID
 *
	`gëMedüSubty≥FromFourcc
(
fourcc
);

580 
	$gëFourccFromMedüSubty≥
(
GUID
 
ty≥
) const;

582 
	`gëVideoPr›îtyAsSåög
(
¥›
, * 
¥›îtyAsSåög
);

583 
	`gëCamîaPr›îtyAsSåög
(
¥›
, * 
¥›îtyAsSåög
);

585 
HRESULT
 
	`gëDevi˚
(
IBa£Fûãr
 **
pSrcFûãr
, 
devi˚ID
, 
WCHAR
 * 
wDevi˚Name
, * 
nDevi˚Name
);

586 
HRESULT
 
	`ShowFûãrPr›îtyPages
(
IBa£Fûãr
 *
pFûãr
);

587 
HRESULT
 
	`ShowSåómPr›îtyPages
(
IAMSåómC⁄fig
 *
pSåóm
);

589 
HRESULT
 
	`SaveGøphFûe
(
IGøphBuûdî
 *
pGøph
, 
WCHAR
 *
wszP©h
);

590 
HRESULT
 
	`rouãCrossb¨
(
IC≠tuªGøphBuûdî2
 **
µBuûd
, 
IBa£Fûãr
 **
pVidInFûãr
, 
c⁄Ty≥
, 
GUID
 
ˇ±uªMode
);

593 
boﬁ
 
	`comInô
();

594 
boﬁ
 
	`comUnInô
();

596 
c⁄√˘i⁄
;

597 
ˇŒbackSëCou¡
;

598 
boﬁ
 
bCÆlback
;

600 
GUID
 
CAPTURE_MODE
;

603 
GUID
 
MEDIASUBTYPE_Y800
;

604 
GUID
 
MEDIASUBTYPE_Y8
;

605 
GUID
 
MEDIASUBTYPE_GREY
;

607 
videoDevi˚
 * 
VDLi°
[
VI_MAX_CAMERAS
];

608 
GUID
 
medüSubty≥s
[
VI_NUM_TYPES
];

609 
f‹m©Ty≥s
[
VI_NUM_FORMATS
];

611 
__cde˛
 
	`basicThªad
(* 
objPå
);

613 
devi˚Names
[
VI_MAX_CAMERAS
][255];

619 
	$MyFªeMedüTy≥
(
AM_MEDIA_TYPE
& 
mt
){

620 i‡(
mt
.
cbF‹m©
 != 0)

622 
	`CoTaskMemFªe
((
PVOID
)
mt
.
pbF‹m©
);

623 
mt
.
cbF‹m©
 = 0;

624 
mt
.
pbF‹m©
 = 
NULL
;

626 i‡(
mt
.
pUnk
 !
NULL
)

629 
mt
.
pUnk
->
	`Rñó£
();

630 
mt
.
pUnk
 = 
NULL
;

632 
	}
}

634 
	$MyDñëeMedüTy≥
(
AM_MEDIA_TYPE
 *
pmt
)

636 i‡(
pmt
 !
NULL
)

638 
	`MyFªeMedüTy≥
(*
pmt
);

639 
	`CoTaskMemFªe
(
pmt
);

641 
	}
}

646 ˛as†
	cSam∂eGøbbîCÆlback
 : 
public
 
ISam∂eGøbbîCB
{

647 
public
:

650 
	$Sam∂eGøbbîCÆlback
(){

651 
	`InôülizeCrôiˇlSe˘i⁄
(&
¸ôSe˘i⁄
);

652 
‰ìzeCheck
 = 0;

655 
buf„rSëup
 = 
Ál£
;

656 
√wFøme
 = 
Ál£
;

657 
œã°Buf„rLígth
 = 0;

659 
hEvít
 = 
	`Cª©eEvít
(
NULL
, 
åue
, 
Ál£
, NULL);

664 
vútuÆ
 ~
	$Sam∂eGøbbîCÆlback
(){

665 
±rBuf„r
 = 
NULL
;

666 
	`DñëeCrôiˇlSe˘i⁄
(&
¸ôSe˘i⁄
);

667 
	`Clo£H™dÀ
(
hEvít
);

668 if(
buf„rSëup
){

669 
dñëe
[] 
pixñs
;

671 
	}
}

675 
boﬁ
 
	$£tupBuf„r
(
numByãsIn
){

676 if(
buf„rSëup
){

677  
Ál£
;

679 
numByãs
 = 
numByãsIn
;

680 
pixñs
 = 
√w
 [
numByãs
];

681 
buf„rSëup
 = 
åue
;

682 
√wFøme
 = 
Ál£
;

683 
œã°Buf„rLígth
 = 0;

685  
åue
;

686 
	}
}

690 
	$STDMETHODIMP_
(
ULONG
Ë
	$AddRef
(Ë{  1; 
	}
}

691 
	$STDMETHODIMP_
(
ULONG
Ë
	$Rñó£
(Ë{  2; 
	}
}

695 
STDMETHODIMP
 
	$QuîyI¡îÁ˚
(
REFIID
, **
µvObje˘
){

696 *
µvObje˘
 = 
°©ic_ˇ°
<
ISam∂eGøbbîCB
*>(
this
);

697  
S_OK
;

698 
	}
}

703 
STDMETHODIMP
 
	$Sam∂eCB
(, 
IMedüSam∂e
 *
pSam∂e
){

704 if(
	`WaôF‹SögÀObje˘
(
hEvít
, 0Ë=
WAIT_OBJECT_0
Ë 
S_OK
;

706 
HRESULT
 
hr
 = 
pSam∂e
->
	`GëPoöãr
(&
±rBuf„r
);

708 if(
hr
 =
S_OK
){

709 
œã°Buf„rLígth
 = 
pSam∂e
->
	`GëA˘uÆD©aLígth
();

710 if(
œã°Buf„rLígth
 =
numByãs
){

711 
	`E¡îCrôiˇlSe˘i⁄
(&
¸ôSe˘i⁄
);

712 
	`mem˝y
(
pixñs
, 
±rBuf„r
, 
œã°Buf„rLígth
);

713 
√wFøme
 = 
åue
;

714 
‰ìzeCheck
 = 1;

715 
	`LóveCrôiˇlSe˘i⁄
(&
¸ôSe˘i⁄
);

716 
	`SëEvít
(
hEvít
);

718 
	`DebugPrötOut
("ERROR: SampleCB() - buffer sizes doÇot match\n");

722  
S_OK
;

723 
	}
}

727 
STDMETHODIMP
 
	$Buf„rCB
(, 
BYTE
 *, ){

728  
E_NOTIMPL
;

729 
	}
}

731 
	g‰ìzeCheck
;

733 
	gœã°Buf„rLígth
;

734 
	gnumByãs
;

735 
boﬁ
 
	g√wFøme
;

736 
boﬁ
 
	gbuf„rSëup
;

737 * 
	gpixñs
;

738 * 
	g±rBuf„r
;

739 
CRITICAL_SECTION
 
	g¸ôSe˘i⁄
;

740 
HANDLE
 
	ghEvít
;

751 
	gvideoDevi˚
::
	$videoDevi˚
(){

753 
pC≠tuªGøph
 = 
NULL
;

754 
pGøph
 = 
NULL
;

755 
pC⁄åﬁ
 = 
NULL
;

756 
pVideoI≈utFûãr
 = 
NULL
;

757 
pGøbbî
 = 
NULL
;

758 
pDe°Fûãr
 = 
NULL
;

759 
pGøbbîF
 = 
NULL
;

760 
pMedüEvít
 = 
NULL
;

761 
°ªamC⁄f
 = 
NULL
;

762 
pAmMedüTy≥
 = 
NULL
;

765 
sgCÆlback
 = 
√w
 
	`Sam∂eGøbbîCÆlback
();

766 
sgCÆlback
->
√wFøme
 = 
Ál£
;

769 
videoTy≥
 = 
MEDIASUBTYPE_RGB24
;

770 
c⁄√˘i⁄
 = 
PhysC⁄n_Video_Composôe
;

771 
°‹eC⁄n
 = 0;

773 
videoSize
 = 0;

774 
width
 = 0;

775 
height
 = 0;

777 
åyWidth
 = 640;

778 
åyHeight
 = 480;

779 
åyVideoTy≥
 = 
MEDIASUBTYPE_RGB24
;

780 
nFømesF‹Rec⁄√˘
= 10000;

781 
nFømesRu¬ög
 = 0;

782 
myID
 = -1;

784 
åyDiffSize
 = 
åue
;

785 
u£Crossb¨
 = 
Ál£
;

786 
ªadyToC≠tuª
 = 
Ál£
;

787 
sizeSë
 = 
Ál£
;

788 
£tupSèπed
 = 
Ál£
;

789 
•ecificF‹m©
 = 
Ál£
;

790 
autoRec⁄√˘
 = 
Ál£
;

791 
ªque°edFømeTime
 = -1;

793 
	`mem£t
(
wDevi˚Name
, 0, (
WCHAR
) * 255);

794 
	`mem£t
(
nDevi˚Name
, 0, () * 255);

796 
	}
}

804 
	gvideoDevi˚
::
	$£tSize
(
w
, 
h
){

805 if(
sizeSë
){

806 
	`DebugPrötOut
("SETUP: Error device size shouldÇot be set moreÅhan once\n");

810 
width
 = 
w
;

811 
height
 = 
h
;

812 
videoSize
 = 
w
*
h
*3;

813 
sizeSë
 = 
åue
;

814 
pixñs
 = 
√w
 [
videoSize
];

815 
pBuf„r
 = 
√w
 [
videoSize
];

817 
	`mem£t
(
pixñs
, 0 , 
videoSize
);

818 
sgCÆlback
->
	`£tupBuf„r
(
videoSize
);

821 
	}
}

829 
	gvideoDevi˚
::
	$NukeDown°ªam
(
IBa£Fûãr
 *
pBF
){

830 
IPö
 *
pP
, *
pTo
;

831 
ULONG
 
u
;

832 
IEnumPös
 *
pös
 = 
NULL
;

833 
PIN_INFO
 
pööfo
;

834 
HRESULT
 
hr
 = 
pBF
->
	`EnumPös
(&
pös
);

835 
pös
->
	`Re£t
();

836 
hr
 =
NOERROR
)

838 
hr
 = 
pös
->
	`Next
(1, &
pP
, &
u
);

839 i‡(
hr
 =
S_OK
 && 
pP
)

841 
pP
->
	`C⁄√˘edTo
(&
pTo
);

842 i‡(
pTo
)

844 
hr
 = 
pTo
->
	`QuîyPöInfo
(&
pööfo
);

845 i‡(
hr
 =
NOERROR
)

847 i‡(
pööfo
.
dú
 =
PINDIR_INPUT
)

849 
	`NukeDown°ªam
(
pööfo
.
pFûãr
);

850 
pGøph
->
	`Disc⁄√˘
(
pTo
);

851 
pGøph
->
	`Disc⁄√˘
(
pP
);

852 
pGøph
->
	`RemoveFûãr
(
pööfo
.
pFûãr
);

854 
pööfo
.
pFûãr
->
	`Rñó£
();

855 
pööfo
.
pFûãr
 = 
NULL
;

857 
pTo
->
	`Rñó£
();

859 
pP
->
	`Rñó£
();

862 i‡(
pös
Ëpös->
	`Rñó£
();

863 
	}
}

870 
	gvideoDevi˚
::
	$de°royGøph
(){

871 
HRESULT
 
hr
 = 0;

875 
i
 = 0;

876 
hr
 =
NOERROR
)

878 
IEnumFûãrs
 * 
pEnum
 = 0;

879 
ULONG
 
cFëched
;

883 
hr
 = 
pGøph
->
	`EnumFûãrs
(&
pEnum
);

884 i‡(
	`FAILED
(
hr
)Ë{ 
	`DebugPrötOut
("SETUP:ÖGraph->EnumFilters() failed.\n"); ; }

886 
IBa£Fûãr
 * 
pFûãr
 = 
NULL
;

887 i‡(
pEnum
->
	`Next
(1, &
pFûãr
, &
cFëched
Ë=
S_OK
)

889 
FILTER_INFO
 
FûãrInfo
;

890 
	`mem£t
(&
FûãrInfo
, 0, (FilterInfo));

891 
hr
 = 
pFûãr
->
	`QuîyFûãrInfo
(&
FûãrInfo
);

892 
FûãrInfo
.
pGøph
->
	`Rñó£
();

894 
cou¡
 = 0;

895 
buf„r
[255];

896 
	`mem£t
(
buf„r
, 0, 255 * ());

898  
FûãrInfo
.
achName
[
cou¡
] != 0x00 )

900 
buf„r
[
cou¡
] = ()
FûãrInfo
.
achName
[count];

901 
cou¡
++;

904 
	`DebugPrötOut
("SETUP:Ñemovög fûã∏%s...\n", 
buf„r
);

905 
hr
 = 
pGøph
->
	`RemoveFûãr
(
pFûãr
);

906 i‡(
	`FAILED
(
hr
)Ë{ 
	`DebugPrötOut
("SETUP:ÖGraph->RemoveFilter() failed.\n"); ; }

907 
	`DebugPrötOut
("SETUP: fûã∏ªmoved %s\n",
buf„r
);

909 
pFûãr
->
	`Rñó£
();

910 
pFûãr
 = 
NULL
;

913 
pEnum
->
	`Rñó£
();

914 
pEnum
 = 
NULL
;

915 
i
++;

919 
	}
}

928 
	gvideoDevi˚
::~
	$videoDevi˚
(){

930 if(
£tupSèπed
){ 
	`DebugPrötOut
("\nSETUP: Disc⁄√˘ög devi˚ %i\n", 
myID
); }

932 if(
sgCÆlback
){

933 
sgCÆlback
->
	`Rñó£
();

934 
dñëe
 
sgCÆlback
;

939 
HRESULT
 
HR
 = 
NOERROR
;

942 if–(
sgCÆlback
Ë&& (
pGøbbî
) )

944 
pGøbbî
->
	`SëCÆlback
(
NULL
, 1);

945 
	`DebugPrötOut
("SETUP: freeing Grabber Callback\n");

946 
sgCÆlback
->
	`Rñó£
();

949 if(
sizeSë
){

950 
dñëe
[] 
pixñs
;

951 
dñëe
[] 
pBuf„r
;

954 
dñëe
 
sgCÆlback
;

958 if–(
pC⁄åﬁ
) )

960 
HR
 = 
pC⁄åﬁ
->
	`Pau£
();

961 i‡(
	`FAILED
(
HR
)Ë
	`DebugPrötOut
("ERROR - CouldÇotÖauseÖControl\n");

963 
HR
 = 
pC⁄åﬁ
->
	`St›
();

964 i‡(
	`FAILED
(
HR
)Ë
	`DebugPrötOut
("ERROR - CouldÇot stopÖControl\n");

968 if–(
pVideoI≈utFûãr
Ë)
	`NukeDown°ªam
(pVideoInputFilter);

971 if–(
pDe°Fûãr
Ë){ 
	`DebugPrötOut
("SETUP: freeing Renderer\n");

972 (
pDe°Fûãr
)->
	`Rñó£
();

973 (
pDe°Fûãr
) = 0;

975 if–(
pVideoI≈utFûãr
Ë){ 
	`DebugPrötOut
("SETUP: freeing Capture Source\n");

976 (
pVideoI≈utFûãr
)->
	`Rñó£
();

977 (
pVideoI≈utFûãr
) = 0;

979 if–(
pGøbbîF
Ë){ 
	`DebugPrötOut
("SETUP: freeing Grabber Filter\n");

980 (
pGøbbîF
)->
	`Rñó£
();

981 (
pGøbbîF
) = 0;

983 if–(
pGøbbî
Ë){ 
	`DebugPrötOut
("SETUP: freeing Grabber\n");

984 (
pGøbbî
)->
	`Rñó£
();

985 (
pGøbbî
) = 0;

987 if–(
pC⁄åﬁ
Ë){ 
	`DebugPrötOut
("SETUP: freeing Control\n");

988 (
pC⁄åﬁ
)->
	`Rñó£
();

989 (
pC⁄åﬁ
) = 0;

991 if–(
pMedüEvít
Ë){ 
	`DebugPrötOut
("SETUP: freeing Media Event\n");

992 (
pMedüEvít
)->
	`Rñó£
();

993 (
pMedüEvít
) = 0;

995 if–(
°ªamC⁄f
Ë){ 
	`DebugPrötOut
("SETUP: freeing Stream\n");

996 (
°ªamC⁄f
)->
	`Rñó£
();

997 (
°ªamC⁄f
) = 0;

1000 if–(
pAmMedüTy≥
Ë){ 
	`DebugPrötOut
("SETUP: freeing Media Type\n");

1001 
	`MyDñëeMedüTy≥
(
pAmMedüTy≥
);

1004 if((
pMedüEvít
)){

1005 
	`DebugPrötOut
("SETUP: freeing Media Event\n");

1006 (
pMedüEvít
)->
	`Rñó£
();

1007 (
pMedüEvít
) = 0;

1011 if–(
pGøph
Ë)
	`de°royGøph
();

1014 if–(
pC≠tuªGøph
Ë){ 
	`DebugPrötOut
("SETUP: freeing Capture Graph\n");

1015 (
pC≠tuªGøph
)->
	`Rñó£
();

1016 (
pC≠tuªGøph
) = 0;

1018 if–(
pGøph
Ë){ 
	`DebugPrötOut
("SETUP: freeing Main Graph\n");

1019 (
pGøph
)->
	`Rñó£
();

1020 (
pGøph
) = 0;

1024 
dñëe
 
pDe°Fûãr
;

1025 
dñëe
 
pVideoI≈utFûãr
;

1026 
dñëe
 
pGøbbîF
;

1027 
dñëe
 
pGøbbî
;

1028 
dñëe
 
pC⁄åﬁ
;

1029 
dñëe
 
°ªamC⁄f
;

1030 
dñëe
 
pMedüEvít
;

1031 
dñëe
 
pC≠tuªGøph
;

1032 
dñëe
 
pGøph
;

1034 
	`DebugPrötOut
("SETUP: Devi˚ %òdisc⁄√˘edánd fªed\n\n",
myID
);

1035 
	}
}

1047 
	gvideoI≈ut
::
	$videoI≈ut
(){

1049 
	`comInô
();

1051 
devi˚sFound
 = 0;

1052 
ˇŒbackSëCou¡
 = 0;

1053 
bCÆlback
 = 
åue
;

1056 
i
=0; i<
VI_MAX_CAMERAS
; i++Ë
VDLi°
[i] = 
√w
 
	`videoDevi˚
();

1058 
	`DebugPrötOut
("\n***** VIDEOINPUT LIBRARY - %2.04‡- TFW07 *****\n\n",
VI_VERSION
);

1068 
medüSubty≥s
[0] = 
MEDIASUBTYPE_RGB24
;

1069 
medüSubty≥s
[1] = 
MEDIASUBTYPE_RGB32
;

1070 
medüSubty≥s
[2] = 
MEDIASUBTYPE_RGB555
;

1071 
medüSubty≥s
[3] = 
MEDIASUBTYPE_RGB565
;

1072 
medüSubty≥s
[4] = 
MEDIASUBTYPE_YUY2
;

1073 
medüSubty≥s
[5] = 
MEDIASUBTYPE_YVYU
;

1074 
medüSubty≥s
[6] = 
MEDIASUBTYPE_YUYV
;

1075 
medüSubty≥s
[7] = 
MEDIASUBTYPE_IYUV
;

1076 
medüSubty≥s
[8] = 
MEDIASUBTYPE_UYVY
;

1077 
medüSubty≥s
[9] = 
MEDIASUBTYPE_YV12
;

1078 
medüSubty≥s
[10] = 
MEDIASUBTYPE_YVU9
;

1079 
medüSubty≥s
[11] = 
MEDIASUBTYPE_Y411
;

1080 
medüSubty≥s
[12] = 
MEDIASUBTYPE_Y41P
;

1081 
medüSubty≥s
[13] = 
MEDIASUBTYPE_Y211
;

1082 
medüSubty≥s
[14] = 
MEDIASUBTYPE_AYUV
;

1083 
medüSubty≥s
[15] = 
MEDIASUBTYPE_MJPG
;

1086 
medüSubty≥s
[16] = 
MEDIASUBTYPE_Y800
;

1087 
medüSubty≥s
[17] = 
MEDIASUBTYPE_Y8
;

1088 
medüSubty≥s
[18] = 
MEDIASUBTYPE_GREY
;

1089 
medüSubty≥s
[19] = 
MEDIASUBTYPE_I420
;

1092 
f‹m©Ty≥s
[
VI_NTSC_M
] = 
A«logVideo_NTSC_M
;

1093 
f‹m©Ty≥s
[
VI_NTSC_M_J
] = 
A«logVideo_NTSC_M_J
;

1094 
f‹m©Ty≥s
[
VI_NTSC_433
] = 
A«logVideo_NTSC_433
;

1096 
f‹m©Ty≥s
[
VI_PAL_B
] = 
A«logVideo_PAL_B
;

1097 
f‹m©Ty≥s
[
VI_PAL_D
] = 
A«logVideo_PAL_D
;

1098 
f‹m©Ty≥s
[
VI_PAL_G
] = 
A«logVideo_PAL_G
;

1099 
f‹m©Ty≥s
[
VI_PAL_H
] = 
A«logVideo_PAL_H
;

1100 
f‹m©Ty≥s
[
VI_PAL_I
] = 
A«logVideo_PAL_I
;

1101 
f‹m©Ty≥s
[
VI_PAL_M
] = 
A«logVideo_PAL_M
;

1102 
f‹m©Ty≥s
[
VI_PAL_N
] = 
A«logVideo_PAL_N
;

1103 
f‹m©Ty≥s
[
VI_PAL_NC
] = 
A«logVideo_PAL_N_COMBO
;

1105 
f‹m©Ty≥s
[
VI_SECAM_B
] = 
A«logVideo_SECAM_B
;

1106 
f‹m©Ty≥s
[
VI_SECAM_D
] = 
A«logVideo_SECAM_D
;

1107 
f‹m©Ty≥s
[
VI_SECAM_G
] = 
A«logVideo_SECAM_G
;

1108 
f‹m©Ty≥s
[
VI_SECAM_H
] = 
A«logVideo_SECAM_H
;

1109 
f‹m©Ty≥s
[
VI_SECAM_K
] = 
A«logVideo_SECAM_K
;

1110 
f‹m©Ty≥s
[
VI_SECAM_K1
] = 
A«logVideo_SECAM_K1
;

1111 
f‹m©Ty≥s
[
VI_SECAM_L
] = 
A«logVideo_SECAM_L
;

1113 
	}
}

1121 
	gvideoI≈ut
::
	$£tVîbo£
(
boﬁ
 
_vîbo£
){

1122 #ifde‡
_DEBUG


1123 
gs_vîbo£
 = 
_vîbo£
;

1125 ()
_vîbo£
;

1127 
	}
}

1134 
	gvideoI≈ut
::
	$£tU£CÆlback
(
boﬁ
 
u£CÆlback
){

1135 if(
ˇŒbackSëCou¡
 == 0){

1136 
bCÆlback
 = 
u£CÆlback
;

1137 
ˇŒbackSëCou¡
 = 1;

1139 
	`DebugPrötOut
("ERROR: setUseCallback can only be called before setup\n");

1141 
	}
}

1148 
	gvideoI≈ut
::
	$£tIdólFømî©e
(
devi˚Numbî
, 
idólFømî©e
){

1149 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
) ;

1151 if–
idólFømî©e
 > 0 ){

1152 
VDLi°
[
devi˚Numbî
]->
ªque°edFømeTime
 = ()(10000000 / 
idólFømî©e
);

1154 
	}
}

1162 
	gvideoI≈ut
::
	$£tAutoRec⁄√˘OnFªeze
(
devi˚Numbî
, 
boﬁ
 
doRec⁄√˘
, 
numMis£dFømesBef‹eRec⁄√˘
){

1163 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
) ;

1165 
VDLi°
[
devi˚Numbî
]->
autoRec⁄√˘
 = 
doRec⁄√˘
;

1166 
VDLi°
[
devi˚Numbî
]->
nFømesF‹Rec⁄√˘
 = 
numMis£dFømesBef‹eRec⁄√˘
;

1168 
	}
}

1176 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚Numbî
){

1177 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1179 if(
	`£tup
(
devi˚Numbî
)) 
åue
;

1180  
Ál£
;

1181 
	}
}

1189 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚Numbî
, 
_c⁄√˘i⁄
){

1190 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1192 
	`£tPhyC⁄
(
devi˚Numbî
, 
_c⁄√˘i⁄
);

1193 if(
	`£tup
(
devi˚Numbî
)) 
åue
;

1194  
Ál£
;

1195 
	}
}

1203 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚Numbî
, 
w
, 
h
){

1204 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1206 
	`£tAâem±C≠tuªSize
(
devi˚Numbî
,
w
,
h
);

1207 if(
	`£tup
(
devi˚Numbî
)) 
åue
;

1208  
Ál£
;

1209 
	}
}

1218 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚Fourcc
(
devi˚Numbî
, 
w
, 
h
,
fourcc
){

1219 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1221 i‡–
fourcc
 != -1 ) {

1222 
GUID
 *
medüTy≥
 = 
	`gëMedüSubty≥FromFourcc
(
fourcc
);

1223 i‡–
medüTy≥
 ) {

1224 
	`£tAâem±C≠tuªSize
(
devi˚Numbî
,
w
,
h
,*
medüTy≥
);

1227 
	`£tAâem±C≠tuªSize
(
devi˚Numbî
,
w
,
h
);

1229 if(
	`£tup
(
devi˚Numbî
)) 
åue
;

1230  
Ál£
;

1231 
	}
}

1239 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚Numbî
, 
w
, 
h
, 
_c⁄√˘i⁄
){

1240 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || 
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1242 
	`£tAâem±C≠tuªSize
(
devi˚Numbî
,
w
,
h
);

1243 
	`£tPhyC⁄
(
devi˚Numbî
, 
_c⁄√˘i⁄
);

1244 if(
	`£tup
(
devi˚Numbî
)) 
åue
;

1245  
Ál£
;

1246 
	}
}

1256 
boﬁ
 
	gvideoI≈ut
::
	$£tF‹m©
(
devi˚Numbî
, 
f‹m©
){

1257 if(
devi˚Numbî
 >
VI_MAX_CAMERAS
 || !
VDLi°
[devi˚Numbî]->
ªadyToC≠tuª
Ë 
Ál£
;

1259 
boﬁ
 
ªtu∫VÆ
 = 
Ál£
;

1261 if(
f‹m©
 >0 && f‹m© < 
VI_NUM_FORMATS
){

1262 
VDLi°
[
devi˚Numbî
]->
f‹m©Ty≥
 = 
f‹m©Ty≥s
[
f‹m©
];

1263 
VDLi°
[
devi˚Numbî
]->
•ecificF‹m©
 = 
åue
;

1265 if(
VDLi°
[
devi˚Numbî
]->
•ecificF‹m©
){

1267 
HRESULT
 
hr
 = 
	`gëDevi˚
(&
VDLi°
[
devi˚Numbî
]->
pVideoI≈utFûãr
, devi˚Numbî, VDLi°[devi˚Numbî]->
wDevi˚Name
, VDLi°[devi˚Numbî]->
nDevi˚Name
);

1268 if(
hr
 !
S_OK
){

1269  
Ál£
;

1272 
IAMA«logVideoDecodî
 *
pVideoDec
 = 
NULL
;

1273 
hr
 = 
VDLi°
[
devi˚Numbî
]->
pC≠tuªGøph
->
	`FödI¡îÁ˚
(
NULL
, &
MEDIATYPE_Video
, VDLi°[devi˚Numbî]->
pVideoI≈utFûãr
, 
IID_IAMA«logVideoDecodî
, (**)&
pVideoDec
);

1277 if(
VDLi°
[
devi˚Numbî
]->
pVideoI≈utFûãr
)VDLi°[devi˚Numbî]->pVideoI≈utFûãr->
	`Rñó£
();

1278 if(
VDLi°
[
devi˚Numbî
]->
pVideoI≈utFûãr
)VDLi°[devi˚Numbî]->pVideoI≈utFûã∏
NULL
;

1280 if(
	`FAILED
(
hr
)){

1281 
	`DebugPrötOut
("SETUP: couldn't setÑequested format\n");

1283 
lVÆue
 = 0;

1284 
hr
 = 
pVideoDec
->
	`gë_AvaûabÀTVF‹m©s
(&
lVÆue
);

1285 if–
	`SUCCEEDED
(
hr
Ë&& (
lVÆue
 & 
VDLi°
[
devi˚Numbî
]->
f‹m©Ty≥
) )

1287 
hr
 = 
pVideoDec
->
	`put_TVF‹m©
(
VDLi°
[
devi˚Numbî
]->
f‹m©Ty≥
);

1288 if–
	`FAILED
(
hr
) ){

1289 
	`DebugPrötOut
("SETUP: couldn't setÑequested format\n");

1291 
ªtu∫VÆ
 = 
åue
;

1295 
pVideoDec
->
	`Rñó£
();

1296 
pVideoDec
 = 
NULL
;

1301  
ªtu∫VÆ
;

1302 
	}
}

1309 
	gvideoI≈ut
::
devi˚Names
[
VI_MAX_CAMERAS
][255]={{0}};

1311 * 
	gvideoI≈ut
::
	$gëDevi˚Name
(
devi˚ID
){

1312 if–
devi˚ID
 >
VI_MAX_CAMERAS
 ){

1313  
NULL
;

1315  
devi˚Names
[
devi˚ID
];

1316 
	}
}

1324 
	gvideoI≈ut
::
	$li°Devi˚s
(
boﬁ
 
sûít
){

1327 
	`comInô
();

1329 if(!
sûít
Ë
	`DebugPrötOut
("\nVIDEOINPUT SPY MODE!\n\n");

1332 
ICª©eDevEnum
 *
pDevEnum
 = 
NULL
;

1333 
IEnumM⁄ikî
 *
pEnum
 = 
NULL
;

1334 
devi˚Cou¡î
 = 0;

1336 
HRESULT
 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_Sy°emDevi˚Enum
, 
NULL
,

1337 
CLSCTX_INPROC_SERVER
, 
IID_ICª©eDevEnum
,

1338 
ªöãΩªt_ˇ°
<**>(&
pDevEnum
));

1341 i‡(
	`SUCCEEDED
(
hr
))

1344 
hr
 = 
pDevEnum
->
	`Cª©eCœssEnumî©‹
(

1345 
CLSID_VideoI≈utDevi˚C©eg‹y
,

1346 &
pEnum
, 0);

1348 if(
hr
 =
S_OK
){

1350 if(!
sûít
Ë
	`DebugPrötOut
("SETUP: Looking For Capture Devices\n");

1351 
IM⁄ikî
 *
pM⁄ikî
 = 
NULL
;

1353 
pEnum
->
	`Next
(1, &
pM⁄ikî
, 
NULL
Ë=
S_OK
){

1355 
IPr›îtyBag
 *
pPr›Bag
;

1356 
hr
 = 
pM⁄ikî
->
	`BödToSt‹age
(0, 0, 
IID_IPr›îtyBag
,

1357 (**)(&
pPr›Bag
));

1359 i‡(
	`FAILED
(
hr
)){

1360 
pM⁄ikî
->
	`Rñó£
();

1366 
VARIANT
 
v¨Name
;

1367 
	`V¨ü¡Inô
(&
v¨Name
);

1368 
hr
 = 
pPr›Bag
->
	`Ród
(
L
"Des¸ùti⁄", &
v¨Name
, 0);

1370 i‡(
	`FAILED
(
hr
)Ëh∏
pPr›Bag
->
	`Ród
(
L
"FrõndlyName", &
v¨Name
, 0);

1372 i‡(
	`SUCCEEDED
(
hr
)){

1374 
hr
 = 
pPr›Bag
->
	`Ród
(
L
"FrõndlyName", &
v¨Name
, 0);

1376 
cou¡
 = 0;

1377 
maxLí
 = (
devi˚Names
[0])/(deviceNames[0][0]) - 2;

1378  
v¨Name
.
b°rVÆ
[
cou¡
] !0x00 && cou¡ < 
maxLí
) {

1379 
devi˚Names
[
devi˚Cou¡î
][
cou¡
] = ()
v¨Name
.
b°rVÆ
[count];

1380 
cou¡
++;

1382 
devi˚Names
[
devi˚Cou¡î
][
cou¡
] = 0;

1384 if(!
sûít
Ë
	`DebugPrötOut
("SETUP: %iË%s\n",
devi˚Cou¡î
, 
devi˚Names
[deviceCounter]);

1387 
pPr›Bag
->
	`Rñó£
();

1388 
pPr›Bag
 = 
NULL
;

1390 
pM⁄ikî
->
	`Rñó£
();

1391 
pM⁄ikî
 = 
NULL
;

1393 
devi˚Cou¡î
++;

1396 
pDevEnum
->
	`Rñó£
();

1397 
pDevEnum
 = 
NULL
;

1399 
pEnum
->
	`Rñó£
();

1400 
pEnum
 = 
NULL
;

1403 if(!
sûít
Ë
	`DebugPrötOut
("SETUP: %òDevi˚(sËfound\n\n", 
devi˚Cou¡î
);

1406 
	`comUnInô
();

1408  
devi˚Cou¡î
;

1409 
	}
}

1417 
	gvideoI≈ut
::
	$gëWidth
(
id
) const

1419 if(
	`isDevi˚Sëup
(
id
))

1421  
VDLi°
[
id
] ->
width
;

1426 
	}
}

1434 
	gvideoI≈ut
::
	$gëHeight
(
id
) const

1436 if(
	`isDevi˚Sëup
(
id
))

1438  
VDLi°
[
id
] ->
height
;

1443 
	}
}

1449 
	gvideoI≈ut
::
	$gëFourcc
(
id
) const

1451 if(
	`isDevi˚Sëup
(
id
))

1453  
	`gëFourccFromMedüSubty≥
(
VDLi°
[
id
]->
videoTy≥
);

1458 
	}
}

1460 
	gvideoI≈ut
::
	$gëFPS
(
id
) const

1462 if(
	`isDevi˚Sëup
(
id
))

1464 
‰ameTime

VDLi°
[
id
]->
ªque°edFømeTime
;

1465 i‡(
‰ameTime
>0) {

1466  (10000000.0 / 
‰ameTime
);

1472 
	}
}

1480 
	gvideoI≈ut
::
	$gëSize
(
id
) const

1482 if(
	`isDevi˚Sëup
(
id
))

1484  
VDLi°
[
id
] ->
videoSize
;

1489 
	}
}

1496 
boﬁ
 
	gvideoI≈ut
::
	$gëPixñs
(
id
, * 
d°Buf„r
, 
boﬁ
 
ÊùRedAndBlue
, boﬁ 
ÊùImage
){

1498 
boﬁ
 
suc˚ss
 = 
Ál£
;

1500 if(
	`isDevi˚Sëup
(
id
)){

1501 if(
bCÆlback
){

1504 
DWORD
 
ªsu…
 = 
	`WaôF‹SögÀObje˘
(
VDLi°
[
id
]->
sgCÆlback
->
hEvít
, 1000);

1505 if–
ªsu…
 !
WAIT_OBJECT_0
Ë 
Ál£
;

1508 
	`E¡îCrôiˇlSe˘i⁄
(&
VDLi°
[
id
]->
sgCÆlback
->
¸ôSe˘i⁄
);

1510 * 
§c
 = 
VDLi°
[
id
]->
sgCÆlback
->
pixñs
;

1511 * 
d°
 = 
d°Buf„r
;

1512 
height
 = 
VDLi°
[
id
]->height;

1513 
width
 = 
VDLi°
[
id
]->width;

1515 
	`¥o˚ssPixñs
(
§c
, 
d°
, 
width
, 
height
, 
ÊùRedAndBlue
, 
ÊùImage
);

1516 
VDLi°
[
id
]->
sgCÆlback
->
√wFøme
 = 
Ál£
;

1518 
	`LóveCrôiˇlSe˘i⁄
(&
VDLi°
[
id
]->
sgCÆlback
->
¸ôSe˘i⁄
);

1520 
	`Re£tEvít
(
VDLi°
[
id
]->
sgCÆlback
->
hEvít
);

1522 
suc˚ss
 = 
åue
;

1527 
buf„rSize
 = 
VDLi°
[
id
]->
videoSize
;

1528 
HRESULT
 
hr
 = 
VDLi°
[
id
]->
pGøbbî
->
	`GëCuºítBuf„r
(&
buf„rSize
, (*)VDLi°[id]->
pBuf„r
);

1529 if(
hr
==
S_OK
){

1530 
numByãs
 = 
VDLi°
[
id
]->
videoSize
;

1531 i‡(
numByãs
 =
buf„rSize
){

1533 * 
§c
 = (* )
VDLi°
[
id
]->
pBuf„r
;

1534 * 
d°
 = 
d°Buf„r
;

1535 
height
 = 
VDLi°
[
id
]->height;

1536 
width
 = 
VDLi°
[
id
]->width;

1538 
	`¥o˚ssPixñs
(
§c
, 
d°
, 
width
, 
height
, 
ÊùRedAndBlue
, 
ÊùImage
);

1539 
suc˚ss
 = 
åue
;

1541 
	`DebugPrötOut
("ERROR: GetPixels() - bufferSizes doÇot match!\n");

1544 
	`DebugPrötOut
("ERROR: GëPixñs(Ë- U«bÀÅÿgøb fømêf‹ devi˚ %i\n", 
id
);

1549  
suc˚ss
;

1550 
	}
}

1556 * 
	gvideoI≈ut
::
	$gëPixñs
(
id
, 
boﬁ
 
ÊùRedAndBlue
, boﬁ 
ÊùImage
){

1558 if(
	`isDevi˚Sëup
(
id
)){

1559 
	`gëPixñs
(
id
, 
VDLi°
[id]->
pixñs
, 
ÊùRedAndBlue
, 
ÊùImage
);

1562  
VDLi°
[
id
]->
pixñs
;

1563 
	}
}

1571 
boﬁ
 
	gvideoI≈ut
::
	$isFømeNew
(
id
){

1572 if(!
	`isDevi˚Sëup
(
id
)Ë 
Ál£
;

1573 if(!
bCÆlback
) 
åue
;

1575 
boﬁ
 
ªsu…
 = 
Ál£
;

1576 
boﬁ
 
‰ìze
 = 
Ál£
;

1579 
	`E¡îCrôiˇlSe˘i⁄
(&
VDLi°
[
id
]->
sgCÆlback
->
¸ôSe˘i⁄
);

1580 
ªsu…
 = 
VDLi°
[
id
]->
sgCÆlback
->
√wFøme
;

1583 if(
VDLi°
[
id
]->
nFømesRu¬ög
 > 400 && VDLi°[id]->
sgCÆlback
->
‰ìzeCheck
 > VDLi°[id]->
nFømesF‹Rec⁄√˘
 ){

1584 
‰ìze
 = 
åue
;

1590 
VDLi°
[
id
]->
sgCÆlback
->
‰ìzeCheck
++;

1591 
	`LóveCrôiˇlSe˘i⁄
(&
VDLi°
[
id
]->
sgCÆlback
->
¸ôSe˘i⁄
);

1593 
VDLi°
[
id
]->
nFømesRu¬ög
++;

1595 if(
‰ìze
 && 
VDLi°
[
id
]->
autoRec⁄√˘
){

1596 
	`DebugPrötOut
("ERROR: Device seems frozen -áttemptingÅoÑeconnect\n");

1597 if–!
	`ª°¨tDevi˚
(
VDLi°
[
id
]->
myID
) ){

1598 
	`DebugPrötOut
("ERROR: UnableÅoÑeconnectÅo device\n");

1600 
	`DebugPrötOut
("SUCCESS: AbleÅoÑeconnectÅo device\n");

1604  
ªsu…
;

1605 
	}
}

1613 
boﬁ
 
	gvideoI≈ut
::
	$isDevi˚Sëup
(
id
) const

1615 if(
id
>=0 && id<
devi˚sFound
 && 
VDLi°
[id]->
ªadyToC≠tuª
) 
åue
;

1616  
Ál£
;

1617 
	}
}

1626 
__cde˛
 
	gvideoI≈ut
::
	$basicThªad
(* 
objPå
){

1630 
videoDevi˚
 * 
vd
 = *–(videoDevi˚ **)(
objPå
) );

1631 
	`ShowFûãrPr›îtyPages
(
vd
->
pVideoI≈utFûãr
);

1636 if(
vd
->
pVideoI≈utFûãr
)vd->pVideoI≈utFûãr->
	`Rñó£
();

1637 if(
vd
->
pVideoI≈utFûãr
)vd->pVideoI≈utFûã∏
NULL
;

1640 
	}
}

1642 
	gvideoI≈ut
::
	$showSëtögsWödow
(
id
){

1644 if(
	`isDevi˚Sëup
(
id
)){

1650 
HRESULT
 
hr
 = 
	`gëDevi˚
(&
VDLi°
[
id
]->
pVideoI≈utFûãr
, id, VDLi°[id]->
wDevi˚Name
, VDLi°[id]->
nDevi˚Name
);

1651 if(
hr
 =
S_OK
){

1653 
	`_begöthªad
(
basicThªad
, 0, (*)&
VDLi°
[
id
]);

1656 
	}
}

1660 
boﬁ
 
	gvideoI≈ut
::
	$gëVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
cuºítVÆue
, &
Êags
, &
deÁu…VÆue
){

1661 if–!
	`isDevi˚Sëup
(
devi˚ID
Ë) 
Ál£
;

1663 
HRESULT
 
hr
;

1666 
videoDevi˚
 * 
VD
 = 
VDLi°
[
devi˚ID
];

1668 
hr
 = 
	`gëDevi˚
(&
VD
->
pVideoI≈utFûãr
, 
devi˚ID
, VD->
wDevi˚Name
, VD->
nDevi˚Name
);

1669 i‡(
	`FAILED
(
hr
)){

1670 
	`DebugPrötOut
("setVideoSetting - getDevice Error\n");

1671  
Ál£
;

1674 
IAMVideoProcAmp
 *
pAMVideoProcAmp
 = 
NULL
;

1676 
hr
 = 
VD
->
pVideoI≈utFûãr
->
	`QuîyI¡îÁ˚
(
IID_IAMVideoProcAmp
, (**)&
pAMVideoProcAmp
);

1677 if(
	`FAILED
(
hr
)){

1678 
	`DebugPrötOut
("setVideoSetting - QueryInterface Error\n");

1679 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1680 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1681  
Ál£
;

1684 
¥›Så
[16];

1685 
	`gëVideoPr›îtyAsSåög
(
Pr›îty
,
¥›Så
);

1687 
	`DebugPrötOut
("Sëtög videÿ£âög %s.\n", 
¥›Så
);

1689 
pAMVideoProcAmp
->
	`GëR™ge
(
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
deÁu…VÆue
, &
Êags
);

1690 
	`DebugPrötOut
("R™gêf‹ videÿ£âög %s: Mö:%ld Max:%ld SãµögDñè:%ld DeÁu…:%ld Fœgs:%ld\n", 
¥›Så
, 
mö
, 
max
, 
SãµögDñè
, 
deÁu…VÆue
, 
Êags
);

1691 
pAMVideoProcAmp
->
	`Gë
(
Pr›îty
, &
cuºítVÆue
, &
Êags
);

1693 if(
pAMVideoProcAmp
ÌAMVideoProcAmp->
	`Rñó£
();

1694 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1695 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1697  
åue
;

1699 
	}
}

1703 
boﬁ
 
	gvideoI≈ut
::
	$£tVideoSëtögFûãrP˘
(
devi˚ID
, 
Pr›îty
, 
p˘VÆue
, 
Fœgs
){

1704 if–!
	`isDevi˚Sëup
(
devi˚ID
Ë) 
Ál£
;

1706 
mö
, 
max
, 
cuºítVÆue
, 
Êags
, 
deÁu…VÆue
, 
°ïAm¡
;

1708 if–!
	`gëVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, 
mö
, 
max
, 
°ïAm¡
, 
cuºítVÆue
, 
Êags
, 
deÁu…VÆue
Ë) 
Ál£
;

1710 if(
p˘VÆue
 > 1.0)pctValue = 1.0;

1711 if(
p˘VÆue
 < 0)pctValue = 0.0;

1713 
ønge
 = ()
max
 - ()
mö
;

1714 if(
ønge
 <0) 
Ál£
;

1715 if(
°ïAm¡
 =0Ë 
Ál£
;

1717 
vÆue
 = ()–()
mö
 + 
ønge
 * 
p˘VÆue
 );

1718 
ø°îVÆue
 = 
vÆue
;

1722 if–
ønge
 =
°ïAm¡
 ){

1723 if–
p˘VÆue
 < 0.5)
ø°îVÆue
 = 
mö
;

1724 
ø°îVÆue
 = 
max
;

1727 
mod
 = 
vÆue
 % 
°ïAm¡
;

1728 
hÆfSãp
 = ()
°ïAm¡
 * 0.5f;

1729 if–
mod
 < 
hÆfSãp
 ) 
ø°îVÆue
 -= mod;

1730 
ø°îVÆue
 +
°ïAm¡
 - 
mod
;

1731 
	`DebugPrötOut
("RASTER -Ö˘VÆuêi†%‡- vÆuêi†%lò- sã∞i†%lò- mod i†%lò-Ña°îVÆuêi†%li\n", 
p˘VÆue
, 
vÆue
, 
°ïAm¡
, 
mod
, 
ø°îVÆue
);

1734  
	`£tVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, 
ø°îVÆue
, 
Fœgs
, 
Ál£
);

1735 
	}
}

1739 
boﬁ
 
	gvideoI≈ut
::
	$£tVideoSëtögFûãr
(
devi˚ID
, 
Pr›îty
, 
lVÆue
, 
Fœgs
, 
boﬁ
 
u£DeÁu…VÆue
){

1740 if–!
	`isDevi˚Sëup
(
devi˚ID
Ë) 
Ál£
;

1742 
HRESULT
 
hr
;

1745 
¥›Så
[16];

1746 
	`gëVideoPr›îtyAsSåög
(
Pr›îty
,
¥›Så
);

1748 
videoDevi˚
 * 
VD
 = 
VDLi°
[
devi˚ID
];

1750 
hr
 = 
	`gëDevi˚
(&
VD
->
pVideoI≈utFûãr
, 
devi˚ID
, VD->
wDevi˚Name
, VD->
nDevi˚Name
);

1751 i‡(
	`FAILED
(
hr
)){

1752 
	`DebugPrötOut
("setVideoSetting - getDevice Error\n");

1753  
Ál£
;

1756 
IAMVideoProcAmp
 *
pAMVideoProcAmp
 = 
NULL
;

1758 
hr
 = 
VD
->
pVideoI≈utFûãr
->
	`QuîyI¡îÁ˚
(
IID_IAMVideoProcAmp
, (**)&
pAMVideoProcAmp
);

1759 if(
	`FAILED
(
hr
)){

1760 
	`DebugPrötOut
("setVideoSetting - QueryInterface Error\n");

1761 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1762 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1763  
Ál£
;

1766 
	`DebugPrötOut
("Sëtög videÿ£âög %s.\n", 
¥›Så
);

1767 
CuºVÆ
, 
Mö
, 
Max
, 
SãµögDñè
, 
DeÁu…
, 
C≠sFœgs
, 
AvaûabÀC≠sFœgs
 = 0;

1770 
pAMVideoProcAmp
->
	`GëR™ge
(
Pr›îty
, &
Mö
, &
Max
, &
SãµögDñè
, &
DeÁu…
, &
AvaûabÀC≠sFœgs
);

1771 
	`DebugPrötOut
("R™gêf‹ videÿ£âög %s: Mö:%ld Max:%ld SãµögDñè:%ld DeÁu…:%ld Fœgs:%ld\n", 
¥›Så
, 
Mö
, 
Max
, 
SãµögDñè
, 
DeÁu…
, 
AvaûabÀC≠sFœgs
);

1772 
pAMVideoProcAmp
->
	`Gë
(
Pr›îty
, &
CuºVÆ
, &
C≠sFœgs
);

1774 
	`DebugPrötOut
("CuºíàvÆue: %ld Fœg†%ld (%s)\n", 
CuºVÆ
, 
C≠sFœgs
, (CapsFlags == 1 ? "Auto" : (CapsFlags == 2 ? "Manual" : "Unknown")));

1776 i‡(
u£DeÁu…VÆue
) {

1777 
pAMVideoProcAmp
->
	`Së
(
Pr›îty
, 
DeÁu…
, 
VideoProcAmp_Fœgs_Auto
);

1781 
pAMVideoProcAmp
->
	`Së
(
Pr›îty
, 
lVÆue
, 
Fœgs
);

1784 if(
pAMVideoProcAmp
ÌAMVideoProcAmp->
	`Rñó£
();

1785 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1786 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1788  
åue
;

1790 
	}
}

1793 
boﬁ
 
	gvideoI≈ut
::
	$£tVideoSëtögCamîaP˘
(
devi˚ID
, 
Pr›îty
, 
p˘VÆue
, 
Fœgs
){

1794 if–!
	`isDevi˚Sëup
(
devi˚ID
Ë) 
Ál£
;

1796 
mö
, 
max
, 
cuºítVÆue
, 
Êags
, 
deÁu…VÆue
, 
°ïAm¡
;

1798 if–!
	`gëVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, 
mö
, 
max
, 
°ïAm¡
, 
cuºítVÆue
, 
Êags
, 
deÁu…VÆue
Ë) 
Ál£
;

1800 if(
p˘VÆue
 > 1.0)pctValue = 1.0;

1801 if(
p˘VÆue
 < 0)pctValue = 0.0;

1803 
ønge
 = ()
max
 - ()
mö
;

1804 if(
ønge
 <0) 
Ál£
;

1805 if(
°ïAm¡
 =0Ë 
Ál£
;

1807 
vÆue
 = ()–()
mö
 + 
ønge
 * 
p˘VÆue
 );

1808 
ø°îVÆue
 = 
vÆue
;

1812 if–
ønge
 =
°ïAm¡
 ){

1813 if–
p˘VÆue
 < 0.5)
ø°îVÆue
 = 
mö
;

1814 
ø°îVÆue
 = 
max
;

1817 
mod
 = 
vÆue
 % 
°ïAm¡
;

1818 
hÆfSãp
 = ()
°ïAm¡
 * 0.5f;

1819 if–
mod
 < 
hÆfSãp
 ) 
ø°îVÆue
 -= mod;

1820 
ø°îVÆue
 +
°ïAm¡
 - 
mod
;

1821 
	`DebugPrötOut
("RASTER -Ö˘VÆuêi†%‡- vÆuêi†%lò- sã∞i†%lò- mod i†%lò-Ña°îVÆuêi†%li\n", 
p˘VÆue
, 
vÆue
, 
°ïAm¡
, 
mod
, 
ø°îVÆue
);

1824  
	`£tVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, 
ø°îVÆue
, 
Fœgs
, 
Ál£
);

1825 
	}
}

1828 
boﬁ
 
	gvideoI≈ut
::
	$£tVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, 
lVÆue
, 
Fœgs
, 
boﬁ
 
u£DeÁu…VÆue
){

1829 
IAMCamîaC⁄åﬁ
 *
pIAMCamîaC⁄åﬁ
;

1830 if(
	`isDevi˚Sëup
(
devi˚ID
))

1832 
HRESULT
 
hr
;

1833 
hr
 = 
	`gëDevi˚
(&
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
, devi˚ID, VDLi°[devi˚ID]->
wDevi˚Name
, VDLi°[devi˚ID]->
nDevi˚Name
);

1835 
¥›Så
[16];

1836 
	`gëCamîaPr›îtyAsSåög
(
Pr›îty
,
¥›Så
);

1838 
	`DebugPrötOut
("Sëtög videÿ£âög %s.\n", 
¥›Så
);

1839 
hr
 = 
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
->
	`QuîyI¡îÁ˚
(
IID_IAMCamîaC⁄åﬁ
, (**)&
pIAMCamîaC⁄åﬁ
);

1840 i‡(
	`FAILED
(
hr
)) {

1841 
	`DebugPrötOut
("Error\n");

1842 if(
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
)VDLi°[devi˚ID]->pVideoI≈utFûãr->
	`Rñó£
();

1843 if(
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
)VDLi°[devi˚ID]->pVideoI≈utFûã∏
NULL
;

1844  
Ál£
;

1848 
CuºVÆ
, 
Mö
, 
Max
, 
SãµögDñè
, 
DeÁu…
, 
C≠sFœgs
, 
AvaûabÀC≠sFœgs
;

1849 
pIAMCamîaC⁄åﬁ
->
	`GëR™ge
(
Pr›îty
, &
Mö
, &
Max
, &
SãµögDñè
, &
DeÁu…
, &
AvaûabÀC≠sFœgs
);

1850 
	`DebugPrötOut
("R™gêf‹ videÿ£âög %s: Mö:%ld Max:%ld SãµögDñè:%ld DeÁu…:%ld Fœgs:%ld\n", 
¥›Så
, 
Mö
, 
Max
, 
SãµögDñè
, 
DeÁu…
, 
AvaûabÀC≠sFœgs
);

1851 
pIAMCamîaC⁄åﬁ
->
	`Gë
(
Pr›îty
, &
CuºVÆ
, &
C≠sFœgs
);

1852 
	`DebugPrötOut
("CuºíàvÆue: %ld Fœg†%ld (%s)\n", 
CuºVÆ
, 
C≠sFœgs
, (CapsFlags == 1 ? "Auto" : (CapsFlags == 2 ? "Manual" : "Unknown")));

1853 i‡(
u£DeÁu…VÆue
) {

1854 
pIAMCamîaC⁄åﬁ
->
	`Së
(
Pr›îty
, 
DeÁu…
, 
CamîaC⁄åﬁ_Fœgs_Auto
);

1859 
pIAMCamîaC⁄åﬁ
->
	`Së
(
Pr›îty
, 
lVÆue
, 
Fœgs
);

1861 
pIAMCamîaC⁄åﬁ
->
	`Rñó£
();

1862 if(
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
)VDLi°[devi˚ID]->pVideoI≈utFûãr->
	`Rñó£
();

1863 if(
VDLi°
[
devi˚ID
]->
pVideoI≈utFûãr
)VDLi°[devi˚ID]->pVideoI≈utFûã∏
NULL
;

1864  
åue
;

1867  
Ál£
;

1868 
	}
}

1872 
boﬁ
 
	gvideoI≈ut
::
	$gëVideoSëtögCamîa
(
devi˚ID
, 
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
cuºítVÆue
, &
Êags
, &
deÁu…VÆue
){

1873 if–!
	`isDevi˚Sëup
(
devi˚ID
Ë) 
Ál£
;

1875 
HRESULT
 
hr
;

1878 
videoDevi˚
 * 
VD
 = 
VDLi°
[
devi˚ID
];

1880 
hr
 = 
	`gëDevi˚
(&
VD
->
pVideoI≈utFûãr
, 
devi˚ID
, VD->
wDevi˚Name
, VD->
nDevi˚Name
);

1881 i‡(
	`FAILED
(
hr
)){

1882 
	`DebugPrötOut
("setVideoSetting - getDevice Error\n");

1883  
Ál£
;

1886 
IAMCamîaC⁄åﬁ
 *
pIAMCamîaC⁄åﬁ
 = 
NULL
;

1888 
hr
 = 
VD
->
pVideoI≈utFûãr
->
	`QuîyI¡îÁ˚
(
IID_IAMCamîaC⁄åﬁ
, (**)&
pIAMCamîaC⁄åﬁ
);

1889 if(
	`FAILED
(
hr
)){

1890 
	`DebugPrötOut
("setVideoSetting - QueryInterface Error\n");

1891 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1892 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1893  
Ál£
;

1896 
¥›Så
[16];

1897 
	`gëCamîaPr›îtyAsSåög
(
Pr›îty
,
¥›Så
);

1898 
	`DebugPrötOut
("Sëtög videÿ£âög %s.\n", 
¥›Så
);

1900 
pIAMCamîaC⁄åﬁ
->
	`GëR™ge
(
Pr›îty
, &
mö
, &
max
, &
SãµögDñè
, &
deÁu…VÆue
, &
Êags
);

1901 
	`DebugPrötOut
("R™gêf‹ videÿ£âög %s: Mö:%ld Max:%ld SãµögDñè:%ld DeÁu…:%ld Fœgs:%ld\n", 
¥›Så
, 
mö
, 
max
, 
SãµögDñè
, 
deÁu…VÆue
, 
Êags
);

1902 
pIAMCamîaC⁄åﬁ
->
	`Gë
(
Pr›îty
, &
cuºítVÆue
, &
Êags
);

1904 if(
pIAMCamîaC⁄åﬁ
ÌIAMCamîaC⁄åﬁ->
	`Rñó£
();

1905 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûãr->
	`Rñó£
();

1906 if(
VD
->
pVideoI≈utFûãr
)VD->pVideoI≈utFûã∏
NULL
;

1908  
åue
;

1910 
	}
}

1918 
	gvideoI≈ut
::
	$°›Devi˚
(
id
){

1919 if(
id
 < 
VI_MAX_CAMERAS
)

1921 
dñëe
 
VDLi°
[
id
];

1922 
VDLi°
[
id
] = 
√w
 
	`videoDevi˚
();

1925 
	}
}

1932 
boﬁ
 
	gvideoI≈ut
::
	$ª°¨tDevi˚
(
id
){

1933 if(
	`isDevi˚Sëup
(
id
))

1935 
c⁄n
 = 
VDLi°
[
id
]->
°‹eC⁄n
;

1936 
tmpW
 = 
VDLi°
[
id
]->
width
;

1937 
tmpH
 = 
VDLi°
[
id
]->
height
;

1939 
boﬁ
 
bF‹m©
 = 
VDLi°
[
id
]->
•ecificF‹m©
;

1940 
f‹m©
 = 
VDLi°
[
id
]->
f‹m©Ty≥
;

1942 
nRec⁄√˘
 = 
VDLi°
[
id
]->
nFømesF‹Rec⁄√˘
;

1943 
boﬁ
 
bRec⁄√˘
 = 
VDLi°
[
id
]->
autoRec⁄√˘
;

1945 
avgFømeTime
 = 
VDLi°
[
id
]->
ªque°edFømeTime
;

1947 
	`°›Devi˚
(
id
);

1950 if–
avgFømeTime
 != ()-1){

1951 
VDLi°
[
id
]->
ªque°edFømeTime
 = 
avgFømeTime
;

1954 if–
	`£tupDevi˚
(
id
, 
tmpW
, 
tmpH
, 
c⁄n
) ){

1956 if–
bF‹m©
 ){

1957 
	`£tF‹m©
(
id
, 
f‹m©
);

1959 if–
bRec⁄√˘
 ){

1960 
	`£tAutoRec⁄√˘OnFªeze
(
id
, 
åue
, 
nRec⁄√˘
);

1962  
åue
;

1965  
Ál£
;

1966 
	}
}

1972 
	gvideoI≈ut
::~
	$videoI≈ut
(){

1974 
i
 = 0; i < 
VI_MAX_CAMERAS
; i++)

1976 
dñëe
 
VDLi°
[
i
];

1979 
	`comUnInô
();

1980 
	}
}

1992 
boﬁ
 
	gvideoI≈ut
::
	$comInô
(){

2014  
åue
;

2015 
	}
}

2023 
boﬁ
 
	gvideoI≈ut
::
	$comUnInô
(){

2032  
åue
;

2033 
	}
}

2041 
	gvideoI≈ut
::
	$£tAâem±C≠tuªSize
(
id
, 
w
, 
h
,
GUID
 
medüTy≥
){

2043 
VDLi°
[
id
]->
åyWidth
 = 
w
;

2044 
VDLi°
[
id
]->
åyHeight
 = 
h
;

2045 
VDLi°
[
id
]->
åyDiffSize
 = 
åue
;

2046 
VDLi°
[
id
]->
åyVideoTy≥
 = 
medüTy≥
;

2048 
	}
}

2055 
	gvideoI≈ut
::
	$£tPhyC⁄
(
id
, 
c⁄n
){

2057 
c⁄n
){

2060 
VDLi°
[
id
]->
c⁄√˘i⁄
 = 
PhysC⁄n_Video_Composôe
;

2063 
VDLi°
[
id
]->
c⁄√˘i⁄
 = 
PhysC⁄n_Video_SVideo
;

2066 
VDLi°
[
id
]->
c⁄√˘i⁄
 = 
PhysC⁄n_Video_Tu√r
;

2069 
VDLi°
[
id
]->
c⁄√˘i⁄
 = 
PhysC⁄n_Video_USB
;

2072 
VDLi°
[
id
]->
c⁄√˘i⁄
 = 
PhysC⁄n_Video_1394
;

2079 
VDLi°
[
id
]->
°‹eC⁄n
 = 
c⁄n
;

2080 
VDLi°
[
id
]->
u£Crossb¨
 = 
åue
;

2081 
	}
}

2089 
boﬁ
 
	gvideoI≈ut
::
	$£tup
(
devi˚Numbî
){

2090 
devi˚sFound
 = 
	`gëDevi˚Cou¡
();

2092 if(
devi˚Numbî
>
devi˚sFound
-1)

2094 
	`DebugPrötOut
("SETUP: devi˚[%i]ÇŸ found - you havê%òdevi˚†avaûabÀ\n", 
devi˚Numbî
, 
devi˚sFound
);

2095 if(
devi˚sFound
>=0Ë
	`DebugPrötOut
("SETUP:Åhis meansÅhatÅheÜast device you can use is device[%i]\n", devicesFound-1);

2096  
Ál£
;

2099 if(
VDLi°
[
devi˚Numbî
]->
ªadyToC≠tuª
)

2101 
	`DebugPrötOut
("SETUP: c™'à£tup, devi˚ %òi†cuºíéy beög u£d\n",
VDLi°
[
devi˚Numbî
]->
myID
);

2102  
Ál£
;

2105 
HRESULT
 
hr
 = 
	`°¨t
(
devi˚Numbî
, 
VDLi°
[deviceNumber]);

2106 if(
hr
 =
S_OK
) 
åue
;

2107  
Ál£
;

2108 
	}
}

2116 
	gvideoI≈ut
::
	$¥o˚ssPixñs
(* 
§c
, * 
d°
, 
width
, 
height
, 
boﬁ
 
bRGB
, boﬁ 
bFlù
){

2118 
widthInByãs
 = 
width
 * 3;

2119 
numByãs
 = 
widthInByãs
 * 
height
;

2121 if(!
bRGB
){

2126 if(
bFlù
){

2127 
y
 = 0; y < 
height
; y++){

2128 
	`mem˝y
(
d°
 + (
y
 * 
widthInByãs
), 
§c
 + ( (
height
 -y -1) * widthInBytes), widthInBytes);

2132 
	`mem˝y
(
d°
, 
§c
, 
numByãs
);

2135 if(
bFlù
){

2137 
x
 = 0;

2138 
y
 = (
height
 - 1Ë* 
widthInByãs
;

2139 
§c
 +
y
;

2141 
i
 = 0; i < 
numByãs
; i+=3){

2142 if(
x
 >
width
){

2143 
x
 = 0;

2144 
§c
 -
widthInByãs
*2;

2147 *
d°
 = *(
§c
+2);

2148 
d°
++;

2150 *
d°
 = *(
§c
+1);

2151 
d°
++;

2153 *
d°
 = *
§c
;

2154 
d°
++;

2156 
§c
+=3;

2157 
x
++;

2161 
i
 = 0; i < 
numByãs
; i+=3){

2162 *
d°
 = *(
§c
+2);

2163 
d°
++;

2165 *
d°
 = *(
§c
+1);

2166 
d°
++;

2168 *
d°
 = *
§c
;

2169 
d°
++;

2171 
§c
+=3;

2175 
	}
}

2179 
	gvideoI≈ut
::
	$gëMedüSubty≥AsSåög
(
GUID
 
ty≥
, * 
ty≥AsSåög
){

2181 
tmpSå
[8];

2182 if–
ty≥
 =
MEDIASUBTYPE_RGB24
Ë
	`•rötf
(
tmpSå
, "RGB24");

2183 if(
ty≥
 =
MEDIASUBTYPE_RGB32
Ë
	`•rötf
(
tmpSå
, "RGB32");

2184 if(
ty≥
 =
MEDIASUBTYPE_RGB555
)
	`•rötf
(
tmpSå
, "RGB555");

2185 if(
ty≥
 =
MEDIASUBTYPE_RGB565
)
	`•rötf
(
tmpSå
, "RGB565");

2186 if(
ty≥
 =
MEDIASUBTYPE_YUY2
Ë
	`•rötf
(
tmpSå
, "YUY2");

2187 if(
ty≥
 =
MEDIASUBTYPE_YVYU
Ë
	`•rötf
(
tmpSå
, "YVYU");

2188 if(
ty≥
 =
MEDIASUBTYPE_YUYV
Ë
	`•rötf
(
tmpSå
, "YUYV");

2189 if(
ty≥
 =
MEDIASUBTYPE_IYUV
Ë
	`•rötf
(
tmpSå
, "IYUV");

2190 if(
ty≥
 =
MEDIASUBTYPE_UYVY
Ë
	`•rötf
(
tmpSå
, "UYVY");

2191 if(
ty≥
 =
MEDIASUBTYPE_YV12
Ë
	`•rötf
(
tmpSå
, "YV12");

2192 if(
ty≥
 =
MEDIASUBTYPE_YVU9
Ë
	`•rötf
(
tmpSå
, "YVU9");

2193 if(
ty≥
 =
MEDIASUBTYPE_Y411
Ë
	`•rötf
(
tmpSå
, "Y411");

2194 if(
ty≥
 =
MEDIASUBTYPE_Y41P
Ë
	`•rötf
(
tmpSå
, "Y41P");

2195 if(
ty≥
 =
MEDIASUBTYPE_Y211
Ë
	`•rötf
(
tmpSå
, "Y211");

2196 if(
ty≥
 =
MEDIASUBTYPE_AYUV
Ë
	`•rötf
(
tmpSå
, "AYUV");

2197 if(
ty≥
 =
MEDIASUBTYPE_MJPG
Ë
	`•rötf
(
tmpSå
, "MJPG");

2198 if(
ty≥
 =
MEDIASUBTYPE_Y800
Ë
	`•rötf
(
tmpSå
, "Y800");

2199 if(
ty≥
 =
MEDIASUBTYPE_Y8
Ë
	`•rötf
(
tmpSå
, "Y8");

2200 if(
ty≥
 =
MEDIASUBTYPE_GREY
Ë
	`•rötf
(
tmpSå
, "GREY");

2201 if(
ty≥
 =
MEDIASUBTYPE_I420
Ë
	`•rötf
(
tmpSå
, "I420");

2202 
	`•rötf
(
tmpSå
, "OTHER");

2204 
	`mem˝y
(
ty≥AsSåög
, 
tmpSå
, ()*8);

2205 
	}
}

2207 
	gvideoI≈ut
::
	$gëFourccFromMedüSubty≥
(
GUID
 
ty≥
) const

2209  
ty≥
.
D©a1
;

2210 
	}
}

2212 
GUID
 *
	gvideoI≈ut
::
	$gëMedüSubty≥FromFourcc
(
fourcc
){

2214 
i
=0;i<
VI_NUM_TYPES
;i++) {

2215 i‡–()()
fourcc
 =
medüSubty≥s
[
i
].
D©a1
 ) {

2216  &
medüSubty≥s
[
i
];

2220  
NULL
;

2221 
	}
}

2224 
	gvideoI≈ut
::
	$gëVideoPr›îtyAsSåög
(
¥›
, * 
¥›îtyAsSåög
){

2226 
tmpSå
[16];

2228 i‡–
¥›
==
VideoProcAmp_Brighäess
Ë
	`•rötf
(
tmpSå
, "Brightness");

2229 i‡–
¥›
==
VideoProcAmp_C⁄åa°
Ë
	`•rötf
(
tmpSå
, "Contrast");

2230 i‡–
¥›
==
VideoProcAmp_S©uøti⁄
Ë
	`•rötf
(
tmpSå
, "Saturation");

2231 i‡–
¥›
==
VideoProcAmp_Hue
Ë
	`•rötf
(
tmpSå
, "Hue");

2232 i‡–
¥›
==
VideoProcAmp_Gaö
Ë
	`•rötf
(
tmpSå
, "Gain");

2233 i‡–
¥›
==
VideoProcAmp_Gamma
Ë
	`•rötf
(
tmpSå
, "Gamma");

2234 i‡–
¥›
==
VideoProcAmp_Cﬁ‹E«bÀ
Ë
	`•rötf
(
tmpSå
, "ColorEnable");

2235 i‡–
¥›
==
VideoProcAmp_Sh¨≤ess
Ë
	`•rötf
(
tmpSå
, "Sharpness");

2236 
	`•rötf
(
tmpSå
, "%u",
¥›
);

2238 
	`mem˝y
(
¥›îtyAsSåög
, 
tmpSå
, ()*16);

2239 
	}
}

2242 
	gvideoI≈ut
::
	$gëVideoPr›îtyFromCV
(
cv_¥›îty
){

2245 
cv_¥›îty
) {

2246 
CV_CAP_PROP_BRIGHTNESS
:

2247  
VideoProcAmp_Brighäess
;

2249 
CV_CAP_PROP_CONTRAST
:

2250  
VideoProcAmp_C⁄åa°
;

2252 
CV_CAP_PROP_HUE
:

2253  
VideoProcAmp_Hue
;

2255 
CV_CAP_PROP_SATURATION
:

2256  
VideoProcAmp_S©uøti⁄
;

2258 
CV_CAP_PROP_SHARPNESS
:

2259  
VideoProcAmp_Sh¨≤ess
;

2261 
CV_CAP_PROP_GAMMA
:

2262  
VideoProcAmp_Gamma
;

2264 
CV_CAP_PROP_MONOCHROME
:

2265  
VideoProcAmp_Cﬁ‹E«bÀ
;

2267 
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
:

2268  
VideoProcAmp_WhôeBÆ™˚
;

2270 
CV_CAP_PROP_BACKLIGHT
:

2271  
VideoProcAmp_BacklightCom≥nßti⁄
;

2273 
CV_CAP_PROP_GAIN
:

2274  
VideoProcAmp_Gaö
;

2277 
	}
}

2279 
	gvideoI≈ut
::
	$gëCamîaPr›îtyFromCV
(
cv_¥›îty
){

2282 
cv_¥›îty
) {

2283 
CV_CAP_PROP_PAN
:

2284  
CamîaC⁄åﬁ_P™
;

2286 
CV_CAP_PROP_TILT
:

2287  
CamîaC⁄åﬁ_Tût
;

2289 
CV_CAP_PROP_ROLL
:

2290  
CamîaC⁄åﬁ_Rﬁl
;

2292 
CV_CAP_PROP_ZOOM
:

2293  
CamîaC⁄åﬁ_Zoom
;

2295 
CV_CAP_PROP_EXPOSURE
:

2296  
CamîaC⁄åﬁ_Exposuª
;

2298 
CV_CAP_PROP_IRIS
:

2299  
CamîaC⁄åﬁ_Iris
;

2301 
CV_CAP_PROP_FOCUS
:

2302  
CamîaC⁄åﬁ_Focus
;

2305 
	}
}

2307 
	gvideoI≈ut
::
	$gëCamîaPr›îtyAsSåög
(
¥›
, * 
¥›îtyAsSåög
){

2309 
tmpSå
[16];

2311 i‡–
¥›
==
CamîaC⁄åﬁ_P™
Ë
	`•rötf
(
tmpSå
, "Pan");

2312 i‡–
¥›
==
CamîaC⁄åﬁ_Tût
Ë
	`•rötf
(
tmpSå
, "Tilt");

2313 i‡–
¥›
==
CamîaC⁄åﬁ_Rﬁl
Ë
	`•rötf
(
tmpSå
, "Roll");

2314 i‡–
¥›
==
CamîaC⁄åﬁ_Zoom
Ë
	`•rötf
(
tmpSå
, "Zoom");

2315 i‡–
¥›
==
CamîaC⁄åﬁ_Exposuª
Ë
	`•rötf
(
tmpSå
, "Exposure");

2316 i‡–
¥›
==
CamîaC⁄åﬁ_Iris
Ë
	`•rötf
(
tmpSå
, "Iris");

2317 i‡–
¥›
==
CamîaC⁄åﬁ_Focus
Ë
	`•rötf
(
tmpSå
, "Focus");

2318 
	`•rötf
(
tmpSå
, "%u",
¥›
);

2320 
	`mem˝y
(
¥›îtyAsSåög
, 
tmpSå
, ()*16);

2321 
	}
}

2325 
	$födClo£°SizeAndSubty≥
(
videoDevi˚
 * 
VD
, 
widthIn
, 
heightIn
, &
widthOut
, &
heightOut
, 
GUID
 & 
medüty≥Out
){

2326 
HRESULT
 
hr
;

2329 
√¨W
 = 9999999;

2330 
√¨H
 = 9999999;

2333 
iCou¡
 = 0;

2334 
iSize
 = 0;

2335 
hr
 = 
VD
->
°ªamC⁄f
->
	`GëNumbîOfC≠abûôõs
(&
iCou¡
, &
iSize
);

2337 i‡(
iSize
 =(
VIDEO_STREAM_CONFIG_CAPS
))

2340 
iF‹m©
 = 0; iF‹m© < 
iCou¡
; iFormat++)

2342 
VIDEO_STREAM_CONFIG_CAPS
 
scc
;

2343 
AM_MEDIA_TYPE
 *
pmtC⁄fig
;

2344 
hr
 = 
VD
->
°ªamC⁄f
->
	`GëSåómC≠s
(
iF‹m©
, &
pmtC⁄fig
, (
BYTE
*)&
scc
);

2346 i‡(
	`SUCCEEDED
(
hr
)){

2349 
°ïX
 = 
scc
.
OuçutGønuœrôyX
;

2350 
°ïY
 = 
scc
.
OuçutGønuœrôyY
;

2352 
ãmpW
 = 999999;

2353 
ãmpH
 = 999999;

2356 if(
°ïX
 < 1 || 
°ïY
 < 1) ;

2361 
boﬁ
 
exa˘M©ch
 = 
Ál£
;

2362 
boﬁ
 
exa˘M©chX
 = 
Ál£
;

2363 
boﬁ
 
exa˘M©chY
 = 
Ál£
;

2365 
x
 = 
scc
.
MöOuçutSize
.
cx
; x <scc.
MaxOuçutSize
.cx; x+
°ïX
){

2367 if–
widthIn
 =
x
 ){

2368 
exa˘M©chX
 = 
åue
;

2369 
ãmpW
 = 
x
;

2372 if–
	`abs
(
widthIn
-
x
Ë<ábs(widthIn-
ãmpW
) ){

2373 
ãmpW
 = 
x
;

2377 
y
 = 
scc
.
MöOuçutSize
.
cy
; y <scc.
MaxOuçutSize
.cy; y+
°ïY
){

2379 if–
heightIn
 =
y
){

2380 
exa˘M©chY
 = 
åue
;

2381 
ãmpH
 = 
y
;

2384 if–
	`abs
(
heightIn
-
y
Ë<ábs(heightIn-
ãmpH
) ){

2385 
ãmpH
 = 
y
;

2390 if(
exa˘M©chX
 && 
exa˘M©chY
){

2392 
exa˘M©ch
 = 
åue
;

2394 
widthOut
 = 
widthIn
;

2395 
heightOut
 = 
heightIn
;

2396 
medüty≥Out
 = 
pmtC⁄fig
->
subty≥
;

2402 if–
	`abs
(
widthIn
 - 
ãmpW
Ë+ábs(
heightIn
 - 
ãmpH
Ë<ábs(widthI¿- 
√¨W
Ë+ábs(heightI¿- 
√¨H
) )

2404 
√¨W
 = 
ãmpW
;

2405 
√¨H
 = 
ãmpH
;

2407 
widthOut
 = 
√¨W
;

2408 
heightOut
 = 
√¨H
;

2409 
medüty≥Out
 = 
pmtC⁄fig
->
subty≥
;

2412 
	`MyDñëeMedüTy≥
(
pmtC⁄fig
);

2415 if(
exa˘M©ch
);

2420 
	}
}

2424 
boﬁ
 
	$£tSizeAndSubty≥
(
videoDevi˚
 * 
VD
, 
©ãm±Width
, 
©ãm±Height
, 
GUID
 
medüty≥
){

2425 
VIDEOINFOHEADER
 *
pVih
 = 
ªöãΩªt_ˇ°
<VIDEOINFOHEADER*>(
VD
->
pAmMedüTy≥
->
pbF‹m©
);

2430 
AM_MEDIA_TYPE
 * 
tmpTy≥
 = 
NULL
;

2432 
HRESULT
 
hr
 = 
VD
->
°ªamC⁄f
->
	`GëF‹m©
(&
tmpTy≥
);

2433 if(
hr
 !
S_OK
) 
Ál£
;

2437 
	`HEADER
(
pVih
)->
biWidth
 = 
©ãm±Width
;

2438 
	`HEADER
(
pVih
)->
biHeight
 = 
©ãm±Height
;

2440 
VD
->
pAmMedüTy≥
->
f‹m©ty≥
 = 
FORMAT_VideoInfo
;

2441 
VD
->
pAmMedüTy≥
->
maj‹ty≥
 = 
MEDIATYPE_Video
;

2442 
VD
->
pAmMedüTy≥
->
subty≥
 = 
medüty≥
;

2445 i‡(
medüty≥
 =
MEDIASUBTYPE_RGB24
)

2447 
VD
->
pAmMedüTy≥
->
lSam∂eSize
 = 
©ãm±Width
*
©ãm±Height
*3;

2452 
VD
->
pAmMedüTy≥
->
lSam∂eSize
 = 0;

2456 if–
VD
->
ªque°edFømeTime
 != -1){

2457 
pVih
->
AvgTimePîFøme
 = 
VD
->
ªque°edFømeTime
;

2461 
hr
 = 
VD
->
°ªamC⁄f
->
	`SëF‹m©
(VD->
pAmMedüTy≥
);

2462 if(
hr
 =
S_OK
){

2463 if–
tmpTy≥
 !
NULL
 )
	`MyDñëeMedüTy≥
(tmpType);

2464  
åue
;

2466 
VD
->
°ªamC⁄f
->
	`SëF‹m©
(
tmpTy≥
);

2467 if–
tmpTy≥
 !
NULL
 )
	`MyDñëeMedüTy≥
(tmpType);

2470  
Ál£
;

2471 
	}
}

2478 
	gvideoI≈ut
::
	$°¨t
(
devi˚ID
, 
videoDevi˚
 *
VD
){

2480 
HRESULT
 
hr
 = 
NOERROR
;

2481 
VD
->
myID
 = 
devi˚ID
;

2482 
VD
->
£tupSèπed
 = 
åue
;

2483 
CAPTURE_MODE
 = 
PIN_CATEGORY_CAPTURE
;

2484 
ˇŒbackSëCou¡
 = 1;

2486 
	`DebugPrötOut
("SETUP: Sëtög u∞devi˚ %i\n",
devi˚ID
);

2490 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_C≠tuªGøphBuûdî2
, 
NULL
, 
CLSCTX_INPROC_SERVER
, 
IID_IC≠tuªGøphBuûdî2
, (**)&
VD
->
pC≠tuªGøph
);

2491 i‡(
	`FAILED
(
hr
))

2493 
	`DebugPrötOut
("ERROR - CouldÇot createÅhe Filter Graph Manager\n");

2494  
hr
;

2499 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_FûãrGøph
, 0, 
CLSCTX_INPROC_SERVER
,
IID_IGøphBuûdî
, (**)&
VD
->
pGøph
);

2500 i‡(
	`FAILED
(
hr
))

2502 
	`DebugPrötOut
("ERROR - CouldÇotáddÅhe graph builder!\n");

2503 
	`°›Devi˚
(
devi˚ID
);

2504  
hr
;

2508 
hr
 = 
VD
->
pC≠tuªGøph
->
	`SëFûãrgøph
(VD->
pGøph
);

2509 i‡(
	`FAILED
(
hr
))

2511 
	`DebugPrötOut
("ERROR - CouldÇot set filtergraph\n");

2512 
	`°›Devi˚
(
devi˚ID
);

2513  
hr
;

2519 
hr
 = 
VD
->
pGøph
->
	`QuîyI¡îÁ˚
(
IID_IMedüC⁄åﬁ
, (**)&VD->
pC⁄åﬁ
);

2520 i‡(
	`FAILED
(
hr
))

2522 
	`DebugPrötOut
("ERROR - CouldÇot createÅhe Media Control object\n");

2523 
	`°›Devi˚
(
devi˚ID
);

2524  
hr
;

2530 
hr
 = 
	`gëDevi˚
(&
VD
->
pVideoI≈utFûãr
, 
devi˚ID
, VD->
wDevi˚Name
, VD->
nDevi˚Name
);

2532 i‡(
	`SUCCEEDED
(
hr
)){

2533 
	`DebugPrötOut
("SETUP: %s\n", 
VD
->
nDevi˚Name
);

2534 
hr
 = 
VD
->
pGøph
->
	`AddFûãr
(VD->
pVideoI≈utFûãr
, VD->
wDevi˚Name
);

2536 
	`DebugPrötOut
("ERROR - CouldÇot find specified video device\n");

2537 
	`°›Devi˚
(
devi˚ID
);

2538  
hr
;

2542 
IAMSåómC⁄fig
 *
°ªamC⁄fTe°
 = 
NULL
;

2543 
hr
 = 
VD
->
pC≠tuªGøph
->
	`FödI¡îÁ˚
(&
PIN_CATEGORY_PREVIEW
, &
MEDIATYPE_Video
, VD->
pVideoI≈utFûãr
, 
IID_IAMSåómC⁄fig
, (**)&
°ªamC⁄fTe°
);

2544 if(
	`FAILED
(
hr
)){

2545 
	`DebugPrötOut
("SETUP: Couldn't findÖreviewÖin using SmartTee\n");

2547 
CAPTURE_MODE
 = 
PIN_CATEGORY_PREVIEW
;

2548 
°ªamC⁄fTe°
->
	`Rñó£
();

2549 
°ªamC⁄fTe°
 = 
NULL
;

2555 if(
VD
->
u£Crossb¨
)

2557 
	`DebugPrötOut
("SETUP: Checking crossbar\n");

2558 
	`rouãCrossb¨
(&
VD
->
pC≠tuªGøph
, &VD->
pVideoI≈utFûãr
, VD->
c⁄√˘i⁄
, 
CAPTURE_MODE
);

2563 
hr
 = 
VD
->
pC≠tuªGøph
->
	`FödI¡îÁ˚
(&
CAPTURE_MODE
, &
MEDIATYPE_Video
, VD->
pVideoI≈utFûãr
, 
IID_IAMSåómC⁄fig
, (**)&VD->
°ªamC⁄f
);

2564 if(
	`FAILED
(
hr
)){

2565 
	`DebugPrötOut
("ERROR: Couldn't configÅhe stream!\n");

2566 
	`°›Devi˚
(
devi˚ID
);

2567  
hr
;

2571 
hr
 = 
VD
->
°ªamC⁄f
->
	`GëF‹m©
(&VD->
pAmMedüTy≥
);

2572 if(
	`FAILED
(
hr
)){

2573 
	`DebugPrötOut
("ERROR: Couldn't getFormat forÖAmMediaType!\n");

2574 
	`°›Devi˚
(
devi˚ID
);

2575  
hr
;

2578 
VIDEOINFOHEADER
 *
pVih
 = 
ªöãΩªt_ˇ°
<VIDEOINFOHEADER*>(
VD
->
pAmMedüTy≥
->
pbF‹m©
);

2579 
cuºítWidth
 = 
	`HEADER
(
pVih
)->
biWidth
;

2580 
cuºítHeight
 = 
	`HEADER
(
pVih
)->
biHeight
;

2582 
boﬁ
 
cu°omSize
 = 
VD
->
åyDiffSize
;

2584 
boﬁ
 
foundSize
 = 
Ál£
;

2586 if(
cu°omSize
){

2587 
	`DebugPrötOut
("SETUP: DeÁu… F‹m© i†£àtÿ%ix%i\n", 
cuºítWidth
, 
cuºítHeight
);

2589 
guidSå
[8];

2591 
	`gëMedüSubty≥AsSåög
(
VD
->
åyVideoTy≥
, 
guidSå
);

2592 
	`DebugPrötOut
("SETUP:Åryög s≥cifõd f‹m© %†@ %ix%i\n", 
guidSå
, 
VD
->
åyWidth
, VD->
åyHeight
);

2594 if–
	`£tSizeAndSubty≥
(
VD
, VD->
åyWidth
, VD->
åyHeight
, VD->
åyVideoTy≥
) ){

2595 
VD
->
	`£tSize
(VD->
åyWidth
, VD->
åyHeight
);

2596 
VD
->
videoTy≥
 = VD->
åyVideoTy≥
;

2597 
foundSize
 = 
åue
;

2600 
i
 = 0; i < 
VI_NUM_TYPES
; i++){

2602 
	`gëMedüSubty≥AsSåög
(
medüSubty≥s
[
i
], 
guidSå
);

2604 
	`DebugPrötOut
("SETUP:Åryög f‹m© %†@ %ix%i\n", 
guidSå
, 
VD
->
åyWidth
, VD->
åyHeight
);

2605 if–
	`£tSizeAndSubty≥
(
VD
, VD->
åyWidth
, VD->
åyHeight
, 
medüSubty≥s
[
i
]) ){

2606 
VD
->
	`£tSize
(VD->
åyWidth
, VD->
åyHeight
);

2607 
VD
->
videoTy≥
 = 
medüSubty≥s
[
i
];

2608 
foundSize
 = 
åue
;

2616 if–
foundSize
 =
Ál£
 ){

2617 
	`DebugPrötOut
("SETUP: couldn't findÑequested size - searching for closest matching size\n");

2619 
˛o£°Width
 = -1;

2620 
˛o£°Height
 = -1;

2621 
GUID
 
√wMedüSubty≥
;

2623 
	`födClo£°SizeAndSubty≥
(
VD
, VD->
åyWidth
, VD->
åyHeight
, 
˛o£°Width
, 
˛o£°Height
, 
√wMedüSubty≥
);

2625 if–
˛o£°Width
 !-1 && 
˛o£°Height
 != -1){

2626 
	`gëMedüSubty≥AsSåög
(
√wMedüSubty≥
, 
guidSå
);

2628 
	`DebugPrötOut
("SETUP: clo£° suµ‹ãd sizêi†%†@ %ò%i\n", 
guidSå
, 
˛o£°Width
, 
˛o£°Height
);

2629 if–
	`£tSizeAndSubty≥
(
VD
, 
˛o£°Width
, 
˛o£°Height
, 
√wMedüSubty≥
) ){

2630 
VD
->
	`£tSize
(
˛o£°Width
, 
˛o£°Height
);

2631 
foundSize
 = 
åue
;

2638 if(
cu°omSize
 =
Ál£
 || 
foundSize
 == false){

2639 if–
VD
->
ªque°edFømeTime
 != -1 ){

2640 
pVih
->
AvgTimePîFøme
 = 
VD
->
ªque°edFømeTime
;

2641 
hr
 = 
VD
->
°ªamC⁄f
->
	`SëF‹m©
(VD->
pAmMedüTy≥
);

2643 
VD
->
	`£tSize
(
cuºítWidth
, 
cuºítHeight
);

2648 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_Sam∂eGøbbî
, 
NULL
, 
CLSCTX_INPROC_SERVER
,
IID_IBa£Fûãr
, (**)&
VD
->
pGøbbîF
);

2649 i‡(
	`FAILED
(
hr
)){

2650 
	`DebugPrötOut
("CouldÇot Create Sample Grabber - CoCreateInstance()\n");

2651 
	`°›Devi˚
(
devi˚ID
);

2652  
hr
;

2655 
hr
 = 
VD
->
pGøph
->
	`AddFûãr
(VD->
pGøbbîF
, 
L
"Sample Grabber");

2656 i‡(
	`FAILED
(
hr
)){

2657 
	`DebugPrötOut
("CouldÇotádd Sample Grabber - AddFilter()\n");

2658 
	`°›Devi˚
(
devi˚ID
);

2659  
hr
;

2662 
hr
 = 
VD
->
pGøbbîF
->
	`QuîyI¡îÁ˚
(
IID_ISam∂eGøbbî
, (**)&VD->
pGøbbî
);

2663 i‡(
	`FAILED
(
hr
)){

2664 
	`DebugPrötOut
("ERROR: CouldÇot query SampleGrabber\n");

2665 
	`°›Devi˚
(
devi˚ID
);

2666  
hr
;

2671 
hr
 = 
VD
->
pGøbbî
->
	`SëO√ShŸ
(
FALSE
);

2672 if(
bCÆlback
){

2673 
hr
 = 
VD
->
pGøbbî
->
	`SëBuf„rSam∂es
(
FALSE
);

2675 
hr
 = 
VD
->
pGøbbî
->
	`SëBuf„rSam∂es
(
TRUE
);

2678 if(
bCÆlback
){

2681 
hr
 = 
VD
->
pGøbbî
->
	`SëCÆlback
(VD->
sgCÆlback
, 0);

2682 i‡(
	`FAILED
(
hr
)){

2683 
	`DebugPrötOut
("ERROR:Öroblem setting callback\n");

2684 
	`°›Devi˚
(
devi˚ID
);

2685  
hr
;

2687 
	`DebugPrötOut
("SETUP: Capture callback set\n");

2694 
AM_MEDIA_TYPE
 
mt
;

2695 
	`ZîoMem‹y
(&
mt
,(
AM_MEDIA_TYPE
));

2697 
mt
.
maj‹ty≥
 = 
MEDIATYPE_Video
;

2698 
mt
.
subty≥
 = 
MEDIASUBTYPE_RGB24
;

2699 
mt
.
f‹m©ty≥
 = 
FORMAT_VideoInfo
;

2702 
hr
 = 
VD
->
pGøbbî
->
	`SëMedüTy≥
(&
mt
);

2706 if(
VD
->
°ªamC⁄f
){

2707 
VD
->
°ªamC⁄f
->
	`Rñó£
();

2708 
VD
->
°ªamC⁄f
 = 
NULL
;

2710 
	`DebugPrötOut
("ERROR: connecting device -Örehaps it isálready being used?\n");

2711 
	`°›Devi˚
(
devi˚ID
);

2712  
S_FALSE
;

2718 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_NuŒRídîî
, 
NULL
, 
CLSCTX_INPROC_SERVER
, 
IID_IBa£Fûãr
, (**)(&
VD
->
pDe°Fûãr
));

2719 i‡(
	`FAILED
(
hr
)){

2720 
	`DebugPrötOut
("ERROR: CouldÇot create filter - NullRenderer\n");

2721 
	`°›Devi˚
(
devi˚ID
);

2722  
hr
;

2725 
hr
 = 
VD
->
pGøph
->
	`AddFûãr
(VD->
pDe°Fûãr
, 
L
"NullRenderer");

2726 i‡(
	`FAILED
(
hr
)){

2727 
	`DebugPrötOut
("ERROR: CouldÇotádd filter - NullRenderer\n");

2728 
	`°›Devi˚
(
devi˚ID
);

2729  
hr
;

2734 
hr
 = 
VD
->
pC≠tuªGøph
->
	`RídîSåóm
(&
PIN_CATEGORY_PREVIEW
, &
MEDIATYPE_Video
, VD->
pVideoI≈utFûãr
, VD->
pGøbbîF
, VD->
pDe°Fûãr
);

2736 i‡(
	`FAILED
(
hr
)){

2737 
	`DebugPrötOut
("ERROR: CouldÇot connectÖins - RenderStream()\n");

2738 
	`°›Devi˚
(
devi˚ID
);

2739  
hr
;

2745 
IMedüFûãr
 *
pMedüFûãr
 = 0;

2746 
hr
 = 
VD
->
pGøph
->
	`QuîyI¡îÁ˚
(
IID_IMedüFûãr
, (**)&
pMedüFûãr
);

2747 i‡(
	`FAILED
(
hr
)){

2748 
	`DebugPrötOut
("ERROR: CouldÇot get IID_IMediaFilter interface\n");

2750 
pMedüFûãr
->
	`SëSyncSour˚
(
NULL
);

2751 
pMedüFûãr
->
	`Rñó£
();

2757 
hr
 = 
VD
->
pC⁄åﬁ
->
	`Run
();

2759 i‡(
	`FAILED
(
hr
)){

2760 
	`DebugPrötOut
("ERROR: CouldÇot start graph\n");

2761 
	`°›Devi˚
(
devi˚ID
);

2762  
hr
;

2767 if(!
bCÆlback
){

2769 
buf„rSize
 = 
VD
->
videoSize
;

2771  
hr
 !
S_OK
){

2772 
hr
 = 
VD
->
pGøbbî
->
	`GëCuºítBuf„r
(&
buf„rSize
, (*)VD->
pBuf„r
);

2773 
	`SÀï
(10);

2778 
	`DebugPrötOut
("SETUP: Device is setupándÑeadyÅo capture.\n\n");

2779 
VD
->
ªadyToC≠tuª
 = 
åue
;

2787 
VD
->
pVideoI≈utFûãr
->
	`Rñó£
();

2788 
VD
->
pVideoI≈utFûãr
 = 
NULL
;

2790 
VD
->
pGøbbîF
->
	`Rñó£
();

2791 
VD
->
pGøbbîF
 = 
NULL
;

2793 
VD
->
pDe°Fûãr
->
	`Rñó£
();

2794 
VD
->
pDe°Fûãr
 = 
NULL
;

2796  
S_OK
;

2797 
	}
}

2805 
	gvideoI≈ut
::
	$gëDevi˚Cou¡
(){

2808 
ICª©eDevEnum
 *
pDevEnum
 = 
NULL
;

2809 
IEnumM⁄ikî
 *
pEnum
 = 
NULL
;

2810 
devi˚Cou¡î
 = 0;

2812 
HRESULT
 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_Sy°emDevi˚Enum
, 
NULL
,

2813 
CLSCTX_INPROC_SERVER
, 
IID_ICª©eDevEnum
,

2814 
ªöãΩªt_ˇ°
<**>(&
pDevEnum
));

2817 i‡(
	`SUCCEEDED
(
hr
))

2820 
hr
 = 
pDevEnum
->
	`Cª©eCœssEnumî©‹
(

2821 
CLSID_VideoI≈utDevi˚C©eg‹y
,

2822 &
pEnum
, 0);

2824 if(
hr
 =
S_OK
){

2825 
IM⁄ikî
 *
pM⁄ikî
 = 
NULL
;

2826 
pEnum
->
	`Next
(1, &
pM⁄ikî
, 
NULL
Ë=
S_OK
){

2828 
IPr›îtyBag
 *
pPr›Bag
;

2829 
hr
 = 
pM⁄ikî
->
	`BödToSt‹age
(0, 0, 
IID_IPr›îtyBag
,

2830 (**)(&
pPr›Bag
));

2832 i‡(
	`FAILED
(
hr
)){

2833 
pM⁄ikî
->
	`Rñó£
();

2837 
pPr›Bag
->
	`Rñó£
();

2838 
pPr›Bag
 = 
NULL
;

2840 
pM⁄ikî
->
	`Rñó£
();

2841 
pM⁄ikî
 = 
NULL
;

2843 
devi˚Cou¡î
++;

2846 
pEnum
->
	`Rñó£
();

2847 
pEnum
 = 
NULL
;

2850 
pDevEnum
->
	`Rñó£
();

2851 
pDevEnum
 = 
NULL
;

2853  
devi˚Cou¡î
;

2854 
	}
}

2864 
HRESULT
 
	gvideoI≈ut
::
	$gëDevi˚
(
IBa£Fûãr
** 
gŸèFûãr
, 
devi˚Id
, 
WCHAR
 * 
wDevi˚Name
, * 
nDevi˚Name
){

2865 
BOOL
 
d⁄e
 = 
Ál£
;

2866 
devi˚Cou¡î
 = 0;

2869 
ICª©eDevEnum
 *
pSysDevEnum
 = 
NULL
;

2870 
HRESULT
 
hr
 = 
	`CoCª©eIn°™˚
(
CLSID_Sy°emDevi˚Enum
, 
NULL
, 
CLSCTX_INPROC_SERVER
, 
IID_ICª©eDevEnum
, (**)&
pSysDevEnum
);

2871 i‡(
	`FAILED
(
hr
))

2873  
hr
;

2877 
IEnumM⁄ikî
 *
pEnumC©
 = 
NULL
;

2878 
hr
 = 
pSysDevEnum
->
	`Cª©eCœssEnumî©‹
(
CLSID_VideoI≈utDevi˚C©eg‹y
, &
pEnumC©
, 0);

2880 i‡(
hr
 =
S_OK
)

2883 
IM⁄ikî
 *
pM⁄ikî
 = 
NULL
;

2884 
ULONG
 
cFëched
;

2885 (
pEnumC©
->
	`Next
(1, &
pM⁄ikî
, &
cFëched
Ë=
S_OK
Ë&& (!
d⁄e
))

2887 if(
devi˚Cou¡î
 =
devi˚Id
)

2890 
IPr›îtyBag
 *
pPr›Bag
;

2891 
hr
 = 
pM⁄ikî
->
	`BödToSt‹age
(0, 0, 
IID_IPr›îtyBag
, (**)&
pPr›Bag
);

2892 i‡(
	`SUCCEEDED
(
hr
))

2895 
VARIANT
 
v¨Name
;

2896 
	`V¨ü¡Inô
(&
v¨Name
);

2897 
hr
 = 
pPr›Bag
->
	`Ród
(
L
"FrõndlyName", &
v¨Name
, 0);

2898 i‡(
	`SUCCEEDED
(
hr
))

2902 
cou¡
 = 0;

2903  
v¨Name
.
b°rVÆ
[
cou¡
] != 0x00 ) {

2904 
wDevi˚Name
[
cou¡
] = 
v¨Name
.
b°rVÆ
[count];

2905 
nDevi˚Name
[
cou¡
] = ()
v¨Name
.
b°rVÆ
[count];

2906 
cou¡
++;

2910 
hr
 = 
pM⁄ikî
->
	`BödToObje˘
(
NULL
, NULL, 
IID_IBa£Fûãr
, (**)
gŸèFûãr
);

2911 
d⁄e
 = 
åue
;

2913 
	`V¨ü¡CÀ¨
(&
v¨Name
);

2914 
pPr›Bag
->
	`Rñó£
();

2915 
pPr›Bag
 = 
NULL
;

2916 
pM⁄ikî
->
	`Rñó£
();

2917 
pM⁄ikî
 = 
NULL
;

2920 
devi˚Cou¡î
++;

2922 
pEnumC©
->
	`Rñó£
();

2923 
pEnumC©
 = 
NULL
;

2925 
pSysDevEnum
->
	`Rñó£
();

2926 
pSysDevEnum
 = 
NULL
;

2928 i‡(
d⁄e
) {

2929  
hr
;

2931  
VFW_E_NOT_FOUND
;

2933 
	}
}

2941 
HRESULT
 
	gvideoI≈ut
::
	$ShowFûãrPr›îtyPages
(
IBa£Fûãr
 *
pFûãr
){

2943 
IS≥cifyPr›îtyPages
 *
pPr›
;

2945 
HRESULT
 
hr
 = 
pFûãr
->
	`QuîyI¡îÁ˚
(
IID_IS≥cifyPr›îtyPages
, (**)&
pPr›
);

2946 i‡(
	`SUCCEEDED
(
hr
))

2949 
FILTER_INFO
 
FûãrInfo
;

2950 
hr
 = 
pFûãr
->
	`QuîyFûãrInfo
(&
FûãrInfo
);

2951 
IUnknown
 *
pFûãrUnk
;

2952 
pFûãr
->
	`QuîyI¡îÁ˚
(
IID_IUnknown
, (**)&
pFûãrUnk
);

2955 
CAUUID
 
ˇGUID
;

2956 
pPr›
->
	`GëPages
(&
ˇGUID
);

2957 
pPr›
->
	`Rñó£
();

2958 
	`OÀCª©ePr›îtyFøme
(

2959 
NULL
,

2961 
FûãrInfo
.
achName
,

2963 &
pFûãrUnk
,

2964 
ˇGUID
.
cEÀms
,

2965 
ˇGUID
.
pEÀms
,

2967 0, 
NULL


2971 if(
pFûãrUnk
ÌFûãrUnk->
	`Rñó£
();

2972 if(
FûãrInfo
.
pGøph
)FûãrInfo.pGøph->
	`Rñó£
();

2973 
	`CoTaskMemFªe
(
ˇGUID
.
pEÀms
);

2975  
hr
;

2976 
	}
}

2978 
HRESULT
 
	gvideoI≈ut
::
	$ShowSåómPr›îtyPages
(
IAMSåómC⁄fig
 * ){

2980 
HRESULT
 
hr
 = 
NOERROR
;

2981  
hr
;

2982 
	}
}

2989 
HRESULT
 
	gvideoI≈ut
::
	$SaveGøphFûe
(
IGøphBuûdî
 *
pGøph
, 
WCHAR
 *
wszP©h
) {

2990 c⁄° 
WCHAR
 
wszSåómName
[] = 
L
"ActiveMovieGraph";

2991 
HRESULT
 
hr
;

2992 
ISt‹age
 *
pSt‹age
 = 
NULL
;

2995 
hr
 = 
	`StgCª©eDocfûe
(

2996 
wszP©h
,

2997 
STGM_CREATE
 | 
STGM_TRANSACTED
 | 
STGM_READWRITE
 | 
STGM_SHARE_EXCLUSIVE
,

2998 0, &
pSt‹age
);

2999 if(
	`FAILED
(
hr
))

3001  
hr
;

3005 
ISåóm
 *
pSåóm
;

3006 
hr
 = 
pSt‹age
->
	`Cª©eSåóm
(

3007 
wszSåómName
,

3008 
STGM_WRITE
 | 
STGM_CREATE
 | 
STGM_SHARE_EXCLUSIVE
,

3009 0, 0, &
pSåóm
);

3010 i‡(
	`FAILED
(
hr
))

3012 
pSt‹age
->
	`Rñó£
();

3013  
hr
;

3017 
IPîsi°Såóm
 *
pPîsi°
 = 
NULL
;

3018 
pGøph
->
	`QuîyI¡îÁ˚
(
IID_IPîsi°Såóm
, 
ªöãΩªt_ˇ°
<**>(&
pPîsi°
));

3019 
hr
 = 
pPîsi°
->
	`Save
(
pSåóm
, 
TRUE
);

3020 
pSåóm
->
	`Rñó£
();

3021 
pPîsi°
->
	`Rñó£
();

3022 i‡(
	`SUCCEEDED
(
hr
))

3024 
hr
 = 
pSt‹age
->
	`Commô
(
STGC_DEFAULT
);

3026 
pSt‹age
->
	`Rñó£
();

3027  
hr
;

3028 
	}
}

3036 
HRESULT
 
	gvideoI≈ut
::
	$rouãCrossb¨
(
IC≠tuªGøphBuûdî2
 **
µBuûd
, 
IBa£Fûãr
 **
pVidInFûãr
, 
c⁄Ty≥
, 
GUID
 
ˇ±uªMode
){

3039 
IC≠tuªGøphBuûdî2
 *
pBuûd
 = 
NULL
;

3040 
pBuûd
 = *
µBuûd
;

3043 
IBa£Fûãr
 *
pVidFûãr
 = 
NULL
;

3044 
pVidFûãr
 = * 
pVidInFûãr
;

3047 
IAMCrossb¨
 *
pXB¨1
 = 
NULL
;

3048 
HRESULT
 
hr
 = 
pBuûd
->
	`FödI¡îÁ˚
(&
LOOK_UPSTREAM_ONLY
, 
NULL
, 
pVidFûãr
,

3049 
IID_IAMCrossb¨
, (**)&
pXB¨1
);

3050 i‡(
	`SUCCEEDED
(
hr
))

3053 
boﬁ
 
foundDevi˚
 = 
Ál£
;

3055 
	`DebugPrötOut
("SETUP: YouáreÇotá webcam! Setting Crossbar\n");

3056 
pXB¨1
->
	`Rñó£
();

3058 
IAMCrossb¨
 *
Crossb¨
;

3059 
hr
 = 
pBuûd
->
	`FödI¡îÁ˚
(&
ˇ±uªMode
, &
MEDIATYPE_I¡îÀaved
, 
pVidFûãr
, 
IID_IAMCrossb¨
, (**)&
Crossb¨
);

3061 if(
hr
 !
NOERROR
){

3062 
hr
 = 
pBuûd
->
	`FödI¡îÁ˚
(&
ˇ±uªMode
, &
MEDIATYPE_Video
, 
pVidFûãr
, 
IID_IAMCrossb¨
, (**)&
Crossb¨
);

3065 
LONG
 
lI≈ö
, 
lOuçö
;

3066 
hr
 = 
Crossb¨
->
	`gë_PöCou¡s
(&
lOuçö
 , &
lI≈ö
);

3068 
BOOL
 
iPö
=
TRUE
; 
LONG
 
pIndex
=0 , 
pRIndex
=0 , 
pTy≥
=0;

3070  
pIndex
 < 
lI≈ö
)

3072 
hr
 = 
Crossb¨
->
	`gë_Crossb¨PöInfo
–
iPö
 , 
pIndex
 , &
pRIndex
 , &
pTy≥
);

3074 if–
pTy≥
 =
c⁄Ty≥
){

3075 
	`DebugPrötOut
("SETUP: Found Physical Interface");

3077 
c⁄Ty≥
){

3079 
PhysC⁄n_Video_Composôe
:

3080 
	`DebugPrötOut
(" - Composite\n");

3082 
PhysC⁄n_Video_SVideo
:

3083 
	`DebugPrötOut
(" - S-Video\n");

3085 
PhysC⁄n_Video_Tu√r
:

3086 
	`DebugPrötOut
(" - Tuner\n");

3088 
PhysC⁄n_Video_USB
:

3089 
	`DebugPrötOut
(" - USB\n");

3091 
PhysC⁄n_Video_1394
:

3092 
	`DebugPrötOut
(" - Firewire\n");

3096 
foundDevi˚
 = 
åue
;

3099 
pIndex
++;

3103 if(
foundDevi˚
){

3104 
BOOL
 
OPö
=
FALSE
; 
LONG
 
pOIndex
=0 , 
pORIndex
=0 , 
pOTy≥
=0;

3105  
pOIndex
 < 
lOuçö
)

3107 
hr
 = 
Crossb¨
->
	`gë_Crossb¨PöInfo
–
OPö
 , 
pOIndex
 , &
pORIndex
 , &
pOTy≥
);

3108 if–
pOTy≥
 =
PhysC⁄n_Video_VideoDecodî
)

3111 
Crossb¨
->
	`Rouã
(
pOIndex
,
pIndex
);

3113 
	`DebugPrötOut
("SETUP: Didn't find specified Physical ConnectionÅype. Using Defualt.\n");

3121 if(
pXB¨1
ÌXB¨1->
	`Rñó£
();

3122 if(
pXB¨1
ÌXB¨1 = 
NULL
;

3125 
	`DebugPrötOut
("SETUP: Youáreá webcam or snazzy firewire cam! No CrossbarÇeeded\n");

3126  
hr
;

3129  
hr
;

3130 
	}
}

3132 
«me•a˚
 
	gcv


3134 
videoI≈ut
 
	gVideoC≠tuª_DShow
::
g_VI
;

3136 
	gVideoC≠tuª_DShow
::
VideoC≠tuª_DShow
(
ödex
)

3137 : 
m_ödex
(-1)

3138 , 
m_width
(-1)

3139 , 
m_height
(-1)

3140 , 
m_fourcc
(-1)

3141 , 
m_widthSë
(-1)

3142 , 
m_heightSë
(-1)

3144 
CoInôülize
(0);

3145 
›í
(
ödex
);

3147 
	gVideoC≠tuª_DShow
::~
VideoC≠tuª_DShow
()

3149 
˛o£
();

3150 
CoUnöôülize
();

3153 
	gVideoC≠tuª_DShow
::
gëPr›îty
(
¥›Idx
) const

3156 
mö_vÆue
, 
	gmax_vÆue
, 
	g°ïpög_dñè
, 
	gcuºít_vÆue
, 
	gÊags
, 
	gdeÁu…VÆue
;

3158 
	g¥›Idx
)

3161 
	gCV_CAP_PROP_FRAME_WIDTH
:

3162  
g_VI
.
gëWidth
(
m_ödex
);

3163 
	gCV_CAP_PROP_FRAME_HEIGHT
:

3164  
g_VI
.
gëHeight
(
m_ödex
);

3165 
	gCV_CAP_PROP_FOURCC
:

3166  
g_VI
.
gëFourcc
(
m_ödex
);

3167 
	gCV_CAP_PROP_FPS
:

3168  
g_VI
.
gëFPS
(
m_ödex
);

3171 
	gCV_CAP_PROP_BRIGHTNESS
:

3172 
CV_CAP_PROP_CONTRAST
:

3173 
CV_CAP_PROP_HUE
:

3174 
CV_CAP_PROP_SATURATION
:

3175 
CV_CAP_PROP_SHARPNESS
:

3176 
CV_CAP_PROP_GAMMA
:

3177 
CV_CAP_PROP_MONOCHROME
:

3178 
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
:

3179 
CV_CAP_PROP_BACKLIGHT
:

3180 
CV_CAP_PROP_GAIN
:

3181 i‡(
g_VI
.
gëVideoSëtögFûãr
(
m_ödex
, g_VI.
gëVideoPr›îtyFromCV
(
¥›Idx
), 
mö_vÆue
, 
max_vÆue
, 
°ïpög_dñè
, 
cuºít_vÆue
, 
Êags
, 
deÁu…VÆue
))

3182  ()
	gcuºít_vÆue
;

3185 
	gCV_CAP_PROP_PAN
:

3186 
CV_CAP_PROP_TILT
:

3187 
CV_CAP_PROP_ROLL
:

3188 
CV_CAP_PROP_ZOOM
:

3189 
CV_CAP_PROP_EXPOSURE
:

3190 
CV_CAP_PROP_IRIS
:

3191 
CV_CAP_PROP_FOCUS
:

3192 i‡(
g_VI
.
gëVideoSëtögCamîa
(
m_ödex
, g_VI.
gëCamîaPr›îtyFromCV
(
¥›Idx
), 
mö_vÆue
, 
max_vÆue
, 
°ïpög_dñè
, 
cuºít_vÆue
, 
Êags
, 
deÁu…VÆue
))

3193  ()
	gcuºít_vÆue
;

3199 
boﬁ
 
	gVideoC≠tuª_DShow
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
)

3202 
boﬁ
 
	gh™dÀd
 = 
Ál£
;

3203 
	g¥›Idx
)

3205 
	gCV_CAP_PROP_FRAME_WIDTH
:

3206 
m_width
 = 
cvRound
(
¥›VÆ
);

3207 
	gh™dÀd
 = 
åue
;

3210 
	gCV_CAP_PROP_FRAME_HEIGHT
:

3211 
m_height
 = 
cvRound
(
¥›VÆ
);

3212 
	gh™dÀd
 = 
åue
;

3215 
	gCV_CAP_PROP_FOURCC
:

3216 
m_fourcc
 = ()()(
¥›VÆ
);

3217 i‡(-1 =
m_fourcc
)

3222 
h™dÀd
 = 
åue
;

3225 
	gCV_CAP_PROP_FPS
:

3226 
Âs
 = 
cvRound
(
¥›VÆ
);

3227 i‡(
	gÂs
 !
g_VI
.
gëFPS
(
m_ödex
))

3229 
g_VI
.
°›Devi˚
(
m_ödex
);

3230 
	gg_VI
.
£tIdólFømî©e
(
m_ödex
, 
Âs
);

3231 i‡(
	gm_widthSë
 > 0 && 
	gm_heightSë
 > 0)

3232 
	gg_VI
.
£tupDevi˚
(
m_ödex
, 
m_widthSë
, 
m_heightSë
);

3234 
	gg_VI
.
£tupDevi˚
(
m_ödex
);

3236  
	gg_VI
.
isDevi˚Sëup
(
m_ödex
);

3239 i‡(
	gh™dÀd
)

3242 i‡(
	gm_width
 > 0 && 
	gm_height
 > 0)

3244 i‡(
	gm_width
 !
g_VI
.
gëWidth
(
m_ödex
Ë|| 
m_height
 !g_VI.
gëHeight
(m_index) )

3246 
Âs
 = 
°©ic_ˇ°
<>(
g_VI
.
gëFPS
(
m_ödex
));

3247 
	gg_VI
.
°›Devi˚
(
m_ödex
);

3248 
	gg_VI
.
£tIdólFømî©e
(
m_ödex
, 
Âs
);

3249 
	gg_VI
.
£tupDevi˚Fourcc
(
m_ödex
, 
m_width
, 
m_height
, 
m_fourcc
);

3252 
boﬁ
 
	gsuc˚ss
 = 
g_VI
.
isDevi˚Sëup
(
m_ödex
);

3253 i‡(
	gsuc˚ss
)

3255 
	gm_widthSë
 = 
m_width
;

3256 
	gm_heightSë
 = 
m_height
;

3257 
	gm_width
 = 
m_height
 = 
m_fourcc
 = -1;

3259  
	gsuc˚ss
;

3261  
	gåue
;

3265 i‡(
	g¥›Idx
 =
CV_CAP_PROP_SETTINGS
 )

3267 
g_VI
.
showSëtögsWödow
(
m_ödex
);

3268  
	gåue
;

3272 
	g¥›Idx
)

3274 
	gCV_CAP_PROP_BRIGHTNESS
:

3275 
CV_CAP_PROP_CONTRAST
:

3276 
CV_CAP_PROP_HUE
:

3277 
CV_CAP_PROP_SATURATION
:

3278 
CV_CAP_PROP_SHARPNESS
:

3279 
CV_CAP_PROP_GAMMA
:

3280 
CV_CAP_PROP_MONOCHROME
:

3281 
CV_CAP_PROP_WHITE_BALANCE_BLUE_U
:

3282 
CV_CAP_PROP_BACKLIGHT
:

3283 
CV_CAP_PROP_GAIN
:

3284  
g_VI
.
£tVideoSëtögFûãr
(
m_ödex
, g_VI.
gëVideoPr›îtyFromCV
(
¥›Idx
), ()
¥›VÆ
);

3288 
	g¥›Idx
)

3290 
	gCV_CAP_PROP_PAN
:

3291 
CV_CAP_PROP_TILT
:

3292 
CV_CAP_PROP_ROLL
:

3293 
CV_CAP_PROP_ZOOM
:

3294 
CV_CAP_PROP_EXPOSURE
:

3295 
CV_CAP_PROP_IRIS
:

3296 
CV_CAP_PROP_FOCUS
:

3297  
g_VI
.
£tVideoSëtögCamîa
(
m_ödex
, g_VI.
gëCamîaPr›îtyFromCV
(
¥›Idx
), ()
¥›VÆ
);

3300  
	gÁl£
;

3303 
boﬁ
 
	gVideoC≠tuª_DShow
::
gøbFøme
()

3305  
åue
;

3307 
boﬁ
 
	gVideoC≠tuª_DShow
::
ªåõveFøme
(, 
OuçutAºay
 
‰ame
)

3309 
	g‰ame
.
¸óã
(
Size
(
g_VI
.
gëWidth
(
m_ödex
), g_VI.
gëHeight
(m_ödex)), 
CV_8UC3
);

3310 
	gcv
::
M©
 
m©
 = 
‰ame
.
gëM©
();

3311  
	gg_VI
.
gëPixñs
(
m_ödex
, 
m©
.
±r
(), 
Ál£
, 
åue
 );

3313 
	gVideoC≠tuª_DShow
::
gëC≠tuªDomaö
()

3315  
CV_CAP_DSHOW
;

3317 
boﬁ
 
	gVideoC≠tuª_DShow
::
isO≥√d
() const

3319  (-1 !
m_ödex
);

3322 
	gVideoC≠tuª_DShow
::
›í
(
ödex
)

3324 
˛o£
();

3325 
	gdevi˚s
 = 
g_VI
.
li°Devi˚s
(
åue
);

3326 i‡(0 =
devi˚s
)

3328 i‡(
	gödex
 < 0 || index > 
	gdevi˚s
-1)

3330 
	gg_VI
.
£tupDevi˚
(
ödex
);

3331 i‡(!
	gg_VI
.
isDevi˚Sëup
(
ödex
))

3333 
	gm_ödex
 = 
ödex
;

3336 
	gVideoC≠tuª_DShow
::
˛o£
()

3338 i‡(
m_ödex
 >= 0)

3340 
g_VI
.
°›Devi˚
(
m_ödex
);

3341 
	gm_ödex
 = -1;

3343 
	gm_widthSë
 = 
m_heightSë
 = 
m_width
 = 
m_height
 = -1;

	@src/cap_ffmpeg.cpp

42 
	~"¥ecomp.hµ
"

44 #i‡
deföed
 
HAVE_FFMPEG
 && !deföed 
WIN32


45 
	~"ˇp_ffm≥g_im∂.hµ
"

47 
	~"ˇp_ffm≥g_≠i.hµ
"

50 
CvCª©eFûeC≠tuª_Plugö
 
	gicvCª©eFûeC≠tuª_FFMPEG_p
 = 0;

51 
CvRñó£C≠tuª_Plugö
 
	gicvRñó£C≠tuª_FFMPEG_p
 = 0;

52 
CvGøbFøme_Plugö
 
	gicvGøbFøme_FFMPEG_p
 = 0;

53 
CvRërõveFøme_Plugö
 
	gicvRërõveFøme_FFMPEG_p
 = 0;

54 
CvSëC≠tuªPr›îty_Plugö
 
	gicvSëC≠tuªPr›îty_FFMPEG_p
 = 0;

55 
CvGëC≠tuªPr›îty_Plugö
 
	gicvGëC≠tuªPr›îty_FFMPEG_p
 = 0;

56 
CvCª©eVideoWrôî_Plugö
 
	gicvCª©eVideoWrôî_FFMPEG_p
 = 0;

57 
CvRñó£VideoWrôî_Plugö
 
	gicvRñó£VideoWrôî_FFMPEG_p
 = 0;

58 
CvWrôeFøme_Plugö
 
	gicvWrôeFøme_FFMPEG_p
 = 0;

60 
	gcv
::
Muãx
 
_icvInôFFMPEG_muãx
;

62 ˛as†
	cicvInôFFMPEG


64 
	mpublic
:

65 
	$Inô
()

67 
cv
::
AutoLock
 
	`Æ
(
_icvInôFFMPEG_muãx
);

68 
icvInôFFMPEG
 
öô
;

71 
¥iv©e
:

72 #i‡
deföed
 
WIN32
 || deföed 
_WIN32


73 
HMODULE
 
icvFFO≥nCV
;

75 ~
	$icvInôFFMPEG
()

77 i‡(
icvFFO≥nCV
)

79 
	`FªeLibøry
(
icvFFO≥nCV
);

80 
icvFFO≥nCV
 = 0;

82 
	}
}

85 
	$icvInôFFMPEG
()

87 #i‡
deföed
 
WIN32
 || deföed 
_WIN32


88 #ifde‡
WINRT


89 c⁄° 
wch¨_t
* 
moduÀ_«me
 = 
L
"opencv_ffmpeg"

90 
	`CVAUX_STRW
(
CV_MAJOR_VERSION
ËCVAUX_STRW(
CV_MINOR_VERSION
ËCVAUX_STRW(
CV_SUBMINOR_VERSION
)

91 #i‡(
deföed
 
_MSC_VER
 && deföed 
_M_X64
Ë|| (deföed 
__GNUC__
 && deföed 
__x86_64__
)

92 
L
"_64"

94 
L
".dll";

96 
icvFFO≥nCV
 = 
	`LﬂdPackagedLibøry
–
moduÀ_«me
, 0 );

98 c⁄° * 
moduÀ_«me
 = "opencv_ffmpeg"

99 
	`CVAUX_STR
(
CV_MAJOR_VERSION
ËCVAUX_STR(
CV_MINOR_VERSION
ËCVAUX_STR(
CV_SUBMINOR_VERSION
)

100 #i‡(
deföed
 
_MSC_VER
 && deföed 
_M_X64
Ë|| (deföed 
__GNUC__
 && deföed 
__x86_64__
)

105 
icvFFO≥nCV
 = 
	`LﬂdLibøry
–
moduÀ_«me
 );

108 if–
icvFFO≥nCV
 )

110 
icvCª©eFûeC≠tuª_FFMPEG_p
 =

111 (
CvCª©eFûeC≠tuª_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvCreateFileCapture_FFMPEG");

112 
icvRñó£C≠tuª_FFMPEG_p
 =

113 (
CvRñó£C≠tuª_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvReleaseCapture_FFMPEG");

114 
icvGøbFøme_FFMPEG_p
 =

115 (
CvGøbFøme_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvGrabFrame_FFMPEG");

116 
icvRërõveFøme_FFMPEG_p
 =

117 (
CvRërõveFøme_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvRetrieveFrame_FFMPEG");

118 
icvSëC≠tuªPr›îty_FFMPEG_p
 =

119 (
CvSëC≠tuªPr›îty_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvSetCaptureProperty_FFMPEG");

120 
icvGëC≠tuªPr›îty_FFMPEG_p
 =

121 (
CvGëC≠tuªPr›îty_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvGetCaptureProperty_FFMPEG");

122 
icvCª©eVideoWrôî_FFMPEG_p
 =

123 (
CvCª©eVideoWrôî_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvCreateVideoWriter_FFMPEG");

124 
icvRñó£VideoWrôî_FFMPEG_p
 =

125 (
CvRñó£VideoWrôî_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvReleaseVideoWriter_FFMPEG");

126 
icvWrôeFøme_FFMPEG_p
 =

127 (
CvWrôeFøme_Plugö
)
	`GëProcAddªss
(
icvFFO≥nCV
, "cvWriteFrame_FFMPEG");

130 if–
icvCª©eFûeC≠tuª_FFMPEG_p
 != 0 &&

131 
icvRñó£C≠tuª_FFMPEG_p
 != 0 &&

132 
icvGøbFøme_FFMPEG_p
 != 0 &&

133 
icvRërõveFøme_FFMPEG_p
 != 0 &&

134 
icvSëC≠tuªPr›îty_FFMPEG_p
 != 0 &&

135 
icvGëC≠tuªPr›îty_FFMPEG_p
 != 0 &&

136 
icvCª©eVideoWrôî_FFMPEG_p
 != 0 &&

137 
icvRñó£VideoWrôî_FFMPEG_p
 != 0 &&

138 
icvWrôeFøme_FFMPEG_p
 != 0 )

140 
	`¥ötf
("Successfully initialized ffmpegÖlugin!\n");

144 
	`¥ötf
("FaûedÅÿlﬂd FFMPEGÖlugö: moduÀ h™dÀ=%p\n", 
icvFFO≥nCV
);

148 #ñi‡
deföed
 
HAVE_FFMPEG


149 
icvCª©eFûeC≠tuª_FFMPEG_p
 = (
CvCª©eFûeC≠tuª_Plugö
)
cvCª©eFûeC≠tuª_FFMPEG
;

150 
icvRñó£C≠tuª_FFMPEG_p
 = (
CvRñó£C≠tuª_Plugö
)
cvRñó£C≠tuª_FFMPEG
;

151 
icvGøbFøme_FFMPEG_p
 = (
CvGøbFøme_Plugö
)
cvGøbFøme_FFMPEG
;

152 
icvRërõveFøme_FFMPEG_p
 = (
CvRërõveFøme_Plugö
)
cvRërõveFøme_FFMPEG
;

153 
icvSëC≠tuªPr›îty_FFMPEG_p
 = (
CvSëC≠tuªPr›îty_Plugö
)
cvSëC≠tuªPr›îty_FFMPEG
;

154 
icvGëC≠tuªPr›îty_FFMPEG_p
 = (
CvGëC≠tuªPr›îty_Plugö
)
cvGëC≠tuªPr›îty_FFMPEG
;

155 
icvCª©eVideoWrôî_FFMPEG_p
 = (
CvCª©eVideoWrôî_Plugö
)
cvCª©eVideoWrôî_FFMPEG
;

156 
icvRñó£VideoWrôî_FFMPEG_p
 = (
CvRñó£VideoWrôî_Plugö
)
cvRñó£VideoWrôî_FFMPEG
;

157 
icvWrôeFøme_FFMPEG_p
 = (
CvWrôeFøme_Plugö
)
cvWrôeFøme_FFMPEG
;

159 
	}
}

163 ˛as†
	cCvC≠tuª_FFMPEG_¥oxy
 :

164 
public
 
CvC≠tuª


166 
public
:

167 
	$CvC≠tuª_FFMPEG_¥oxy
(Ë{ 
ffm≥gC≠tuª
 = 0; }

168 
vútuÆ
 ~
	$CvC≠tuª_FFMPEG_¥oxy
(Ë{ 
	`˛o£
(); 
	}
}

170 
vútuÆ
 
	$gëPr›îty
(
¥›Id
) const

172  
ffm≥gC≠tuª
 ? 
	`icvGëC≠tuªPr›îty_FFMPEG_p
(ffm≥gC≠tuª, 
¥›Id
) : 0;

173 
	}
}

174 
vútuÆ
 
boﬁ
 
	$£tPr›îty
(
¥›Id
, 
vÆue
)

176  
ffm≥gC≠tuª
 ? 
	`icvSëC≠tuªPr›îty_FFMPEG_p
(ffm≥gC≠tuª, 
¥›Id
, 
vÆue
)!=0 : 
Ál£
;

177 
	}
}

178 
vútuÆ
 
boﬁ
 
	$gøbFøme
()

180  
ffm≥gC≠tuª
 ? 
	`icvGøbFøme_FFMPEG_p
(ffm≥gC≠tuª)!=0 : 
Ál£
;

181 
	}
}

182 
vútuÆ
 
I∂Image
* 
	$ªåõveFøme
()

184 * 
d©a
 = 0;

185 
°ï
=0, 
width
=0, 
height
=0, 
˙
=0;

187 i‡(!
ffm≥gC≠tuª
 ||

188 !
	`icvRërõveFøme_FFMPEG_p
(
ffm≥gC≠tuª
, &
d©a
, &
°ï
, &
width
, &
height
, &
˙
))

190 
	`cvInôImageHódî
(&
‰ame
, 
	`cvSize
(
width
, 
height
), 8, 
˙
);

191 
	`cvSëD©a
(&
‰ame
, 
d©a
, 
°ï
);

192  &
‰ame
;

193 
	}
}

194 
vútuÆ
 
boﬁ
 
	$›í
–c⁄° * 
fûíame
 )

196 
icvInôFFMPEG
::
	`Inô
();

197 
	`˛o£
();

199 if–!
icvCª©eFûeC≠tuª_FFMPEG_p
 )

200  
Ál£
;

201 
ffm≥gC≠tuª
 = 
	`icvCª©eFûeC≠tuª_FFMPEG_p
–
fûíame
 );

202  
ffm≥gC≠tuª
 != 0;

203 
	}
}

204 
vútuÆ
 
	$˛o£
()

206 if–
ffm≥gC≠tuª
 && 
icvRñó£C≠tuª_FFMPEG_p
 )

207 
	`icvRñó£C≠tuª_FFMPEG_p
–&
ffm≥gC≠tuª
 );

208 
	`as£π
–
ffm≥gC≠tuª
 == 0 );

209 
ffm≥gC≠tuª
 = 0;

210 
	}
}

212 
	g¥Ÿe˘ed
:

213 * 
ffm≥gC≠tuª
;

214 
I∂Image
 
	g‰ame
;

218 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_FFMPEG_¥oxy
(c⁄° * 
fûíame
)

220 
CvC≠tuª_FFMPEG_¥oxy
* 
ªsu…
 = 
√w
 CvCapture_FFMPEG_proxy;

221 if–
ªsu…
->
	`›í
–
fûíame
 ))

222  
ªsu…
;

223 
dñëe
 
ªsu…
;

225 
	}
}

227 ˛as†
	cCvVideoWrôî_FFMPEG_¥oxy
 :

228 
public
 
CvVideoWrôî


230 
public
:

231 
	$CvVideoWrôî_FFMPEG_¥oxy
(Ë{ 
ffm≥gWrôî
 = 0; }

232 
vútuÆ
 ~
	$CvVideoWrôî_FFMPEG_¥oxy
(Ë{ 
	`˛o£
(); 
	}
}

234 
vútuÆ
 
boﬁ
 
	$wrôeFøme
–c⁄° 
I∂Image
* 
image
 )

236 if(!
ffm≥gWrôî
)

237  
Ál£
;

238 
	`CV_As£π
(
image
->
dïth
 == 8);

240  
	`icvWrôeFøme_FFMPEG_p
(
ffm≥gWrôî
, (c⁄° 
uch¨
*)
image
->
imageD©a
,

241 
image
->
widthSãp
, image->
width
, image->
height
, image->
nCh™√ls
, image->
‹igö
) !=0;

242 
	}
}

243 
vútuÆ
 
boﬁ
 
	$›í
–c⁄° * 
fûíame
, 
fourcc
, 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 )

245 
icvInôFFMPEG
::
	`Inô
();

246 
	`˛o£
();

247 if–!
icvCª©eVideoWrôî_FFMPEG_p
 )

248  
Ál£
;

249 
ffm≥gWrôî
 = 
	`icvCª©eVideoWrôî_FFMPEG_p
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
.
width
, fømeSize.
height
, 
isCﬁ‹
 );

250  
ffm≥gWrôî
 != 0;

251 
	}
}

253 
vútuÆ
 
	$˛o£
()

255 if–
ffm≥gWrôî
 && 
icvRñó£VideoWrôî_FFMPEG_p
 )

256 
	`icvRñó£VideoWrôî_FFMPEG_p
–&
ffm≥gWrôî
 );

257 
	`as£π
–
ffm≥gWrôî
 == 0 );

258 
ffm≥gWrôî
 = 0;

259 
	}
}

261 
	g¥Ÿe˘ed
:

262 * 
ffm≥gWrôî
;

266 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_FFMPEG_¥oxy
–c⁄° * 
fûíame
, 
fourcc
,

267 
Âs
, 
CvSize
 
‰ameSize
, 
isCﬁ‹
 )

269 
CvVideoWrôî_FFMPEG_¥oxy
* 
ªsu…
 = 
√w
 CvVideoWriter_FFMPEG_proxy;

271 if–
ªsu…
->
	`›í
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
 != 0 ))

272  
ªsu…
;

273 
dñëe
 
ªsu…
;

275 
	}
}

	@src/cap_giganetix.cpp

47 
	~"¥ecomp.hµ
"

48 
	~<GigEVisi⁄SDK.h
>

49 
	~<GigEVisi⁄SDK.˝p
>

51 #ifde‡
WIN32


52 
	~<io.h
>

54 
	~<°dio.h
>

57 #ifde‡
NDEBUG


58 
	#CV_WARN
(
mesßge
)

	)

60 
	#CV_WARN
(
mesßge
Ë
	`Ârötf
(
°dîr
, "w¨nög: %†(%s:%d)\n", mesßge, 
__FILE__
, 
__LINE__
)

	)

63 
	#QTGIG_HEARTBEAT_TIME
 (12000.0)

	)

64 
	#QTGIG_MAX_WAIT_TIME
 (2.0)

	)

65 
	#QTGIG_IMG_WAIT_TIME
 (3.0)

	)

76 
boﬁ


77 
	$wΩrInôGigEVisi⁄API
()

79 
	`CV_FUNCNAME
("wrprInitGigEVisionAPI");

80 
__BEGIN__
;

82 
åy
 {

83 
gige
::
	`InôGigEVisi⁄API
 ();

84 } 
	`ˇtch
(...) {

85 
	`CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: initialization (InitGigEVisionAPI()) failed.\n");

87 
__END__
;

88  
åue
;

89 
	}
}

100 
boﬁ


101 
	$wΩrExôGigEVisi⁄API
()

103 
	`CV_FUNCNAME
("wrprExitGigEVisionAPI");

104 
__BEGIN__
;

106 
åy
 {

107 
gige
::
	`ExôGigEVisi⁄API
 ();

108 } 
	`ˇtch
(...) {

109 
	`CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: finalization (ExitGigEVisionAPI()) failed.\n");

110  
Ál£
;

112 
__END__
;

113  
åue
;

114 
	}
}

125 
	ggige
::
IGigEVisi⁄API


126 
	$wΩrGëGigEVisi⁄API
()

129 
gige
::
IGigEVisi⁄API
 
b_ªt
 = 0;

131 
	`CV_FUNCNAME
("wrprGetGigEVisionAPI");

132 
__BEGIN__
;

134 
åy
 {

135 
b_ªt
 = 
gige
::
	`GëGigEVisi⁄API
 ();

136 } 
	`ˇtch
(...) {

137 
	`CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: API instance (from GetGigEVisionAPI()) failed.\n");

140 
__END__
;

142  
b_ªt
;

143 
	}
}

157 
boﬁ


158 
wΩrUƒegi°îCÆlback
–c⁄° 
gige
::
IGigEVisi⁄API
* 
≠i
, gige::
ICÆlbackEvít
* 
evítH™dÀr
)

160 
boﬁ
 
b_ªt
 = 
≠i
 !
NULL
;

162 if(
	gb_ªt
Ëb_ªà
≠i
->
IsVÆid
 ();

164 
CV_FUNCNAME
("wrprUnregisterCallback");

165 
	g__BEGIN__
;

167 if(
	gb_ªt
)

169 if(
	gevítH™dÀr
 !
NULL
)

171 
åy
 {

172 
b_ªt
 = ((
gige
::
IGigEVisi⁄APII¡îÁ˚
*)
≠i
)->
Uƒegi°îCÆlback
 (
evítH™dÀr
);

173 } 
ˇtch
(...) {

174 
CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: API unregister callback function (from UnregisterCallback()) failed.\n");

175 
	gb_ªt
 = 
Ál£
;

179 
	g__END__
;

181  (
	gb_ªt
);

193 
boﬁ


194 
wΩrDevi˚IsC⁄√˘
–
gige
::
IDevi˚
& 
devi˚
 )

196 
boﬁ
 
b_ªt
 = 
devi˚
 !
NULL
;

198 
CV_FUNCNAME
("wrprDeviceIsConnect");

199 
	g__BEGIN__
;

201 if(
	gb_ªt
)

203 
	gåy
 {

204 
	gb_ªt
 = 
devi˚
->
IsC⁄√˘ed
 ();

205 } 
ˇtch
 (...) {

206 
CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: API device connection state (from IsConnected()) failed.\n");

207 
	gb_ªt
 = 
Ál£
;

210 
	g__END__
;

212  (
	gb_ªt
);

225 
boﬁ


226 
wΩrDevi˚IsVÆid
–
gige
::
IDevi˚
& 
devi˚
 )

228 
boﬁ
 
b_ªt
 = 
devi˚
 !
NULL
;

230 
CV_FUNCNAME
("wrprDeviceIsConnect");

231 
	g__BEGIN__
;

233 if(
	gb_ªt
)

235 
	gåy
 {

236 
	gb_ªt
 = 
devi˚
.
IsVÆid
 ();

237 } 
ˇtch
 (...) {

238 
CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: API device validation state (from IsValid()) failed.\n");

239 
	gb_ªt
 = 
Ál£
;

242 
	g__END__
;

244  (
	gb_ªt
);

257 
boﬁ


258 
wΩrDevi˚Disc⁄√˘
 ( 
gige
::
IDevi˚
& 
devi˚
 )

260 
boﬁ
 
b_ªt
 = 
devi˚
 !
NULL
;

262 
CV_FUNCNAME
("wrprDeviceDisconnect");

263 
	g__BEGIN__
;

265 if(
	gb_ªt
)

267 
	gåy
 {

268 
	gdevi˚
->
Disc⁄√˘
 ();

269 } 
ˇtch
 (...) {

270 
CV_ERROR
(
CV_StsEº‹
, "GigEVisionAPI: API device disconnect (from Disconnect()) failed.\n");

271 
	gb_ªt
 = 
Ál£
;

275 
	g__END__
;

277  (
	gb_ªt
);

289 ˛as†
	cCvC≠tuªCAM_Gig™ëix
 : 
public
 
CvC≠tuª


291 
public
:

292 
CvC≠tuªCAM_Gig™ëix
();

293 
	mvútuÆ
 ~
CvC≠tuªCAM_Gig™ëix
();

295 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

296 
vútuÆ
 
˛o£
();

297 
vútuÆ
 
	$gëPr›îty
() const;

298 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

299 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

300 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

301 
vútuÆ
 
	$gëC≠tuªDomaö
()

303  
CV_CAP_GIGANETIX
;

306 
boﬁ
 
	`°¨t
 ();

307 
boﬁ
 
	`°›
 ();

309 
¥Ÿe˘ed
:

311 
	`öô
 ();

312 
	`gøbImage
 ();

314 
gige
::
IGigEVisi⁄API
 
m_≠i
;

315 
boﬁ
 
m_≠i_⁄
;

316 
gige
::
IDevi˚
 
m_devi˚
;

317 
boﬁ
 
m_a˘ive
;

319 
I∂Image
* 
m_øw_image
;

320 
UINT32
 
m_øwImagePixñTy≥
;

321 
boﬁ
 
m_m⁄o¸ome
;

323 
	}
};

327 
	gCvC≠tuªCAM_Gig™ëix
::
	$öô
 ()

329 
m_m⁄o¸ome
 = 
m_a˘ive
 = 
m_≠i_⁄
 = 
Ál£
;

330 
m_≠i
 = 0;

331 
m_devi˚
 = 0;

332 
m_øw_image
 = 0;

333 
m_øwImagePixñTy≥
 = 0;

334 
	}
}

337 
	gCvC≠tuªCAM_Gig™ëix
::
	$CvC≠tuªCAM_Gig™ëix
()

339 
	`öô
 ();

341 
m_≠i_⁄
 = 
	`wΩrInôGigEVisi⁄API
 ();

343 if(
m_≠i_⁄
)

345 if((
m_≠i
 = 
	`wΩrGëGigEVisi⁄API
 ()Ë!
NULL
)

347 
m_≠i
->
	`SëHóπbótTime
 (
QTGIG_HEARTBEAT_TIME
);

350 
	}
}

353 
	gCvC≠tuªCAM_Gig™ëix
::~
	$CvC≠tuªCAM_Gig™ëix
()

355 
	`˛o£
();

356 
	}
}

359 
	gCvC≠tuªCAM_Gig™ëix
::
	$˛o£
()

361 
	`°›
 ();

363 ()
	`wΩrDevi˚Disc⁄√˘
(
m_devi˚
);

365 ()
	`wΩrExôGigEVisi⁄API
 ();

367 if(
m_øw_image
Ë
	`cvRñó£ImageHódî
(&m_raw_image);

369 
	`öô
 ();

370 
	}
}

373 
boﬁ


374 
	gCvC≠tuªCAM_Gig™ëix
::
	$›í
–
ödex
 )

376 
boﬁ
 
b_ªt
 = 
m_≠i_⁄
;

378 
	`CV_FUNCNAME
("CvCaptureCAM_Giganetix::open");

379 
__BEGIN__
;

381 if(
b_ªt
)

382 
b_ªt
 = 
m_≠i
.
	`IsVÆid
 ();

384 if(
b_ªt
 )

386 
m_≠i
->
	`FödAŒDevi˚s
 (
QTGIG_MAX_WAIT_TIME
);

389 
gige
::
Devi˚sLi°
 Devi˚sLi° = 
m_≠i
->
	`GëAŒDevi˚s
 ();

391 
m_devi˚
 = 0;

392 
b_ªt
 = 
Ál£
;

394 
i
 = 0; i < (Ë
Devi˚sLi°
.
	`size
(Ë&& !
b_ªt
; i++)

396 
b_ªt
 = (
i
 =
ödex
);

397 if(
b_ªt
)

399 
m_devi˚
 = 
Devi˚sLi°
[
i
];

400 
b_ªt
 = 
m_devi˚
->
	`C⁄√˘
 ();

402 if(
b_ªt
)

404 
b_ªt
 =

405 
m_devi˚
->
	`SëSåögNodeVÆue
("AcquisitionStatusSelector", "AcquisitionActive")

407 
m_devi˚
->
	`SëSåögNodeVÆue
 ("TriggerMode", "Off")

409 
m_devi˚
->
	`SëSåögNodeVÆue
 ("AcquisitionMode", "Continuous")

411 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("AcquisitionFrameCount", 20)

418 if(!
b_ªt
)

420 
	`CV_ERROR
(
CV_StsEº‹
, "Giganetix: Error cannot find camera\n");

421 
	`˛o£
 ();

423 
	`°¨t
 ();

426 
__END__
;

428  
b_ªt
;

429 
	}
}

433 
	gCvC≠tuªCAM_Gig™ëix
::
	$gøbImage
 ()

435 
	`CV_FUNCNAME
("CvCaptureCAM_Giganetix::grabImage");

436 
__BEGIN__
;

438 if(
	`wΩrDevi˚IsVÆid
(
m_devi˚
Ë&& 
	`wΩrDevi˚IsC⁄√˘
(m_device))

440 if(!
m_devi˚
->
	`IsBuf„rEm±y
 ())

442 
gige
::
IImageInfo
 
imageInfo
;

443 
m_devi˚
->
	`GëImageInfo
 (&
imageInfo
);

444 
	`as£π
(
imageInfo
.
	`IsVÆid
());

446 i‡(
m_devi˚
->
	`GëPídögImagesCou¡
() == 1)

448 
UINT32
 
√wPixñTy≥
;

449 
UINT32
 
√wWidth
, 
√wHeight
;

451 
imageInfo
->
	`GëPixñTy≥
(
√wPixñTy≥
);

452 
imageInfo
->
	`GëSize
(
√wWidth
, 
√wHeight
);

455 
boﬁ
 
b_vÆid©i⁄
 = 
m_øw_image
 !
NULL
;

456 if(
b_vÆid©i⁄
)

458 
b_vÆid©i⁄
 =

459 
m_øw_image
->
imageSize
 =()(
imageInfo
->
	`GëRawD©aSize
 ())

461 
m_øwImagePixñTy≥
 =
√wPixñTy≥
;

463 if(
m_øw_image
Ë
	`cvRñó£ImageHódî
(&m_raw_image);

466 
m_øwImagePixñTy≥
 = 
√wPixñTy≥
;

467 
m_m⁄o¸ome
 = 
	`Gv•GëBôsPîPixñ
((
GVSP_PIXEL_TYPES
)
√wPixñTy≥
Ë=
IPL_DEPTH_8U
;

469 
åy
 {

470 i‡(
m_m⁄o¸ome
)

473 i‡(!
b_vÆid©i⁄
)

475 
m_øw_image
 = 
	`cvCª©eImageHódî
 (
	`cvSize
(()
√wWidth
, ()
√wHeight
),
IPL_DEPTH_8U
,1);

476 
m_øw_image
->
‹igö
 = 
IPL_ORIGIN_TL
;

477 
m_øw_image
->
d©aOrdî
 = 
IPL_DATA_ORDER_PIXEL
;

478 
m_øw_image
->
widthSãp
 = 
√wWidth
;

484 
m_øw_image
->
imageD©a
 = (*)(
imageInfo
->
	`GëRawD©a
 ());

487 i‡(!
m_m⁄o¸ome
 && 
√wPixñTy≥
 =
GVSP_PIX_RGB8_PACKED
)

490 i‡(!
b_vÆid©i⁄
)

492 
m_øw_image
 = 
	`cvCª©eImageHódî
 (
	`cvSize
(()
√wWidth
, ()
√wHeight
), 
IPL_DEPTH_32F
, 3);

493 
m_øw_image
->
‹igö
 = 
IPL_ORIGIN_TL
;

494 
m_øw_image
->
d©aOrdî
 = 
IPL_DATA_ORDER_PIXEL
;

495 
m_øw_image
->
widthSãp
 = 
√wWidth
 * 3;

497 
m_øw_image
->
imageD©a
 = (*)(
imageInfo
->
	`GëRawD©a
 ());

499 } 
	`ˇtch
 (...) {

500 
	`CV_ERROR
(
CV_StsEº‹
, "Giganetix: failedÅo queueá buffer on device\n");

501 
	`˛o£
 ();

505 
m_øw_image
 = 0;

506 
	`CV_WARN
("Giganetix: Undefined imageÖixelÅype\n");

508 
m_devi˚
->
	`P›Image
 (
imageInfo
);

509 
m_devi˚
->
	`CÀ¨ImageBuf„r
 ();

513 
__END__
;

514 
	}
}

517 
boﬁ


518 
	gCvC≠tuªCAM_Gig™ëix
::
	$°¨t
 ()

520 
	`CV_FUNCNAME
("CvCaptureCAM_Giganetix::start");

521 
__BEGIN__
;

523 
m_a˘ive
 = 
	`wΩrDevi˚IsVÆid
(
m_devi˚
Ë&& 
	`wΩrDevi˚IsC⁄√˘
(m_device);

525 if(
m_a˘ive
)

527 ()
m_devi˚
->
	`SëI¡egîNodeVÆue
("TLParamsLocked", 1);

528 ()
m_devi˚
->
	`Comm™dNodeExecuã
("AcquisitionStart");

529 
m_a˘ive
 = 
m_devi˚
->
	`GëBoﬁónNodeVÆue
("AcquisitionStatus", m_active);

532 if(!
m_a˘ive
)

534 
	`CV_ERROR
(
CV_StsEº‹
, "Giganetix: Cannot open camera\n");

535 
	`˛o£
 ();

538 
__END__
;

540  
m_a˘ive
;

541 
	}
}

544 
boﬁ


545 
	gCvC≠tuªCAM_Gig™ëix
::
	$°›
 ()

547 i‡(!
m_a˘ive
Ë 
åue
;

549 
	`CV_FUNCNAME
("CvCaptureCAM_Giganetix::stop");

550 
__BEGIN__
;

552 if(
	`wΩrDevi˚IsVÆid
(
m_devi˚
Ë&& 
	`wΩrDevi˚IsC⁄√˘
(m_device))

554 ()
m_devi˚
->
	`GëBoﬁónNodeVÆue
("Acquisôi⁄Sètus", 
m_a˘ive
);

556 if(
m_a˘ive
)

558 ()
m_devi˚
->
	`Comm™dNodeExecuã
("AcquisitionStop");

559 ()
m_devi˚
->
	`SëI¡egîNodeVÆue
("TLParamsLocked", 0);

560 
m_devi˚
->
	`CÀ¨ImageBuf„r
 ();

561 ()
m_devi˚
->
	`GëBoﬁónNodeVÆue
("Acquisôi⁄Sètus", 
m_a˘ive
);

565 if(
m_a˘ive
)

567 
	`CV_ERROR
(
CV_StsEº‹
, "Giganetix: Improper closure ofÅhe camera\n");

568 
	`˛o£
 ();

570 
__END__
;

572  !
m_a˘ive
;

573 
	}
}

576 
boﬁ


577 
	gCvC≠tuªCAM_Gig™ëix
::
	$gøbFøme
()

579 
boﬁ
 
b_ªt
 =

580 
	`wΩrDevi˚IsVÆid
(
m_devi˚
)

582 
	`wΩrDevi˚IsC⁄√˘
(
m_devi˚
);

584 if(
b_ªt
Ë
	`gøbImage
 ();

586  
b_ªt
;

587 
	}
}

591 
I∂Image
*

592 
	gCvC≠tuªCAM_Gig™ëix
::
	$ªåõveFøme
()

595 
	`wΩrDevi˚IsVÆid
(
m_devi˚
Ë&& 
	`wΩrDevi˚IsC⁄√˘
(m_device) ?

596 
m_øw_image
 :

597 
NULL


599 
	}
}

603 
	gCvC≠tuªCAM_Gig™ëix
::
	$gëPr›îty
–
¥›îty_id
 ) const

605 
d_ªt
 = -1.0;

606 
INT64
 
i
;

608 if(
	`wΩrDevi˚IsC⁄√˘
(
m_devi˚
))

610  
¥›îty_id
 )

612 
CV_CAP_PROP_FRAME_WIDTH
:

613 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Width", 
i
);

614 
d_ªt
 = 
i
;

616 
CV_CAP_PROP_FRAME_HEIGHT
:

617 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Height", 
i
);

618 
d_ªt
 = 
i
;

620 
CV_CAP_PROP_GIGA_FRAME_OFFSET_X
:

621 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Off£tX", 
i
);

622 
d_ªt
 = 
i
;

624 
CV_CAP_PROP_GIGA_FRAME_OFFSET_Y
:

625 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Off£tY", 
i
);

626 
d_ªt
 = 
i
;

628 
CV_CAP_PROP_GIGA_FRAME_WIDTH_MAX
:

629 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("WidthMax", 
i
);

630 
d_ªt
 = 
i
;

632 
CV_CAP_PROP_GIGA_FRAME_HEIGH_MAX
:

633 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("HeightMax", 
i
);

634 
d_ªt
 = 
i
;

636 
CV_CAP_PROP_GIGA_FRAME_SENS_WIDTH
:

637 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Sís‹Width", 
i
);

638 
d_ªt
 = 
i
;

640 
CV_CAP_PROP_GIGA_FRAME_SENS_HEIGH
:

641 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Sís‹Height", 
i
);

642 
d_ªt
 = 
i
;

644 
CV_CAP_PROP_FRAME_COUNT
:

645 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Acquisôi⁄FømeCou¡", 
i
);

646 
d_ªt
 = 
i
;

648 
CV_CAP_PROP_EXPOSURE
:

649 
m_devi˚
->
	`GëFlﬂtNodeVÆue
 ("ExposuªTime",
d_ªt
);

651 
CV_CAP_PROP_GAIN
 :

652 
m_devi˚
->
	`GëFlﬂtNodeVÆue
 ("Gaö",
d_ªt
);

654 
CV_CAP_PROP_TRIGGER
 :

655 
boﬁ
 
b
;

656 
m_devi˚
->
	`GëBoﬁónNodeVÆue
 ("TriggîMode",
b
);

657 
d_ªt
 = ()
b
;

659 
CV_CAP_PROP_TRIGGER_DELAY
 :

660 
m_devi˚
->
	`GëFlﬂtNodeVÆue
 ("TriggîDñay",
d_ªt
);

666  
d_ªt
;

667 
	}
}

670 
boﬁ


671 
	gCvC≠tuªCAM_Gig™ëix
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

673 
boﬁ
 
b_ªt
 = 
	`wΩrDevi˚IsC⁄√˘
(
m_devi˚
);

675 if(
b_ªt
)

677 
boﬁ
 
b_vÆ
 = 
m_a˘ive
;

679  
¥›îty_id
 )

681 
CV_CAP_PROP_FRAME_WIDTH
:

682 
	`°›
 ();

683 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Width", (
INT64
)
vÆue
);

684 if(
b_vÆ
Ë
	`°¨t
 ();

686 
CV_CAP_PROP_GIGA_FRAME_WIDTH_MAX
:

687 
	`°›
 ();

688 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("WidthMax", (
INT64
)
vÆue
);

689 if(
b_vÆ
Ë
	`°¨t
 ();

691 
CV_CAP_PROP_GIGA_FRAME_SENS_WIDTH
:

692 
	`°›
 ();

693 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Sís‹Width", (
INT64
)
vÆue
);

694 if(
b_vÆ
Ë
	`°¨t
 ();

696 
CV_CAP_PROP_FRAME_HEIGHT
:

697 
	`°›
 ();

698 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Height", (
INT64
)
vÆue
);

699 if(
b_vÆ
Ë
	`°¨t
 ();

701 
CV_CAP_PROP_GIGA_FRAME_HEIGH_MAX
:

702 
	`°›
 ();

703 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("HeightMax", (
INT64
)
vÆue
);

704 if(
b_vÆ
Ë
	`°¨t
 ();

706 
CV_CAP_PROP_GIGA_FRAME_SENS_HEIGH
:

707 
	`°›
 ();

708 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Sís‹Height", (
INT64
)
vÆue
);

709 if(
b_vÆ
Ë
	`°¨t
 ();

711 
CV_CAP_PROP_GIGA_FRAME_OFFSET_X
: {

712 
INT64
 
w
, 
wmax
, 
vÆ
 = (INT64)
vÆue
;

713 if((
b_ªt
 = 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Width", 
w
)))

714 if((
b_ªt
 = 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("WidthMax", 
wmax
)))

715 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Off£tX", (
vÆ
 + 
w
Ë> 
wmax
 ? (wmax - w) : val);

717 
CV_CAP_PROP_GIGA_FRAME_OFFSET_Y
: {

718 
INT64
 
h
, 
hmax
, 
vÆ
 = (INT64)
vÆue
;

719 if((
b_ªt
 = 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("Height", 
h
)))

720 if((
b_ªt
 = 
m_devi˚
->
	`GëI¡egîNodeVÆue
 ("HeightMax", 
hmax
)))

721 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Off£tY", (
vÆ
 + 
h
Ë> 
hmax
 ? (hmax - h) : val);

722 
b_ªt
 = 
m_devi˚
->
	`SëI¡egîNodeVÆue
 ("Off£tY", (
INT64
)
vÆue
);

725 
CV_CAP_PROP_EXPOSURE
:

726 
b_ªt
 = 
m_devi˚
->
	`SëFlﬂtNodeVÆue
 ("ExposuªTime",
vÆue
);

728 
CV_CAP_PROP_GAIN
 :

729 
b_ªt
 = 
m_devi˚
->
	`SëFlﬂtNodeVÆue
 ("Gaö",
vÆue
);

731 
CV_CAP_PROP_TRIGGER
 :

732 
b_ªt
 = 
m_devi˚
->
	`SëBoﬁónNodeVÆue
 ("TriggîMode",(
boﬁ
)
vÆue
);

734 
CV_CAP_PROP_TRIGGER_DELAY
 :

735 
	`°›
 ();

736 
b_ªt
 = 
m_devi˚
->
	`SëFlﬂtNodeVÆue
 ("TriggîDñay",
vÆue
);

737 if(
b_vÆ
Ë
	`°¨t
 ();

740 
b_ªt
 = 
Ál£
;

744  
b_ªt
;

745 
	}
}

750 
CvC≠tuª
*

751 
	$cvCª©eCamîaC≠tuª_Gig™ëix
–
ödex
 )

753 
CvC≠tuªCAM_Gig™ëix
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_Giganetix;

755 i‡(!(
ˇ±uª
->
	`›í
–
ödex
 )))

757 
dñëe
 
ˇ±uª
;

758 
ˇ±uª
 = 
NULL
;

761  ((
CvC≠tuª
*)
ˇ±uª
);

762 
	}
}

	@src/cap_gphoto2.cpp

28 
	~"¥ecomp.hµ
"

30 #ifde‡
HAVE_GPHOTO2


32 
	~<gphŸo2/gphŸo2.h
>

34 
	~<Æg‹ôhm
>

35 
	~<˛oˇÀ
>

36 
	~<c°dio
>

37 
	~<c°rög
>

38 
	~<˘ime
>

39 
	~<deque
>

40 
	~<ex˚±i⁄
>

41 
	~<m≠
>

42 
	~<o°ªam
>

43 
	~<°rög
>

45 
«me•a˚
 
	gcv


48 
«me•a˚
 
	ggphŸo2
 {

53 ˛as†
	cGPhŸo2Ex˚±i⁄
: 
public
 
°d
::
ex˚±i⁄


55 
¥iv©e
:

56 
ªsu…
;

57 c⁄° * 
	gmëhod
;

58 
	gpublic
:

63 
GPhŸo2Ex˚±i⁄
(c⁄° * 
mëhodSå
, 
gPhŸo2Resu…
)

65 
	gªsu…
 = 
gPhŸo2Resu…
;

66 
	gmëhod
 = 
mëhodSå
;

68 
vútuÆ
 c⁄° * 
wh©
(Ëc⁄° 
throw
 ()

70  
gp_ªsu…_as_°rög
(
ªsu…
);

72 
‰õnd
 
	g°d
::
o°ªam
 & 
›î©‹
<<(
°d
::ostream & ostream,

73 
	gGPhŸo2Ex˚±i⁄
 & 
	ge
)

75  
	go°ªam
 << 
	ge
.
	gmëhod
 << ": " <<É.
wh©
();

131 ˛as†
	cDigôÆCamîaC≠tuª
: 
public
 
IVideoC≠tuª


133 
public
:

134 c⁄° * 
£∑øt‹
;

135 c⁄° * 
	glöeDñimôî
;

137 
DigôÆCamîaC≠tuª
();

138 
DigôÆCamîaC≠tuª
(
ödex
);

139 
DigôÆCamîaC≠tuª
(c⁄° 
Såög
 &
devi˚Name
);

140 
	gvútuÆ
 ~
DigôÆCamîaC≠tuª
();

142 
vútuÆ
 
boﬁ
 
isO≥√d
() const;

143 
vútuÆ
 
gëPr›îty
() const;

144 
vútuÆ
 
boﬁ
 
£tPr›îty
(, );

145 
vútuÆ
 
boﬁ
 
gøbFøme
();

146 
vútuÆ
 
boﬁ
 
ªåõveFøme
(, 
OuçutAºay
);

147 
vútuÆ
 
gëC≠tuªDomaö
()

149  
	gCV_CAP_GPHOTO2
;

152 
boﬁ
 
›í
(
ödex
);

153 
˛o£
();

154 
boﬁ
 
devi˚Exi°
(
ödex
) const;

155 
födDevi˚
(c⁄° * 
devi˚Name
) const;

157 
	g¥Ÿe˘ed
:

159 c⁄° * 
PROP_EXPOSURE_COMPENSACTION
;

160 c⁄° * 
	gPROP_SELF_TIMER_DELAY
;

161 c⁄° * 
	gPROP_MANUALFOCUS
;

162 c⁄° * 
	gPROP_AUTOFOCUS
;

163 c⁄° * 
	gPROP_ISO
;

164 c⁄° * 
	gPROP_SPEED
;

165 c⁄° * 
	gPROP_APERTURE_NIKON
;

166 c⁄° * 
	gPROP_APERTURE_CANON
;

167 c⁄° * 
	gPROP_EXPOSURE_PROGRAM
;

168 c⁄° * 
	gPROP_VIEWFINDER
;

171 
GPC⁄ãxt
 * 
	gc⁄ãxt
 = 
NULL
;

172 
	gnumDevi˚s
;

173 
öôC⁄ãxt
();

176 
boﬁ
 
	g›íed
;

177 
Camîa
 * 
	gˇmîa
 = 
NULL
;

178 
M©
 
	g‰ame
;

181 
CamîaWidgë
 * 
	groŸWidgë
 = 
NULL
;

182 
CamîaWidgë
 * 
gëGíîicPr›îty
(
¥›îtyId
, & 
ouçut
) const;

183 
CamîaWidgë
 * 
£tGíîicPr›îty
(
¥›îtyId
, 
vÆue
,

184 
boﬁ
 & 
ouçut
) const;

187 
ªlﬂdC⁄fig
(Ë
throw
 (
GPhŸo2Ex˚±i⁄
);

188 
CamîaWidgë
 * 
gëWidgë
(
widgëId
) const;

189 
CamîaWidgë
 * 
födWidgëByName
(c⁄° * 
«me
) const;

192 
ªadFømeFromFûe
(
CamîaFûe
 * 
fûe
, 
OuçutAºay
 
ouçutFøme
Ë
throw
 (
GPhŸo2Ex˚±i⁄
);

195 
‰õnd
 
˘xEº‹Func
(
GPC⁄ãxt
 *, const *, *);

196 
‰õnd
 
˘xSètusFunc
(
GPC⁄ãxt
 *, const *, *);

197 
‰õnd
 
˘xMesßgeFunc
(
GPC⁄ãxt
 *, const *, *);

200 
	eMsgTy≥


202 
	gERROR
 = () 'E',

203 
	gWARNING
 = () 'W',

204 
	gSTATUS
 = () 'S',

205 
	gOTHER
 = () 'O'

207 
	gãm∂©e
<
ty≥«me
 
	gOs°ªamPröèbÀ
>

208 
mesßge
(
MsgTy≥
 
msgTy≥
, c⁄° * 
msg
,

209 
Os°ªamPröèbÀ
 & 
¨g
) const;

211 
	g¥iv©e
:

213 
CamîaAbûôõsLi°
 * 
abûôõsLi°
 = 
NULL
;

214 
GPP‹tInfoLi°
 * 
	gˇ∑bÀP‹ts
 = 
NULL
;

215 
CamîaLi°
 * 
	gÆlDevi˚s
 = 
NULL
;

218 
CamîaAbûôõs
 
	gˇmîaAbûôõs
;

219 
	g°d
::
deque
<
CamîaFûe
 *> 
gøbbedFømes
;

222 
boﬁ
 
	g¥evõw
;

223 
	g°d
::
°rög
 
widgëInfo
;

224 
	g°d
::
m≠
<, 
	gCamîaWidgë
 *> 
	gwidgës
;

225 
boﬁ
 
	gªlﬂdOnCh™ge
;

226 
time_t
 
	gfú°C≠tuªdFømeTime
;

227 
	gˇ±uªdFømes
;

229 
DigôÆCamîaC≠tuª
(const DigitalCameraCapture&);

230 
	gDigôÆCamîaC≠tuª
& 
	g›î©‹
=(
DigôÆCamîaC≠tuª
 const&);

233 
	gnoOfWidgës
;

234 
widgëDes¸ùti⁄
(
°d
::
o°ªam
 &
os
, 
CamîaWidgë
 * 
widgë
) const

235 
throw
 (
GPhŸo2Ex˚±i⁄
);

236 
cﬁÀ˘Widgës
(
°d
::
o°ªam
 &
os
, 
CamîaWidgë
 * 
widgë
)

237 
throw
 (
GPhŸo2Ex˚±i⁄
);

240 
muèbÀ
 
	g°d
::
o°rög°ªam
 
msgsBuf„r
;

241 
muèbÀ
 
	g°d
::
°rög
 
œ°Flush
;

242 
boﬁ
 
	gcﬁÀ˘Msgs
;

248 
	#CR
(
GPHOTO2_FUN
) do {\

249 
r_0629c47b758
;\

250 i‡((
r_0629c47b758
 = (
GPHOTO2_FUN
)Ë< 
GP_OK
) {\

251 
throw
 
	`GPhŸo2Ex˚±i⁄
(#GPHOTO2_FUN, 
r_0629c47b758
);\

253 } 0)

	)

259 
˘xEº‹Func
(
GPC⁄ãxt
 *, c⁄° * 
°r
, * 
th©GPhŸoC≠
)

261 c⁄° 
DigôÆCamîaC≠tuª
 * 
	g£lf
 =

262 (c⁄° 
DigôÆCamîaC≠tuª
 *Ë
th©GPhŸoC≠
;

263 
	g£lf
->
mesßge
(
£lf
->
ERROR
, "c⁄ãxà„edback", 
°r
);

270 
˘xSètusFunc
(
GPC⁄ãxt
 *, c⁄° * 
°r
, * 
th©GPhŸoC≠
)

272 c⁄° 
DigôÆCamîaC≠tuª
 * 
	g£lf
 =

273 (c⁄° 
DigôÆCamîaC≠tuª
 *Ë
th©GPhŸoC≠
;

274 
	g£lf
->
mesßge
(
£lf
->
STATUS
, "c⁄ãxà„edback", 
°r
);

281 
˘xMesßgeFunc
(
GPC⁄ãxt
 *, c⁄° * 
°r
, * 
th©GPhŸoC≠
)

283 c⁄° 
DigôÆCamîaC≠tuª
 * 
	g£lf
 =

284 (c⁄° 
DigôÆCamîaC≠tuª
 *Ë
th©GPhŸoC≠
;

285 
	g£lf
->
mesßge
(
£lf
->
OTHER
, "c⁄ãxà„edback", 
°r
);

291 c⁄° * 
	gDigôÆCamîaC≠tuª
::
£∑øt‹
 = ",";

295 c⁄° * 
	gDigôÆCamîaC≠tuª
::
löeDñimôî
 = "\n";

302 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_EXPOSURE_COMPENSACTION
 =

304 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_SELF_TIMER_DELAY
 = "selftimerdelay";

305 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_MANUALFOCUS
 = "manualfocusdrive";

306 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_AUTOFOCUS
 = "autofocusdrive";

307 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_ISO
 = "iso";

308 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_SPEED
 = "shutterspeed";

309 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_APERTURE_NIKON
 = "f-number";

310 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_APERTURE_CANON
 = "aperture";

311 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_EXPOSURE_PROGRAM
 = "expprogram";

312 c⁄° * 
	gDigôÆCamîaC≠tuª
::
PROP_VIEWFINDER
 = "viewfinder";

317 
	gDigôÆCamîaC≠tuª
::
öôC⁄ãxt
()

319 
ˇ±uªdFømes
 = 
noOfWidgës
 = 
numDevi˚s
 = 0;

320 
	g›íed
 = 
¥evõw
 = 
ªlﬂdOnCh™ge
 = 
Ál£
;

321 
	gfú°C≠tuªdFømeTime
 = 0;

323 
	gc⁄ãxt
 = 
gp_c⁄ãxt_√w
();

325 
gp_c⁄ãxt_£t_îr‹_func
(
c⁄ãxt
, 
˘xEº‹Func
, (*Ë
this
);

326 
gp_c⁄ãxt_£t_°©us_func
(
c⁄ãxt
, 
˘xSètusFunc
, (*Ë
this
);

327 
gp_c⁄ãxt_£t_mesßge_func
(
c⁄ãxt
, 
˘xMesßgeFunc
, (*Ë
this
);

329 
	gåy


332 
CR
(
gp_abûôõs_li°_√w
(&
abûôõsLi°
));

333 
CR
(
gp_abûôõs_li°_lﬂd
(
abûôõsLi°
, 
c⁄ãxt
));

336 
CR
(
gp_p‹t_öfo_li°_√w
(&
ˇ∑bÀP‹ts
));

337 
CR
(
gp_p‹t_öfo_li°_lﬂd
(
ˇ∑bÀP‹ts
));

340 
CR
(
gp_li°_√w
(&
ÆlDevi˚s
));

341 
CR
(
gp_ˇmîa_autodëe˘
(
ÆlDevi˚s
, 
c⁄ãxt
));

342 
CR
(
numDevi˚s
 = 
gp_li°_cou¡
(
ÆlDevi˚s
));

344 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

346 
	gnumDevi˚s
 = 0;

353 
	gDigôÆCamîaC≠tuª
::
DigôÆCamîaC≠tuª
()

355 
öôC⁄ãxt
();

361 
	gDigôÆCamîaC≠tuª
::
DigôÆCamîaC≠tuª
(
ödex
)

363 
öôC⁄ãxt
();

364 i‡(
devi˚Exi°
(
ödex
))

365 
›í
(
ödex
);

372 
	gDigôÆCamîaC≠tuª
::
DigôÆCamîaC≠tuª
(c⁄° 
Såög
 & 
devi˚Name
)

374 
öôC⁄ãxt
();

375 
	gödex
 = 
födDevi˚
(
devi˚Name
.
c_°r
());

376 i‡(
devi˚Exi°
(
ödex
))

377 
›í
(
ödex
);

383 
	gDigôÆCamîaC≠tuª
::~
DigôÆCamîaC≠tuª
()

385 
˛o£
();

386 
	gåy


388 
CR
(
gp_abûôõs_li°_‰ì
(
abûôõsLi°
));

389 
	gabûôõsLi°
 = 
NULL
;

390 
CR
(
gp_p‹t_öfo_li°_‰ì
(
ˇ∑bÀP‹ts
));

391 
	gˇ∑bÀP‹ts
 = 
NULL
;

392 
CR
(
gp_li°_uƒef
(
ÆlDevi˚s
));

393 
	gÆlDevi˚s
 = 
NULL
;

394 
gp_c⁄ãxt_uƒef
(
c⁄ãxt
);

395 
	gc⁄ãxt
 = 
NULL
;

397 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

399 
mesßge
(
ERROR
, "de°ru˘i⁄Éº‹", 
e
);

406 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
›í
(
ödex
)

408 c⁄° * 
modñ
 = 0, *
	g∑th
 = 0;

409 
	gm
, 
	gp
;

410 
GPP‹tInfo
 
	gp‹tInfo
;

412 i‡(
isO≥√d
()) {

413 
˛o£
();

416 
	gåy


418 
CR
(
gp_ˇmîa_√w
(&
ˇmîa
));

419 
CR
(
gp_li°_gë_«me
(
ÆlDevi˚s
, 
ödex
, &
modñ
));

420 
CR
(
gp_li°_gë_vÆue
(
ÆlDevi˚s
, 
ödex
, &
∑th
));

423 
CR
(
m
 = 
gp_abûôõs_li°_lookup_modñ
(
abûôõsLi°
, 
modñ
));

424 
CR
(
gp_abûôõs_li°_gë_abûôõs
(
abûôõsLi°
, 
m
, &
ˇmîaAbûôõs
));

425 
CR
(
gp_ˇmîa_£t_abûôõs
(
ˇmîa
, 
ˇmîaAbûôõs
));

428 
CR
(
p
 = 
gp_p‹t_öfo_li°_lookup_∑th
(
ˇ∑bÀP‹ts
, 
∑th
));

429 
CR
(
gp_p‹t_öfo_li°_gë_öfo
(
ˇ∑bÀP‹ts
, 
p
, &
p‹tInfo
));

430 
CR
(
gp_ˇmîa_£t_p‹t_öfo
(
ˇmîa
, 
p‹tInfo
));

433 
CR
(
gp_ˇmîa_öô
(
ˇmîa
, 
c⁄ãxt
));

435 
mesßge
(
STATUS
, "c⁄√˘ed camîa", 
modñ
);

436 
mesßge
(
STATUS
, "c⁄√˘ed usög", 
∑th
);

439 
	gfú°C≠tuªdFømeTime
 = 0;

440 
	gˇ±uªdFømes
 = 0;

441 
	g¥evõw
 = 
Ál£
;

442 
	gªlﬂdOnCh™ge
 = 
Ál£
;

443 
	gcﬁÀ˘Msgs
 = 
Ál£
;

445 
ªlﬂdC⁄fig
();

447 
	g›íed
 = 
åue
;

448  
	gåue
;

450 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

452 
mesßge
(
WARNING
, "›íög devi˚ faûed", 
e
);

453  
	gÁl£
;

460 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
isO≥√d
() const

462  
›íed
;

468 
	gDigôÆCamîaC≠tuª
::
˛o£
()

470 
åy


472 i‡(!
‰ame
.
em±y
())

474 
‰ame
.
ªÀa£
();

476 i‡(
	gˇmîa
)

478 
CR
(
gp_ˇmîa_exô
(
ˇmîa
, 
c⁄ãxt
));

479 
CR
(
gp_ˇmîa_uƒef
(
ˇmîa
));

480 
	gˇmîa
 = 
NULL
;

482 
	g›íed
 = 
Ál£
;

483 i‡(
	g‰ames
 = 
gøbbedFømes
.
size
() > 0)

485 
‰ames
--)

487 
CamîaFûe
 * 
fûe
 = 
gøbbedFømes
.
‰⁄t
();

488 
	ggøbbedFømes
.
p›_‰⁄t
();

489 
CR
(
gp_fûe_uƒef
(
fûe
));

492 i‡(
	groŸWidgë
)

494 
	gwidgëInfo
.
˛ór
();

495 
CR
(
gp_widgë_uƒef
(
roŸWidgë
));

496 
	groŸWidgë
 = 
NULL
;

499 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

501 
mesßge
(
ERROR
, "ˇ¬Ÿ clo£ devi˚Ör›îly", 
e
);

509 
CamîaWidgë
 * 
	gDigôÆCamîaC≠tuª
::
gëGíîicPr›îty
(
¥›îtyId
,

510 & 
ouçut
) const

512 
	g¥›îtyId
)

514 
	gCV_CAP_PROP_POS_MSEC
:

517 
ouçut
 = (
time
(0Ë- 
fú°C≠tuªdFømeTime
) * 1e2;

518  
	gNULL
;

520 
	gCV_CAP_PROP_POS_FRAMES
:

522 
ouçut
 = 
ˇ±uªdFømes
;

523  
	gNULL
;

525 
	gCV_CAP_PROP_FRAME_WIDTH
:

527 i‡(!
‰ame
.
em±y
())

529 
ouçut
 = 
‰ame
.
cﬁs
;

531  
	gNULL
;

533 
	gCV_CAP_PROP_FRAME_HEIGHT
:

535 i‡(!
‰ame
.
em±y
())

537 
ouçut
 = 
‰ame
.
rows
;

539  
	gNULL
;

541 
	gCV_CAP_PROP_FORMAT
:

543 i‡(!
‰ame
.
em±y
())

545 
ouçut
 = 
‰ame
.
ty≥
();

547  
	gNULL
;

549 
	gCV_CAP_PROP_FPS
:

551 
whﬁePro˚ssTime
 = 0;

552 
gëGíîicPr›îty
(
CV_CAP_PROP_POS_MSEC
, 
whﬁePro˚ssTime
);

553 
	gwhﬁePro˚ssTime
 /= 1e2;

554 
	gouçut
 = 
ˇ±uªdFømes
 / 
whﬁePro˚ssTime
;

555  
	gNULL
;

557 
	gCV_CAP_PROP_FRAME_COUNT
:

559 
ouçut
 = 
ˇ±uªdFømes
;

560  
	gNULL
;

562 
	gCV_CAP_PROP_EXPOSURE
:

563  
födWidgëByName
(
PROP_EXPOSURE_COMPENSACTION
);

564 
	gCV_CAP_PROP_TRIGGER_DELAY
:

565  
födWidgëByName
(
PROP_SELF_TIMER_DELAY
);

566 
	gCV_CAP_PROP_ZOOM
:

567  
födWidgëByName
(
PROP_MANUALFOCUS
);

568 
	gCV_CAP_PROP_FOCUS
:

569  
födWidgëByName
(
PROP_AUTOFOCUS
);

570 
	gCV_CAP_PROP_ISO_SPEED
:

571  
födWidgëByName
(
PROP_ISO
);

572 
	gCV_CAP_PROP_SPEED
:

573  
födWidgëByName
(
PROP_SPEED
);

574 
	gCV_CAP_PROP_APERTURE
:

576 
CamîaWidgë
 * 
widgë
 = 
födWidgëByName
(
PROP_APERTURE_NIKON
);

577  (
	gwidgë
 =0Ë? 
födWidgëByName
(
PROP_APERTURE_CANON
Ë: 
widgë
;

579 
	gCV_CAP_PROP_EXPOSUREPROGRAM
:

580  
födWidgëByName
(
PROP_EXPOSURE_PROGRAM
);

581 
	gCV_CAP_PROP_VIEWFINDER
:

582  
födWidgëByName
(
PROP_VIEWFINDER
);

584  
	gNULL
;

591 
	gDigôÆCamîaC≠tuª
::
gëPr›îty
(
¥›îtyId
) const

593 
CamîaWidgë
 * 
widgë
 = 
NULL
;

594 
	gouçut
 = 0;

595 i‡(
	g¥›îtyId
 < 0)

597 
	gwidgë
 = 
gëWidgë
(-
¥›îtyId
);

601 
	g¥›îtyId
)

604 
	gCV_CAP_PROP_GPHOTO2_PREVIEW
:

605  
¥evõw
;

606 
	gCV_CAP_PROP_GPHOTO2_WIDGET_ENUMERATE
:

607 i‡(
roŸWidgë
 =
NULL
)

609  (
	göçå_t
Ë
	gwidgëInfo
.
c_°r
();

610 
	gCV_CAP_PROP_GPHOTO2_RELOAD_CONFIG
:

612 
	gCV_CAP_PROP_GPHOTO2_RELOAD_ON_CHANGE
:

613  
ªlﬂdOnCh™ge
;

614 
	gCV_CAP_PROP_GPHOTO2_COLLECT_MSGS
:

615  
cﬁÀ˘Msgs
;

616 
	gCV_CAP_PROP_GPHOTO2_FLUSH_MSGS
:

617 
œ°Flush
 = 
msgsBuf„r
.
°r
();

618 
	gmsgsBuf„r
.
°r
("");

619 
	gmsgsBuf„r
.
˛ór
();

620  (
	göçå_t
Ë
	gœ°Flush
.
c_°r
();

622 
widgë
 = 
gëGíîicPr›îty
(
¥›îtyId
, 
ouçut
);

626 i‡(
	gwidgë
 =
NULL
)

627  
ouçut
;

628 
	gåy


630 
CamîaWidgëTy≥
 
	gty≥
;

631 
CR
(
gp_widgë_gë_ty≥
(
widgë
, &
ty≥
));

632 
	gty≥
)

634 
	gGP_WIDGET_MENU
:

635 
GP_WIDGET_RADIO
:

637 
˙t
 = 0, 
	gi
;

638 c⁄° * 
	gcuºít
;

639 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
cuºít
));

640 
CR
(
˙t
 = 
gp_widgë_cou¡_choi˚s
(
widgë
));

641 
	gi
 = 0; i < 
	g˙t
; i++)

643 c⁄° *
	gchoi˚
;

644 
CR
(
gp_widgë_gë_choi˚
(
widgë
, 
i
, &
choi˚
));

645 i‡(
	g°d
::
°rcmp
(
choi˚
, 
cuºít
) == 0)

647  
i
;

652 
	gGP_WIDGET_TOGGLE
:

654 
vÆue
;

655 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
vÆue
));

656  
	gvÆue
;

658 
	gGP_WIDGET_RANGE
:

660 
vÆue
;

661 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
vÆue
));

662  
	gvÆue
;

666 * 
vÆue
;

667 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
vÆue
));

668  (
	göçå_t
Ë
	gvÆue
;

672 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

674 
	gbuf
[128] = "";

675 
•rötf
(
buf
, "ˇ¬Ÿ gëÖr›îty: %d", 
¥›îtyId
);

676 
mesßge
(
WARNING
, (c⁄° *Ë
buf
, 
e
);

685 
CamîaWidgë
 * 
	gDigôÆCamîaC≠tuª
::
£tGíîicPr›îty
(
¥›îtyId
,

686 , 
boﬁ
 & 
ouçut
) const

688 
	g¥›îtyId
)

690 
	gCV_CAP_PROP_POS_MSEC
:

691 
CV_CAP_PROP_POS_FRAMES
:

692 
CV_CAP_PROP_FRAME_WIDTH
:

693 
CV_CAP_PROP_FRAME_HEIGHT
:

694 
CV_CAP_PROP_FPS
:

695 
CV_CAP_PROP_FRAME_COUNT
:

696 
CV_CAP_PROP_FORMAT
:

697 
ouçut
 = 
Ál£
;

698  
	gNULL
;

699 
	gCV_CAP_PROP_EXPOSURE
:

700  
födWidgëByName
(
PROP_EXPOSURE_COMPENSACTION
);

701 
	gCV_CAP_PROP_TRIGGER_DELAY
:

702  
födWidgëByName
(
PROP_SELF_TIMER_DELAY
);

703 
	gCV_CAP_PROP_ZOOM
:

704  
födWidgëByName
(
PROP_MANUALFOCUS
);

705 
	gCV_CAP_PROP_FOCUS
:

706  
födWidgëByName
(
PROP_AUTOFOCUS
);

707 
	gCV_CAP_PROP_ISO_SPEED
:

708  
födWidgëByName
(
PROP_ISO
);

709 
	gCV_CAP_PROP_SPEED
:

710  
födWidgëByName
(
PROP_SPEED
);

711 
	gCV_CAP_PROP_APERTURE
:

713 
CamîaWidgë
 * 
widgë
 = 
födWidgëByName
(
PROP_APERTURE_NIKON
);

714  (
	gwidgë
 =
NULL
Ë? 
födWidgëByName
(
PROP_APERTURE_CANON
Ë: 
widgë
;

716 
	gCV_CAP_PROP_EXPOSUREPROGRAM
:

717  
födWidgëByName
(
PROP_EXPOSURE_PROGRAM
);

718 
	gCV_CAP_PROP_VIEWFINDER
:

719  
födWidgëByName
(
PROP_VIEWFINDER
);

721  
	gNULL
;

728 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
£tPr›îty
(
¥›îtyId
, 
vÆue
)

730 
CamîaWidgë
 * 
	gwidgë
 = 
NULL
;

731 
boﬁ
 
	gouçut
 = 
Ál£
;

732 i‡(
	g¥›îtyId
 < 0)

734 
	gwidgë
 = 
gëWidgë
(-
¥›îtyId
);

738 
	g¥›îtyId
)

741 
	gCV_CAP_PROP_GPHOTO2_PREVIEW
:

742 
¥evõw
 = 
vÆue
 != 0;

743  
	gåue
;

744 
	gCV_CAP_PROP_GPHOTO2_WIDGET_ENUMERATE
:

745  
Ál£
;

746 
	gCV_CAP_PROP_GPHOTO2_RELOAD_CONFIG
:

747 
ªlﬂdC⁄fig
();

748  
	gåue
;

749 
	gCV_CAP_PROP_GPHOTO2_RELOAD_ON_CHANGE
:

750 
ªlﬂdOnCh™ge
 = 
vÆue
 != 0;

751  
	gåue
;

752 
	gCV_CAP_PROP_GPHOTO2_COLLECT_MSGS
:

753 
cﬁÀ˘Msgs
 = 
vÆue
 != 0;

754  
	gåue
;

755 
	gCV_CAP_PROP_GPHOTO2_FLUSH_MSGS
:

756  
Ál£
;

758 
widgë
 = 
£tGíîicPr›îty
(
¥›îtyId
, 
vÆue
, 
ouçut
);

762 i‡(
	gwidgë
 =
NULL
)

763  
ouçut
;

764 
	gåy


766 
CamîaWidgëTy≥
 
	gty≥
;

767 
CR
(
gp_widgë_gë_ty≥
(
widgë
, &
ty≥
));

768 
	gty≥
)

770 
	gGP_WIDGET_RADIO
:

771 
GP_WIDGET_MENU
:

773 
i
 = 
°©ic_ˇ°
<>(
vÆue
);

774 *
	gchoi˚
;

775 
CR
(
gp_widgë_gë_choi˚
(
widgë
, 
i
, (c⁄° **)&
choi˚
));

776 
CR
(
gp_widgë_£t_vÆue
(
widgë
, 
choi˚
));

779 
	gGP_WIDGET_TOGGLE
:

781 
i
 = 
°©ic_ˇ°
<>(
vÆue
);

782 
CR
(
gp_widgë_£t_vÆue
(
widgë
, &
i
));

785 
	gGP_WIDGET_RANGE
:

787 
v
 = 
°©ic_ˇ°
<>(
vÆue
);

788 
CR
(
gp_widgë_£t_vÆue
(
widgë
, &
v
));

793 
CR
(
gp_widgë_£t_vÆue
(
widgë
, (* )(
öçå_t
 )&
vÆue
));

797 i‡(!
	gªlﬂdOnCh™ge
)

800 
CR
(
gp_widgë_£t_ch™ged
(
widgë
, 1));

804 * 
	gloˇÀTmp
 = 
£éoˇÀ
(
LC_ALL
, "C");

805 
CR
(
gp_ˇmîa_£t_c⁄fig
(
ˇmîa
, 
roŸWidgë
, 
c⁄ãxt
));

806 
£éoˇÀ
(
LC_ALL
, 
loˇÀTmp
);

808 i‡(
	gªlﬂdOnCh™ge
)

810 
ªlﬂdC⁄fig
();

812 
CR
(
gp_widgë_£t_ch™ged
(
widgë
, 0));

815 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

817 
	gbuf
[128] = "";

818 
•rötf
(
buf
, "ˇ¬Ÿ sëÖr›îty: %dÅÿ%f", 
¥›îtyId
, 
vÆue
);

819 
mesßge
(
WARNING
, (c⁄° *Ë
buf
, 
e
);

820  
	gÁl£
;

822  
	gåue
;

829 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
gøbFøme
()

831 
CamîaFûeP©h
 
fûeP©h
;

832 
CamîaFûe
 * 
	gfûe
 = 
NULL
;

833 
	gåy


835 
CR
(
gp_fûe_√w
(&
fûe
));

837 i‡(
	g¥evõw
)

839 
CR
(
gp_ˇmîa_ˇ±uª_¥evõw
(
ˇmîa
, 
fûe
, 
c⁄ãxt
));

844 
CR
(
gp_ˇmîa_ˇ±uª
(
ˇmîa
, 
GP_CAPTURE_IMAGE
, &
fûeP©h
, 
c⁄ãxt
));

845 
CR
(
gp_ˇmîa_fûe_gë
(
ˇmîa
, 
fûeP©h
.
fﬁdî
, fûeP©h.
«me
, 
GP_FILE_TYPE_NORMAL
,

846 
fûe
, 
c⁄ãxt
));

847 
CR
(
gp_ˇmîa_fûe_dñëe
(
ˇmîa
, 
fûeP©h
.
fﬁdî
, fûeP©h.
«me
, 
c⁄ãxt
));

850 i‡(
	gfú°C≠tuªdFømeTime
 == 0)

852 
fú°C≠tuªdFømeTime
 = 
time
(0);

854 
	gˇ±uªdFømes
++;

855 
	ggøbbedFømes
.
push_back
(
fûe
);

857 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

859 i‡(
	gfûe
)

860 
gp_fûe_uƒef
(
fûe
);

861 
mesßge
(
WARNING
, "ˇ¬Ÿ gøbÇew føme", 
e
);

862  
	gÁl£
;

864  
	gåue
;

870 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
ªåõveFøme
(, 
OuçutAºay
 
ouçutFøme
)

872 i‡(
	ggøbbedFømes
.
size
() > 0)

874 
CamîaFûe
 * 
	gfûe
 = 
gøbbedFømes
.
‰⁄t
();

875 
	ggøbbedFømes
.
p›_‰⁄t
();

876 
	gåy


878 
ªadFømeFromFûe
(
fûe
, 
ouçutFøme
);

879 
CR
(
gp_fûe_uƒef
(
fûe
));

881 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

883 
mesßge
(
WARNING
, "ˇ¬ŸÑód fûêgøbbed from devi˚", 
e
);

884  
	gÁl£
;

889  
	gÁl£
;

891  
	gåue
;

897 
boﬁ
 
	gDigôÆCamîaC≠tuª
::
devi˚Exi°
(
ödex
) const

899  (
numDevi˚s
 > 0Ë&& (
ödex
 <ÇumDevices);

905 
	gDigôÆCamîaC≠tuª
::
födDevi˚
(c⁄° * 
devi˚Name
) const

907 c⁄° * 
modñ
 = 0;

908 
	gåy


910 i‡(
	gdevi˚Name
 != 0)

912 
i
 = 0; 
	gi
 < 
	gnumDevi˚s
; ++i)

914 
CR
(
gp_li°_gë_«me
(
ÆlDevi˚s
, 
i
, &
modñ
));

915 i‡(
	gmodñ
 !0 && 
°r°r
(
modñ
, 
devi˚Name
))

917  
	gi
;

922 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

932 
	gDigôÆCamîaC≠tuª
::
ªlﬂdC⁄fig
(Ë
throw
 (
GPhŸo2Ex˚±i⁄
)

934 
°d
::
o°rög°ªam
 
widgëInfoLi°Såóm
;

936 i‡(
	groŸWidgë
 !
NULL
)

938 
widgëInfo
.
˛ór
();

939 
CR
(
gp_widgë_uƒef
(
roŸWidgë
));

940 
	groŸWidgë
 = 
NULL
;

941 
	gwidgës
.
˛ór
();

944 * 
	gloˇÀTmp
 = 
£éoˇÀ
(
LC_ALL
, "C");

945 
CR
(
gp_ˇmîa_gë_c⁄fig
(
ˇmîa
, &
roŸWidgë
, 
c⁄ãxt
));

946 
£éoˇÀ
(
LC_ALL
, 
loˇÀTmp
);

947 
	gwidgëInfoLi°Såóm
 << "id,label,name,info,readonly,type,value,"

948 << 
	glöeDñimôî
;

949 
	gnoOfWidgës
 = 
cﬁÀ˘Widgës
(
widgëInfoLi°Såóm
, 
roŸWidgë
) + 1;

950 
	gwidgëInfo
 = 
widgëInfoLi°Såóm
.
°r
();

956 
CamîaWidgë
 * 
	gDigôÆCamîaC≠tuª
::
gëWidgë
(
widgëId
) const

958 
CamîaWidgë
 * 
widgë
;

959 
	g°d
::
m≠
<, 
	gCamîaWidgë
 *>::
c⁄°_ôî©‹
 
ô
 = 
widgës
.
föd
(
widgëId
);

960 i‡(
	gô
 =
widgës
.
íd
())

962 
	gwidgë
 = 
ô
->
£c⁄d
;

963  
	gwidgë
;

969 
CamîaWidgë
 * 
	gDigôÆCamîaC≠tuª
::
födWidgëByName
(

970 c⁄° * 
subName
) const

972 i‡(
subName
 !
NULL
)

974 
åy


976 c⁄° * 
«me
;

977 
	g°d
::
	tm≠
<, 
	tCamîaWidgë
 *>::
	tc⁄°_ôî©‹
 
	tô_t
;

978 
ô_t
 
	gô
 = 
widgës
.
begö
(), 
	gíd
 = widgës.
íd
();

979 
	gô
 !
íd
)

981 
CR
(
gp_widgë_gë_«me
(
ô
->
£c⁄d
, &
«me
));

982 i‡(
°r°r
(
«me
, 
subName
))

984 
	gô
++;

986  (
	gô
 !
íd
Ë? 
ô
->
£c⁄d
 : 
NULL
;

988 
ˇtch
 (
GPhŸo2Ex˚±i⁄
 & 
e
)

990 
mesßge
(
WARNING
, "îr‹ whûê£¨chög f‹ widgë", 
e
);

1001 
	gDigôÆCamîaC≠tuª
::
ªadFømeFromFûe
(
CamîaFûe
 * 
fûe
, 
OuçutAºay
 
ouçutFøme
)

1002 
throw
 (
GPhŸo2Ex˚±i⁄
)

1005 c⁄° * 
	gd©a
;

1006 
	gsize
;

1007 
CR
(
gp_fûe_gë_d©a_™d_size
(
fûe
, &
d©a
, &
size
));

1008 i‡(
	gsize
 > 0)

1010 
M©
 
	gbuf
 = M©(1, 
size
, 
CV_8UC1
, (*Ë
d©a
);

1011 if(!
	gbuf
.
em±y
())

1013 
	g‰ame
 = 
imdecode
(
buf
, 
CV_LOAD_IMAGE_UNCHANGED
);

1015 
	g‰ame
.
c›yTo
(
ouçutFøme
);

1024 
	gDigôÆCamîaC≠tuª
::
widgëDes¸ùti⁄
(
°d
::
o°ªam
 &
os
,

1025 
CamîaWidgë
 * 
widgë
Ëc⁄° 
throw
 (
GPhŸo2Ex˚±i⁄
)

1027 c⁄° * 
	gœbñ
, *
	g«me
, *
	göfo
;

1028 
	gid
, 
	gªad⁄ly
;

1029 
CamîaWidgëTy≥
 
	gty≥
;

1031 
CR
(
gp_widgë_gë_id
(
widgë
, &
id
));

1032 
CR
(
gp_widgë_gë_œbñ
(
widgë
, &
œbñ
));

1033 
CR
(
gp_widgë_gë_«me
(
widgë
, &
«me
));

1034 
CR
(
gp_widgë_gë_öfo
(
widgë
, &
öfo
));

1035 
CR
(
gp_widgë_gë_ty≥
(
widgë
, &
ty≥
));

1036 
CR
(
gp_widgë_gë_ªad⁄ly
(
widgë
, &
ªad⁄ly
));

1038 i‡((
	gty≥
 =
GP_WIDGET_WINDOW
Ë|| (
ty≥
 =
GP_WIDGET_SECTION
)

1039 || (
ty≥
 =
GP_WIDGET_BUTTON
))

1041 
ªad⁄ly
 = 1;

1043 
	gos
 << (
	gid
 - 
	gnoOfWidgës
Ë<< 
	g£∑øt‹
 << 
	gœbñ
 << sï¨©‹ << 
	g«me


1044 << 
	g£∑øt‹
 << 
	göfo
 << sï¨©‹ << 
	gªad⁄ly
 << separator;

1046 
	gty≥
)

1048 
	gGP_WIDGET_WINDOW
:

1050 
os
 << "wödow" << 
£∑øt‹
 << separator;

1053 
	gGP_WIDGET_SECTION
:

1055 
os
 << "£˘i⁄" << 
£∑øt‹
 << separator;

1058 
	gGP_WIDGET_TEXT
:

1060 
os
 << "ãxt" << 
£∑øt‹
;

1061 *
	gtxt
;

1062 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
txt
));

1063 
	gos
 << 
	gtxt
 << 
	g£∑øt‹
;

1066 
	gGP_WIDGET_RANGE
:

1068 
os
 << "ønge" << 
£∑øt‹
;

1069 
	gf
, 
	gt
, 
	gb
, 
	gs
;

1070 
CR
(
gp_widgë_gë_ønge
(
widgë
, &
b
, &
t
, &
s
));

1071 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
f
));

1072 
	gos
 << "(" << 
	gb
 << ":" << 
	gt
 << ":" << 
	gs
 << "):" << 
	gf
 << 
	g£∑øt‹
;

1075 
	gGP_WIDGET_TOGGLE
:

1077 
os
 << "toggÀ" << 
£∑øt‹
;

1078 
	gt
;

1079 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
t
));

1080 
	gos
 << 
	gt
 << 
	g£∑øt‹
;

1083 
	gGP_WIDGET_RADIO
:

1084 
GP_WIDGET_MENU
:

1086 i‡(
ty≥
 =
GP_WIDGET_RADIO
)

1088 
os
 << "ødio" << 
£∑øt‹
;

1092 
	gos
 << "míu" << 
	g£∑øt‹
;

1094 
	g˙t
 = 0, 
	gi
;

1095 *
	gcuºít
;

1096 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
cuºít
));

1097 
CR
(
˙t
 = 
gp_widgë_cou¡_choi˚s
(
widgë
));

1098 
	gos
 << "(";

1099 
	gi
 = 0; i < 
	g˙t
; i++)

1101 c⁄° *
	gchoi˚
;

1102 
CR
(
gp_widgë_gë_choi˚
(
widgë
, 
i
, &
choi˚
));

1103 
	gos
 << 
	gi
 << ":" << 
	gchoi˚
;

1104 i‡(
	gi
 + 1 < 
	g˙t
)

1106 
	gos
 << ";";

1109 
	gos
 << "):" << 
	gcuºít
 << 
	g£∑øt‹
;

1112 
	gGP_WIDGET_BUTTON
:

1114 
os
 << "buâ⁄" << 
£∑øt‹
 << separator;

1117 
	gGP_WIDGET_DATE
:

1119 
os
 << "d©e" << 
£∑øt‹
;

1120 
	gt
;

1121 
time_t
 
	gxtime
;

1122 
tm
 *
	gxtm
;

1123 
	gtimebuf
[200];

1124 
CR
(
gp_widgë_gë_vÆue
(
widgë
, &
t
));

1125 
	gxtime
 = 
t
;

1126 
	gxtm
 = 
loˇ…ime
(&
xtime
);

1127 
°r·ime
(
timebuf
, —imebuf), "%c", 
xtm
);

1128 
	gos
 << 
	gt
 << ":" << 
	gtimebuf
 << 
	g£∑øt‹
;

1132  
	gid
;

1139 
	gDigôÆCamîaC≠tuª
::
cﬁÀ˘Widgës
(
°d
::
o°ªam
 & 
os
,

1140 
CamîaWidgë
 * 
widgë
Ë
throw
 (
GPhŸo2Ex˚±i⁄
)

1142 
	gid
 = 
widgëDes¸ùti⁄
(
os
, 
widgë
);

1143 
	gos
 << 
	glöeDñimôî
;

1145 
	gwidgës
[
id
 - 
noOfWidgës
] = 
widgë
;

1147 
CamîaWidgë
 * 
	gchûd
;

1148 
CamîaWidgëTy≥
 
	gty≥
;

1149 
CR
(
gp_widgë_gë_ty≥
(
widgë
, &
ty≥
));

1150 i‡((
	gty≥
 =
GP_WIDGET_WINDOW
Ë|| (
ty≥
 =
GP_WIDGET_SECTION
))

1152 
x
 = 0; 
	gx
 < 
gp_widgë_cou¡_chûdªn
(
widgë
); x++)

1154 
CR
(
gp_widgë_gë_chûd
(
widgë
, 
x
, &
chûd
));

1155 
	gid
 = 
°d
::
max
(
id
, 
cﬁÀ˘Widgës
(
os
, 
chûd
));

1158  
	gid
;

1166 
	gãm∂©e
<
ty≥«me
 
	gOs°ªamPröèbÀ
>

1167 
	gDigôÆCamîaC≠tuª
::
mesßge
(
MsgTy≥
 
msgTy≥
, c⁄° * 
msg
,

1168 
Os°ªamPröèbÀ
 & 
¨g
) const

1170 #i‡
deföed
(
NDEBUG
)

1171 i‡(
	gcﬁÀ˘Msgs
)

1174 
	g°d
::
o°rög°ªam
 
msgCª©‹
;

1175 
	g°d
::
°rög
 
out
;

1176 
	gty≥
 = (Ë
msgTy≥
;

1177 
	gmsgCª©‹
 << "[gPhŸo2][" << 
	gty≥
 << "]: " << 
	gmsg
 << ": " << 
	g¨g


1178 << 
	glöeDñimôî
;

1179 
	gout
 = 
msgCª©‹
.
°r
();

1180 #i‡!
deföed
(
NDEBUG
)

1181 i‡(
	gcﬁÀ˘Msgs
)

1184 
	gmsgsBuf„r
 << 
	gout
;

1186 #i‡!
deföed
(
NDEBUG
)

1187 #i‡
deföed
(
WIN32
Ë|| deföed(
_WIN32
)

1188 ::
OuçutDebugSåög
(
out
.
c_°r
());

1190 
Âuts
(
out
.
c_°r
(), 
°dîr
);

1200 
	gPå
<
	gIVideoC≠tuª
> 
¸óãGPhŸo2C≠tuª
(
ödex
)

1202 
	gPå
<
	gIVideoC≠tuª
> 
	gˇ±uª
 = 
makePå
<
gphŸo2
::
DigôÆCamîaC≠tuª
>(
ödex
);

1204 i‡(
	gˇ±uª
->
isO≥√d
())

1205  
	gˇ±uª
;

1207  
	gPå
<
	ggphŸo2
::
DigôÆCamîaC≠tuª
>();

1215 
	gPå
<
	gIVideoC≠tuª
> 
¸óãGPhŸo2C≠tuª
(c⁄° 
Såög
 & 
devi˚Name
)

1217 
	gPå
<
	gIVideoC≠tuª
> 
	gˇ±uª
 = 
makePå
<
gphŸo2
::
DigôÆCamîaC≠tuª
>(
devi˚Name
);

1219 i‡(
	gˇ±uª
->
isO≥√d
())

1220  
	gˇ±uª
;

1222  
	gPå
<
	ggphŸo2
::
DigôÆCamîaC≠tuª
>();

	@src/cap_gstreamer.cpp

50 
	~"¥ecomp.hµ
"

51 
	~<uni°d.h
>

52 
	~<°rög.h
>

53 
	~<g°/g°.h
>

54 
	~<g°/g°buf„r.h
>

55 
	~<g°/video/video.h
>

56 
	~<g°/≠p/g°≠psök.h
>

57 
	~<g°/≠p/g°≠p§c.h
>

58 
	~<g°/riff/riff-medü.h
>

59 
	~<g°/pbutûs/missög-∂ugös.h
>

61 
	#VERSION_NUM
(
maj‹
, 
mö‹
, 
mi¸o
Ë(maj‹ * 1000000 + mö‹ * 1000 + mi¸o)

	)

62 
	#FULL_GST_VERSION
 
	`VERSION_NUM
(
GST_VERSION_MAJOR
, 
GST_VERSION_MINOR
, 
GST_VERSION_MICRO
)

	)

64 #i‡
FULL_GST_VERSION
 >
VERSION_NUM
(0,10,32)

65 
	~<g°/pbutûs/ícodög-¥ofûe.h
>

70 #ifde‡
NDEBUG


71 
	#CV_WARN
(
mesßge
)

	)

73 
	#CV_WARN
(
mesßge
Ë
	`Ârötf
(
°dîr
, "w¨nög: %†(%s:%d)\n", mesßge, 
__FILE__
, 
__LINE__
)

	)

76 #i‡
GST_VERSION_MAJOR
 == 0

77 
	#COLOR_ELEM
 "ffm≥gcﬁ‹•a˚"

	)

78 #ñi‡
FULL_GST_VERSION
 < 
VERSION_NUM
(1,5,0)

79 
	#COLOR_ELEM
 "videoc⁄vît"

	)

81 
	#COLOR_ELEM
 "autovideoc⁄vît"

	)

84 
toFø˘i⁄
(
decimÆ
, &
numî©‹
, &
díomö©‹
);

85 
h™dÀMesßge
(
G°EÀmít
 * 
pùñöe
);

88 
	gcv
::
Muãx
 
g°_öôülizî_muãx
;

94 ˛as†
	cg°_öôülizî


96 
	mpublic
:

97 
	$öô
()

99 
g°_öôülizî_muãx
.
	`lock
();

100 
g°_öôülizî
 
öô
;

101 
g°_öôülizî_muãx
.
	`u∆ock
();

103 
¥iv©e
:

104 
	$g°_öôülizî
()

106 
	`g°_öô
(
NULL
, NULL);

110 
	}
}

117 ˛as†
	cCvC≠tuª_GSåómî
 : 
public
 
CvC≠tuª


119 
public
:

120 
	$CvC≠tuª_GSåómî
(Ë{ 
	`öô
(); }

121 
vútuÆ
 ~
	$CvC≠tuª_GSåómî
(Ë{ 
	`˛o£
(); 
	}
}

123 
vútuÆ
 
boﬁ
 
›í
–
ty≥
, c⁄° * 
fûíame
 );

124 
vútuÆ
 
˛o£
();

126 
vútuÆ
 
	$gëPr›îty
() const;

127 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

128 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

129 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

131 
¥Ÿe˘ed
:

132 
	`öô
();

133 
boﬁ
 
	`ª›í
();

134 
boﬁ
 
	`isPùñöePœyög
();

135 
	`°¨tPùñöe
();

136 
	`°›Pùñöe
();

137 
	`ª°¨tPùñöe
();

138 
	`£tFûãr
(c⁄° * 
¥›
, 
ty≥
, 
v1
, 
v2
 = 0);

139 
	`ªmoveFûãr
(c⁄° *
fûãr
);

140 
	`√wPad
(
G°EÀmít
 *
myñemít
,

141 
G°Pad
 *
∑d
,

142 
gpoöãr
 
d©a
);

143 
G°EÀmít
* 
pùñöe
;

144 
G°EÀmít
* 
uridecodebö
;

145 
G°EÀmít
* 
cﬁ‹
;

146 
G°EÀmít
* 
sök
;

147 #i‡
GST_VERSION_MAJOR
 > 0

148 
G°Sam∂e
* 
ßm∂e
;

149 
G°M≠Info
* 
öfo
;

151 
G°Buf„r
* 
buf„r
;

152 
G°C≠s
* 
ˇps
;

153 
I∂Image
* 
‰ame
;

154 
göt64
 
duøti⁄
;

155 
göt
 
width
;

156 
göt
 
height
;

157 
Âs
;

158 
	}
};

164 
	gCvC≠tuª_GSåómî
::
	$öô
()

166 
pùñöe
 = 
NULL
;

167 
uridecodebö
 = 
NULL
;

168 
cﬁ‹
 = 
NULL
;

169 
sök
 = 
NULL
;

170 #i‡
GST_VERSION_MAJOR
 > 0

171 
ßm∂e
 = 
NULL
;

172 
öfo
 = 
√w
 
G°M≠Info
;

174 
buf„r
 = 
NULL
;

175 
ˇps
 = 
NULL
;

176 
‰ame
 = 
NULL
;

177 
duøti⁄
 = -1;

178 
width
 = -1;

179 
height
 = -1;

180 
Âs
 = -1;

181 
	}
}

187 
	gCvC≠tuª_GSåómî
::
	$˛o£
()

189 i‡(
	`isPùñöePœyög
())

190 
this
->
	`°›Pùñöe
();

192 if(
pùñöe
) {

193 
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_NULL
);

194 
	`g°_obje˘_uƒef
(
	`GST_OBJECT
(
pùñöe
));

195 
pùñöe
 = 
NULL
;

198 
duøti⁄
 = -1;

199 
width
 = -1;

200 
height
 = -1;

201 
Âs
 = -1;

202 
	}
}

210 
boﬁ
 
	gCvC≠tuª_GSåómî
::
	$gøbFøme
()

212 if(!
pùñöe
)

213  
Ál£
;

216 if(!
this
->
	`isPùñöePœyög
())

217 
this
->
	`°¨tPùñöe
();

220 if(
	`g°_≠p_sök_is_eos
(
	`GST_APP_SINK
(
sök
)))

221  
Ál£
;

223 #i‡
GST_VERSION_MAJOR
 == 0

224 if(
buf„r
)

225 
	`g°_buf„r_uƒef
(
buf„r
);

227 
buf„r
 = 
	`g°_≠p_sök_puŒ_buf„r
(
	`GST_APP_SINK
(
sök
));

229 if(
ßm∂e
)

230 
	`g°_ßm∂e_uƒef
(
ßm∂e
);

232 
ßm∂e
 = 
	`g°_≠p_sök_puŒ_ßm∂e
(
	`GST_APP_SINK
(
sök
));

234 if(!
ßm∂e
)

235  
Ál£
;

237 
buf„r
 = 
	`g°_ßm∂e_gë_buf„r
(
ßm∂e
);

240 if(!
buf„r
)

241  
Ál£
;

243  
åue
;

244 
	}
}

251 
I∂Image
 * 
	gCvC≠tuª_GSåómî
::
	$ªåõveFøme
()

253 if(!
buf„r
)

257 if(!
‰ame
)

259 #i‡
GST_VERSION_MAJOR
 == 0

260 
G°C≠s
* 
buf„r_ˇps
 = 
	`g°_buf„r_gë_ˇps
(
buf„r
);

262 
G°C≠s
* 
buf„r_ˇps
 = 
	`g°_ßm∂e_gë_ˇps
(
ßm∂e
);

265 
	`as£π
(
	`g°_ˇps_gë_size
(
buf„r_ˇps
) == 1);

266 
G°Såu˘uª
* 
°ru˘uª
 = 
	`g°_ˇps_gë_°ru˘uª
(
buf„r_ˇps
, 0);

269 if(!
	`g°_°ru˘uª_gë_öt
(
°ru˘uª
, "width", &
width
) ||

270 !
	`g°_°ru˘uª_gë_öt
(
°ru˘uª
, "height", &
height
))

272 
	`g°_ˇps_uƒef
(
buf„r_ˇps
);

276 
dïth
 = 3;

277 #i‡
GST_VERSION_MAJOR
 > 0

278 
dïth
 = 0;

279 c⁄° 
gch¨
* 
«me
 = 
	`g°_°ru˘uª_gë_«me
(
°ru˘uª
);

280 c⁄° 
gch¨
* 
f‹m©
 = 
	`g°_°ru˘uª_gë_°rög
(
°ru˘uª
, "format");

282 i‡(!
«me
 || !
f‹m©
)

292 i‡(
	`°rˇ£cmp
(
«me
, "video/x-raw") == 0)

294 i‡(
	`°rˇ£cmp
(
f‹m©
, "BGR") == 0) {

295 
dïth
 = 3;

297 if(
	`°rˇ£cmp
(
f‹m©
, "GRAY8") == 0){

298 
dïth
 = 1;

301 i‡(
	`°rˇ£cmp
(
«me
, "video/x-bayer") == 0)

303 
dïth
 = 1;

306 i‡(
dïth
 > 0) {

307 
‰ame
 = 
	`cvCª©eImageHódî
(
	`cvSize
(
width
, 
height
), 
IPL_DEPTH_8U
, 
dïth
);

309 
	`g°_ˇps_uƒef
(
buf„r_ˇps
);

313 
	`g°_ˇps_uƒef
(
buf„r_ˇps
);

318 #i‡
GST_VERSION_MAJOR
 == 0

319 
‰ame
->
imageD©a
 = (*)
	`GST_BUFFER_DATA
(
buf„r
);

324 
gboﬁón
 
suc˚ss
 = 
	`g°_buf„r_m≠
(
buf„r
,
öfo
, (
G°M≠Fœgs
)
GST_MAP_READ
);

325 i‡(!
suc˚ss
){

330 
‰ame
->
imageD©a
 = (*)
öfo
->
d©a
;

331 
	`g°_buf„r_unm≠
(
buf„r
,
öfo
);

334  
‰ame
;

335 
	}
}

342 
boﬁ
 
	gCvC≠tuª_GSåómî
::
	$isPùñöePœyög
()

344 
G°Sèã
 
cuºít
, 
≥ndög
;

345 
G°ClockTime
 
timeout
 = 5*
GST_SECOND
;

346 if(!
	`GST_IS_ELEMENT
(
pùñöe
)){

347  
Ál£
;

350 
G°SèãCh™geRëu∫
 
ªt
 = 
	`g°_ñemít_gë_°©e
(
	`GST_ELEMENT
(
pùñöe
),&
cuºít
, &
≥ndög
, 
timeout
);

351 i‡(!
ªt
){

353  
Ál£
;

356  
cuºít
 =
GST_STATE_PLAYING
;

357 
	}
}

363 
	gCvC≠tuª_GSåómî
::
	$°¨tPùñöe
()

365 
	`CV_FUNCNAME
("icvStartPipeline");

367 
__BEGIN__
;

370 
G°SèãCh™geRëu∫
 
°©us
 = 
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_PLAYING
);

371 i‡(
°©us
 =
GST_STATE_CHANGE_ASYNC
)

374 
G°Sèã
 
°1
;

375 
G°Sèã
 
°2
;

376 
°©us
 = 
	`g°_ñemít_gë_°©e
(
pùñöe
, &
°1
, &
°2
, 
GST_CLOCK_TIME_NONE
);

378 i‡(
°©us
 =
GST_STATE_CHANGE_FAILURE
)

380 
	`h™dÀMesßge
(
pùñöe
);

381 
	`g°_obje˘_uƒef
(
pùñöe
);

382 
pùñöe
 = 
NULL
;

383 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: unableÅo startÖipeline\n");

388 
	`h™dÀMesßge
(
pùñöe
);

389 
__END__
;

390 
	}
}

397 
	gCvC≠tuª_GSåómî
::
	$°›Pùñöe
()

399 
	`CV_FUNCNAME
("icvStopPipeline");

401 
__BEGIN__
;

404 if(
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_NULL
) ==

405 
GST_STATE_CHANGE_FAILURE
) {

406 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: unableÅo stopÖipeline\n");

407 
	`g°_obje˘_uƒef
(
pùñöe
);

408 
pùñöe
 = 
NULL
;

411 
__END__
;

412 
	}
}

418 
	gCvC≠tuª_GSåómî
::
	$ª°¨tPùñöe
()

420 
	`h™dÀMesßge
(
pùñöe
);

422 
this
->
	`°›Pùñöe
();

423 
this
->
	`°¨tPùñöe
();

424 
	}
}

435 
	gCvC≠tuª_GSåómî
::
	$£tFûãr
(c⁄° *
¥›
, 
ty≥
, 
v1
, 
v2
)

438 if(!
ˇps
 || !–
	`GST_IS_CAPS
 (caps) ))

440 if(
ty≥
 =
G_TYPE_INT
)

442 #i‡
GST_VERSION_MAJOR
 == 0

443 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-øw-rgb", 
¥›
, 
ty≥
, 
v1
, 
NULL
);

445 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-øw","f‹m©",
G_TYPE_STRING
,"BGR", 
¥›
, 
ty≥
, 
v1
, 
NULL
);

450 #i‡
GST_VERSION_MAJOR
 == 0

451 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-øw-rgb", 
¥›
, 
ty≥
, 
v1
, 
v2
, 
NULL
);

453 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-øw","f‹m©",
G_TYPE_STRING
,"BGR", 
¥›
, 
ty≥
, 
v1
, 
v2
, 
NULL
);

459 #i‡
GST_VERSION_MAJOR
 > 0

460 i‡(! 
	`g°_ˇps_is_wrôabÀ
(
ˇps
))

461 
ˇps
 = 
	`g°_ˇps_make_wrôabÀ
 (caps);

463 if(
ty≥
 =
G_TYPE_INT
){

464 
	`g°_ˇps_£t_sim∂e
(
ˇps
, 
¥›
, 
ty≥
, 
v1
, 
NULL
);

466 
	`g°_ˇps_£t_sim∂e
(
ˇps
, 
¥›
, 
ty≥
, 
v1
, 
v2
, 
NULL
);

470 #i‡
GST_VERSION_MAJOR
 > 0

471 
ˇps
 = 
	`g°_ˇps_fix©e
(caps);

474 
	`g°_≠p_sök_£t_ˇps
(
	`GST_APP_SINK
(
sök
), 
ˇps
);

476 
	}
}

484 
	gCvC≠tuª_GSåómî
::
	$ªmoveFûãr
(c⁄° *
fûãr
)

486 if(!
ˇps
)

489 #i‡
GST_VERSION_MAJOR
 > 0

490 i‡(! 
	`g°_ˇps_is_wrôabÀ
(
ˇps
))

491 
ˇps
 = 
	`g°_ˇps_make_wrôabÀ
 (caps);

494 
G°Såu˘uª
 *
s
 = 
	`g°_ˇps_gë_°ru˘uª
(
ˇps
, 0);

495 
	`g°_°ru˘uª_ªmove_fõld
(
s
, 
fûãr
);

497 
	`g°_≠p_sök_£t_ˇps
(
	`GST_APP_SINK
(
sök
), 
ˇps
);

498 
	}
}

507 
	gCvC≠tuª_GSåómî
::
	$√wPad
(
G°EÀmít
 * ,

508 
G°Pad
 *
∑d
,

509 
gpoöãr
 
d©a
)

511 
G°Pad
 *
sök∑d
;

512 
G°EÀmít
 *
cﬁ‹
 = (G°EÀmíà*Ë
d©a
;

514 
sök∑d
 = 
	`g°_ñemít_gë_°©ic_∑d
 (
cﬁ‹
, "sink");

515 i‡(!
sök∑d
){

520 
	`g°_∑d_lök
 (
∑d
, 
sök∑d
);

521 
	`g°_obje˘_uƒef
 (
sök∑d
);

522 
	}
}

555 
boﬁ
 
	gCvC≠tuª_GSåómî
::
	$›í
–
ty≥
, c⁄° * 
fûíame
 )

557 
	`CV_FUNCNAME
("cvCaptureFromCAM_GStreamer");

559 
__BEGIN__
;

561 
g°_öôülizî
::
	`öô
();

563 
boﬁ
 
fûe
 = 
Ál£
;

564 
boﬁ
 
°ªam
 = 
Ál£
;

565 
boﬁ
 
m™uÆpùñöe
 = 
Ál£
;

566 *
uri
 = 
NULL
;

567 
uridecodebö
 = 
NULL
;

568 
G°EÀmítFa˘‹y
 * 
ã°Ác
;

569 
G°SèãCh™geRëu∫
 
°©us
;

571 i‡(
ty≥
 =
CV_CAP_GSTREAMER_V4L
){

572 
ã°Ác
 = 
	`g°_ñemít_Á˘‹y_föd
("v4lsrc");

573 i‡(!
ã°Ác
){

574  
Ál£
;

576 
	`g_obje˘_uƒef
(
	`G_OBJECT
(
ã°Ác
));

577 
fûíame
 = "v4l§¯! " 
COLOR_ELEM
 " !áppsink";

579 i‡(
ty≥
 =
CV_CAP_GSTREAMER_V4L2
){

580 
ã°Ác
 = 
	`g°_ñemít_Á˘‹y_föd
("v4l2src");

581 i‡(!
ã°Ác
){

582  
Ál£
;

584 
	`g_obje˘_uƒef
(
	`G_OBJECT
(
ã°Ác
));

585 
fûíame
 = "v4l2§¯! " 
COLOR_ELEM
 " !áppsink";

593 if(!
	`g°_uri_is_vÆid
(
fûíame
))

595 
uri
 = 
	`ªÆ∑th
(
fûíame
, 
NULL
);

596 
°ªam
 = 
Ál£
;

597 if(
uri
)

599 
uri
 = 
	`g_fûíame_to_uri
(uri, 
NULL
, NULL);

600 if(
uri
)

602 
fûe
 = 
åue
;

606 
	`CV_WARN
("GStreamer: Error opening file\n");

607 
	`˛o£
();

608  
Ál£
;

613 
GEº‹
 *
îr
 = 
NULL
;

614 
uridecodebö
 = 
	`g°_∑r£_œunch
(
fûíame
, &
îr
);

615 if(!
uridecodebö
)

617 
	`Ârötf
(
°dîr
, "GSåómî: Eº‹ o≥nög bö: %s\n", 
îr
->
mesßge
);

618  
Ál£
;

620 
°ªam
 = 
åue
;

621 
m™uÆpùñöe
 = 
åue
;

624 
°ªam
 = 
åue
;

625 
uri
 = 
	`g_°rdup
(
fûíame
);

628 
boﬁ
 
ñemít_‰om_uri
 = 
Ál£
;

629 if(!
uridecodebö
)

635 
gch¨
 * 
¥Ÿocﬁ
 = 
	`g°_uri_gë_¥Ÿocﬁ
(
uri
);

636 i‡(!
	`°rˇ£cmp
(
¥Ÿocﬁ
 , "v4l2"))

638 #i‡
GST_VERSION_MAJOR
 == 0

639 
uridecodebö
 = 
	`g°_ñemít_make_‰om_uri
(
GST_URI_SRC
, 
uri
, "src");

641 
uridecodebö
 = 
	`g°_ñemít_make_‰om_uri
(
GST_URI_SRC
, 
uri
, "§c", 
NULL
);

643 
ñemít_‰om_uri
 = 
åue
;

645 
uridecodebö
 = 
	`g°_ñemít_Á˘‹y_make
("uridecodebö", 
NULL
);

646 
	`g_obje˘_£t
(
	`G_OBJECT
(
uridecodebö
), "uri", 
uri
, 
NULL
);

648 
	`g_‰ì
(
¥Ÿocﬁ
);

650 if(!
uridecodebö
) {

652 
	`˛o£
();

653  
Ál£
;

657 if(
m™uÆpùñöe
)

659 
G°Iãøt‹
 *
ô
 = 
NULL
;

660 #i‡
GST_VERSION_MAJOR
 == 0

661 
ô
 = 
	`g°_bö_ôî©e_söks
(
	`GST_BIN
(
uridecodebö
));

662 if(
	`g°_ôî©‹_√xt
(
ô
, (
gpoöãr
 *)&
sök
Ë!
GST_ITERATOR_OK
) {

663 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannot findáppsink in manualÖipeline\n");

664  
Ál£
;

667 
ô
 = 
	`g°_bö_ôî©e_söks
 (
	`GST_BIN
(
uridecodebö
));

669 
gboﬁón
 
d⁄e
 = 
FALSE
;

670 
G°EÀmít
 *
ñemít
 = 
NULL
;

671 
gch¨
* 
«me
 = 
NULL
;

672 
GVÆue
 
vÆue
 = 
G_VALUE_INIT
;

674 !
d⁄e
) {

675 
	`g°_ôî©‹_√xt
 (
ô
, &
vÆue
)) {

676 
GST_ITERATOR_OK
:

677 
ñemít
 = 
	`GST_ELEMENT
 (
	`g_vÆue_gë_obje˘
 (&
vÆue
));

678 
«me
 = 
	`g°_ñemít_gë_«me
(
ñemít
);

679 i‡(
«me
){

680 if(
	`°r°r
(
«me
, "›ícvsök"Ë!
NULL
 || strstr(name, "appsink") != NULL) {

681 
sök
 = 
	`GST_ELEMENT
 ( 
	`g°_obje˘_ªf
 (
ñemít
) );

682 
d⁄e
 = 
TRUE
;

684 
	`g_‰ì
(
«me
);

686 
	`g_vÆue_un£t
 (&
vÆue
);

689 
GST_ITERATOR_RESYNC
:

690 
	`g°_ôî©‹_ªsync
 (
ô
);

692 
GST_ITERATOR_ERROR
:

693 
GST_ITERATOR_DONE
:

694 
d⁄e
 = 
TRUE
;

698 
	`g°_ôî©‹_‰ì
 (
ô
);

701 i‡(!
sök
){

702 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannot findáppsink in manualÖipeline\n");

703  
Ál£
;

706 
pùñöe
 = 
uridecodebö
;

710 
pùñöe
 = 
	`g°_pùñöe_√w
(
NULL
);

713 
cﬁ‹
 = 
	`g°_ñemít_Á˘‹y_make
(
COLOR_ELEM
, 
NULL
);

714 
sök
 = 
	`g°_ñemít_Á˘‹y_make
("≠psök", 
NULL
);

716 
	`g°_bö_add_m™y
(
	`GST_BIN
(
pùñöe
), 
uridecodebö
, 
cﬁ‹
, 
sök
, 
NULL
);

718 if(
ñemít_‰om_uri
) {

719 if(!
	`g°_ñemít_lök
(
uridecodebö
, 
cﬁ‹
)) {

720 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannotÜink color -> sink\n");

721 
	`g°_obje˘_uƒef
(
pùñöe
);

722 
pùñöe
 = 
NULL
;

723  
Ál£
;

726 
	`g_sig«l_c⁄√˘
(
uridecodebö
, "∑d-added", 
	`G_CALLBACK
(
√wPad
), 
cﬁ‹
);

729 if(!
	`g°_ñemít_lök
(
cﬁ‹
, 
sök
)) {

730 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannotÜink color -> sink\n");

731 
	`g°_obje˘_uƒef
(
pùñöe
);

732 
pùñöe
 = 
NULL
;

733  
Ál£
;

738 
	`g°_≠p_sök_£t_max_buf„rs
 (
	`GST_APP_SINK
(
sök
), 1);

739 
	`g°_≠p_sök_£t_dr›
 (
	`GST_APP_SINK
(
sök
), 
°ªam
);

741 
	`g°_≠p_sök_£t_emô_sig«ls
 (
	`GST_APP_SINK
(
sök
), 0);

743 #i‡
GST_VERSION_MAJOR
 == 0

744 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-raw-rgb",

745 "bµ", 
G_TYPE_INT
, 24,

746 "ªd_mask", 
G_TYPE_INT
, 0x0000FF,

747 "gªí_mask", 
G_TYPE_INT
, 0x00FF00,

748 "blue_mask", 
G_TYPE_INT
, 0xFF0000,

749 
NULL
);

752 
ˇps
 = 
	`g°_ˇps_‰om_°rög
("video/x-raw, format=(string){BGR, GRAY8}; video/x-bayer,format=(string){rggb,bggr,grbg,gbrg}");

754 
	`g°_≠p_sök_£t_ˇps
(
	`GST_APP_SINK
(
sök
), 
ˇps
);

755 
	`g°_ˇps_uƒef
(
ˇps
);

758 i‡(
fûe
)

760 
°©us
 = 
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_PAUSED
);

761 i‡(
°©us
 =
GST_STATE_CHANGE_ASYNC
)

764 
G°Sèã
 
°1
;

765 
G°Sèã
 
°2
;

766 
°©us
 = 
	`g°_ñemít_gë_°©e
(
pùñöe
, &
°1
, &
°2
, 
GST_CLOCK_TIME_NONE
);

768 i‡(
°©us
 =
GST_STATE_CHANGE_FAILURE
)

770 
	`h™dÀMesßge
(
pùñöe
);

771 
	`g°_obje˘_uƒef
(
pùñöe
);

772 
pùñöe
 = 
NULL
;

773 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: unableÅo startÖipeline\n");

774  
Ál£
;

777 
G°F‹m©
 
f‹m©
;

779 
f‹m©
 = 
GST_FORMAT_DEFAULT
;

780 #i‡
GST_VERSION_MAJOR
 == 0

781 if(!
	`g°_ñemít_quîy_duøti⁄
(
sök
, &
f‹m©
, &
duøti⁄
))

783 if(!
	`g°_ñemít_quîy_duøti⁄
(
sök
, 
f‹m©
, &
duøti⁄
))

786 
	`h™dÀMesßge
(
pùñöe
);

787 
	`CV_WARN
("GStreamer: unableÅo query duration of stream");

788 
duøti⁄
 = -1;

791 
G°Pad
* 
∑d
 = 
	`g°_ñemít_gë_°©ic_∑d
(
cﬁ‹
, "src");

792 #i‡
GST_VERSION_MAJOR
 == 0

793 
G°C≠s
* 
buf„r_ˇps
 = 
	`g°_∑d_gë_ˇps
(
∑d
);

795 
G°C≠s
* 
buf„r_ˇps
 = 
	`g°_∑d_gë_cuºít_ˇps
(
∑d
);

797 c⁄° 
G°Såu˘uª
 *
°ru˘uª
 = 
	`g°_ˇps_gë_°ru˘uª
 (
buf„r_ˇps
, 0);

799 i‡(!
	`g°_°ru˘uª_gë_öt
 (
°ru˘uª
, "width", &
width
))

801 
	`CV_WARN
("Cannot query video width\n");

804 i‡(!
	`g°_°ru˘uª_gë_öt
 (
°ru˘uª
, "height", &
height
))

806 
	`CV_WARN
("Cannot query video heigth\n");

809 
göt
 
num
 = 0, 
díom
=1;

810 if(!
	`g°_°ru˘uª_gë_‰a˘i⁄
(
°ru˘uª
, "‰amî©e", &
num
, &
díom
))

812 
	`CV_WARN
("Cannot query video fps\n");

815 
Âs
 = ()
num
/()
díom
;

821 
duøti⁄
 = -1;

822 
width
 = -1;

823 
height
 = -1;

824 
Âs
 = -1;

827 
__END__
;

829  
åue
;

830 
	}
}

841 
	gCvC≠tuª_GSåómî
::
	$gëPr›îty
–
¥›Id
 ) const

843 
G°F‹m©
 
f‹m©
;

844 
göt64
 
vÆue
;

845 
gboﬁón
 
°©us
;

847 #i‡
GST_VERSION_MAJOR
 == 0

848 
	#FORMAT
 &
f‹m©


	)

850 
	#FORMAT
 
f‹m©


	)

853 if(!
pùñöe
) {

854 
	`CV_WARN
("GStreamer:ÇoÖipeline");

855  
Ál£
;

858 
¥›Id
) {

859 
CV_CAP_PROP_POS_MSEC
:

860 
f‹m©
 = 
GST_FORMAT_TIME
;

861 
°©us
 = 
	`g°_ñemít_quîy_posôi⁄
(
sök
, 
FORMAT
, &
vÆue
);

862 if(!
°©us
) {

863 
	`CV_WARN
("GStreamer: unableÅo queryÖosition of stream");

864  
Ál£
;

866  
vÆue
 * 1e-6;

867 
CV_CAP_PROP_POS_FRAMES
:

868 
f‹m©
 = 
GST_FORMAT_DEFAULT
;

869 
°©us
 = 
	`g°_ñemít_quîy_posôi⁄
(
sök
, 
FORMAT
, &
vÆue
);

870 if(!
°©us
) {

871 
	`CV_WARN
("GStreamer: unableÅo queryÖosition of stream");

872  
Ál£
;

874  
vÆue
;

875 
CV_CAP_PROP_POS_AVI_RATIO
:

876 
f‹m©
 = 
GST_FORMAT_PERCENT
;

877 
°©us
 = 
	`g°_ñemít_quîy_posôi⁄
(
sök
, 
FORMAT
, &
vÆue
);

878 if(!
°©us
) {

879 
	`CV_WARN
("GStreamer: unableÅo queryÖosition of stream");

880  
Ál£
;

882  ((Ë
vÆue
Ë/ 
GST_FORMAT_PERCENT_MAX
;

883 
CV_CAP_PROP_FRAME_WIDTH
:

884  
width
;

885 
CV_CAP_PROP_FRAME_HEIGHT
:

886  
height
;

887 
CV_CAP_PROP_FPS
:

888  
Âs
;

889 
CV_CAP_PROP_FOURCC
:

891 
CV_CAP_PROP_FRAME_COUNT
:

892  
duøti⁄
;

893 
CV_CAP_PROP_FORMAT
:

894 
CV_CAP_PROP_MODE
:

895 
CV_CAP_PROP_BRIGHTNESS
:

896 
CV_CAP_PROP_CONTRAST
:

897 
CV_CAP_PROP_SATURATION
:

898 
CV_CAP_PROP_HUE
:

899 
CV_CAP_PROP_GAIN
:

900 
CV_CAP_PROP_CONVERT_RGB
:

902 
CV_CAP_GSTREAMER_QUEUE_LENGTH
:

903 if(!
sök
) {

904 
	`CV_WARN
("GStreamer:Åhere isÇo sink yet");

905  
Ál£
;

907  
	`g°_≠p_sök_gë_max_buf„rs
(
	`GST_APP_SINK
(
sök
));

909 
	`CV_WARN
("GStreamer: unhandledÖroperty");

913 #unde‡
FORMAT


915  
Ál£
;

916 
	}
}

926 
boﬁ
 
	gCvC≠tuª_GSåómî
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

928 
G°F‹m©
 
f‹m©
;

929 
G°SìkFœgs
 
Êags
;

931 if(!
pùñöe
) {

932 
	`CV_WARN
("GStreamer:ÇoÖipeline");

933  
Ál£
;

936 
boﬁ
 
wasPœyög
 = 
this
->
	`isPùñöePœyög
();

937 i‡(
wasPœyög
)

938 
this
->
	`°›Pùñöe
();

941 
¥›Id
) {

942 
CV_CAP_PROP_POS_MSEC
:

943 
f‹m©
 = 
GST_FORMAT_TIME
;

944 
Êags
 = (
G°SìkFœgs
Ë(
GST_SEEK_FLAG_FLUSH
|
GST_SEEK_FLAG_ACCURATE
);

945 if(!
	`g°_ñemít_£ek_sim∂e
(
	`GST_ELEMENT
(
pùñöe
), 
f‹m©
,

946 
Êags
, (
göt64
Ë(
vÆue
 * 
GST_MSECOND
))) {

947 
	`CV_WARN
("GStreamer: unableÅo seek");

950 
CV_CAP_PROP_POS_FRAMES
:

951 
f‹m©
 = 
GST_FORMAT_DEFAULT
;

952 
Êags
 = (
G°SìkFœgs
Ë(
GST_SEEK_FLAG_FLUSH
|
GST_SEEK_FLAG_ACCURATE
);

953 if(!
	`g°_ñemít_£ek_sim∂e
(
	`GST_ELEMENT
(
pùñöe
), 
f‹m©
,

954 
Êags
, (
göt64
Ë
vÆue
)) {

955 
	`CV_WARN
("GStreamer: unableÅo seek");

958 
CV_CAP_PROP_POS_AVI_RATIO
:

959 
f‹m©
 = 
GST_FORMAT_PERCENT
;

960 
Êags
 = (
G°SìkFœgs
Ë(
GST_SEEK_FLAG_FLUSH
|
GST_SEEK_FLAG_ACCURATE
);

961 if(!
	`g°_ñemít_£ek_sim∂e
(
	`GST_ELEMENT
(
pùñöe
), 
f‹m©
,

962 
Êags
, (
göt64
Ë(
vÆue
 * 
GST_FORMAT_PERCENT_MAX
))) {

963 
	`CV_WARN
("GStreamer: unableÅo seek");

966 
CV_CAP_PROP_FRAME_WIDTH
:

967 if(
vÆue
 > 0)

968 
	`£tFûãr
("width", 
G_TYPE_INT
, (Ë
vÆue
, 0);

970 
	`ªmoveFûãr
("width");

972 
CV_CAP_PROP_FRAME_HEIGHT
:

973 if(
vÆue
 > 0)

974 
	`£tFûãr
("height", 
G_TYPE_INT
, (Ë
vÆue
, 0);

976 
	`ªmoveFûãr
("height");

978 
CV_CAP_PROP_FPS
:

979 if(
vÆue
 > 0) {

980 
num
=0, 
díom
 = 1;

981 
	`toFø˘i⁄
(
vÆue
, 
num
, 
díom
);

982 
	`£tFûãr
("‰amî©e", 
GST_TYPE_FRACTION
, 
vÆue
, 
díom
);

984 
	`ªmoveFûãr
("framerate");

986 
CV_CAP_PROP_FOURCC
:

987 
CV_CAP_PROP_FRAME_COUNT
:

988 
CV_CAP_PROP_FORMAT
:

989 
CV_CAP_PROP_MODE
:

990 
CV_CAP_PROP_BRIGHTNESS
:

991 
CV_CAP_PROP_CONTRAST
:

992 
CV_CAP_PROP_SATURATION
:

993 
CV_CAP_PROP_HUE
:

994 
CV_CAP_PROP_GAIN
:

995 
CV_CAP_PROP_CONVERT_RGB
:

997 
CV_CAP_GSTREAMER_QUEUE_LENGTH
:

998 if(!
sök
)

1000 
	`g°_≠p_sök_£t_max_buf„rs
(
	`GST_APP_SINK
(
sök
), (
guöt
Ë
vÆue
);

1003 
	`CV_WARN
("GStreamer: unhandledÖroperty");

1006 i‡(
wasPœyög
)

1007 
this
->
	`°¨tPùñöe
();

1009  
Ál£
;

1010 
	}
}

1018 
CvC≠tuª
* 
	$cvCª©eC≠tuª_GSåómî
(
ty≥
, c⁄° * 
fûíame
 )

1020 
CvC≠tuª_GSåómî
* 
ˇ±uª
 = 
√w
 CvCapture_GStreamer;

1022 if–
ˇ±uª
->
	`›í
–
ty≥
, 
fûíame
 ))

1023  
ˇ±uª
;

1025 
dñëe
 
ˇ±uª
;

1027 
	}
}

1034 ˛as†
	cCvVideoWrôî_GSåómî
 : 
public
 
CvVideoWrôî


1036 
public
:

1037 
	$CvVideoWrôî_GSåómî
(Ë{ 
	`öô
(); }

1038 
vútuÆ
 ~
	$CvVideoWrôî_GSåómî
(Ë{ 
	`˛o£
(); 
	}
}

1040 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
, 
fourcc
,

1041 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 );

1042 
vútuÆ
 
˛o£
();

1043 
vútuÆ
 
boﬁ
 
wrôeFøme
–c⁄° 
I∂Image
* 
image
 );

1044 
	g¥Ÿe˘ed
:

1045 
öô
();

1046 c⁄° * 
fûíameToMimëy≥
(c⁄° * 
fûíame
);

1047 
G°EÀmít
* 
	gpùñöe
;

1048 
G°EÀmít
* 
	gsour˚
;

1049 
G°EÀmít
* 
	gícodebö
;

1050 
G°EÀmít
* 
	gfûe
;

1052 
G°Buf„r
* 
	gbuf„r
;

1053 
	göput_pix_fmt
;

1054 
	gnum_‰ames
;

1055 
	g‰amî©e
;

1062 
	gCvVideoWrôî_GSåómî
::
	$öô
()

1064 
pùñöe
 = 
NULL
;

1065 
sour˚
 = 
NULL
;

1066 
ícodebö
 = 
NULL
;

1067 
fûe
 = 
NULL
;

1068 
buf„r
 = 
NULL
;

1070 
num_‰ames
 = 0;

1071 
‰amî©e
 = 0;

1072 
	}
}

1079 
	gCvVideoWrôî_GSåómî
::
	$˛o£
()

1081 
G°SèãCh™geRëu∫
 
°©us
;

1082 i‡(
pùñöe
)

1084 
	`h™dÀMesßge
(
pùñöe
);

1086 i‡(
	`g°_≠p_§c_íd_of_°ªam
(
	`GST_APP_SRC
(
sour˚
)Ë!
GST_FLOW_OK
)

1088 
	`CV_WARN
("Cannot send EOSÅo GStreamerÖipeline\n");

1093 
G°Bus
* 
bus
 = 
	`g°_ñemít_gë_bus
(
pùñöe
);

1094 
G°Mesßge
 *
msg
 = 
	`g°_bus_timed_p›_fûãªd
(
bus
, 
GST_CLOCK_TIME_NONE
, (
G°MesßgeTy≥
)(
GST_MESSAGE_ERROR
 | 
GST_MESSAGE_EOS
));

1095 i‡(
	`GST_MESSAGE_TYPE
(
msg
Ë=
GST_MESSAGE_ERROR
)

1097 
	`CV_WARN
("Error during VideoWriter finalization\n");

1101 if(
msg
 !
NULL
)

1103 
	`g°_mesßge_uƒef
(
msg
);

1104 
	`g_obje˘_uƒef
(
	`G_OBJECT
(
bus
));

1107 
°©us
 = 
	`g°_ñemít_£t_°©e
 (
pùñöe
, 
GST_STATE_NULL
);

1108 i‡(
°©us
 =
GST_STATE_CHANGE_ASYNC
)

1111 
G°Sèã
 
°1
;

1112 
G°Sèã
 
°2
;

1113 
°©us
 = 
	`g°_ñemít_gë_°©e
(
pùñöe
, &
°1
, &
°2
, 
GST_CLOCK_TIME_NONE
);

1115 i‡(
°©us
 =
GST_STATE_CHANGE_FAILURE
)

1117 
	`h™dÀMesßge
 (
pùñöe
);

1118 
	`g°_obje˘_uƒef
 (
	`GST_OBJECT
 (
pùñöe
));

1119 
pùñöe
 = 
NULL
;

1120 
	`CV_WARN
("UnableÅo stop gstreamerÖipeline\n");

1124 
	`g°_obje˘_uƒef
 (
	`GST_OBJECT
 (
pùñöe
));

1125 
pùñöe
 = 
NULL
;

1127 
	}
}

1136 c⁄° * 
	gCvVideoWrôî_GSåómî
::
	$fûíameToMimëy≥
(c⁄° *
fûíame
)

1139 c⁄° *
ext
 = 
	`°ºchr
(
fûíame
, '.');

1140 if(!
ext
 ||Éxà=
fûíame
Ë 
NULL
;

1141 
ext
 += 1;

1147 i‡(
	`°∫ˇ£cmp
(
ext
,"avi", 3) == 0)

1150 i‡(
	`°∫ˇ£cmp
(
ext
,"mkv", 3) == 0 || strncasecmp(ext,"mk3d",4) == 0 || strncasecmp(ext,"webm",4) == 0 )

1153 i‡(
	`°∫ˇ£cmp
(
ext
,"wmv", 3) == 0)

1156 i‡(
	`°∫ˇ£cmp
(
ext
,"mov", 3) == 0)

1159 i‡(
	`°∫ˇ£cmp
(
ext
,"ogg", 3) == 0 || strncasecmp(ext,"ogv", 3) == 0)

1162 i‡(
	`°∫ˇ£cmp
(
ext
,"rm", 3) == 0)

1165 i‡(
	`°∫ˇ£cmp
(
ext
,"swf", 3) == 0)

1168 i‡(
	`°∫ˇ£cmp
(
ext
,"mp4", 3) == 0)

1173 
	}
}

1193 
boﬁ
 
	gCvVideoWrôî_GSåómî
::
	$›í
–c⁄° * 
fûíame
, 
fourcc
,

1194 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
is_cﬁ‹
 )

1196 
	`CV_FUNCNAME
("CvVideoWriter_GStreamer::open");

1199 
	`as£π
 (
fûíame
);

1200 
	`as£π
 (
Âs
 > 0);

1201 
	`as£π
 (
‰ameSize
.
width
 > 0 && fømeSize.
height
 > 0);

1204 
g°_öôülizî
::
	`öô
();

1207 
boﬁ
 
m™uÆpùñöe
 = 
åue
;

1208 
bufsize
 = 0;

1209 
GEº‹
 *
îr
 = 
NULL
;

1210 c⁄° * 
mime
 = 
NULL
;

1211 
G°SèãCh™geRëu∫
 
°©îë
;

1213 
G°C≠s
* 
ˇps
 = 
NULL
;

1214 
G°C≠s
* 
videoˇps
 = 
NULL
;

1216 #i‡
FULL_GST_VERSION
 >
	`VERSION_NUM
(0,10,32)

1217 
G°C≠s
* 
c⁄èöîˇps
 = 
NULL
;

1218 
G°EncodögC⁄èöîProfûe
* 
c⁄èöî¥ofûe
 = 
NULL
;

1219 
G°EncodögVideoProfûe
* 
vide›rofûe
 = 
NULL
;

1222 
G°Iãøt‹
* 
ô
 = 
NULL
;

1223 
gboﬁón
 
d⁄e
 = 
FALSE
;

1224 
G°EÀmít
 *
ñemít
 = 
NULL
;

1225 
gch¨
* 
«me
 = 
NULL
;

1227 #i‡
GST_VERSION_MAJOR
 == 0

1228 
G°EÀmít
* 
•lôãr
 = 
NULL
;

1229 
G°EÀmít
* 
comböî
 = 
NULL
;

1235 
__BEGIN__
;

1237 
ícodebö
 = 
	`g°_∑r£_œunch
(
fûíame
, &
îr
);

1238 
m™uÆpùñöe
 = (
ícodebö
 !
NULL
);

1240 if(
m™uÆpùñöe
)

1242 #i‡
GST_VERSION_MAJOR
 == 0

1243 
ô
 = 
	`g°_bö_ôî©e_sour˚s
(
	`GST_BIN
(
ícodebö
));

1244 if(
	`g°_ôî©‹_√xt
(
ô
, (
gpoöãr
 *)&
sour˚
Ë!
GST_ITERATOR_OK
) {

1245 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannot findáppsink in manualÖipeline\n");

1246  
Ál£
;

1249 
ô
 = 
	`g°_bö_ôî©e_sour˚s
 (
	`GST_BIN
(
ícodebö
));

1250 
GVÆue
 
vÆue
 = 
G_VALUE_INIT
;

1252 !
d⁄e
) {

1253 
	`g°_ôî©‹_√xt
 (
ô
, &
vÆue
)) {

1254 
GST_ITERATOR_OK
:

1255 
ñemít
 = 
	`GST_ELEMENT
 (
	`g_vÆue_gë_obje˘
 (&
vÆue
));

1256 
«me
 = 
	`g°_ñemít_gë_«me
(
ñemít
);

1257 i‡(
«me
){

1258 if(
	`°r°r
(
«me
, "›ícv§c"Ë!
NULL
 || strstr(name, "appsrc") != NULL) {

1259 
sour˚
 = 
	`GST_ELEMENT
 ( 
	`g°_obje˘_ªf
 (
ñemít
) );

1260 
d⁄e
 = 
TRUE
;

1262 
	`g_‰ì
(
«me
);

1264 
	`g_vÆue_un£t
 (&
vÆue
);

1267 
GST_ITERATOR_RESYNC
:

1268 
	`g°_ôî©‹_ªsync
 (
ô
);

1270 
GST_ITERATOR_ERROR
:

1271 
GST_ITERATOR_DONE
:

1272 
d⁄e
 = 
TRUE
;

1276 
	`g°_ôî©‹_‰ì
 (
ô
);

1278 i‡(!
sour˚
){

1279 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannot findáppsrc in manualÖipeline\n");

1280  
Ál£
;

1283 
pùñöe
 = 
ícodebö
;

1287 
pùñöe
 = 
	`g°_pùñöe_√w
 (
NULL
);

1295 i‡(
fourcc
 =
	`CV_FOURCC
('M','P','1','V')) fourcc = CV_FOURCC('M', 'P', 'G' ,'1');

1296 i‡(
fourcc
 =
	`CV_FOURCC
('M','P','2','V')) fourcc = CV_FOURCC('M', 'P', 'G' ,'2');

1297 i‡(
fourcc
 =
	`CV_FOURCC
('D','R','A','C')) fourcc = CV_FOURCC('d', 'r', 'a' ,'c');

1302 
videoˇps
 = 
	`g°_riff_¸óã_video_ˇps
(
fourcc
, 
NULL
, NULL, NULL, NULL, NULL);

1303 i‡(!
videoˇps
){

1304 
	`CV_ERROR
–
CV_StsUnsuµ‹ãdF‹m©
, "Gstreamer Opencv backend doesÇot supportÅhis codec.");

1308 
mime
 = 
	`fûíameToMimëy≥
(
fûíame
);

1309 i‡(!
mime
) {

1310 
	`CV_ERROR
–
CV_StsUnsuµ‹ãdF‹m©
, "Gstreamer Opencv backend doesÇot supportÅhis fileÅype.");

1313 #i‡
FULL_GST_VERSION
 >
	`VERSION_NUM
(0,10,32)

1314 
c⁄èöîˇps
 = 
	`g°_ˇps_‰om_°rög
(
mime
);

1317 
c⁄èöî¥ofûe
 = 
	`g°_ícodög_c⁄èöî_¥ofûe_√w
("c⁄èöî", "c⁄èöî", 
c⁄èöîˇps
, 
NULL
);

1318 
vide›rofûe
 = 
	`g°_ícodög_video_¥ofûe_√w
(
videoˇps
, 
NULL
, NULL, 1);

1319 
	`g°_ícodög_c⁄èöî_¥ofûe_add_¥ofûe
(
c⁄èöî¥ofûe
, (
G°EncodögProfûe
 *Ë
vide›rofûe
);

1323 
ícodebö
 = 
	`g°_ñemít_Á˘‹y_make
("ícodebö", 
NULL
);

1325 #i‡
FULL_GST_VERSION
 >
	`VERSION_NUM
(0,10,32)

1326 
	`g_obje˘_£t
(
	`G_OBJECT
(
ícodebö
), "¥ofûe", 
c⁄èöî¥ofûe
, 
NULL
);

1328 
sour˚
 = 
	`g°_ñemít_Á˘‹y_make
("≠p§c", 
NULL
);

1329 
fûe
 = 
	`g°_ñemít_Á˘‹y_make
("fûesök", 
NULL
);

1330 
	`g_obje˘_£t
(
	`G_OBJECT
(
fûe
), "loˇti⁄", 
fûíame
, 
NULL
);

1333 i‡(
is_cﬁ‹
)

1335 
öput_pix_fmt
 = 
GST_VIDEO_FORMAT_BGR
;

1336 
bufsize
 = 
‰ameSize
.
width
 * fømeSize.
height
 * 3;

1338 #i‡
GST_VERSION_MAJOR
 == 0

1339 
ˇps
 = 
	`g°_video_f‹m©_√w_ˇps
(
GST_VIDEO_FORMAT_BGR
,

1340 
‰ameSize
.
width
,

1341 
‰ameSize
.
height
,

1342 (
Âs
), 1,

1345 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-raw",

1346 "f‹m©", 
G_TYPE_STRING
, "BGR",

1347 "width", 
G_TYPE_INT
, 
‰ameSize
.
width
,

1348 "height", 
G_TYPE_INT
, 
‰ameSize
.
height
,

1349 "‰amî©e", 
GST_TYPE_FRACTION
, (
Âs
), 1,

1350 
NULL
);

1351 
ˇps
 = 
	`g°_ˇps_fix©e
(caps);

1358 #i‡
FULL_GST_VERSION
 >
	`VERSION_NUM
(0,10,29)

1359 
öput_pix_fmt
 = 
GST_VIDEO_FORMAT_GRAY8
;

1360 
bufsize
 = 
‰ameSize
.
width
 * fømeSize.
height
;

1362 #i‡
GST_VERSION_MAJOR
 == 0

1363 
ˇps
 = 
	`g°_video_f‹m©_√w_ˇps
(
GST_VIDEO_FORMAT_GRAY8
,

1364 
‰ameSize
.
width
,

1365 
‰ameSize
.
height
,

1366 (
Âs
), 1,

1369 
ˇps
 = 
	`g°_ˇps_√w_sim∂e
("video/x-raw",

1370 "f‹m©", 
G_TYPE_STRING
, "GRAY8",

1371 "width", 
G_TYPE_INT
, 
‰ameSize
.
width
,

1372 "height", 
G_TYPE_INT
, 
‰ameSize
.
height
,

1373 "‰amî©e", 
GST_TYPE_FRACTION
, (
Âs
), 1,

1374 
NULL
);

1375 
ˇps
 = 
	`g°_ˇps_fix©e
(caps);

1378 
	`CV_As£π
(!"Gstreamer 0.10.29 orÇewer isÑequired for grayscale input");

1382 
	`g°_≠p_§c_£t_ˇps
(
	`GST_APP_SRC
(
sour˚
), 
ˇps
);

1383 
	`g°_≠p_§c_£t_°ªam_ty≥
(
	`GST_APP_SRC
(
sour˚
), 
GST_APP_STREAM_TYPE_STREAM
);

1384 
	`g°_≠p_§c_£t_size
 (
	`GST_APP_SRC
(
sour˚
), -1);

1386 
	`g_obje˘_£t
(
	`G_OBJECT
(
sour˚
), "f‹m©", 
GST_FORMAT_TIME
, 
NULL
);

1387 
	`g_obje˘_£t
(
	`G_OBJECT
(
sour˚
), "block", 1, 
NULL
);

1388 
	`g_obje˘_£t
(
	`G_OBJECT
(
sour˚
), "is-live", 0, 
NULL
);

1391 if(!
m™uÆpùñöe
)

1393 
	`g_obje˘_£t
(
	`G_OBJECT
(
fûe
), "buf„r-size", 
bufsize
, 
NULL
);

1394 
	`g°_bö_add_m™y
(
	`GST_BIN
(
pùñöe
), 
sour˚
, 
ícodebö
, 
fûe
, 
NULL
);

1395 if(!
	`g°_ñemít_lök_m™y
(
sour˚
, 
ícodebö
, 
fûe
, 
NULL
)) {

1396 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannotÜinkÉlements\n");

1400 #i‡
GST_VERSION_MAJOR
 == 0

1405 
ô
 = 
	`g°_bö_ôî©e_ªcur£
 (
	`GST_BIN
(
ícodebö
));

1406 !
d⁄e
) {

1407 
	`g°_ôî©‹_√xt
 (
ô
, (**)&
ñemít
)) {

1408 
GST_ITERATOR_OK
:

1409 
«me
 = 
	`g°_ñemít_gë_«me
(
ñemít
);

1410 i‡(
	`°r°r
(
«me
, "streamsplitter"))

1411 
•lôãr
 = 
ñemít
;

1412 i‡(
	`°r°r
(
«me
, "streamcombiner"))

1413 
comböî
 = 
ñemít
;

1415 
GST_ITERATOR_RESYNC
:

1416 
	`g°_ôî©‹_ªsync
 (
ô
);

1418 
GST_ITERATOR_ERROR
:

1419 
d⁄e
 = 
åue
;

1421 
GST_ITERATOR_DONE
:

1422 
d⁄e
 = 
åue
;

1427 
	`g°_ôî©‹_‰ì
 (
ô
);

1429 i‡(
•lôãr
 && 
comböî
)

1431 
	`g°_ñemít_u∆ök
(
•lôãr
, 
comböî
);

1433 
G°Pad
* 
§c
 = 
	`g°_ñemít_gë_∑d
(
comböî
, "src");

1434 
G°Pad
* 
sök
 = 
	`g°_ñemít_gë_∑d
(
comböî
, "encodingsink");

1436 
G°Pad
* 
§cPìr
 = 
	`g°_∑d_gë_≥î
(
§c
);

1437 
G°Pad
* 
sökPìr
 = 
	`g°_∑d_gë_≥î
(
sök
);

1439 
	`g°_∑d_u∆ök
(
sökPìr
, 
sök
);

1440 
	`g°_∑d_u∆ök
(
§c
, 
§cPìr
);

1442 
	`g°_∑d_lök
(
sökPìr
, 
§cPìr
);

1444 
§c
 = 
	`g°_ñemít_gë_∑d
(
•lôãr
, "encodingsrc");

1445 
sök
 = 
	`g°_ñemít_gë_∑d
(
•lôãr
, "sink");

1447 
§cPìr
 = 
	`g°_∑d_gë_≥î
(
§c
);

1448 
sökPìr
 = 
	`g°_∑d_gë_≥î
(
sök
);

1450 
	`g°_∑d_u∆ök
(
sökPìr
, 
sök
);

1451 
	`g°_∑d_u∆ök
(
§c
, 
§cPìr
);

1453 
	`g°_∑d_lök
(
sökPìr
, 
§cPìr
);

1457 
°©îë
 = 
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_PLAYING
);

1458 if(
°©îë
 =
GST_STATE_CHANGE_FAILURE
) {

1459 
	`h™dÀMesßge
(
pùñöe
);

1460 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: cannotÖutÖipelineÅoÖlay\n");

1463 
‰amî©e
 = 
Âs
;

1464 
num_‰ames
 = 0;

1466 
	`h™dÀMesßge
(
pùñöe
);

1468 
__END__
;

1470  
åue
;

1471 
	}
}

1482 
boﬁ
 
	gCvVideoWrôî_GSåómî
::
	$wrôeFøme
–c⁄° 
I∂Image
 * 
image
 )

1484 
	`CV_FUNCNAME
("CvVideoWriter_GStreamer::writerFrame");

1486 
G°ClockTime
 
duøti⁄
, 
time°amp
;

1487 
G°FlowRëu∫
 
ªt
;

1488 
size
;

1490 
__BEGIN__
;

1492 
	`h™dÀMesßge
(
pùñöe
);

1494 i‡(
öput_pix_fmt
 =
GST_VIDEO_FORMAT_BGR
) {

1495 i‡(
image
->
nCh™√ls
 !3 || image->
dïth
 !
IPL_DEPTH_8U
) {

1496 
	`CV_ERROR
(
CV_StsUnsuµ‹ãdF‹m©
, "cvWriteFrame()Çeeds images with depth = IPL_DEPTH_8UándÇChannels = 3.");

1499 #i‡
FULL_GST_VERSION
 >
	`VERSION_NUM
(0,10,29)

1500 i‡(
öput_pix_fmt
 =
GST_VIDEO_FORMAT_GRAY8
) {

1501 i‡(
image
->
nCh™√ls
 !1 || image->
dïth
 !
IPL_DEPTH_8U
) {

1502 
	`CV_ERROR
(
CV_StsUnsuµ‹ãdF‹m©
, "cvWriteFrame()Çeeds images with depth = IPL_DEPTH_8UándÇChannels = 1.");

1507 
	`CV_ERROR
(
CV_StsUnsuµ‹ãdF‹m©
, "cvWriteFrame()Çeeds BGR or grayscale images\n");

1508  
Ál£
;

1511 
size
 = 
image
->
imageSize
;

1512 
duøti⁄
 = (()1/
‰amî©e
Ë* 
GST_SECOND
;

1513 
time°amp
 = 
num_‰ames
 * 
duøti⁄
;

1516 #i‡
GST_VERSION_MAJOR
 == 0

1517 
buf„r
 = 
	`g°_buf„r_åy_√w_™d_Æloc
 (
size
);

1518 i‡(!
buf„r
)

1520 
	`CV_ERROR
(
CV_StsBadSize
, "Cannot create GStreamer buffer");

1523 
	`mem˝y
(
	`GST_BUFFER_DATA
 (
buf„r
), (
guöt8
*)
image
->
imageD©a
, 
size
);

1524 
	`GST_BUFFER_DURATION
(
buf„r
Ë
duøti⁄
;

1525 
	`GST_BUFFER_TIMESTAMP
(
buf„r
Ë
time°amp
;

1527 
buf„r
 = 
	`g°_buf„r_√w_Æloˇã
 (
NULL
, 
size
, NULL);

1528 
G°M≠Info
 
öfo
;

1529 
	`g°_buf„r_m≠
(
buf„r
, &
öfo
, (
G°M≠Fœgs
)
GST_MAP_READ
);

1530 
	`mem˝y
(
öfo
.
d©a
, (
guöt8
*)
image
->
imageD©a
, 
size
);

1531 
	`g°_buf„r_unm≠
(
buf„r
, &
öfo
);

1532 
	`GST_BUFFER_DURATION
(
buf„r
Ë
duøti⁄
;

1533 
	`GST_BUFFER_PTS
(
buf„r
Ë
time°amp
;

1534 
	`GST_BUFFER_DTS
(
buf„r
Ë
time°amp
;

1537 
	`GST_BUFFER_OFFSET
(
buf„r
Ë
num_‰ames
;

1539 
ªt
 = 
	`g°_≠p_§c_push_buf„r
(
	`GST_APP_SRC
(
sour˚
), 
buf„r
);

1540 i‡(
ªt
 !
GST_FLOW_OK
) {

1541 
	`CV_WARN
("ErrorÖushing bufferÅo GStreamerÖipeline");

1542  
Ál£
;

1547 ++
num_‰ames
;

1549 
__END__
;

1551  
åue
;

1552 
	}
}

1564 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_GSåómî
(c⁄° * 
fûíame
, 
fourcc
, 
Âs
,

1565 
CvSize
 
‰ameSize
, 
isCﬁ‹
 )

1567 
CvVideoWrôî_GSåómî
* 
wπ
 = 
√w
 CvVideoWriter_GStreamer;

1568 if–
wπ
->
	`›í
(
fûíame
, 
fourcc
, 
Âs
,
‰ameSize
, 
isCﬁ‹
))

1569  
wπ
;

1571 
dñëe
 
wπ
;

1573 
	}
}

1584 
	$toFø˘i⁄
(
decimÆ
, &
numî©‹
, &
díomö©‹
)

1586 
dummy
;

1587 
whﬁe
;

1588 
decimÆ
 = 
	`modf
 (decimÆ, &
whﬁe
);

1589 
díomö©‹
 = 1; denominator<=100; denominator++){

1590 i‡(
	`modf
(
díomö©‹
 * 
decimÆ
, &
dummy
) < 0.001f)

1593 
numî©‹
 = 
díomö©‹
 * 
decimÆ
;

1594 
	}
}

1601 
	$h™dÀMesßge
(
G°EÀmít
 * 
pùñöe
)

1603 
	`CV_FUNCNAME
("handlemessage");

1605 
GEº‹
 *
îr
 = 
NULL
;

1606 
gch¨
 *
debug
 = 
NULL
;

1607 
G°Bus
* 
bus
 = 
NULL
;

1608 
G°SåómSètusTy≥
 
ç
;

1609 
G°EÀmít
 * 
ñem
 = 
NULL
;

1610 
G°Mesßge
* 
msg
 = 
NULL
;

1612 
__BEGIN__
;

1613 
bus
 = 
	`g°_ñemít_gë_bus
(
pùñöe
);

1615 
	`g°_bus_have_≥ndög
(
bus
)) {

1616 
msg
 = 
	`g°_bus_p›
(
bus
);

1620 if(
	`g°_is_missög_∂ugö_mesßge
(
msg
))

1622 
	`CV_ERROR
(
CV_StsEº‹
, "GStreamer: your gstreamer installation is missingáÑequiredÖlugin\n");

1626 
	`GST_MESSAGE_TYPE
 (
msg
)) {

1627 
GST_MESSAGE_STATE_CHANGED
:

1628 
G°Sèã
 
ﬁd°©e
, 
√w°©e
, 
≥nd°©e
;

1629 
	`g°_mesßge_∑r£_°©e_ch™ged
(
msg
, &
ﬁd°©e
, &
√w°©e
, &
≥nd°©e
);

1633 
GST_MESSAGE_ERROR
:

1634 
	`g°_mesßge_∑r£_îr‹
(
msg
, &
îr
, &
debug
);

1635 
	`Ârötf
(
°dîr
, "GStreamer Plugin: Embedded videoÖlayback halted; module %sÑeported: %s\n",

1636 
	`g°_ñemít_gë_«me
(
	`GST_MESSAGE_SRC
 (
msg
)), 
îr
->
mesßge
);

1638 
	`g_îr‹_‰ì
(
îr
);

1639 
	`g_‰ì
(
debug
);

1641 
	`g°_ñemít_£t_°©e
(
	`GST_ELEMENT
(
pùñöe
), 
GST_STATE_NULL
);

1643 
GST_MESSAGE_EOS
:

1646 
GST_MESSAGE_STREAM_STATUS
:

1647 
	`g°_mesßge_∑r£_°ªam_°©us
(
msg
,&
ç
,&
ñem
);

1655 
	`g°_mesßge_uƒef
(
msg
);

1658 
	`g°_obje˘_uƒef
(
	`GST_OBJECT
(
bus
));

1660 
__END__


1661 
	}
}

	@src/cap_images.cpp

52 
	~"¥ecomp.hµ
"

53 
	~<sys/°©.h
>

55 #ifde‡
NDEBUG


56 
	#CV_WARN
(
mesßge
)

	)

58 
	#CV_WARN
(
mesßge
Ë
	`Ârötf
(
°dîr
, "w¨nög: %†(%s:%d)\n", mesßge, 
__FILE__
, 
__LINE__
)

	)

61 #i‚de‡
_MAX_PATH


62 
	#_MAX_PATH
 1024

	)

65 ˛as†
	cCvC≠tuª_Images
 : 
public
 
CvC≠tuª


67 
public
:

68 
	$CvC≠tuª_Images
()

70 
fûíame
 = 0;

71 
cuºít‰ame
 = 
fú°‰ame
 = 0;

72 
Àngth
 = 0;

73 
‰ame
 = 0;

76 
vútuÆ
 ~
	$CvC≠tuª_Images
()

78 
	`˛o£
();

79 
	}
}

81 
vútuÆ
 
boﬁ
 
›í
(c⁄° * 
_fûíame
);

82 
vútuÆ
 
˛o£
();

83 
vútuÆ
 
	$gëPr›îty
() const;

84 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

85 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

86 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

88 
¥Ÿe˘ed
:

89 * 
fûíame
;

90 
cuºít‰ame
;

91 
fú°‰ame
;

92 
Àngth
;

94 
I∂Image
* 
‰ame
;

95 
	}
};

98 
	gCvC≠tuª_Images
::
	$˛o£
()

100 if–
fûíame
 )

102 
	`‰ì
(
fûíame
);

103 
fûíame
 = 0;

105 
cuºít‰ame
 = 
fú°‰ame
 = 0;

106 
Àngth
 = 0;

107 
	`cvRñó£Image
–&
‰ame
 );

108 
	}
}

111 
boﬁ
 
	gCvC≠tuª_Images
::
	$gøbFøme
()

113 
°r
[
_MAX_PATH
];

114 
	`•rötf
(
°r
, 
fûíame
, 
fú°‰ame
 + 
cuºít‰ame
);

116 
	`cvRñó£Image
(&
‰ame
);

117 
‰ame
 = 
	`cvLﬂdImage
(
°r
, 
CV_LOAD_IMAGE_ANYDEPTH
 | 
CV_LOAD_IMAGE_ANYCOLOR
);

118 if–
‰ame
 )

119 
cuºít‰ame
++;

121  
‰ame
 != 0;

122 
	}
}

124 
I∂Image
* 
	gCvC≠tuª_Images
::
	$ªåõveFøme
()

126  
‰ame
;

127 
	}
}

129 
	gCvC≠tuª_Images
::
	$gëPr›îty
(
id
) const

131 
id
)

133 
CV_CAP_PROP_POS_MSEC
:

134 
	`CV_WARN
("collections of images don't have framerates\n");

136 
CV_CAP_PROP_POS_FRAMES
:

137  
cuºít‰ame
;

138 
CV_CAP_PROP_FRAME_COUNT
:

139  
Àngth
;

140 
CV_CAP_PROP_POS_AVI_RATIO
:

141  ()
cuºít‰ame
 / ()(
Àngth
 - 1);

142 
CV_CAP_PROP_FRAME_WIDTH
:

143  
‰ame
 ? føme->
width
 : 0;

144 
CV_CAP_PROP_FRAME_HEIGHT
:

145  
‰ame
 ? føme->
height
 : 0;

146 
CV_CAP_PROP_FPS
:

147 
	`CV_WARN
("collections of images don't have framerates\n");

149 
CV_CAP_PROP_FOURCC
:

150 
	`CV_WARN
("collections of images don't have 4-character codes\n");

154 
	}
}

156 
boﬁ
 
	gCvC≠tuª_Images
::
	$£tPr›îty
(
id
, 
vÆue
)

158 
id
)

160 
CV_CAP_PROP_POS_MSEC
:

161 
CV_CAP_PROP_POS_FRAMES
:

162 if(
vÆue
 < 0) {

163 
	`CV_WARN
("seekingÅoÇegativeÖositions doesÇot work - clamping\n");

164 
vÆue
 = 0;

166 if(
vÆue
 >
Àngth
) {

167 
	`CV_WARN
("seeking beyondÉnd of sequence - clamping\n");

168 
vÆue
 = 
Àngth
 - 1;

170 
cuºít‰ame
 = 
	`cvRound
(
vÆue
);

171  
åue
;

172 
CV_CAP_PROP_POS_AVI_RATIO
:

173 if(
vÆue
 > 1) {

174 
	`CV_WARN
("seeking beyondÉnd of sequence - clamping\n");

175 
vÆue
 = 1;

176 } if(
vÆue
 < 0) {

177 
	`CV_WARN
("seekingÅoÇegativeÖositions doesÇot work - clamping\n");

178 
vÆue
 = 0;

180 
cuºít‰ame
 = 
	`cvRound
((
Àngth
 - 1Ë* 
vÆue
);

181  
åue
;

183 
	`CV_WARN
("unknown/unhandledÖroperty\n");

184  
Ál£
;

185 
	}
}

187 * 
	$icvExåa˘P©ã∫
(c⁄° *
fûíame
, *
off£t
)

189 *
«me
 = (*)
fûíame
;

191 if–!
fûíame
 )

195 *
©
 = 
	`°rchr
(
«me
, '%');

196 if(
©
)

198 
dummy
;

199 if(
	`ssˇnf
(
©
 + 1, "%ud", &
dummy
) != 1)

201 
«me
 = 
	`°rdup
(
fûíame
);

205 
©
 = 
«me
;

208 *
¶ash
 = 
	`°ºchr
(
©
, '/');

209 i‡(
¶ash
Ë
©
 = slash + 1;

211 #ifde‡
_WIN32


212 
¶ash
 = 
	`°ºchr
(
©
, '\\');

213 i‡(
¶ash
Ë
©
 = slash + 1;

216 *
©
 && !
	`isdigô
(*at))át++;

218 if(!*
©
)

221 
	`ssˇnf
(
©
, "%u", 
off£t
);

223 
size
 = ()
	`°æí
(
fûíame
) + 20;

224 
«me
 = (*)
	`mÆloc
(
size
);

225 
	`°∫˝y
(
«me
, 
fûíame
, 
©
 - filename);

226 
«me
[
©
 - 
fûíame
] = 0;

228 
	`°rˇt
(
«me
, "%0");

230 
i
;

231 *
exãnsi⁄
;

232 
i
 = 0, 
exãnsi⁄
 = 
©
; 
	`isdigô
(at[i]); i++,Éxtension++)

234 
∂a˚s
[10];

235 
	`•rötf
(
∂a˚s
, "%dd", 
i
);

237 
	`°rˇt
(
«me
, 
∂a˚s
);

238 
	`°rˇt
(
«me
, 
exãnsi⁄
);

241  
«me
;

242 
	}
}

245 
boﬁ
 
	gCvC≠tuª_Images
::
	$›í
(c⁄° * 
_fûíame
)

247 
off£t
 = 0;

248 
	`˛o£
();

250 
fûíame
 = 
	`icvExåa˘P©ã∫
(
_fûíame
, &
off£t
);

251 if(!
fûíame
)

252  
Ál£
;

255 
Àngth
 = 0;

256 
°r
[
_MAX_PATH
];

259 
	`•rötf
(
°r
, 
fûíame
, 
off£t
 + 
Àngth
);

260 
°©
 
s
;

261 if(
	`°©
(
°r
, &
s
))

263 if(
Àngth
 =0 && 
off£t
 == 0)

265 
off£t
++;

270 if(!
	`cvHaveImageRódî
(
°r
))

273 
Àngth
++;

276 if(
Àngth
 == 0)

278 
	`˛o£
();

279  
Ál£
;

282 
fú°‰ame
 = 
off£t
;

283  
åue
;

284 
	}
}

287 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_Images
(c⁄° * 
fûíame
)

289 
CvC≠tuª_Images
* 
ˇ±uª
 = 
√w
 CvCapture_Images;

291 if–
ˇ±uª
->
	`›í
(
fûíame
) )

292  
ˇ±uª
;

294 
dñëe
 
ˇ±uª
;

296 
	}
}

303 ˛as†
	cCvVideoWrôî_Images
 : 
public
 
CvVideoWrôî


305 
public
:

306 
	$CvVideoWrôî_Images
()

308 
fûíame
 = 0;

309 
cuºít‰ame
 = 0;

311 
vútuÆ
 ~
	$CvVideoWrôî_Images
(Ë{ 
	`˛o£
(); 
	}
}

313 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
_fûíame
 );

314 
vútuÆ
 
˛o£
();

315 
vútuÆ
 
boﬁ
 
wrôeFøme
–c⁄° 
I∂Image
* );

317 
	g¥Ÿe˘ed
:

318 * 
fûíame
;

319 
	gcuºít‰ame
;

322 
boﬁ
 
	gCvVideoWrôî_Images
::
	$wrôeFøme
–c⁄° 
I∂Image
* 
image
 )

324 
°r
[
_MAX_PATH
];

325 
	`•rötf
(
°r
, 
fûíame
, 
cuºít‰ame
);

326 
ªt
 = 
	`cvSaveImage
(
°r
, 
image
);

328 
cuºít‰ame
++;

330  
ªt
 > 0;

331 
	}
}

333 
	gCvVideoWrôî_Images
::
	$˛o£
()

335 if–
fûíame
 )

337 
	`‰ì
–
fûíame
 );

338 
fûíame
 = 0;

340 
cuºít‰ame
 = 0;

341 
	}
}

344 
boﬁ
 
	gCvVideoWrôî_Images
::
	$›í
–c⁄° * 
_fûíame
 )

346 
off£t
 = 0;

348 
	`˛o£
();

350 
fûíame
 = 
	`icvExåa˘P©ã∫
(
_fûíame
, &
off£t
);

351 if(!
fûíame
)

352  
Ál£
;

354 
°r
[
_MAX_PATH
];

355 
	`•rötf
(
°r
, 
fûíame
, 0);

356 if(!
	`cvHaveImageWrôî
(
°r
))

358 
	`˛o£
();

359  
Ál£
;

362 
cuºít‰ame
 = 
off£t
;

363  
åue
;

364 
	}
}

367 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_Images
–c⁄° * 
fûíame
 )

369 
CvVideoWrôî_Images
 *
wrôî
 = 
√w
 CvVideoWriter_Images;

371 if–
wrôî
->
	`›í
–
fûíame
 ))

372  
wrôî
;

374 
dñëe
 
wrôî
;

376 
	}
}

	@src/cap_intelperc.cpp

1 #ifde‡
HAVE_INTELPERC


3 
	~"ˇp_öãÕîc.hµ
"

5 
«me•a˚
 
	gcv


10 
	gI¡ñPîCSåómBa£
::
I¡ñPîCSåómBa£
()

11 : 
m_¥ofûeIdx
(-1)

12 , 
m_‰ameIdx
(0)

13 , 
m_timeSèmpSèπNS
(0)

16 
	gI¡ñPîCSåómBa£
::~
I¡ñPîCSåómBa£
()

20 
boﬁ
 
I¡ñPîCSåómBa£
::
isVÆid
()

22  (
m_devi˚
.
IsVÆid
(Ë&& 
m_°ªam
.IsValid());

24 
boﬁ
 
	gI¡ñPîCSåómBa£
::
gøbFøme
()

26 i‡(!
m_°ªam
.
IsVÆid
())

27  
Ál£
;

28 i‡(-1 =
m_¥ofûeIdx
)

30 i‡(!
£tPr›îty
(
CV_CAP_PROP_INTELPERC_PROFILE_IDX
, 0))

31  
Ál£
;

33 
PXCSm¨tSP
 
	g•
;

34 
	gm_pxcImage
.
Rñó£Ref
();

35 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	gm_°ªam
->
RódSåómAsync
(&
m_pxcImage
, &
•
))

36  
	gÁl£
;

37 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	g•
->
Synchr⁄ize
())

38  
	gÁl£
;

39 i‡(0 =
m_timeSèmpSèπNS
)

40 
m_timeSèmpSèπNS
 = 
m_pxcImage
->
QuîyTimeSèmp
();

41 
	gm_timeSèmp
 = ()((
m_pxcImage
->
QuîyTimeSèmp
(Ë- 
m_timeSèmpSèπNS
) / 10000);

42 
	gm_‰ameIdx
++;

43  
	gåue
;

45 
	gI¡ñPîCSåómBa£
::
gëProfûeIDX
() const

47  
m_¥ofûeIdx
;

49 
	gI¡ñPîCSåómBa£
::
gëPr›îty
(
¥›Idx
) const

51 
ªt
 = 0.0;

52 
	g¥›Idx
)

54 
	gCV_CAP_PROP_INTELPERC_PROFILE_COUNT
:

55 
ªt
 = ()
m_¥ofûes
.
size
();

57 
	gCV_CAP_PROP_FRAME_WIDTH
 :

58 i‡((0 <
m_¥ofûeIdx
Ë&& (m_¥ofûeIdx < 
m_¥ofûes
.
size
()))

59 
ªt
 = ()
m_¥ofûes
[
m_¥ofûeIdx
].
imageInfo
.
width
;

61 
	gCV_CAP_PROP_FRAME_HEIGHT
 :

62 i‡((0 <
m_¥ofûeIdx
Ë&& (m_¥ofûeIdx < 
m_¥ofûes
.
size
()))

63 
ªt
 = ()
m_¥ofûes
[
m_¥ofûeIdx
].
imageInfo
.
height
;

65 
	gCV_CAP_PROP_FPS
 :

66 i‡((0 <
m_¥ofûeIdx
Ë&& (m_¥ofûeIdx < 
m_¥ofûes
.
size
()))

68 
ªt
 = (()
m_¥ofûes
[
m_¥ofûeIdx
].
‰ameR©eMö
.
numî©‹
 / ()m_¥ofûes[m_¥ofûeIdx].‰ameR©eMö.
díomö©‹


69 + ()
m_¥ofûes
[
m_¥ofûeIdx
].
‰ameR©eMax
.
numî©‹
 / ()m_¥ofûes[m_¥ofûeIdx].‰ameR©eMax.
díomö©‹
) / 2.0;

72 
	gCV_CAP_PROP_POS_FRAMES
:

73 
ªt
 = ()
m_‰ameIdx
;

75 
	gCV_CAP_PROP_POS_MSEC
:

76 
ªt
 = 
m_timeSèmp
;

79  
	gªt
;

81 
boﬁ
 
	gI¡ñPîCSåómBa£
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
)

83 
boﬁ
 
	gisSë
 = 
Ál£
;

84 
	g¥›Idx
)

86 
	gCV_CAP_PROP_INTELPERC_PROFILE_IDX
:

88 
¥›VÆI¡
 = ()
¥›VÆ
;

89 i‡(0 > 
	g¥›VÆI¡
)

91 
	gm_¥ofûeIdx
 = 
¥›VÆI¡
;

92 
	gisSë
 = 
åue
;

94 i‡(
	g¥›VÆI¡
 < 
	gm_¥ofûes
.
size
())

96 i‡(
	gm_¥ofûeIdx
 !
¥›VÆI¡
)

98 
m_¥ofûeIdx
 = 
¥›VÆI¡
;

99 i‡(
	gm_°ªam
.
IsVÆid
())

100 
	gm_°ªam
->
SëProfûe
(&
m_¥ofûes
[
m_¥ofûeIdx
]);

101 
	gm_‰ameIdx
 = 0;

102 
	gm_timeSèmpSèπNS
 = 0;

104 
	gisSë
 = 
åue
;

109  
	gisSë
;

111 
boﬁ
 
	gI¡ñPîCSåómBa£
::
öôDevi˚
(
PXCSessi⁄
 *
£ssi⁄
)

113 i‡(
NULL
 =
£ssi⁄
)

114  
Ál£
;

116 
pxcSètus
 
	g°s
 = 
PXC_STATUS_NO_ERROR
;

117 
	gPXCSessi⁄
::
Im∂Desc
 
ãm∂©
;

118 
mem£t
(&
ãm∂©
,0,(templat));

119 
	gãm∂©
.
	ggroup
 = 
PXCSessi⁄
::
IMPL_GROUP_SENSOR
;

120 
	gãm∂©
.
	gsubgroup

PXCSessi⁄
::
IMPL_SUBGROUP_VIDEO_CAPTURE
;

122 
	gmodidx
 = 0; 
	gPXC_STATUS_NO_ERROR
 <
°s
; modidx++)

124 
	gPXCSessi⁄
::
Im∂Desc
 
desc
;

125 
	g°s
 = 
£ssi⁄
->
QuîyIm∂
(&
ãm∂©
, 
modidx
, &
desc
);

126 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	g°s
)

129 
	gPXCSm¨tPå
<
	gPXCC≠tuª
> 
	gˇ±uª
;

130 
	g°s
 = 
£ssi⁄
->
Cª©eIm∂
<
PXCC≠tuª
>(&
desc
, &
	gˇ±uª
);

131 i‡(!
	gˇ±uª
.
IsVÆid
())

135 
	gdevidx
 = 0; 
	gPXC_STATUS_NO_ERROR
 <
°s
; devidx++)

137 
	gPXCSm¨tPå
<
	gPXCC≠tuª
::
Devi˚
> 
devi˚
;

138 
	g°s
 = 
ˇ±uª
->
Cª©eDevi˚
(
devidx
, &
devi˚
);

139 i‡(
	gPXC_STATUS_NO_ERROR
 <
°s
)

141 
m_devi˚
 = 
devi˚
.
Rñó£På
();

142  
	gåue
;

146  
	gÁl£
;

149 
	gI¡ñPîCSåómBa£
::
öôSåómIm∂
(
PXCImage
::
ImageTy≥
 
ty≥
)

151 i‡(!
m_devi˚
.
IsVÆid
())

154 
pxcSètus
 
	g°s
 = 
PXC_STATUS_NO_ERROR
;

156 
	g°ªamidx
 = 0; 
	gPXC_STATUS_NO_ERROR
 <
°s
; streamidx++)

158 
	gPXCC≠tuª
::
Devi˚
::
SåómInfo
 
söfo
;

159 
	g°s
 = 
m_devi˚
->
QuîySåóm
(
°ªamidx
, &
söfo
);

160 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	g°s
)

162 i‡(
	gPXCC≠tuª
::
VideoSåóm
::
CUID
 !
söfo
.
cuid
)

164 i‡(
	gty≥
 !
söfo
.
imageTy≥
)

167 
	g°s
 = 
m_devi˚
->
Cª©eSåóm
<
PXCC≠tuª
::
VideoSåóm
>(
°ªamidx
, &
	gm_°ªam
);

168 i‡(
	gPXC_STATUS_NO_ERROR
 =
°s
)

170 
	gm_°ªam
.
Rñó£Ref
();

173 
boﬁ
 
	gI¡ñPîCSåómBa£
::
vÆidProfûe
(c⁄° 
PXCC≠tuª
::
VideoSåóm
::
ProfûeInfo
& )

175  
åue
;

177 
	gI¡ñPîCSåómBa£
::
íumProfûes
()

179 
m_¥ofûes
.
˛ór
();

180 i‡(!
	gm_°ªam
.
IsVÆid
())

182 
pxcSètus
 
	g°s
 = 
PXC_STATUS_NO_ERROR
;

183 
	g¥ofidx
 = 0; 
	gPXC_STATUS_NO_ERROR
 <
°s
;Örofidx++)

185 
	gPXCC≠tuª
::
VideoSåóm
::
ProfûeInfo
 
pöfo
;

186 
	g°s
 = 
m_°ªam
->
QuîyProfûe
(
¥ofidx
, &
pöfo
);

187 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	g°s
)

189 i‡(
vÆidProfûe
(
pöfo
))

190 
	gm_¥ofûes
.
push_back
(
pöfo
);

196 
	gI¡ñPîCSåómImage
::
I¡ñPîCSåómImage
()

199 
I¡ñPîCSåómImage
::~IntelPerCStreamImage()

203 
boﬁ
 
I¡ñPîCSåómImage
::
öôSåóm
(
PXCSessi⁄
 *
£ssi⁄
)

205 i‡(!
öôDevi˚
(
£ssi⁄
))

206  
Ál£
;

207 
öôSåómIm∂
(
PXCImage
::
IMAGE_TYPE_COLOR
);

208 i‡(!
	gm_°ªam
.
IsVÆid
())

209  
	gÁl£
;

210 
íumProfûes
();

211  
	gåue
;

213 
	gI¡ñPîCSåómImage
::
gëPr›îty
(
¥›Idx
) const

215 
¥›Idx
)

217 
CV_CAP_PROP_BRIGHTNESS
:

219 i‡(!
m_devi˚
.
IsVÆid
())

221 
	g‰ë
 = 0.0f;

222 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_BRIGHTNESS
, &
‰ë
))

223  ()
	g‰ë
;

227 
	gCV_CAP_PROP_CONTRAST
:

229 i‡(!
m_devi˚
.
IsVÆid
())

231 
	g‰ë
 = 0.0f;

232 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_CONTRAST
, &
‰ë
))

233  ()
	g‰ë
;

237 
	gCV_CAP_PROP_SATURATION
:

239 i‡(!
m_devi˚
.
IsVÆid
())

241 
	g‰ë
 = 0.0f;

242 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_SATURATION
, &
‰ë
))

243  ()
	g‰ë
;

247 
	gCV_CAP_PROP_HUE
:

249 i‡(!
m_devi˚
.
IsVÆid
())

251 
	g‰ë
 = 0.0f;

252 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_HUE
, &
‰ë
))

253  ()
	g‰ë
;

257 
	gCV_CAP_PROP_GAMMA
:

259 i‡(!
m_devi˚
.
IsVÆid
())

261 
	g‰ë
 = 0.0f;

262 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_GAMMA
, &
‰ë
))

263  ()
	g‰ë
;

267 
	gCV_CAP_PROP_SHARPNESS
:

269 i‡(!
m_devi˚
.
IsVÆid
())

271 
	g‰ë
 = 0.0f;

272 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_SHARPNESS
, &
‰ë
))

273  ()
	g‰ë
;

277 
	gCV_CAP_PROP_GAIN
:

279 i‡(!
m_devi˚
.
IsVÆid
())

281 
	g‰ë
 = 0.0f;

282 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_GAIN
, &
‰ë
))

283  ()
	g‰ë
;

287 
	gCV_CAP_PROP_BACKLIGHT
:

289 i‡(!
m_devi˚
.
IsVÆid
())

291 
	g‰ë
 = 0.0f;

292 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_BACK_LIGHT_COMPENSATION
, &
‰ë
))

293  ()
	g‰ë
;

297 
	gCV_CAP_PROP_EXPOSURE
:

299 i‡(!
m_devi˚
.
IsVÆid
())

301 
	g‰ë
 = 0.0f;

302 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_EXPOSURE
, &
‰ë
))

303  ()
	g‰ë
;

309  
	gI¡ñPîCSåómBa£
::
gëPr›îty
(
¥›Idx
);

311 
boﬁ
 
	gI¡ñPîCSåómImage
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
)

313 
	g¥›Idx
)

315 
	gCV_CAP_PROP_BRIGHTNESS
:

317 i‡(!
m_devi˚
.
IsVÆid
())

318  
Ál£
;

319  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_BRIGHTNESS
, ()
¥›VÆ
));

322 
	gCV_CAP_PROP_CONTRAST
:

324 i‡(!
m_devi˚
.
IsVÆid
())

325  
Ál£
;

326  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_CONTRAST
, ()
¥›VÆ
));

329 
	gCV_CAP_PROP_SATURATION
:

331 i‡(!
m_devi˚
.
IsVÆid
())

332  
Ál£
;

333  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_SATURATION
, ()
¥›VÆ
));

336 
	gCV_CAP_PROP_HUE
:

338 i‡(!
m_devi˚
.
IsVÆid
())

339  
Ál£
;

340  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_HUE
, ()
¥›VÆ
));

343 
	gCV_CAP_PROP_GAMMA
:

345 i‡(!
m_devi˚
.
IsVÆid
())

346  
Ál£
;

347  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_GAMMA
, ()
¥›VÆ
));

350 
	gCV_CAP_PROP_SHARPNESS
:

352 i‡(!
m_devi˚
.
IsVÆid
())

353  
Ál£
;

354  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_SHARPNESS
, ()
¥›VÆ
));

357 
	gCV_CAP_PROP_GAIN
:

359 i‡(!
m_devi˚
.
IsVÆid
())

360  
Ál£
;

361  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_GAIN
, ()
¥›VÆ
));

364 
	gCV_CAP_PROP_BACKLIGHT
:

366 i‡(!
m_devi˚
.
IsVÆid
())

367  
Ál£
;

368  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_BACK_LIGHT_COMPENSATION
, ()
¥›VÆ
));

371 
	gCV_CAP_PROP_EXPOSURE
:

373 i‡(!
m_devi˚
.
IsVÆid
())

374  
Ál£
;

375  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_COLOR_EXPOSURE
, ()
¥›VÆ
));

380  
	gI¡ñPîCSåómBa£
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
);

382 
boﬁ
 
	gI¡ñPîCSåómImage
::
ªåõveAsOuçutAºay
(
cv
::
OuçutAºay
 
image
)

384 i‡(!
m_pxcImage
.
IsVÆid
())

385  
Ál£
;

386 
	gPXCImage
::
ImageInfo
 
öfo
;

387 
	gm_pxcImage
->
QuîyInfo
(&
öfo
);

389 
	gPXCImage
::
ImageD©a
 
d©a
;

390 
	gm_pxcImage
->
AcquúeAc˚ss
(
PXCImage
::
ACCESS_READ
, PXCImage::
COLOR_FORMAT_RGB24
, &
d©a
);

392 i‡(
	gPXCImage
::
SURFACE_TYPE_SYSTEM_MEMORY
 !
d©a
.
ty≥
)

393  
Ál£
;

395 
	gcv
::
M©
 
ãmp
(
öfo
.
height
, info.
width
, 
CV_8UC3
, 
d©a
.
∂™es
[0], d©a.
pôches
[0]);

396 
	gãmp
.
c›yTo
(
image
);

398 
	gm_pxcImage
->
Rñó£Ac˚ss
(&
d©a
);

399  
	gåue
;

404 
	gI¡ñPîCSåómDïth
::
I¡ñPîCSåómDïth
()

407 
I¡ñPîCSåómDïth
::~IntelPerCStreamDepth()

411 
boﬁ
 
I¡ñPîCSåómDïth
::
öôSåóm
(
PXCSessi⁄
 *
£ssi⁄
)

413 i‡(!
öôDevi˚
(
£ssi⁄
))

414  
Ál£
;

415 
öôSåómIm∂
(
PXCImage
::
IMAGE_TYPE_DEPTH
);

416 i‡(!
	gm_°ªam
.
IsVÆid
())

417  
	gÁl£
;

418 
íumProfûes
();

419  
	gåue
;

421 
	gI¡ñPîCSåómDïth
::
gëPr›îty
(
¥›Idx
) const

423 
¥›Idx
)

425 
CV_CAP_PROP_INTELPERC_DEPTH_LOW_CONFIDENCE_VALUE
:

427 i‡(!
m_devi˚
.
IsVÆid
())

429 
	g‰ë
 = 0.0f;

430 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_LOW_CONFIDENCE_VALUE
, &
‰ë
))

431  ()
	g‰ë
;

435 
	gCV_CAP_PROP_INTELPERC_DEPTH_SATURATION_VALUE
:

437 i‡(!
m_devi˚
.
IsVÆid
())

439 
	g‰ë
 = 0.0f;

440 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_SATURATION_VALUE
, &
‰ë
))

441  ()
	g‰ë
;

445 
	gCV_CAP_PROP_INTELPERC_DEPTH_CONFIDENCE_THRESHOLD
:

447 i‡(!
m_devi˚
.
IsVÆid
())

449 
	g‰ë
 = 0.0f;

450 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_CONFIDENCE_THRESHOLD
, &
‰ë
))

451  ()
	g‰ë
;

455 
	gCV_CAP_PROP_INTELPERC_DEPTH_FOCAL_LENGTH_HORZ
:

457 i‡(!
m_devi˚
.
IsVÆid
())

459 
PXCPoötF32
 
	g±f
;

460 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îtyAsPoöt
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_FOCAL_LENGTH
, &
±f
))

461  ()
	g±f
.
	gx
;

465 
	gCV_CAP_PROP_INTELPERC_DEPTH_FOCAL_LENGTH_VERT
:

467 i‡(!
m_devi˚
.
IsVÆid
())

469 
PXCPoötF32
 
	g±f
;

470 i‡(
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
QuîyPr›îtyAsPoöt
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_FOCAL_LENGTH
, &
±f
))

471  ()
	g±f
.
	gy
;

477  
	gI¡ñPîCSåómBa£
::
gëPr›îty
(
¥›Idx
);

479 
boﬁ
 
	gI¡ñPîCSåómDïth
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
)

481 
	g¥›Idx
)

483 
	gCV_CAP_PROP_INTELPERC_DEPTH_LOW_CONFIDENCE_VALUE
:

485 i‡(!
m_devi˚
.
IsVÆid
())

486  
Ál£
;

487  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_LOW_CONFIDENCE_VALUE
, ()
¥›VÆ
));

490 
	gCV_CAP_PROP_INTELPERC_DEPTH_SATURATION_VALUE
:

492 i‡(!
m_devi˚
.
IsVÆid
())

493  
Ál£
;

494  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_SATURATION_VALUE
, ()
¥›VÆ
));

497 
	gCV_CAP_PROP_INTELPERC_DEPTH_CONFIDENCE_THRESHOLD
:

499 i‡(!
m_devi˚
.
IsVÆid
())

500  
Ál£
;

501  (
	gPXC_STATUS_NO_ERROR
 =
m_devi˚
->
SëPr›îty
(
PXCC≠tuª
::
Devi˚
::
PROPERTY_DEPTH_CONFIDENCE_THRESHOLD
, ()
¥›VÆ
));

506  
	gI¡ñPîCSåómBa£
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
);

508 
boﬁ
 
	gI¡ñPîCSåómDïth
::
ªåõveDïthAsOuçutAºay
(
cv
::
OuçutAºay
 
image
)

510  
ªåiveFøme
(
CV_16SC1
, 0, 
image
);

512 
boﬁ
 
	gI¡ñPîCSåómDïth
::
ªåõveIRAsOuçutAºay
(
cv
::
OuçutAºay
 
image
)

514  
ªåiveFøme
(
CV_16SC1
, 1, 
image
);

516 
boﬁ
 
	gI¡ñPîCSåómDïth
::
ªåõveUVAsOuçutAºay
(
cv
::
OuçutAºay
 
image
)

518  
ªåiveFøme
(
CV_32FC2
, 2, 
image
);

520 
boﬁ
 
	gI¡ñPîCSåómDïth
::
vÆidProfûe
(c⁄° 
PXCC≠tuª
::
VideoSåóm
::
ProfûeInfo
& 
pöfo
)

522  (
PXCImage
::
COLOR_FORMAT_DEPTH
 =
pöfo
.
imageInfo
.
f‹m©
);

524 
boﬁ
 
	gI¡ñPîCSåómDïth
::
ªåiveFøme
(
ty≥
, 
∂™eIdx
, 
cv
::
OuçutAºay
 
‰ame
)

526 i‡(!
m_pxcImage
.
IsVÆid
())

527  
Ál£
;

528 
	gPXCImage
::
ImageInfo
 
öfo
;

529 
	gm_pxcImage
->
QuîyInfo
(&
öfo
);

531 
	gPXCImage
::
ImageD©a
 
d©a
;

532 
	gm_pxcImage
->
AcquúeAc˚ss
(
PXCImage
::
ACCESS_READ
, &
d©a
);

534 i‡(
	gPXCImage
::
SURFACE_TYPE_SYSTEM_MEMORY
 !
d©a
.
ty≥
)

535  
Ál£
;

537 
	gcv
::
M©
 
ãmp
(
öfo
.
height
, info.
width
, 
ty≥
, 
d©a
.
∂™es
[
∂™eIdx
], d©a.
pôches
[planeIdx]);

538 
	gãmp
.
c›yTo
(
‰ame
);

540 
	gm_pxcImage
->
Rñó£Ac˚ss
(&
d©a
);

541  
	gåue
;

546 
	gVideoC≠tuª_I¡ñPîC
::
VideoC≠tuª_I¡ñPîC
()

547 : 
m_c⁄ãxtO≥√d
(
Ál£
)

549 
pxcSètus
 
°s
 = 
PXCSessi⁄_Cª©e
(&
m_£ssi⁄
);

550 i‡(
	gPXC_STATUS_NO_ERROR
 > 
	g°s
)

552 
	gm_c⁄ãxtO≥√d
 = 
m_imageSåóm
.
öôSåóm
(
m_£ssi⁄
);

553 
	gm_c⁄ãxtO≥√d
 &
m_dïthSåóm
.
öôSåóm
(
m_£ssi⁄
);

555 
	gVideoC≠tuª_I¡ñPîC
::~
VideoC≠tuª_I¡ñPîC
(){}

557 
VideoC≠tuª_I¡ñPîC
::
gëPr›îty
(
¥›Idx
) const

559 
¥›VÆue
 = 0;

560 
	gpuªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_INTELPERC_GENERATORS_MASK
;

561 i‡(
	gCV_CAP_INTELPERC_IMAGE_GENERATOR
 =(
¥›Idx
 & 
CV_CAP_INTELPERC_GENERATORS_MASK
))

563 
¥›VÆue
 = 
m_imageSåóm
.
gëPr›îty
(
puªPr›Idx
);

565 i‡(
	gCV_CAP_INTELPERC_DEPTH_GENERATOR
 =(
¥›Idx
 & 
CV_CAP_INTELPERC_GENERATORS_MASK
))

567 
¥›VÆue
 = 
m_dïthSåóm
.
gëPr›îty
(
puªPr›Idx
);

571 
	g¥›VÆue
 = 
m_dïthSåóm
.
gëPr›îty
(
puªPr›Idx
);

573  
	g¥›VÆue
;

575 
boﬁ
 
	gVideoC≠tuª_I¡ñPîC
::
£tPr›îty
(
¥›Idx
, 
¥›VÆ
)

577 
boﬁ
 
	gisSë
 = 
Ál£
;

578 
	gpuªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_INTELPERC_GENERATORS_MASK
;

579 i‡(
	gCV_CAP_INTELPERC_IMAGE_GENERATOR
 =(
¥›Idx
 & 
CV_CAP_INTELPERC_GENERATORS_MASK
))

581 
isSë
 = 
m_imageSåóm
.
£tPr›îty
(
puªPr›Idx
, 
¥›VÆ
);

583 i‡(
	gCV_CAP_INTELPERC_DEPTH_GENERATOR
 =(
¥›Idx
 & 
CV_CAP_INTELPERC_GENERATORS_MASK
))

585 
isSë
 = 
m_dïthSåóm
.
£tPr›îty
(
puªPr›Idx
, 
¥›VÆ
);

589 
	gisSë
 = 
m_dïthSåóm
.
£tPr›îty
(
puªPr›Idx
, 
¥›VÆ
);

591  
	gisSë
;

594 
boﬁ
 
	gVideoC≠tuª_I¡ñPîC
::
gøbFøme
()

596 i‡(!
isO≥√d
())

597  
Ál£
;

599 
boﬁ
 
	gisGøbbed
 = 
Ál£
;

600 i‡(
	gm_dïthSåóm
.
isVÆid
())

601 
	gisGøbbed
 = 
m_dïthSåóm
.
gøbFøme
();

602 i‡((
	gm_imageSåóm
.
isVÆid
()Ë&& (-1 !
m_imageSåóm
.
gëProfûeIDX
()))

603 
isGøbbed
 &
m_imageSåóm
.
gøbFøme
();

605  
	gisGøbbed
;

607 
boﬁ
 
	gVideoC≠tuª_I¡ñPîC
::
ªåõveFøme
(
ouçutTy≥
, 
cv
::
OuçutAºay
 
‰ame
)

609 
ouçutTy≥
)

611 
CV_CAP_INTELPERC_DEPTH_MAP
:

612  
m_dïthSåóm
.
ªåõveDïthAsOuçutAºay
(
‰ame
);

613 
	gCV_CAP_INTELPERC_UVDEPTH_MAP
:

614  
m_dïthSåóm
.
ªåõveUVAsOuçutAºay
(
‰ame
);

615 
	gCV_CAP_INTELPERC_IR_MAP
:

616  
m_dïthSåóm
.
ªåõveIRAsOuçutAºay
(
‰ame
);

617 
	gCV_CAP_INTELPERC_IMAGE
:

618  
m_imageSåóm
.
ªåõveAsOuçutAºay
(
‰ame
);

620  
	gÁl£
;

622 
	gVideoC≠tuª_I¡ñPîC
::
gëC≠tuªDomaö
()

624  
CV_CAP_INTELPERC
;

627 
boﬁ
 
	gVideoC≠tuª_I¡ñPîC
::
isO≥√d
() const

629  
m_c⁄ãxtO≥√d
;

	@src/cap_libv4l.cpp

240 
	~"¥ecomp.hµ
"

242 #i‡!
deföed
 
WIN32
 && deföed 
HAVE_LIBV4L


244 
	#CLEAR
(
x
Ë
	`mem£t
 (&(x), 0,  (x))

	)

246 
	~<°dio.h
>

247 
	~<uni°d.h
>

248 
	~<f˙é.h
>

249 
	~<î∫o.h
>

250 
	~<sys/ty≥s.h
>

251 
	~<sys/mm™.h
>

252 
	~<°rög.h
>

253 
	~<°dlib.h
>

254 
	~<asm/ty≥s.h
>

255 
	~<as£π.h
>

256 
	~<sys/°©.h
>

257 
	~<sys/io˘l.h
>

259 #ifde‡
HAVE_CAMV4L


260 
	~<löux/videodev.h
>

262 #ifde‡
HAVE_CAMV4L2


263 
	~<löux/videodev2.h
>

266 
	~<libv4l1.h
>

267 
	~<libv4l2.h
>

270 
	#DEFAULT_V4L_WIDTH
 640

	)

271 
	#DEFAULT_V4L_HEIGHT
 480

	)

273 
	#CHANNEL_NUMBER
 1

	)

274 
	#MAX_CAMERAS
 8

	)

278 
	#MAX_V4L_BUFFERS
 10

	)

279 
	#DEFAULT_V4L_BUFFERS
 4

	)

283 
	#USE_TEMP_BUFFER


	)

285 
	#MAX_DEVICE_DRIVER_NAME
 80

	)

289 
	sbuf„r


291 * 
	m°¨t
;

292 
size_t
 
	mÀngth
;

294 
	gn_buf„rs
 = 0;

300 
	sv4l2_˘æ_ønge
 {

301 
__u32
 
	m˘æ_id
;

302 
__s32
 
	möôül_vÆue
;

303 
__s32
 
	mcuºít_vÆue
;

304 
__s32
 
	mmöimum
;

305 
__s32
 
	mmaximum
;

306 
__s32
 
	mdeÁu…_vÆue
;

307 } 
	tv4l2_˘æ_ønge
;

309 
	sCvC≠tuªCAM_V4L


311 * 
	mdevi˚Name
;

312 
	mdevi˚H™dÀ
;

313 
	mbuf„rIndex
;

314 
	mFú°C≠tuª
;

316 
	mwidth
; 
	mheight
;

317 
	mmode
;

319 
video_ˇ∑bûôy
 
	mˇ∑bûôy
;

320 
video_wödow
 
	mˇ±uªWödow
;

321 
video_pi˘uª
 
	mimagePr›îtõs
;

322 
video_mbuf
 
	mmem‹yBuf„r
;

323 
video_mm≠
 *
	mmm≠s
;

324 *
	mmem‹yM≠
;

325 
I∂Image
 
	m‰ame
;

328 
buf„r
 
	mbuf„rs
[
MAX_V4L_BUFFERS
 + 1];

329 
v4l2_ˇ∑bûôy
 
	mˇp
;

330 
v4l2_öput
 
	möp
;

331 
v4l2_f‹m©
 
	mf‹m
;

332 
v4l2_¸›
 
	m¸›
;

333 
v4l2_¸›ˇp
 
	m¸›ˇp
;

334 
v4l2_ªque°buf„rs
 
	mªq
;

335 
v4l2_j≥gcom¥essi⁄
 
	mcom¥
;

336 
v4l2_c⁄åﬁ
 
	mc⁄åﬁ
;

337 
v4l2_buf_ty≥
 
	mty≥
;

338 
v4l2_quîy˘æ
 
	mquîy˘æ
;

340 
timevÆ
 
	mtime°amp
;

343 
	m£quí˚
;

346 
v4l2_˘æ_ønge
** 
	mv4l2_˘æ_ønges
;

347 
	mv4l2_˘æ_cou¡
;

349 
	mis_v4l2_devi˚
;

351 
	tCvC≠tuªCAM_V4L
;

353 
icvClo£CAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 );

355 
icvGøbFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 );

356 
I∂Image
* 
icvRërõveFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, );

357 
CvC≠tuª
* 
cvCª©eCamîaC≠tuª_V4L
–
ödex
 );

359 
icvGëPr›îtyCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
 );

360 
icvSëPr›îtyCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
 );

362 
icvSëVideoSize
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
w
, 
h
);

366 
	gnumCamîas
 = 0;

367 
	gödexLi°
 = 0;

370 #ifde‡
HAVE_IOCTL_ULONG


371 
	$xio˘l
–
fd
, 
ªque°
, *
¨g
)

373 
	$xio˘l
–
fd
, 
ªque°
, *
¨g
)

377 
r
;

380 dÿ
r
 = 
	`v4l2_io˘l
 (
fd
, 
ªque°
, 
¨g
);

381 -1 =
r
 && 
EINTR
 =
î∫o
);

383  
r
;

385 
	}
}

393 
	$icvInôC≠tuª_V4L
() {

394 
devi˚H™dÀ
;

395 
CamîaNumbî
;

396 
devi˚Name
[
MAX_DEVICE_DRIVER_NAME
];

398 
CamîaNumbî
 = 0;

399 
CamîaNumbî
 < 
MAX_CAMERAS
) {

401 
	`•rötf
(
devi˚Name
, "/dev/video%1d", 
CamîaNumbî
);

403 
devi˚H™dÀ
 = 
	`›í
(
devi˚Name
, 
O_RDONLY
);

404 i‡(
devi˚H™dÀ
 != -1) {

407 
ödexLi°
|=(1 << 
CamîaNumbî
);

408 
numCamîas
++;

410 i‡(
devi˚H™dÀ
 != -1)

411 
	`˛o£
(
devi˚H™dÀ
);

413 
CamîaNumbî
++;

416 
	}
};

419 
	$åy_öô_v4l
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, *
devi˚Name
)

426 
dëe˘
 = 0;

433 
ˇ±uª
->
devi˚H™dÀ
 = 
	`v4l1_›í
(
devi˚Name
, 
O_RDWR
);

436 i‡(
ˇ±uª
->
devi˚H™dÀ
 == 0)

438 
dëe˘
 = -1;

440 
	`icvClo£CAM_V4L
(
ˇ±uª
);

443 i‡(
dëe˘
 == 0)

446 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGCAP
, &ˇ±uª->
ˇ∑bûôy
) < 0)

448 
dëe˘
 = 0;

450 
	`icvClo£CAM_V4L
(
ˇ±uª
);

454 
dëe˘
 = 1;

458  
dëe˘
;

460 
	}
}

463 
	$åy_öô_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, *
devi˚Name
)

469 
dëe˘
 = 0;

475 
ˇ±uª
->
devi˚H™dÀ
 = 
	`v4l2_›í
 (
devi˚Name
, 
O_RDWR
 | 
O_NONBLOCK
, 0);

479 i‡(
ˇ±uª
->
devi˚H™dÀ
 == 0)

481 
dëe˘
 = -1;

483 
	`icvClo£CAM_V4L
(
ˇ±uª
);

486 i‡(
dëe˘
 == 0)

488 
	`CLEAR
 (
ˇ±uª
->
ˇp
);

489 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCAP
, &ˇ±uª->
ˇp
))

491 
dëe˘
 = 0;

493 
	`icvClo£CAM_V4L
(
ˇ±uª
);

497 
	`CLEAR
 (
ˇ±uª
->
ˇ∑bûôy
);

498 
ˇ±uª
->
ˇ∑bûôy
.
ty≥
 = c≠tuª->
ˇp
.
ˇ∑bûôõs
;

501 i‡(-1 !
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_INPUT
, &ˇ±uª->
ˇ∑bûôy
.
ch™√ls
))

503 
dëe˘
 = 1;

508  
dëe˘
;

510 
	}
}

513 
	$v4l2_‰ì_ønges
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

514 
i
;

515 i‡(
ˇ±uª
->
v4l2_˘æ_ønges
 !
NULL
) {

516 
i
 = 0; i < 
ˇ±uª
->
v4l2_˘æ_cou¡
; i++) {

523 
	`‰ì
(
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]);

526 
	`‰ì
(
ˇ±uª
->
v4l2_˘æ_ønges
);

527 
ˇ±uª
->
v4l2_˘æ_cou¡
 = 0;

528 
ˇ±uª
->
v4l2_˘æ_ønges
 = 
NULL
;

529 
	}
}

531 
	$v4l2_add_˘æ_ønge
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
v4l2_c⁄åﬁ
* 
˘æ
) {

532 
v4l2_˘æ_ønge
* 
ønge
 = (v4l2_˘æ_ønge*)
	`mÆloc
((v4l2_ctrl_range));

533 
ønge
->
˘æ_id
 = 
˘æ
->
id
;

534 
ønge
->
öôül_vÆue
 = 
˘æ
->
vÆue
;

535 
ønge
->
cuºít_vÆue
 = 
˘æ
->
vÆue
;

536 
ønge
->
möimum
 = 
ˇ±uª
->
quîy˘æ
.minimum;

537 
ønge
->
maximum
 = 
ˇ±uª
->
quîy˘æ
.maximum;

538 
ønge
->
deÁu…_vÆue
 = 
ˇ±uª
->
quîy˘æ
.default_value;

539 
ˇ±uª
->
v4l2_˘æ_ønges
[ˇ±uª->
v4l2_˘æ_cou¡
] = 
ønge
;

540 
ˇ±uª
->
v4l2_˘æ_cou¡
 += 1;

541 
ˇ±uª
->
v4l2_˘æ_ønges
 = (
v4l2_˘æ_ønge
**)
	`ªÆloc
((v4l2_˘æ_ønge**)ˇ±uª->v4l2_˘æ_ønges, (ˇ±uª->
v4l2_˘æ_cou¡
 + 1) * (v4l2_ctrl_range*));

542 
	}
}

544 
	$v4l2_gë_˘æ_deÁu…
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
__u32
 
id
) {

545 
i
;

546 
i
 = 0; i < 
ˇ±uª
->
v4l2_˘æ_cou¡
; i++) {

547 i‡(
id
 =
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
˘æ_id
) {

548  
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
deÁu…_vÆue
;

552 
	}
}

554 
	$v4l2_gë_˘æ_mö
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
__u32
 
id
) {

555 
i
;

556 
i
 = 0; i < 
ˇ±uª
->
v4l2_˘æ_cou¡
; i++) {

557 i‡(
id
 =
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
˘æ_id
) {

558  
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
möimum
;

562 
	}
}

564 
	$v4l2_gë_˘æ_max
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
__u32
 
id
) {

565 
i
;

566 
i
 = 0; i < 
ˇ±uª
->
v4l2_˘æ_cou¡
; i++) {

567 i‡(
id
 =
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
˘æ_id
) {

568  
ˇ±uª
->
v4l2_˘æ_ønges
[
i
]->
maximum
;

572 
	}
}

575 
	$v4l2_sˇn_c⁄åﬁs
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

577 
__u32
 
˘æ_id
;

578 
v4l2_c⁄åﬁ
 
c
;

579 i‡(
ˇ±uª
->
v4l2_˘æ_ønges
 !
NULL
) {

580 
	`v4l2_‰ì_ønges
(
ˇ±uª
);

582 
ˇ±uª
->
v4l2_˘æ_ønges
 = (
v4l2_˘æ_ønge
**)
	`mÆloc
((v4l2_ctrl_range*));

583 #ifde‡
V4L2_CTRL_FLAG_NEXT_CTRL


585 
ˇ±uª
->
quîy˘æ
.
id
 = 
V4L2_CTRL_FLAG_NEXT_CTRL
;

586 if(0 =
	`v4l2_io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
, &ˇ±uª->
quîy˘æ
)) {

588 
c
.
id
 = 
ˇ±uª
->
quîy˘æ
.id;

589 
ˇ±uª
->
quîy˘æ
.
id
 |
V4L2_CTRL_FLAG_NEXT_CTRL
;

590 if(
ˇ±uª
->
quîy˘æ
.
Êags
 & 
V4L2_CTRL_FLAG_DISABLED
) {

593 if(
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_INTEGER
 &&

594 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_BOOLEAN
 &&

595 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_MENU
) {

598 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
, &
c
) == 0) {

599 
	`v4l2_add_˘æ_ønge
(
ˇ±uª
, &
c
);

602 } 0 =
	`v4l2_io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
, &ˇ±uª->
quîy˘æ
));

607 
˘æ_id
=
V4L2_CID_BASE
; cål_id<
V4L2_CID_LASTP1
; ctrl_id++) {

608 
ˇ±uª
->
quîy˘æ
.
id
 = 
˘æ_id
;

609 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
, &ˇ±uª->
quîy˘æ
) == 0) {

610 if(
ˇ±uª
->
quîy˘æ
.
Êags
 & 
V4L2_CTRL_FLAG_DISABLED
) {

613 if(
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_INTEGER
 &&

614 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_BOOLEAN
 &&

615 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_MENU
) {

618 
c
.
id
 = 
˘æ_id
;

620 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
, &
c
) == 0) {

621 
	`v4l2_add_˘æ_ønge
(
ˇ±uª
, &
c
);

627 
˘æ_id
=
V4L2_CID_PRIVATE_BASE
; ; ctrl_id++) {

628 
ˇ±uª
->
quîy˘æ
.
id
 = 
˘æ_id
;

629 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
, &ˇ±uª->
quîy˘æ
) == 0) {

630 if(
ˇ±uª
->
quîy˘æ
.
Êags
 & 
V4L2_CTRL_FLAG_DISABLED
) {

635 if(
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_INTEGER
 &&

636 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_BOOLEAN
 &&

637 
ˇ±uª
->
quîy˘æ
.
ty≥
 !
V4L2_CTRL_TYPE_MENU
) {

641 
c
.
id
 = 
˘æ_id
;

643 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
, &
c
) == 0) {

644 
	`v4l2_add_˘æ_ønge
(
ˇ±uª
, &
c
);

651 
	}
}

653 
ölöe
 
	$ch™√ls_f‹_mode
(
mode
)

655 
mode
) {

656 
CV_CAP_MODE_GRAY
:

658 
CV_CAP_MODE_YUYV
:

663 
	}
}

665 
	$_ˇ±uª_V4L2
 (
CvC≠tuªCAM_V4L
 *
ˇ±uª
, *
devi˚Name
)

667 
dëe˘_v4l2
 = 0;

669 
ˇ±uª
->
devi˚Name
 = 
	`°rdup
(deviceName);

671 
dëe˘_v4l2
 = 
	`åy_öô_v4l2
(
ˇ±uª
, 
devi˚Name
);

673 i‡(
dëe˘_v4l2
 != 1) {

679 
ˇ±uª
->
is_v4l2_devi˚
 = 1;

681 
ˇ±uª
->
v4l2_˘æ_ønges
 = 
NULL
;

682 
ˇ±uª
->
v4l2_˘æ_cou¡
 = 0;

685 
	`v4l2_sˇn_c⁄åﬁs
(
ˇ±uª
);

687 i‡((
ˇ±uª
->
ˇp
.
ˇ∑bûôõs
 & 
V4L2_CAP_VIDEO_CAPTURE
) == 0) {

689 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L2: devi˚ %†i†u«bÀÅÿˇ±uª videÿmem‹y.\n",
devi˚Name
);

690 
	`icvClo£CAM_V4L
(
ˇ±uª
);

701 if(
ˇ±uª
->
öp
.
ödex
 > 0) {

702 
	`CLEAR
 (
ˇ±uª
->
öp
);

703 
ˇ±uª
->
öp
.
ödex
 = 
CHANNEL_NUMBER
;

706 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_ENUMINPUT
, &ˇ±uª->
öp
))

708 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L2: Aren'tábleÅo set channelÇumber\n");

709 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

715 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

716 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

718 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
)) {

719 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L2: CouldÇot obtain specifics of capture window.\n\n");

720 
	`icvClo£CAM_V4L
(
ˇ±uª
);

726 
ªque°edPixñF‹m©
;

727 
	`¥ötf
("Pixelformat : ");

728 
ˇ±uª
->
mode
) {

729 
CV_CAP_MODE_RGB
:

730 
ªque°edPixñF‹m©
 = 
V4L2_PIX_FMT_RGB24
;

731 
	`¥ötf
("RGB24\n");

733 
CV_CAP_MODE_GRAY
:

734 
ªque°edPixñF‹m©
 = 
V4L2_PIX_FMT_YUV420
;

735 
	`¥ötf
("YUV420\n");

737 
CV_CAP_MODE_YUYV
:

738 
ªque°edPixñF‹m©
 = 
V4L2_PIX_FMT_YUYV
;

739 
	`¥ötf
("YUYV\n");

742 
ªque°edPixñF‹m©
 = 
V4L2_PIX_FMT_BGR24
;

743 
	`¥ötf
("BGR24\n");

746 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

747 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

748 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
pixñf‹m©
 = 
ªque°edPixñF‹m©
;

751 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
fõld
 = 
V4L2_FIELD_ANY
;

752 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
 = capture->width;

753 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 = capture->height;

755 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_FMT
, &ˇ±uª->
f‹m
)) {

756 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR:Üibv4l unableÅo ioctl S_FMT\n");

760 i‡(
ªque°edPixñF‹m©
 !
ˇ±uª
->
f‹m
.
fmt
.
pix
.
pixñf‹m©
) {

761 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR:Üibv4l unable convertÅoÑequestedÖixfmt\n");

767 
mö
;

770 
mö
 = 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
 * 2;

772 i‡(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 < 
mö
)

773 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 = 
mö
;

775 
mö
 = 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 * c≠tuª->f‹m.fmt.pix.
height
;

777 i‡(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
sizeimage
 < 
mö
)

778 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
sizeimage
 = 
mö
;

780 
	`CLEAR
 (
ˇ±uª
->
ªq
);

782 
buf„r_numbî
 = 
DEFAULT_V4L_BUFFERS
;

784 
åy_agaö
:

786 
ˇ±uª
->
ªq
.
cou¡
 = 
buf„r_numbî
;

787 
ˇ±uª
->
ªq
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

788 
ˇ±uª
->
ªq
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

790 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_REQBUFS
, &ˇ±uª->
ªq
))

792 i‡(
EINVAL
 =
î∫o
)

794 
	`Ârötf
 (
°dîr
, "%†d€†nŸ suµ‹àmem‹y m≠pög\n", 
devi˚Name
);

796 
	`≥º‹
 ("VIDIOC_REQBUFS");

799 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

803 i‡(
ˇ±uª
->
ªq
.
cou¡
 < 
buf„r_numbî
)

805 i‡(
buf„r_numbî
 == 1)

807 
	`Ârötf
 (
°dîr
, "Insufficõ¡ buf„∏mem‹y o¿%s\n", 
devi˚Name
);

810 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

813 
buf„r_numbî
--;

814 
	`Ârötf
 (
°dîr
, "Insufficõ¡ buf„∏mem‹y o¿%†-- de¸ó£ög buf„rs\n", 
devi˚Name
);

816 
åy_agaö
;

820 
n_buf„rs
 = 0;Ç_buf„r†< 
ˇ±uª
->
ªq
.
cou¡
; ++n_buffers)

822 
v4l2_buf„r
 
buf
;

824 
	`CLEAR
 (
buf
);

826 
buf
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

827 
buf
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

828 
buf
.
ödex
 = 
n_buf„rs
;

830 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYBUF
, &
buf
)) {

831 
	`≥º‹
 ("VIDIOC_QUERYBUF");

834 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

838 
ˇ±uª
->
buf„rs
[
n_buf„rs
].
Àngth
 = 
buf
.length;

839 
ˇ±uª
->
buf„rs
[
n_buf„rs
].
°¨t
 =

840 
	`v4l2_mm≠
 (
NULL
 ,

841 
buf
.
Àngth
,

842 
PROT_READ
 | 
PROT_WRITE
 ,

843 
MAP_SHARED
 ,

844 
ˇ±uª
->
devi˚H™dÀ
, 
buf
.
m
.
off£t
);

845 
	`¥ötf
("buf.Àngth = %d\n", 
buf
.
Àngth
);

846 i‡(
MAP_FAILED
 =
ˇ±uª
->
buf„rs
[
n_buf„rs
].
°¨t
) {

847 
	`≥º‹
 ("mmap");

850 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

854 #ifde‡
USE_TEMP_BUFFER


855 i‡(
n_buf„rs
 == 0) {

856 i‡(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
) {

857 
	`‰ì
(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
);

858 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
 = 
NULL
;

861 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
 = 
	`mÆloc
(
buf
.
Àngth
);

862 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
Àngth
 = 
buf
.length;

868 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

869 
	`cvSize
–
ˇ±uª
->
ˇ±uªWödow
.
width
,

870 
ˇ±uª
->
ˇ±uªWödow
.
height
 ),

871 
IPL_DEPTH_8U
, 
	`ch™√ls_f‹_mode
(
ˇ±uª
->
mode
),

872 
IPL_ORIGIN_TL
, 4 );

874 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

877 
	}
};

880 
	$_ˇ±uª_V4L
 (
CvC≠tuªCAM_V4L
 *
ˇ±uª
, *
devi˚Name
)

882 
dëe˘_v4l
 = 0;

884 
dëe˘_v4l
 = 
	`åy_öô_v4l
(
ˇ±uª
, 
devi˚Name
);

886 i‡(
dëe˘_v4l
 == -1)

888 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L"

889 ": devi˚ %s: U«bÀÅÿ›í f‹ READ ONLY\n", 
devi˚Name
);

894 i‡(
dëe˘_v4l
 <= 0)

896 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L"

897 ": devi˚ %s: U«bÀÅÿquîyÇumbî o‡ch™√ls\n", 
devi˚Name
);

903 i‡((
ˇ±uª
->
ˇ∑bûôy
.
ty≥
 & 
VID_TYPE_CAPTURE
) == 0) {

905 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: "

906 "devi˚ %†i†u«bÀÅÿˇ±uª videÿmem‹y.\n",
devi˚Name
);

907 
	`icvClo£CAM_V4L
(
ˇ±uª
);

923 if(
ˇ±uª
->
ˇ∑bûôy
.
ch™√ls
>0) {

925 
video_ch™√l
 
£À˘edCh™√l
;

927 
£À˘edCh™√l
.
ch™√l
=
CHANNEL_NUMBER
;

928 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGCHAN
 , &
£À˘edCh™√l
) != -1) {

931 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSCHAN
 , &
£À˘edCh™√l
) == -1) {

942 if(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGWIN
, &ˇ±uª->
ˇ±uªWödow
) == -1) {

943 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: "

945 
	`icvClo£CAM_V4L
(
ˇ±uª
);

952 if(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGPICT
, &ˇ±uª->
imagePr›îtõs
) < 0) {

953 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: UnableÅo determine size of incoming image\n");

954 
	`icvClo£CAM_V4L
(
ˇ±uª
);

958 
ªque°edVideoPÆëã
;

959 
dïth
;

960 
ˇ±uª
->
mode
) {

961 
CV_CAP_MODE_GRAY
:

962 
ªque°edVideoPÆëã
 = 
VIDEO_PALETTE_YUV420
;

963 
dïth
 = 8;

965 
CV_CAP_MODE_YUYV
:

966 
ªque°edVideoPÆëã
 = 
VIDEO_PALETTE_YUYV
;

967 
dïth
 = 16;

970 
ªque°edVideoPÆëã
 = 
VIDEO_PALETTE_RGB24
;

971 
dïth
 = 24;

974 
ˇ±uª
->
imagePr›îtõs
.
dïth
 = depth;

975 
ˇ±uª
->
imagePr›îtõs
.
∑Àâe
 = 
ªque°edVideoPÆëã
;

976 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSPICT
, &ˇ±uª->
imagePr›îtõs
) < 0) {

977 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR:Üibv4l unableÅo ioctl VIDIOCSPICT\n\n");

978 
	`icvClo£CAM_V4L
(
ˇ±uª
);

981 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGPICT
, &ˇ±uª->
imagePr›îtõs
) < 0) {

982 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR:Üibv4l unableÅo ioctl VIDIOCGPICT\n\n");

983 
	`icvClo£CAM_V4L
(
ˇ±uª
);

986 i‡(
ˇ±uª
->
imagePr›îtõs
.
∑Àâe
 !
ªque°edVideoPÆëã
) {

987 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR:Üibv4l unable convertÅoÑequestedÖixfmt\n\n");

988 
	`icvClo£CAM_V4L
(
ˇ±uª
);

996 
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGMBUF
, &ˇ±uª->
mem‹yBuf„r
);

997 
ˇ±uª
->
mem‹yM≠
 = (*)
	`v4l1_mm≠
(0,

998 
ˇ±uª
->
mem‹yBuf„r
.
size
,

999 
PROT_READ
 | 
PROT_WRITE
,

1000 
MAP_SHARED
,

1001 
ˇ±uª
->
devi˚H™dÀ
,

1003 i‡(
ˇ±uª
->
mem‹yM≠
 =
MAP_FAILED
) {

1004 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: M≠pög Memm‹y from videÿsour˚Éº‹: %s\n", 
	`°ªº‹
(
î∫o
));

1005 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1011 
ˇ±uª
->
mm≠s
 = (
video_mm≠
 *)

1012 (
	`mÆloc
(
ˇ±uª
->
mem‹yBuf„r
.
‰ames
 * (
video_mm≠
)));

1013 i‡(!
ˇ±uª
->
mm≠s
) {

1014 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇot memory map video frames.\n");

1015 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1022 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

1023 
	`cvSize
–
ˇ±uª
->
ˇ±uªWödow
.
width
,

1024 
ˇ±uª
->
ˇ±uªWödow
.
height
 ),

1025 
IPL_DEPTH_8U
, 
	`ch™√ls_f‹_mode
(
ˇ±uª
->
mode
),

1026 
IPL_ORIGIN_TL
, 4 );

1028 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

1031 
	}
};

1033 
CvC≠tuªCAM_V4L
 * 
	$icvC≠tuªFromCAM_V4L
 (
ödex
)

1035 
autoödex
;

1036 
autoödex
 = 0;

1038 
devi˚Name
[
MAX_DEVICE_DRIVER_NAME
];

1040 i‡(!
numCamîas
)

1041 
	`icvInôC≠tuª_V4L
();

1042 i‡(!
numCamîas
)

1043  
NULL
;

1046 i‡–(
ödex
>-1Ë&& ! ((1 << indexË& 
ödexLi°
) )

1048 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: index %d i†nŸ c‹ª˘!\n",
ödex
);

1049  
NULL
;

1053 
CvC≠tuªCAM_V4L
 * 
ˇ±uª
 = (CvC≠tuªCAM_V4L*)
	`cvAŒoc
((CvCaptureCAM_V4L));

1054 i‡(!
ˇ±uª
) {

1055 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇotállocate memory for captureÖrocess.\n");

1056  
NULL
;

1059 #ifde‡
USE_TEMP_BUFFER


1060 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
 = 
NULL
;

1064 i‡(
ödex
<0) {

1065 ; 
autoödex
<
MAX_CAMERAS
;autoindex++)

1066 i‡(
ödexLi°
 & (1<<
autoödex
))

1068 i‡(
autoödex
==
MAX_CAMERAS
)

1069  
NULL
;

1070 
ödex
=
autoödex
;

1071 
autoödex
++;

1074 
	`•rötf
(
devi˚Name
, "/dev/video%1d", 
ödex
);

1077 
	`mem£t
(
ˇ±uª
,0,(
CvC≠tuªCAM_V4L
));

1080 
ˇ±uª
->
Fú°C≠tuª
 = 1;

1083 
ˇ±uª
->
width
 = 
DEFAULT_V4L_WIDTH
;

1084 
ˇ±uª
->
height
 = 
DEFAULT_V4L_HEIGHT
;

1086 i‡(
	`_ˇ±uª_V4L2
 (
ˇ±uª
, 
devi˚Name
) == -1) {

1087 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1088 
ˇ±uª
->
is_v4l2_devi˚
 = 0;

1089 i‡(
	`_ˇ±uª_V4L
 (
ˇ±uª
, 
devi˚Name
) == -1) {

1090 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1091  
NULL
;

1094 
ˇ±uª
->
is_v4l2_devi˚
 = 1;

1097  
ˇ±uª
;

1098 
	}
};

1100 #ifde‡
HAVE_CAMV4L2


1102 
	$ªad_‰ame_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1103 
v4l2_buf„r
 
buf
;

1105 
	`CLEAR
 (
buf
);

1107 
buf
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1108 
buf
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

1110 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_DQBUF
, &
buf
)) {

1111 
î∫o
) {

1112 
EAGAIN
:

1115 
EIO
:

1122 
	`≥º‹
 ("VIDIOC_DQBUF");

1128 
	`as£π
(
buf
.
ödex
 < 
ˇ±uª
->
ªq
.
cou¡
);

1130 #ifde‡
USE_TEMP_BUFFER


1131 
	`mem˝y
(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
,

1132 
ˇ±uª
->
buf„rs
[
buf
.
ödex
].
°¨t
,

1133 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
Àngth
 );

1134 
ˇ±uª
->
buf„rIndex
 = 
MAX_V4L_BUFFERS
;

1138 
ˇ±uª
->
buf„rIndex
 = 
buf
.
ödex
;

1141 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QBUF
, &
buf
))

1142 
	`≥º‹
 ("VIDIOC_QBUF");

1146 
ˇ±uª
->
time°amp
 = 
buf
.timestamp;

1147 
ˇ±uª
->
£quí˚
 = 
buf
.sequence;

1150 
	}
}

1152 
	$maölo›_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1153 
cou¡
;

1155 
cou¡
 = 1;

1157 
cou¡
-- > 0) {

1159 
fd_£t
 
fds
;

1160 
timevÆ
 
tv
;

1161 
r
;

1163 
	`FD_ZERO
 (&
fds
);

1164 
	`FD_SET
 (
ˇ±uª
->
devi˚H™dÀ
, &
fds
);

1167 
tv
.
tv_£c
 = 10;

1168 
tv
.
tv_u£c
 = 0;

1170 
r
 = 
	`£À˘
 (
ˇ±uª
->
devi˚H™dÀ
+1, &
fds
, 
NULL
, NULL, &
tv
);

1172 i‡(-1 =
r
) {

1173 i‡(
EINTR
 =
î∫o
)

1176 
	`≥º‹
 ("select");

1179 i‡(0 =
r
) {

1180 
	`Ârötf
 (
°dîr
, "selectÅimeout\n");

1186 i‡(
	`ªad_‰ame_v4l2
 (
ˇ±uª
))

1190 
	}
}

1192 
	$icvGøbFømeCAM_V4L
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1194 i‡(
ˇ±uª
->
Fú°C≠tuª
) {

1200 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 1)

1203 
ˇ±uª
->
buf„rIndex
 = 0;

1204 
ˇ±uª
->
buf„rIndex
 < (()ˇ±uª->
ªq
.
cou¡
);

1205 ++
ˇ±uª
->
buf„rIndex
)

1208 
v4l2_buf„r
 
buf
;

1210 
	`CLEAR
 (
buf
);

1212 
buf
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1213 
buf
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

1214 
buf
.
ödex
 = ()
ˇ±uª
->
buf„rIndex
;

1216 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QBUF
, &
buf
)) {

1217 
	`≥º‹
 ("VIDIOC_QBUF");

1223 
ˇ±uª
->
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1224 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_STREAMON
,

1225 &
ˇ±uª
->
ty≥
)) {

1227 
	`≥º‹
 ("VIDIOC_STREAMON");

1233 
ˇ±uª
->
buf„rIndex
 = 0;

1234 
ˇ±uª
->
buf„rIndex
 < (ˇ±uª->
mem‹yBuf„r
.
‰ames
-1);

1235 ++
ˇ±uª
->
buf„rIndex
) {

1237 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
‰ame
 = capture->bufferIndex;

1238 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
width
 = c≠tuª->
ˇ±uªWödow
.width;

1239 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
height
 = c≠tuª->
ˇ±uªWödow
.height;

1240 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
f‹m©
 = c≠tuª->
imagePr›îtõs
.
∑Àâe
;

1242 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCMCAPTURE
, &ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
]) == -1) {

1243 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: Initial Capture Error: UnableÅoÜoad initial memory buffers.\n");

1251 
ˇ±uª
->
Fú°C≠tuª
 = 0;

1254 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 1)

1257 
	`maölo›_v4l2
(
ˇ±uª
);

1262 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
‰ame
 = capture->bufferIndex;

1263 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
width
 = c≠tuª->
ˇ±uªWödow
.width;

1264 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
height
 = c≠tuª->
ˇ±uªWödow
.height;

1265 
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
f‹m©
 = c≠tuª->
imagePr›îtõs
.
∑Àâe
;

1267 i‡(
	`v4l1_io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCMCAPTURE
,

1268 &
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
]) == -1) {

1273 ++
ˇ±uª
->
buf„rIndex
;

1274 i‡(
ˇ±uª
->
buf„rIndex
 =ˇ±uª->
mem‹yBuf„r
.
‰ames
) {

1275 
ˇ±uª
->
buf„rIndex
 = 0;

1281 
	}
}

1283 
I∂Image
* 
	$icvRërõveFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, ) {

1285 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 0)

1289 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSYNC
, &ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
].
‰ame
) == -1) {

1290 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇŸ SYNCÅÿvideÿ°ªam. %s\n", 
	`°ªº‹
(
î∫o
));

1299 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 1)

1302 if((()
ˇ±uª
->
‰ame
.
width
 !ˇ±uª->
f‹m
.
fmt
.
pix
.width)

1303 || (()
ˇ±uª
->
‰ame
.
height
 !ˇ±uª->
f‹m
.
fmt
.
pix
.height)) {

1304 
	`cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

1305 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

1306 
	`cvSize
–
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

1307 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 ),

1308 
IPL_DEPTH_8U
, 
	`ch™√ls_f‹_mode
(
ˇ±uª
->
mode
),

1309 
IPL_ORIGIN_TL
, 4 );

1310 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

1316 if((
ˇ±uª
->
‰ame
.
width
 !ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
].width)

1317 || (
ˇ±uª
->
‰ame
.
height
 !ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
].height)) {

1318 
	`cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

1319 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

1320 
	`cvSize
–
ˇ±uª
->
ˇ±uªWödow
.
width
,

1321 
ˇ±uª
->
ˇ±uªWödow
.
height
 ),

1322 
IPL_DEPTH_8U
, 
	`ch™√ls_f‹_mode
(
ˇ±uª
->
mode
),

1323 
IPL_ORIGIN_TL
, 4 );

1324 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

1329 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 1)

1332 if(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
){

1333 
	`mem˝y
((*)
ˇ±uª
->
‰ame
.
imageD©a
,

1334 (*)
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
,

1335 
ˇ±uª
->
‰ame
.
imageSize
);

1342 
ˇ±uª
->
imagePr›îtõs
.
∑Àâe
) {

1343 
VIDEO_PALETTE_RGB24
:

1344 
VIDEO_PALETTE_YUV420
:

1345 
VIDEO_PALETTE_YUYV
:

1346 
	`mem˝y
((*)
ˇ±uª
->
‰ame
.
imageD©a
,

1347 (*)(
ˇ±uª
->
mem‹yM≠
 + c≠tuª->
mem‹yBuf„r
.
off£ts
[ˇ±uª->
buf„rIndex
]),

1348 
ˇ±uª
->
‰ame
.
imageSize
);

1351 
	`Ârötf
–
°dîr
,

1353 
ˇ±uª
->
imagePr›îtõs
.
∑Àâe
,

1354 
ˇ±uª
->
mode
);

1360 (&
ˇ±uª
->
‰ame
);

1361 
	}
}

1364 
	$icvGëPr›îtyCAM_V4L
 (
CvC≠tuªCAM_V4L
* 
ˇ±uª
,

1365 
¥›îty_id
 ) {

1366 
«me
[32];

1367 
is_v4l2_devi˚
 = 0;

1369 
¥›îty_id
) {

1370 
CV_CAP_PROP_FRAME_WIDTH
:

1371 
CV_CAP_PROP_FRAME_HEIGHT
:

1372 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

1373 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1374 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
)) {

1376 
	`≥º‹
 ("VIDIOC_G_FMT");

1377 i‡(
	`v4l1_io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGWIN
, &ˇ±uª->
ˇ±uªWödow
) < 0) {

1378 
	`Ârötf
 (
°dîr
, " ERROR: V4L: UnableÅo determine size of incoming image\n");

1379 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1382 
ªtvÆ
 = (
¥›îty_id
 =
CV_CAP_PROP_FRAME_WIDTH
)?
ˇ±uª
->
ˇ±uªWödow
.
width
:ˇ±uª->ˇ±uªWödow.
height
;

1383  
ªtvÆ
 / 0xFFFF;

1386  (
¥›îty_id
 =
CV_CAP_PROP_FRAME_WIDTH
)?
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
:ˇ±uª->f‹m.fmt.pix.
height
;

1388 
CV_CAP_PROP_POS_MSEC
:

1389 i‡(
ˇ±uª
->
Fú°C≠tuª
) {

1393  1000 * 
ˇ±uª
->
time°amp
.
tv_£c
 + ((Ëˇ±uª->time°amp.
tv_u£c
) / 1000;

1397 
CV_CAP_PROP_POS_FRAMES
:

1398  
ˇ±uª
->
£quí˚
;

1401 
CV_CAP_PROP_FPS
: {

1402 
v4l2_°ªam∑rm
 
•
;

1403 
	`mem£t
 (&
•
, 0, (
v4l2_°ªam∑rm
));

1404 
•
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1405 i‡(
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_PARM
, &
•
) < 0){

1406 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: UnableÅo get camera FPS\n");

1411 
‰amesPîSec
 = 
•
.
∑rm
.
ˇ±uª
.
timïî‰ame
.
díomö©‹
 / (Ë•.∑rm.ˇ±uª.timïî‰ame.
numî©‹
 ;

1412  
‰amesPîSec
;

1417 
CV_CAP_PROP_MODE
:

1418  
ˇ±uª
->
mode
;

1420 
CV_CAP_PROP_BRIGHTNESS
:

1421 
	`•rötf
(
«me
, "Brightness");

1422 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_BRIGHTNESS
;

1424 
CV_CAP_PROP_CONTRAST
:

1425 
	`•rötf
(
«me
, "Contrast");

1426 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_CONTRAST
;

1428 
CV_CAP_PROP_SATURATION
:

1429 
	`•rötf
(
«me
, "Saturation");

1430 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_SATURATION
;

1432 
CV_CAP_PROP_HUE
:

1433 
	`•rötf
(
«me
, "Hue");

1434 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_HUE
;

1436 
CV_CAP_PROP_GAIN
:

1437 
	`•rötf
(
«me
, "Gain");

1438 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_GAIN
;

1440 
CV_CAP_PROP_EXPOSURE
:

1441 
	`•rötf
(
«me
, "Exposure");

1442 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_EXPOSURE
;

1445 
	`•rötf
(
«me
, "<unknownÖroperty string>");

1446 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
¥›îty_id
;

1449 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
, &ˇ±uª->
c⁄åﬁ
) == 0) {

1451 
is_v4l2_devi˚
 = 1;

1453 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L2: U«bÀÅÿgëÖr›îty %s(%uË- %s\n", 
«me
, 
ˇ±uª
->
c⁄åﬁ
.
id
, 
	`°ªº‹
(
î∫o
));

1456 i‡(
is_v4l2_devi˚
 == 1) {

1458 
v4l2_mö
 = 
	`v4l2_gë_˘æ_mö
(
ˇ±uª
, c≠tuª->
c⁄åﬁ
.
id
);

1459 
v4l2_max
 = 
	`v4l2_gë_˘æ_max
(
ˇ±uª
, c≠tuª->
c⁄åﬁ
.
id
);

1461 i‡((
v4l2_mö
 =-1Ë&& (
v4l2_max
 == -1)) {

1462 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L2: Pr›îty %s(%uËnŸ suµ‹ãd by devi˚\n", 
«me
, 
¥›îty_id
);

1467  (()
ˇ±uª
->
c⁄åﬁ
.
vÆue
 - 
v4l2_mö
Ë/ (
v4l2_max
 - v4l2_min);

1471 
ªtvÆ
 = -1;

1473 
¥›îty_id
) {

1474 
CV_CAP_PROP_BRIGHTNESS
:

1475 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
brighäess
;

1477 
CV_CAP_PROP_CONTRAST
:

1478 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
c⁄åa°
;

1480 
CV_CAP_PROP_SATURATION
:

1481 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
cﬁour
;

1483 
CV_CAP_PROP_HUE
:

1484 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
hue
;

1486 
CV_CAP_PROP_GAIN
:

1487 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Gain control in V4L isÇot supported\n");

1490 
CV_CAP_PROP_EXPOSURE
:

1491 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Exposure control in V4L isÇot supported\n");

1496 i‡(
ªtvÆ
 == -1) {

1501  (
ªtvÆ
) / 0xFFFF;

1503 
	}
}

1505 
	$icvSëVideoSize
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
w
, 
h
) {

1507 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 1)

1509 
devi˚Name
[
MAX_DEVICE_DRIVER_NAME
];

1510 
	`•rötf
(
devi˚Name
, "%s", 
ˇ±uª
->deviceName);

1511 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1512 
	`_ˇ±uª_V4L2
(
ˇ±uª
, 
devi˚Name
);

1514 
¸›Height
;

1515 
¸›Width
;

1516 
ˇ±uª
->
mode
) {

1517 
CV_CAP_MODE_GRAY
:

1518 
¸›Height
 = 
h
*8;

1519 
¸›Width
 = 
w
*8;

1521 
CV_CAP_MODE_YUYV
:

1522 
¸›Height
 = 
h
*16;

1523 
¸›Width
 = 
w
*16;

1526 
¸›Height
 = 
h
*24;

1527 
¸›Width
 = 
w
*24;

1530 
	`CLEAR
 (
ˇ±uª
->
¸›
);

1531 
ˇ±uª
->
¸›
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1532 
ˇ±uª
->
¸›
.
c
.
À·
 = 0;

1533 
ˇ±uª
->
¸›
.
c
.
t›
 = 0;

1534 
ˇ±uª
->
¸›
.
c
.
height
 = 
¸›Height
;

1535 
ˇ±uª
->
¸›
.
c
.
width
 = 
¸›Width
;

1538 
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_CROP
, &ˇ±uª->
¸›
);

1540 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

1541 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1544 
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
);

1547 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
 = 
w
;

1548 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 = 
h
;

1549 
ˇ±uª
->
f‹m
.
fmt
.
wö
.
chromakey
 = 0;

1550 
ˇ±uª
->
f‹m
.
fmt
.
wö
.
fõld
 = 
V4L2_FIELD_ANY
;

1551 
ˇ±uª
->
f‹m
.
fmt
.
wö
.
˛ùs
 = 0;

1552 
ˇ±uª
->
f‹m
.
fmt
.
wö
.
˛ùcou¡
 = 0;

1553 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
fõld
 = 
V4L2_FIELD_ANY
;

1559 
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_FMT
, &ˇ±uª->
f‹m
);

1563 
v4l2_°ªam∑rm
 
£tÂs
;

1564 
	`mem£t
 (&
£tÂs
, 0, (
v4l2_°ªam∑rm
));

1566 
£tÂs
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1567 
£tÂs
.
∑rm
.
ˇ±uª
.
timïî‰ame
.
numî©‹
 = 1;

1568 
£tÂs
.
∑rm
.
ˇ±uª
.
timïî‰ame
.
díomö©‹
 = 30;

1570 
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_PARM
, &
£tÂs
);

1575 
ˇ±uª
->
Fú°C≠tuª
 = 1;

1578 i‡(-1 =
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
))

1580 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L/V4L2: CouldÇot obtain specifics of capture window.\n\n");

1582 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1592 i‡(
ˇ±uª
==0)  0;

1593 i‡(
w
>
ˇ±uª
->
ˇ∑bûôy
.
maxwidth
) {

1594 
w
=
ˇ±uª
->
ˇ∑bûôy
.
maxwidth
;

1596 i‡(
h
>
ˇ±uª
->
ˇ∑bûôy
.
maxheight
) {

1597 
h
=
ˇ±uª
->
ˇ∑bûôy
.
maxheight
;

1600 
ˇ±uª
->
ˇ±uªWödow
.
width
=
w
;

1601 
ˇ±uª
->
ˇ±uªWödow
.
height
=
h
;

1603 i‡(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSWIN
, &ˇ±uª->
ˇ±uªWödow
) < 0) {

1604 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1608 i‡(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGWIN
, &ˇ±uª->
ˇ±uªWödow
) < 0) {

1609 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1613 
ˇ±uª
->
Fú°C≠tuª
 = 1;

1619 
	}
}

1621 
	$icvSëC⁄åﬁ
 (
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
) {

1622 
v4l2_c⁄åﬁ
 
c
;

1623 
__s32
 
˘æ_vÆue
;

1624 
«me
[32];

1625 
is_v4l2
 = 1;

1626 
v4l2_mö
 = 0;

1627 
v4l2_max
 = 255;

1628 i‡(
ˇ±uª
->
v4l2_˘æ_ønges
 =
NULL
) {

1629 
	`v4l2_sˇn_c⁄åﬁs
(
ˇ±uª
);

1632 
	`CLEAR
 (
ˇ±uª
->
c⁄åﬁ
);

1633 
	`CLEAR
 (
ˇ±uª
->
quîy˘æ
);

1636 
¥›îty_id
) {

1637 
CV_CAP_PROP_BRIGHTNESS
:

1638 
	`•rötf
(
«me
, "Brightness");

1639 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_BRIGHTNESS
;

1641 
CV_CAP_PROP_CONTRAST
:

1642 
	`•rötf
(
«me
, "Contrast");

1643 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_CONTRAST
;

1645 
CV_CAP_PROP_SATURATION
:

1646 
	`•rötf
(
«me
, "Saturation");

1647 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_SATURATION
;

1649 
CV_CAP_PROP_HUE
:

1650 
	`•rötf
(
«me
, "Hue");

1651 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_HUE
;

1653 
CV_CAP_PROP_GAIN
:

1654 
	`•rötf
(
«me
, "Gain");

1655 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_GAIN
;

1657 
CV_CAP_PROP_EXPOSURE
:

1658 
	`•rötf
(
«me
, "Exposure");

1659 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_EXPOSURE
;

1662 
	`•rötf
(
«me
, "<unknownÖroperty string>");

1663 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
¥›îty_id
;

1666 
v4l2_mö
 = 
	`v4l2_gë_˘æ_mö
(
ˇ±uª
, c≠tuª->
c⁄åﬁ
.
id
);

1667 
v4l2_max
 = 
	`v4l2_gë_˘æ_max
(
ˇ±uª
, c≠tuª->
c⁄åﬁ
.
id
);

1669 i‡((
v4l2_mö
 =-1Ë&& (
v4l2_max
 == -1)) {

1670 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Pr›îty %s(%uËnŸ suµ‹ãd by devi˚\n", 
«me
, 
¥›îty_id
);

1674 if(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
, &ˇ±uª->
c⁄åﬁ
) == 0) {

1677 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L2: U«bÀÅÿgëÖr›îty %s(%uË- %s\n", 
«me
, 
ˇ±uª
->
c⁄åﬁ
.
id
, 
	`°ªº‹
(
î∫o
));

1680 i‡(
v4l2_max
 != 0) {

1681 
vÆ
 = 
vÆue
;

1682 i‡(
vÆue
 < 0.0) {

1683 
vÆ
 = 0.0;

1684 } i‡(
vÆue
 > 1.0) {

1685 
vÆ
 = 1.0;

1687 
˘æ_vÆue
 = 
vÆ
 * ()(
v4l2_max
 - 
v4l2_mö
) + v4l2_min;

1689 
˘æ_vÆue
 = 
	`v4l2_gë_˘æ_deÁu…
(
ˇ±uª
, c≠tuª->
c⁄åﬁ
.
id
Ë* ()(
v4l2_max
 - 
v4l2_mö
) + v4l2_min;

1693 
c
.
id
 = 
ˇ±uª
->
c⁄åﬁ
.id;

1694 
c
.
vÆue
 = 
˘æ_vÆue
;

1695 i‡(
	`v4l2_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_CTRL
, &
c
) != 0) {

1697 i‡(
î∫o
 !
ERANGE
) {

1698 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L2: FaûedÅÿ£àc⁄åﬁ \"%d\": %†(vÆuê%d)\n", 
c
.
id
, 
	`°ªº‹
(
î∫o
), c.
vÆue
);

1699 
is_v4l2
 = 0;

1707 i‡(
is_v4l2
 == 0) {

1708 
	`Ârötf
(
°dîr
, "VIDEOIO WARNING: SëtögÖr›îty %uÅhrough v4l2 faûed. Tryög wôh v4l1.\n", 
c
.
id
);

1709 
v4l_vÆue
;

1711 
v4l_vÆue
 = ()(0xFFFF * 
vÆue
);

1713 
¥›îty_id
) {

1714 
CV_CAP_PROP_BRIGHTNESS
:

1715 
ˇ±uª
->
imagePr›îtõs
.
brighäess
 = 
v4l_vÆue
;

1717 
CV_CAP_PROP_CONTRAST
:

1718 
ˇ±uª
->
imagePr›îtõs
.
c⁄åa°
 = 
v4l_vÆue
;

1720 
CV_CAP_PROP_SATURATION
:

1721 
ˇ±uª
->
imagePr›îtõs
.
cﬁour
 = 
v4l_vÆue
;

1723 
CV_CAP_PROP_HUE
:

1724 
ˇ±uª
->
imagePr›îtõs
.
hue
 = 
v4l_vÆue
;

1726 
CV_CAP_PROP_GAIN
:

1727 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Gain control in V4L isÇot supported\n");

1729 
CV_CAP_PROP_EXPOSURE
:

1730 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Exposure control in V4L isÇot supported\n");

1733 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L:Ör›îty #%d i†nŸ suµ‹ãd\n", 
¥›îty_id
);

1737 i‡(
	`v4l1_io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSPICT
, &ˇ±uª->
imagePr›îtõs
) < 0){

1738 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: UnableÅo set video informations\n");

1739 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1746 
	}
}

1748 
	$icvSëPr›îtyCAM_V4L
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
){

1749 
width
 = 0, 
height
 = 0;

1750 
ªtvÆ
;

1753 
ªtvÆ
 = 0;

1759 
¥›îty_id
) {

1760 
CV_CAP_PROP_FRAME_WIDTH
:

1761 
width
 = 
	`cvRound
(
vÆue
);

1762 
ˇ±uª
->
width
 = width;

1763 if(
width
 !=0 && 
height
 != 0) {

1764 
ªtvÆ
 = 
	`icvSëVideoSize
–
ˇ±uª
, 
width
, 
height
);

1765 
width
 = 
height
 = 0;

1768 
CV_CAP_PROP_FRAME_HEIGHT
:

1769 
height
 = 
	`cvRound
(
vÆue
);

1770 
ˇ±uª
->
height
 = height;

1771 if(
width
 !=0 && 
height
 != 0) {

1772 
ªtvÆ
 = 
	`icvSëVideoSize
–
ˇ±uª
, 
width
, 
height
);

1773 
width
 = 
height
 = 0;

1776 
CV_CAP_PROP_MODE
:

1777 
mode
;

1778 
mode
 = 
	`cvRound
(
vÆue
);

1779 i‡(
ˇ±uª
->
mode
 != mode) {

1780 
mode
) {

1781 
CV_CAP_MODE_BGR
:

1782 
CV_CAP_MODE_RGB
:

1783 
CV_CAP_MODE_GRAY
:

1784 
CV_CAP_MODE_YUYV
:

1785 
ˇ±uª
->
mode
 = mode;

1788 
ªtvÆ
 = 
	`icvSëVideoSize
(
ˇ±uª
, c≠tuª->
width
, c≠tuª->
height
);

1791 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L/V4L2: Unsuµ‹ãd mode: %d\n", 
mode
);

1792 
ªtvÆ
=0;

1797 
CV_CAP_PROP_FPS
:

1798 
v4l2_°ªam∑rm
 
£tÂs
;

1799 
	`mem£t
 (&
£tÂs
, 0, (
v4l2_°ªam∑rm
));

1800 
£tÂs
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1801 
£tÂs
.
∑rm
.
ˇ±uª
.
timïî‰ame
.
numî©‹
 = 1;

1802 
£tÂs
.
∑rm
.
ˇ±uª
.
timïî‰ame
.
díomö©‹
 = 
vÆue
;

1803 i‡(
	`xio˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_PARM
, &
£tÂs
) < 0){

1804 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: UnableÅo set camera FPS\n");

1805 
ªtvÆ
=0;

1809 
ªtvÆ
 = 
	`icvSëC⁄åﬁ
(
ˇ±uª
, 
¥›îty_id
, 
vÆue
);

1813  
ªtvÆ
;

1814 
	}
}

1816 
	$icvClo£CAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 ){

1818 i‡(
ˇ±uª
) {

1819 
	`v4l2_‰ì_ønges
(
ˇ±uª
);

1820 i‡(
ˇ±uª
->
is_v4l2_devi˚
 == 0) {

1821 i‡(
ˇ±uª
->
mm≠s
) {

1822 
	`‰ì
(
ˇ±uª
->
mm≠s
);

1824 i‡(
ˇ±uª
->
mem‹yM≠
) {

1825 
	`v4l1_munm≠
(
ˇ±uª
->
mem‹yM≠
, c≠tuª->
mem‹yBuf„r
.
size
);

1827 i‡(
ˇ±uª
->
devi˚H™dÀ
 != -1) {

1828 
	`v4l1_˛o£
(
ˇ±uª
->
devi˚H™dÀ
);

1831 
ˇ±uª
->
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1832 i‡(
	`xio˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_STREAMOFF
, &ˇ±uª->
ty≥
) < 0) {

1833 
	`≥º‹
 ("UnableÅo stopÅhe stream.");

1835 
n_buf„rs2
 = 0;Ç_buf„rs2 < 
ˇ±uª
->
ªq
.
cou¡
; ++n_buffers2) {

1836 i‡(-1 =
	`v4l2_munm≠
 (
ˇ±uª
->
buf„rs
[
n_buf„rs2
].
°¨t
, c≠tuª->buf„rs[n_buf„rs2].
Àngth
)) {

1837 
	`≥º‹
 ("munmap");

1841 i‡(
ˇ±uª
->
devi˚H™dÀ
 != -1) {

1842 
	`v4l2_˛o£
(
ˇ±uª
->
devi˚H™dÀ
);

1846 i‡(
ˇ±uª
->
‰ame
.
imageD©a
)

1847 
	`cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

1849 #ifde‡
USE_TEMP_BUFFER


1850 i‡(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
) {

1851 
	`‰ì
(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
);

1852 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
 = 
NULL
;

1856 
	`‰ì
(
ˇ±uª
->
devi˚Name
);

1857 
ˇ±uª
->
devi˚Name
 = 
NULL
;

1861 
	}
};

1864 ˛as†
	cCvC≠tuªCAM_V4L_CPP
 : 
CvC≠tuª


1866 
public
:

1867 
	$CvC≠tuªCAM_V4L_CPP
(Ë{ 
ˇ±uªV4L
 = 0; }

1868 
vútuÆ
 ~
	$CvC≠tuªCAM_V4L_CPP
(Ë{ 
	`˛o£
(); 
	}
}

1870 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

1871 
vútuÆ
 
˛o£
();

1873 
vútuÆ
 
	$gëPr›îty
() const;

1874 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

1875 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

1876 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

1877 
¥Ÿe˘ed
:

1879 
CvC≠tuªCAM_V4L
* 
ˇ±uªV4L
;

1880 
	}
};

1882 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$›í
–
ödex
 )

1884 
	`˛o£
();

1885 
ˇ±uªV4L
 = 
	`icvC≠tuªFromCAM_V4L
(
ödex
);

1886  
ˇ±uªV4L
 != 0;

1887 
	}
}

1889 
	gCvC≠tuªCAM_V4L_CPP
::
	$˛o£
()

1891 if–
ˇ±uªV4L
 )

1893 
	`icvClo£CAM_V4L
–
ˇ±uªV4L
 );

1894 
	`cvFªe
–&
ˇ±uªV4L
 );

1896 
	}
}

1898 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$gøbFøme
()

1900  
ˇ±uªV4L
 ? 
	`icvGøbFømeCAM_V4L
–ˇ±uªV4L ) !0 : 
Ál£
;

1901 
	}
}

1903 
I∂Image
* 
	gCvC≠tuªCAM_V4L_CPP
::
	$ªåõveFøme
()

1905  
ˇ±uªV4L
 ? 
	`icvRërõveFømeCAM_V4L
( captureV4L, 0 ) : 0;

1906 
	}
}

1908 
	gCvC≠tuªCAM_V4L_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

1910  
ˇ±uªV4L
 ? 
	`icvGëPr›îtyCAM_V4L
–ˇ±uªV4L, 
¥›Id
 ) : 0.0;

1911 
	}
}

1913 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

1915  
ˇ±uªV4L
 ? 
	`icvSëPr›îtyCAM_V4L
–ˇ±uªV4L, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

1916 
	}
}

1918 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_V4L
–
ödex
 )

1920 
CvC≠tuªCAM_V4L_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_V4L_CPP;

1922 if–
ˇ±uª
->
	`›í
–
ödex
 ))

1923  (
CvC≠tuª
*)
ˇ±uª
;

1925 
dñëe
 
ˇ±uª
;

1927 
	}
}

	@src/cap_mjpeg_decoder.cpp

42 
	~"¥ecomp.hµ
"

43 
	~<deque
>

44 
	~<°döt.h
>

46 
«me•a˚
 
	gcv


49 c⁄° 
uöt32_t
 
	gRIFF_CC
 = 
CV_FOURCC
('R','I','F','F');

50 c⁄° 
uöt32_t
 
	gLIST_CC
 = 
CV_FOURCC
('L','I','S','T');

51 c⁄° 
uöt32_t
 
	gHDRL_CC
 = 
CV_FOURCC
('h','d','r','l');

52 c⁄° 
uöt32_t
 
	gAVIH_CC
 = 
CV_FOURCC
('a','v','i','h');

53 c⁄° 
uöt32_t
 
	gSTRL_CC
 = 
CV_FOURCC
('s','t','r','l');

54 c⁄° 
uöt32_t
 
	gSTRH_CC
 = 
CV_FOURCC
('s','t','r','h');

55 c⁄° 
uöt32_t
 
	gVIDS_CC
 = 
CV_FOURCC
('v','i','d','s');

56 c⁄° 
uöt32_t
 
	gMJPG_CC
 = 
CV_FOURCC
('M','J','P','G');

57 c⁄° 
uöt32_t
 
	gMOVI_CC
 = 
CV_FOURCC
('m','o','v','i');

58 c⁄° 
uöt32_t
 
	gIDX1_CC
 = 
CV_FOURCC
('i','d','x','1');

59 c⁄° 
uöt32_t
 
	gAVI_CC
 = 
CV_FOURCC
('A','V','I',' ');

60 c⁄° 
uöt32_t
 
	gAVIX_CC
 = 
CV_FOURCC
('A','V','I','X');

61 c⁄° 
uöt32_t
 
	gJUNK_CC
 = 
CV_FOURCC
('J','U','N','K');

62 c⁄° 
uöt32_t
 
	gINFO_CC
 = 
CV_FOURCC
('I','N','F','O');

64 
Såög
 
fourccToSåög
(
uöt32_t
 
fourcc
);

66 
Såög
 
fourccToSåög
(
uöt32_t
 
fourcc
)

68  
f‹m©
("%c%c%c%c", 
fourcc
 & 255, (fourcc >> 8) & 255, (fourcc >> 16) & 255, (fourcc >> 24) & 255);

71 #i‚de‡
DWORD


72 
uöt32_t
 
	tDWORD
;

74 #i‚de‡
WORD


75 
uöt16_t
 
	tWORD
;

77 #i‚de‡
LONG


78 
öt32_t
 
	tLONG
;

81 #¥agm®
∑ck
(
push
, 1)

82 
	sAviMaöHódî


84 
DWORD
 
	gdwMi¸oSecPîFøme
;

85 
DWORD
 
	gdwMaxByãsPîSec
;

86 
DWORD
 
	gdwRe£rved1
;

87 
DWORD
 
	gdwFœgs
;

88 
DWORD
 
	gdwTŸÆFømes
;

89 
DWORD
 
	gdwInôülFømes
;

90 
DWORD
 
	gdwSåóms
;

91 
DWORD
 
	gdwSugge°edBuf„rSize
;

92 
DWORD
 
	gdwWidth
;

93 
DWORD
 
	gdwHeight
;

94 
DWORD
 
	gdwRe£rved
[4];

97 
	sAviSåómHódî


99 
uöt32_t
 
	gfccTy≥
;

100 
uöt32_t
 
	gfccH™dÀr
;

101 
DWORD
 
	gdwFœgs
;

102 
DWORD
 
	gdwPri‹ôy
;

103 
DWORD
 
	gdwInôülFømes
;

104 
DWORD
 
	gdwSˇÀ
;

105 
DWORD
 
	gdwR©e
;

106 
DWORD
 
	gdwSèπ
;

107 
DWORD
 
	gdwLígth
;

108 
DWORD
 
	gdwSugge°edBuf„rSize
;

109 
DWORD
 
	gdwQuÆôy
;

110 
DWORD
 
	gdwSam∂eSize
;

112 
	gÀ·
;

113 
	gt›
;

114 
	gright
;

115 
	gbŸtom
;

116 } 
	grcFøme
;

119 
	sAviIndex


121 
DWORD
 
	gckid
;

122 
DWORD
 
	gdwFœgs
;

123 
DWORD
 
	gdwChunkOff£t
;

124 
DWORD
 
	gdwChunkLígth
;

127 
	sBôm≠InfoHódî


129 
DWORD
 
	gbiSize
;

130 
LONG
 
	gbiWidth
;

131 
LONG
 
	gbiHeight
;

132 
WORD
 
	gbiPœ√s
;

133 
WORD
 
	gbiBôCou¡
;

134 
DWORD
 
	gbiCom¥essi⁄
;

135 
DWORD
 
	gbiSizeImage
;

137 
LONG
 
	gbiXPñsPîMëî
;

138 
LONG
 
	gbiYPñsPîMëî
;

139 
DWORD
 
	gbiCÃU£d
;

140 
DWORD
 
	gbiCÃImp‹è¡
;

143 
	sRiffChunk


145 
uöt32_t
 
	gm_four_cc
;

146 
uöt32_t
 
	gm_size
;

149 
	sRiffLi°


151 
uöt32_t
 
	gm_riff_‹_li°_cc
;

152 
uöt32_t
 
	gm_size
;

153 
uöt32_t
 
	gm_li°_ty≥_cc
;

156 #¥agm®
∑ck
(
p›
)

158 ˛as†
	cMj≥gI≈utSåóm


160 
	gpublic
:

161 
Mj≥gI≈utSåóm
();

162 
Mj≥gI≈utSåóm
(c⁄° 
Såög
& 
fûíame
);

163 ~
Mj≥gI≈utSåóm
();

164 
	gMj≥gI≈utSåóm
& 
ªad
(*, 
uöt64_t
);

165 
	gMj≥gI≈utSåóm
& 
£ekg
(
uöt64_t
);

166 
uöt64_t
 
ãŒg
();

167 
boﬁ
 
isO≥√d
() const;

168 
boﬁ
 
›í
(c⁄° 
Såög
& 
fûíame
);

169 
˛o£
();

170 
›î©‹
 
boﬁ
();

172 
	g¥iv©e
:

173 
boﬁ
 
m_is_vÆid
;

174 
FILE
* 
	gm_f
;

177 
	gMj≥gI≈utSåóm
::
	$Mj≥gI≈utSåóm
(): 
	`m_is_vÆid
(
Ál£
), 
	$m_f
(0)

179 
	}
}

181 
	gMj≥gI≈utSåóm
::
	$Mj≥gI≈utSåóm
(c⁄° 
Såög
& 
fûíame
): 
	`m_is_vÆid
(
Ál£
), 
	$m_f
(0)

183 
	`›í
(
fûíame
);

184 
	}
}

186 
boﬁ
 
	gMj≥gI≈utSåóm
::
	$isO≥√d
() const

188  
m_f
 != 0;

189 
	}
}

191 
boﬁ
 
	gMj≥gI≈utSåóm
::
	$›í
(c⁄° 
Såög
& 
fûíame
)

193 
	`˛o£
();

195 
m_f
 = 
	`f›í
(
fûíame
.
	`c_°r
(), "rb");

197 
m_is_vÆid
 = 
	`isO≥√d
();

199  
m_is_vÆid
;

200 
	}
}

202 
	gMj≥gI≈utSåóm
::
	$˛o£
()

204 if(
	`isO≥√d
())

206 
m_is_vÆid
 = 
Ál£
;

208 
	`f˛o£
(
m_f
);

209 
m_f
 = 0;

211 
	}
}

213 
	gMj≥gI≈utSåóm
& Mj≥gI≈utSåóm::
	$ªad
(* 
buf
, 
uöt64_t
 
cou¡
)

215 if(
	`isO≥√d
())

217 
m_is_vÆid
 = (
cou¡
 =
	`‰ód
((*)
buf
, 1, (
size_t
)cou¡, 
m_f
));

220  *
this
;

221 
	}
}

223 
	gMj≥gI≈utSåóm
& Mj≥gI≈utSåóm::
	$£ekg
(
uöt64_t
 
pos
)

225 
m_is_vÆid
 = (
	`f£ek
(
m_f
, ()
pos
, 
SEEK_SET
) == 0);

227  *
this
;

228 
	}
}

230 
uöt64_t
 
	gMj≥gI≈utSåóm
::
	$ãŒg
()

232  
	`·ñl
(
m_f
);

233 
	}
}

235 
	gMj≥gI≈utSåóm
::
›î©‹
 
	$boﬁ
()

237  
m_is_vÆid
;

238 
	}
}

240 
	gMj≥gI≈utSåóm
::~
	$Mj≥gI≈utSåóm
()

242 
	`˛o£
();

243 
	}
}

245 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviMaöHódî
& 
	gavih
);

246 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviSåómHódî
& 
	g°rh
);

247 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gBôm≠InfoHódî
& 
	gbmph
);

248 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gRiffLi°
& 
	griff_li°
);

249 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gRiffChunk
& 
	griff_chunk
);

250 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviIndex
& 
	gidx1
);

252 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviMaöHódî
& 
	gavih
)

254 
	gis
.
ªad
((*)(&
avih
), (
AviMaöHódî
));

255  
	gis
;

258 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviSåómHódî
& 
	g°rh
)

260 
	gis
.
ªad
((*)(&
°rh
), (
AviSåómHódî
));

261  
	gis
;

264 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gBôm≠InfoHódî
& 
	gbmph
)

266 
	gis
.
ªad
((*)(&
bmph
), (
Bôm≠InfoHódî
));

267  
	gis
;

270 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gRiffLi°
& 
	griff_li°
)

272 
	gis
.
ªad
((*)(&
riff_li°
), (riff_list));

273  
	gis
;

276 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gRiffChunk
& 
	griff_chunk
)

278 
	gis
.
ªad
((*)(&
riff_chunk
), (riff_chunk));

279  
	gis
;

282 
	gMj≥gI≈utSåóm
& 
	g›î©‹
 >> (Mj≥gI≈utSåóm& 
	gis
, 
	gAviIndex
& 
	gidx1
)

284 
	gis
.
ªad
((*)(&
idx1
), (idx1));

285  
	gis
;

337 
	g°d
::
	tdeque
< 
	t°d
::
	t∑ú
<
	tuöt64_t
, 
	tuöt32_t
> > 
	t‰ame_li°
;

338 
	g‰ame_li°
::
	tôî©‹
 
	t‰ame_ôî©‹
;

343 ˛as†
	cAviMj≥gSåóm


345 
	gpublic
:

346 
AviMj≥gSåóm
();

348 
boﬁ
 
∑r£Avi
(
Mj≥gI≈utSåóm
& 
ö_°r
);

350 
boﬁ
 
∑r£Avi
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
‰ame_li°
& 
ö_‰ame_li°
);

351 
size_t
 
gëFømesCou¡
();

352 
	g‰ame_li°
& 
gëFømes
();

353 
uöt32_t
 
gëWidth
();

354 
uöt32_t
 
gëHeight
();

355 
gëFps
();

357 
	g¥Ÿe˘ed
:

359 
boﬁ
 
∑r£AviWôhFømeLi°
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
‰ame_li°
& 
ö_‰ame_li°
);

360 
skùJunk
(
RiffChunk
& 
chunk
, 
Mj≥gI≈utSåóm
& 
ö_°r
);

361 
skùJunk
(
RiffLi°
& 
li°
, 
Mj≥gI≈utSåóm
& 
ö_°r
);

362 
boﬁ
 
∑r£HdæLi°
(
Mj≥gI≈utSåóm
& 
ö_°r
);

363 
boﬁ
 
∑r£Index
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
uöt32_t
 
ödex_size
, 
‰ame_li°
& 
ö_‰ame_li°
);

364 
boﬁ
 
∑r£Movi
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
‰ame_li°
& 
ö_‰ame_li°
);

365 
boﬁ
 
∑r£Sål
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
uöt8_t
 
°ªam_id
);

366 
boﬁ
 
∑r£Info
(
Mj≥gI≈utSåóm
& 
ö_°r
);

367 
¥ötEº‹
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
RiffLi°
& 
li°
, 
uöt32_t
 
ex≥˘ed_fourcc
);

368 
¥ötEº‹
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
RiffChunk
& 
chunk
, 
uöt32_t
 
ex≥˘ed_fourcc
);

370 
uöt32_t
 
	gm_°ªam_id
;

371 
uöt64_t
 
	gm_movi_°¨t
;

372 
uöt64_t
 
	gm_movi_íd
;

373 
‰ame_li°
 
	gm_‰ame_li°
;

374 
uöt32_t
 
	gm_width
;

375 
uöt32_t
 
	gm_height
;

376 
	gm_Âs
;

377 
boﬁ
 
	gm_is_ödx_¥e£¡
;

380 
	gAviMj≥gSåóm
::
	$AviMj≥gSåóm
(): 
	`m_°ªam_id
(0), 
	`m_movi_°¨t
(0), 
	`m_movi_íd
(0), 
	`m_width
(0), 
	`m_height
(0), 
	`m_Âs
(0), 
	$m_is_ödx_¥e£¡
(
Ál£
)

382 
	}
}

384 
size_t
 
	gAviMj≥gSåóm
::
	$gëFømesCou¡
()

386  
m_‰ame_li°
.
	`size
();

387 
	}
}

389 
	g‰ame_li°
& 
	gAviMj≥gSåóm
::
	$gëFømes
()

391  
m_‰ame_li°
;

392 
	}
}

394 
uöt32_t
 
	gAviMj≥gSåóm
::
	$gëWidth
()

396  
m_width
;

397 
	}
}

399 
uöt32_t
 
	gAviMj≥gSåóm
::
	$gëHeight
()

401  
m_height
;

402 
	}
}

404 
	gAviMj≥gSåóm
::
	$gëFps
()

406  
m_Âs
;

407 
	}
}

409 
	gAviMj≥gSåóm
::
	$¥ötEº‹
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
RiffLi°
& 
li°
, 
uöt32_t
 
ex≥˘ed_fourcc
)

411 if(!
ö_°r
)

413 
	`Ârötf
(
°dîr
, "U√x≥˘edÉnd o‡fûêwhûê£¨chög f‹ %†li°\n", 
	`fourccToSåög
(
ex≥˘ed_fourcc
).
	`c_°r
());

415 if(
li°
.
m_riff_‹_li°_cc
 !
LIST_CC
)

417 
	`Ârötf
(
°dîr
, "U√x≥˘edÉÀmít. Ex≥˘ed: %s. GŸ: %s.\n", 
	`fourccToSåög
(
LIST_CC
).
	`c_°r
(), fourccToSåög(
li°
.
m_riff_‹_li°_cc
).c_str());

421 
	`Ârötf
(
°dîr
, "U√x≥˘edÜi°Åy≥. Ex≥˘ed: %s. GŸ: %s.\n", 
	`fourccToSåög
(
ex≥˘ed_fourcc
).
	`c_°r
(), fourccToSåög(
li°
.
m_li°_ty≥_cc
).c_str());

423 
	}
}

425 
	gAviMj≥gSåóm
::
	$¥ötEº‹
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
RiffChunk
& 
chunk
, 
uöt32_t
 
ex≥˘ed_fourcc
)

427 if(!
ö_°r
)

429 
	`Ârötf
(
°dîr
, "U√x≥˘edÉnd o‡fûêwhûê£¨chög f‹ %†chunk\n", 
	`fourccToSåög
(
ex≥˘ed_fourcc
).
	`c_°r
());

433 
	`Ârötf
(
°dîr
, "U√x≥˘edÉÀmít. Ex≥˘ed: %s. GŸ: %s.\n", 
	`fourccToSåög
(
ex≥˘ed_fourcc
).
	`c_°r
(), fourccToSåög(
chunk
.
m_four_cc
).c_str());

435 
	}
}

438 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Movi
(
Mj≥gI≈utSåóm
&, 
‰ame_li°
&)

441  
åue
;

442 
	}
}

444 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Info
(
Mj≥gI≈utSåóm
&)

447  
åue
;

448 
	}
}

450 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Index
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
uöt32_t
 
ödex_size
, 
‰ame_li°
& 
ö_‰ame_li°
)

452 
uöt64_t
 
ödex_íd
 = 
ö_°r
.
	`ãŒg
();

453 
ödex_íd
 +
ödex_size
;

454 
boﬁ
 
ªsu…
 = 
Ál£
;

456 
ö_°r
 && (ö_°r.
	`ãŒg
(Ë< 
ödex_íd
))

458 
AviIndex
 
idx1
;

459 
ö_°r
 >> 
idx1
;

461 if(
idx1
.
ckid
 =
m_°ªam_id
)

463 
uöt64_t
 
absﬁuã_pos
 = 
m_movi_°¨t
 + 
idx1
.
dwChunkOff£t
;

465 if(
absﬁuã_pos
 < 
m_movi_íd
)

467 
ö_‰ame_li°
.
	`push_back
(
°d
::
	`make_∑ú
(
absﬁuã_pos
, 
idx1
.
dwChunkLígth
));

472 
	`Ârötf
(
°dîr
, "Frame offsetÖoints outside movi section.\n");

476 
ªsu…
 = 
åue
;

479  
ªsu…
;

480 
	}
}

482 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Sål
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
uöt8_t
 
°ªam_id
)

484 
RiffChunk
 
°rh
;

485 
ö_°r
 >> 
°rh
;

487 if(
ö_°r
 && 
°rh
.
m_four_cc
 =
STRH_CC
)

489 
uöt64_t
 
√xt_°æ_li°
 = 
ö_°r
.
	`ãŒg
();

490 
√xt_°æ_li°
 +
°rh
.
m_size
;

492 
AviSåómHódî
 
°rm_hdr
;

493 
ö_°r
 >> 
°rm_hdr
;

495 if(
°rm_hdr
.
fccTy≥
 =
VIDS_CC
 && såm_hdr.
fccH™dÀr
 =
MJPG_CC
)

497 
uöt8_t
 
fú°_digô
 = (
°ªam_id
/10) + '0';

498 
uöt8_t
 
£c⁄d_digô
 = (
°ªam_id
%10) + '0';

500 if(
m_°ªam_id
 == 0)

502 
m_°ªam_id
 = 
	`CV_FOURCC
(
fú°_digô
, 
£c⁄d_digô
, 'd', 'c');

503 
m_Âs
 = (
°rm_hdr
.
dwR©e
)/°rm_hdr.
dwSˇÀ
;

508 
	`Ârötf
(
°dîr
, "M‹êth™ o√ videÿ°ªam found wôhö AVI/AVIXÜi°. Såóm %c%cd¯would bêign‹ed\n", 
fú°_digô
, 
£c⁄d_digô
);

511  
åue
;

515  
Ál£
;

516 
	}
}

518 
	gAviMj≥gSåóm
::
	$skùJunk
(
RiffChunk
& 
chunk
, 
Mj≥gI≈utSåóm
& 
ö_°r
)

520 if(
chunk
.
m_four_cc
 =
JUNK_CC
)

522 
ö_°r
.
	`£ekg
(ö_°r.
	`ãŒg
(Ë+ 
chunk
.
m_size
);

523 
ö_°r
 >> 
chunk
;

525 
	}
}

527 
	gAviMj≥gSåóm
::
	$skùJunk
(
RiffLi°
& 
li°
, 
Mj≥gI≈utSåóm
& 
ö_°r
)

529 if(
li°
.
m_riff_‹_li°_cc
 =
JUNK_CC
)

532 
ö_°r
.
	`£ekg
(ö_°r.
	`ãŒg
(Ë+ 
li°
.
m_size
 - 4);

533 
ö_°r
 >> 
li°
;

535 
	}
}

537 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£HdæLi°
(
Mj≥gI≈utSåóm
& 
ö_°r
)

539 
boﬁ
 
ªsu…
 = 
Ál£
;

541 
RiffChunk
 
avih
;

542 
ö_°r
 >> 
avih
;

544 if(
ö_°r
 && 
avih
.
m_four_cc
 =
AVIH_CC
)

546 
uöt64_t
 
√xt_°æ_li°
 = 
ö_°r
.
	`ãŒg
();

547 
√xt_°æ_li°
 +
avih
.
m_size
;

549 
AviMaöHódî
 
avi_hdr
;

550 
ö_°r
 >> 
avi_hdr
;

552 if(
ö_°r
)

554 
m_is_ödx_¥e£¡
 = ((
avi_hdr
.
dwFœgs
 & 0x10) != 0);

555 
DWORD
 
numbî_of_°ªams
 = 
avi_hdr
.
dwSåóms
;

556 
m_width
 = 
avi_hdr
.
dwWidth
;

557 
m_height
 = 
avi_hdr
.
dwWidth
;

560 
DWORD
 
i
 = 0; i < 
numbî_of_°ªams
; ++i)

562 
ö_°r
.
	`£ekg
(
√xt_°æ_li°
);

563 
RiffLi°
 
°æ_li°
;

564 
ö_°r
 >> 
°æ_li°
;

566 if–
ö_°r
 && 
°æ_li°
.
m_riff_‹_li°_cc
 =
LIST_CC
 && sål_li°.
m_li°_ty≥_cc
 =
STRL_CC
 )

568 
√xt_°æ_li°
 = 
ö_°r
.
	`ãŒg
();

570 
√xt_°æ_li°
 +(
°æ_li°
.
m_size
 - 4);

572 
ªsu…
 = 
	`∑r£Sål
(
ö_°r
, (
uöt8_t
)
i
);

576 
	`¥ötEº‹
(
ö_°r
, 
°æ_li°
, 
STRL_CC
);

583 
	`¥ötEº‹
(
ö_°r
, 
avih
, 
AVIH_CC
);

586  
ªsu…
;

587 
	}
}

589 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£AviWôhFømeLi°
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
‰ame_li°
& 
ö_‰ame_li°
)

591 
RiffLi°
 
hdæ_li°
;

592 
ö_°r
 >> 
hdæ_li°
;

594 if–
ö_°r
 && 
hdæ_li°
.
m_riff_‹_li°_cc
 =
LIST_CC
 && hdæ_li°.
m_li°_ty≥_cc
 =
HDRL_CC
 )

596 
uöt64_t
 
√xt_li°
 = 
ö_°r
.
	`ãŒg
();

598 
√xt_li°
 +(
hdæ_li°
.
m_size
 - 4);

600 if(
	`∑r£HdæLi°
(
ö_°r
))

602 
ö_°r
.
	`£ekg
(
√xt_li°
);

604 
RiffLi°
 
some_li°
;

605 
ö_°r
 >> 
some_li°
;

608 if(
ö_°r
 && 
some_li°
.
m_riff_‹_li°_cc
 =
LIST_CC
 && some_li°.
m_li°_ty≥_cc
 =
INFO_CC
)

610 
√xt_li°
 = 
ö_°r
.
	`ãŒg
();

612 
√xt_li°
 +(
some_li°
.
m_size
 - 4);

613 
	`∑r£Info
(
ö_°r
);

615 
ö_°r
.
	`£ekg
(
√xt_li°
);

616 
ö_°r
 >> 
some_li°
;

620 
	`skùJunk
(
some_li°
, 
ö_°r
);

623 if(
ö_°r
 && 
some_li°
.
m_riff_‹_li°_cc
 =
LIST_CC
 && some_li°.
m_li°_ty≥_cc
 =
MOVI_CC
)

625 
boﬁ
 
is_ödex_found
 = 
Ál£
;

627 
m_movi_°¨t
 = 
ö_°r
.
	`ãŒg
();

628 
m_movi_°¨t
 -= 4;

630 
m_movi_íd
 = 
m_movi_°¨t
 + 
some_li°
.
m_size
;

632 if(
m_is_ödx_¥e£¡
)

635 
uöt32_t
 
ödx_pos
 = (uöt32_t)
m_movi_°¨t
 + 4;

636 
ödx_pos
 +(
some_li°
.
m_size
 - 4);

637 
ö_°r
.
	`£ekg
(
ödx_pos
);

639 
RiffChunk
 
ödex_chunk
;

640 
ö_°r
 >> 
ödex_chunk
;

642 if(
ö_°r
 && 
ödex_chunk
.
m_four_cc
 =
IDX1_CC
)

644 
is_ödex_found
 = 
	`∑r£Index
(
ö_°r
, 
ödex_chunk
.
m_size
, 
ö_‰ame_li°
);

649 
	`¥ötEº‹
(
ö_°r
, 
ödex_chunk
, 
IDX1_CC
);

654 if(!
is_ödex_found
)

657 
	`∑r£Movi
(
ö_°r
, 
ö_‰ame_li°
);

659 
	`Ârötf
(
°dîr
, "FailedÅoÖarseávi: index wasÇot found\n");

665 
	`¥ötEº‹
(
ö_°r
, 
some_li°
, 
MOVI_CC
);

671 
	`¥ötEº‹
(
ö_°r
, 
hdæ_li°
, 
HDRL_CC
);

674  
ö_‰ame_li°
.
	`size
() > 0;

675 
	}
}

677 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Avi
(
Mj≥gI≈utSåóm
& 
ö_°r
, 
‰ame_li°
& 
ö_‰ame_li°
)

679  
	`∑r£AviWôhFømeLi°
(
ö_°r
, 
ö_‰ame_li°
);

680 
	}
}

682 
boﬁ
 
	gAviMj≥gSåóm
::
	$∑r£Avi
(
Mj≥gI≈utSåóm
& 
ö_°r
)

684  
	`∑r£AviWôhFømeLi°
(
ö_°r
, 
m_‰ame_li°
);

685 
	}
}

688 ˛as†
	cMŸi⁄J≥gC≠tuª
: 
public
 
IVideoC≠tuª


690 
public
:

691 
vútuÆ
 ~
MŸi⁄J≥gC≠tuª
();

692 
vútuÆ
 
gëPr›îty
() const;

693 
vútuÆ
 
boﬁ
 
£tPr›îty
(, );

694 
vútuÆ
 
boﬁ
 
gøbFøme
();

695 
vútuÆ
 
boﬁ
 
ªåõveFøme
(, 
OuçutAºay
);

696 
vútuÆ
 
boﬁ
 
isO≥√d
() const;

697 
vútuÆ
 
gëC≠tuªDomaö
(Ë{  
	gCAP_ANY
; }

698 
MŸi⁄J≥gC≠tuª
(c⁄° 
Såög
&);

700 
boﬁ
 
›í
(c⁄° 
Såög
&);

701 
˛o£
();

702 
	g¥Ÿe˘ed
:

704 
boﬁ
 
∑r£Riff
(
Mj≥gI≈utSåóm
& 
ö_°r
);

706 
ölöe
 
uöt64_t
 
gëFømePos
() const;

707 
	g°d
::
ve˘‹
<> 
ªadFøme
(
‰ame_ôî©‹
 
ô
);

709 
Mj≥gI≈utSåóm
 
	gm_fûe_°ªam
;

710 
boﬁ
 
	gm_is_fú°_‰ame
;

711 
‰ame_li°
 
	gm_mj≥g_‰ames
;

713 
‰ame_ôî©‹
 
	gm_‰ame_ôî©‹
;

714 
M©
 
	gm_cuºít_‰ame
;

719 
uöt32_t
 
	gm_‰ame_width
;

720 
uöt32_t
 
	gm_‰ame_height
;

721 
	gm_Âs
;

724 
uöt64_t
 
	gMŸi⁄J≥gC≠tuª
::
	$gëFømePos
() const

726 if(
m_is_fú°_‰ame
)

729 if(
m_‰ame_ôî©‹
 =
m_mj≥g_‰ames
.
	`íd
())

730  
m_mj≥g_‰ames
.
	`size
();

732  
m_‰ame_ôî©‹
 - 
m_mj≥g_‰ames
.
	`begö
() + 1;

733 
	}
}

735 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$£tPr›îty
(
¥›îty
, 
vÆue
)

737 if(
¥›îty
 =
CAP_PROP_POS_FRAMES
)

739 if((
vÆue
) == 0)

741 
m_is_fú°_‰ame
 = 
åue
;

742 
m_‰ame_ôî©‹
 = 
m_mj≥g_‰ames
.
	`íd
();

743  
åue
;

745 if(
m_mj≥g_‰ames
.
	`size
(Ë> 
vÆue
)

747 
m_‰ame_ôî©‹
 = 
m_mj≥g_‰ames
.
	`begö
(Ë+ (
vÆue
 - 1);

748 
m_is_fú°_‰ame
 = 
Ál£
;

749  
åue
;

753  
Ál£
;

754 
	}
}

756 
	gMŸi⁄J≥gC≠tuª
::
	$gëPr›îty
(
¥›îty
) const

758 
¥›îty
)

760 
CAP_PROP_POS_FRAMES
:

761  ()
	`gëFømePos
();

762 
CAP_PROP_POS_AVI_RATIO
:

763  (
	`gëFømePos
())/
m_mj≥g_‰ames
.
	`size
();

764 
CAP_PROP_FRAME_WIDTH
:

765  ()
m_‰ame_width
;

766 
CAP_PROP_FRAME_HEIGHT
:

767  ()
m_‰ame_height
;

768 
CAP_PROP_FPS
:

769  
m_Âs
;

770 
CAP_PROP_FOURCC
:

771  ()
	`CV_FOURCC
('M','J','P','G');

772 
CAP_PROP_FRAME_COUNT
:

773  ()
m_mj≥g_‰ames
.
	`size
();

774 
CAP_PROP_FORMAT
:

779 
	}
}

781 
	g°d
::
ve˘‹
<> 
MŸi⁄J≥gC≠tuª
::
	$ªadFøme
(
‰ame_ôî©‹
 
ô
)

783 
m_fûe_°ªam
.
	`£ekg
(
ô
->
fú°
);

785 
RiffChunk
 
chunk
;

786 
m_fûe_°ªam
 >> 
chunk
;

788 
°d
::
ve˘‹
<> 
ªsu…
;

790 
ªsu…
.
	`ª£rve
(
chunk
.
m_size
);

791 
ªsu…
.
	`ªsize
(
chunk
.
m_size
);

793 
m_fûe_°ªam
.
	`ªad
(
ªsu…
.
	`d©a
(), 
chunk
.
m_size
);

795  
ªsu…
;

796 
	}
}

798 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$gøbFøme
()

800 if(
	`isO≥√d
())

802 if(
m_is_fú°_‰ame
)

804 
m_is_fú°_‰ame
 = 
Ál£
;

805 
m_‰ame_ôî©‹
 = 
m_mj≥g_‰ames
.
	`begö
();

809 ++
m_‰ame_ôî©‹
;

813  
m_‰ame_ôî©‹
 !
m_mj≥g_‰ames
.
	`íd
();

814 
	}
}

816 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$ªåõveFøme
(, 
OuçutAºay
 
ouçut_‰ame
)

818 if(
m_‰ame_ôî©‹
 !
m_mj≥g_‰ames
.
	`íd
())

820 
°d
::
ve˘‹
<> 
d©a
 = 
	`ªadFøme
(
m_‰ame_ôî©‹
);

822 if(
d©a
.
	`size
())

824 
m_cuºít_‰ame
 = 
	`imdecode
(
d©a
, 
CV_LOAD_IMAGE_ANYDEPTH
 | 
CV_LOAD_IMAGE_COLOR
);

827 
m_cuºít_‰ame
.
	`c›yTo
(
ouçut_‰ame
);

829  
åue
;

832  
Ál£
;

833 
	}
}

835 
	gMŸi⁄J≥gC≠tuª
::~
	$MŸi⁄J≥gC≠tuª
()

837 
	`˛o£
();

838 
	}
}

840 
	gMŸi⁄J≥gC≠tuª
::
	$MŸi⁄J≥gC≠tuª
(c⁄° 
Såög
& 
fûíame
)

842 
	`›í
(
fûíame
);

843 
	}
}

845 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$isO≥√d
() const

847  
m_mj≥g_‰ames
.
	`size
() > 0;

848 
	}
}

850 
	gMŸi⁄J≥gC≠tuª
::
	$˛o£
()

852 
m_fûe_°ªam
.
	`˛o£
();

853 
m_‰ame_ôî©‹
 = 
m_mj≥g_‰ames
.
	`íd
();

854 
	}
}

856 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$›í
(c⁄° 
Såög
& 
fûíame
)

858 
	`˛o£
();

860 
m_fûe_°ªam
.
	`›í
(
fûíame
);

862 
m_‰ame_ôî©‹
 = 
m_mj≥g_‰ames
.
	`íd
();

863 
m_is_fú°_‰ame
 = 
åue
;

865 if(!
	`∑r£Riff
(
m_fûe_°ªam
))

867 
	`˛o£
();

870  
	`isO≥√d
();

871 
	}
}

874 
boﬁ
 
	gMŸi⁄J≥gC≠tuª
::
	$∑r£Riff
(
Mj≥gI≈utSåóm
& 
ö_°r
)

876 
boﬁ
 
ªsu…
 = 
Ál£
;

877 
ö_°r
)

879 
RiffLi°
 
riff_li°
;

881 
ö_°r
 >> 
riff_li°
;

883 if–
ö_°r
 && 
riff_li°
.
m_riff_‹_li°_cc
 =
RIFF_CC
 &&

884 ((
riff_li°
.
m_li°_ty≥_cc
 =
AVI_CC
Ë| (riff_li°.m_li°_ty≥_c¯=
AVIX_CC
)) )

886 
uöt64_t
 
√xt_riff
 = 
ö_°r
.
	`ãŒg
();

888 
√xt_riff
 +(
riff_li°
.
m_size
 - 4);

890 
AviMj≥gSåóm
 
mj≥g_video_°ªam
;

891 
boﬁ
 
is_∑r£d
 = 
mj≥g_video_°ªam
.
	`∑r£Avi
(
ö_°r
, 
m_mj≥g_‰ames
);

892 
ªsu…
 =Ñesu… || 
is_∑r£d
;

894 if(
is_∑r£d
)

896 
m_‰ame_width
 = 
mj≥g_video_°ªam
.
	`gëWidth
();

897 
m_‰ame_height
 = 
mj≥g_video_°ªam
.
	`gëHeight
();

898 
m_Âs
 = 
mj≥g_video_°ªam
.
	`gëFps
();

901 
ö_°r
.
	`£ekg
(
√xt_riff
);

909  
ªsu…
;

910 
	}
}

912 
	gPå
<
	gIVideoC≠tuª
> 
	$¸óãMŸi⁄J≥gC≠tuª
(c⁄° 
Såög
& 
fûíame
)

914 
På
<
MŸi⁄J≥gC≠tuª
> 
	`mjdecodî
(
√w
 
	`MŸi⁄J≥gC≠tuª
(
fûíame
));

915 if–
mjdecodî
->
	`isO≥√d
() )

916  
mjdecodî
;

917  
På
<
MŸi⁄J≥gC≠tuª
>();

918 
	}
}

	@src/cap_mjpeg_encoder.cpp

42 
	~"¥ecomp.hµ
"

43 
	~<ve˘‹
>

45 #i‡
CV_NEON


46 
	#WITH_NEON


	)

49 
«me•a˚
 
	gcv


51 
«me•a˚
 
	gmj≥g


54 íum { 
	gCOLORSPACE_GRAY
=0, 
	gCOLORSPACE_RGBA
=1, 
	gCOLORSPACE_BGR
=2, 
	gCOLORSPACE_YUV444P
=3 };

56 
	#fourCC
(
a
,
b
,
c
,
d
Ë(()((
	`uch¨
(d)<<24Ë| (uch¨(c)<<16Ë| (uch¨(b)<<8Ë| uch¨◊)))

	)

58 c⁄° 
	gAVIH_STRH_SIZE
 = 56;

59 c⁄° 
	gSTRF_SIZE
 = 40;

60 c⁄° 
	gAVI_DWFLAG
 = 0x00000910;

61 c⁄° 
	gAVI_DWSCALE
 = 1;

62 c⁄° 
	gAVI_DWQUALITY
 = -1;

63 c⁄° 
	gJUNK_SEEK
 = 4096;

64 c⁄° 
	gAVIIF_KEYFRAME
 = 0x10;

65 c⁄° 
	gMAX_BYTES_PER_SEC
 = 99999999;

66 c⁄° 
	gSUG_BUFFER_SIZE
 = 1048576;

68 c⁄° 
	gbô_mask
[] =

81 ˛as†
	cBôSåóm


83 
	gpublic
:

86 
DEFAULT_BLOCK_SIZE
 = (1 << 15),

87 
	ghuff_vÆ_shi·
 = 20,

88 
	ghuff_code_mask
 = (1 << 
huff_vÆ_shi·
) - 1

91 
BôSåóm
()

93 
	gm_buf
.
ªsize
(
DEFAULT_BLOCK_SIZE
 + 1024);

94 
	gm_°¨t
 = &
m_buf
[0];

95 
	gm_íd
 = 
m_°¨t
 + 
DEFAULT_BLOCK_SIZE
;

96 
	gm_is_›íed
 = 
Ál£
;

97 
	gm_f
 = 0;

100 ~
BôSåóm
()

102 
˛o£
();

105 
boﬁ
 
›í
(c⁄° 
Såög
& 
fûíame
)

107 
˛o£
();

108 
	gm_f
 = 
f›í
(
fûíame
.
c_°r
(), "wb");

109 if–!
	gm_f
 )

110  
	gÁl£
;

111 
	gm_cuºít
 = 
m_°¨t
;

112 
	gm_pos
 = 0;

113  
	gåue
;

116 
boﬁ
 
isO≥√d
(Ëc⁄° {  
	gm_f
 != 0; }

118 
˛o£
()

120 
wrôeBlock
();

121 if–
	gm_f
 )

122 
f˛o£
(
m_f
);

123 
	gm_f
 = 0;

126 
wrôeBlock
()

128 
size_t
 
	gwsz0
 = 
m_cuºít
 - 
m_°¨t
;

129 if–
	gwsz0
 > 0 && 
	gm_f
 )

131 
size_t
 
	gwsz
 = 
fwrôe
(
m_°¨t
, 1, 
wsz0
, 
m_f
);

132 
CV_As£π
–
wsz
 =
wsz0
 );

134 
	gm_pos
 +
wsz0
;

135 
	gm_cuºít
 = 
m_°¨t
;

138 
size_t
 
gëPos
() const

140  (
	gsize_t
)(
	gm_cuºít
 - 
	gm_°¨t
Ë+ 
	gm_pos
;

143 
putByã
(
vÆ
)

145 *
	gm_cuºít
++ = (
uch¨
)
vÆ
;

146 if–
	gm_cuºít
 >
m_íd
 )

147 
wrôeBlock
();

150 
putByãs
(c⁄° 
uch¨
* 
buf
, 
cou¡
)

152 
uch¨
* 
	gd©a
 = (uch¨*)
buf
;

153 
CV_As£π
(
m_f
 && 
d©a
 && 
m_cuºít
 && 
cou¡
 >= 0);

154 if–
	gm_cuºít
 >
m_íd
 )

155 
wrôeBlock
();

157  
	gcou¡
 )

159 
	gl
 = ()(
m_íd
 - 
m_cuºít
);

161 i‡(
	gl
 > 
	gcou¡
)

162 
	gl
 = 
cou¡
;

164 if–
	gl
 > 0 )

166 
mem˝y
(
m_cuºít
, 
d©a
, 
l
);

167 
	gm_cuºít
 +
l
;

168 
	gd©a
 +
l
;

169 
	gcou¡
 -
l
;

171 if–
	gm_cuºít
 >
m_íd
 )

172 
wrôeBlock
();

176 
putSh‹t
(
vÆ
)

178 
	gm_cuºít
[0] = (
uch¨
)
vÆ
;

179 
	gm_cuºít
[1] = (
uch¨
)(
vÆ
 >> 8);

180 
	gm_cuºít
 += 2;

181 if–
	gm_cuºít
 >
m_íd
 )

182 
wrôeBlock
();

185 
putI¡
(
vÆ
)

187 
	gm_cuºít
[0] = (
uch¨
)
vÆ
;

188 
	gm_cuºít
[1] = (
uch¨
)(
vÆ
 >> 8);

189 
	gm_cuºít
[2] = (
uch¨
)(
vÆ
 >> 16);

190 
	gm_cuºít
[3] = (
uch¨
)(
vÆ
 >> 24);

191 
	gm_cuºít
 += 4;

192 if–
	gm_cuºít
 >
m_íd
 )

193 
wrôeBlock
();

196 
jputSh‹t
(
vÆ
)

198 
	gm_cuºít
[0] = (
uch¨
)(
vÆ
 >> 8);

199 
	gm_cuºít
[1] = (
uch¨
)
vÆ
;

200 
	gm_cuºít
 += 2;

201 if–
	gm_cuºít
 >
m_íd
 )

202 
wrôeBlock
();

205 
∑tchI¡
(
vÆ
, 
size_t
 
pos
)

207 if–
	gpos
 >
m_pos
 )

209 
±rdiff_t
 
dñè
 = 
pos
 - 
m_pos
;

210 
CV_As£π
–
dñè
 < 
m_cuºít
 - 
m_°¨t
 );

211 
	gm_°¨t
[
dñè
] = (
uch¨
)
vÆ
;

212 
	gm_°¨t
[
dñè
+1] = (
uch¨
)(
vÆ
 >> 8);

213 
	gm_°¨t
[
dñè
+2] = (
uch¨
)(
vÆ
 >> 16);

214 
	gm_°¨t
[
dñè
+3] = (
uch¨
)(
vÆ
 >> 24);

218 
	gÂos
 = 
·ñl
(
m_f
);

219 
f£ek
(
m_f
, ()
pos
, 
SEEK_SET
);

220 
uch¨
 
	gbuf
[] = { (uch¨)
vÆ
, (uchar)(val >> 8), (uchar)(val >> 16), (uchar)(val >> 24) };

221 
fwrôe
(
buf
, 1, 4, 
m_f
);

222 
f£ek
(
m_f
, 
Âos
, 
SEEK_SET
);

226 
jput
(
cuºvÆ
)

228 
uch¨
 
	gv
;

229 
uch¨
* 
	g±r
 = 
m_cuºít
;

230 
	gv
 = (
uch¨
)(
cuºvÆ
 >> 24);

231 *
	g±r
++ = 
v
;

232 if–
	gv
 == 255 )

233 *
±r
++ = 0;

234 
	gv
 = (
uch¨
)(
cuºvÆ
 >> 16);

235 *
	g±r
++ = 
v
;

236 if–
	gv
 == 255 )

237 *
±r
++ = 0;

238 
	gv
 = (
uch¨
)(
cuºvÆ
 >> 8);

239 *
	g±r
++ = 
v
;

240 if–
	gv
 == 255 )

241 *
±r
++ = 0;

242 
	gv
 = (
uch¨
)
cuºvÆ
;

243 *
	g±r
++ = 
v
;

244 if–
	gv
 == 255 )

245 *
±r
++ = 0;

246 
	gm_cuºít
 = 
±r
;

247 if–
	gm_cuºít
 >
m_íd
 )

248 
wrôeBlock
();

251 
jÊush
(
cuºvÆ
, 
bôIdx
)

253 
uch¨
 
	gv
;

254 
uch¨
* 
	g±r
 = 
m_cuºít
;

255 
	gcuºvÆ
 |(1 << 
bôIdx
)-1;

256  
	gbôIdx
 < 32 )

258 
	gv
 = (
uch¨
)(
cuºvÆ
 >> 24);

259 *
	g±r
++ = 
v
;

260 if–
	gv
 == 255 )

261 *
±r
++ = 0;

262 
	gcuºvÆ
 <<= 8;

263 
	gbôIdx
 += 8;

265 
	gm_cuºít
 = 
±r
;

266 if–
	gm_cuºít
 >
m_íd
 )

267 
wrôeBlock
();

270 
boﬁ
 
¸óãEncodeHuffm™TabÀ
–c⁄° * 
§c
, * 
èbÀ
, 
max_size
 )

272 
	gi
, 
	gk
;

273 
	gmö_vÆ
 = 
INT_MAX
, 
	gmax_vÆ
 = 
INT_MIN
;

274 
	gsize
;

277  
	gi
 = 1, 
	gk
 = 1; 
	g§c
[
k
] >= 0; i++ )

279 
	gcode_cou¡
 = 
§c
[
k
++];

281  
	gcode_cou¡
 +
k
; 
	gk
 < code_count; k++ )

283 
	gvÆ
 = 
§c
[
k
] >> 
huff_vÆ_shi·
;

284 if–
	gvÆ
 < 
	gmö_vÆ
 )

285 
	gmö_vÆ
 = 
vÆ
;

286 if–
	gvÆ
 > 
	gmax_vÆ
 )

287 
	gmax_vÆ
 = 
vÆ
;

291 
	gsize
 = 
max_vÆ
 - 
mö_vÆ
 + 3;

293 if–
	gsize
 > 
	gmax_size
 )

295 
CV_Eº‹
(
CV_StsOutOfR™ge
, "too big maximum Huffman code size");

296  
	gÁl£
;

299 
mem£t
–
èbÀ
, 0, 
size
*(table[0]));

301 
	gèbÀ
[0] = 
mö_vÆ
;

302 
	gèbÀ
[1] = 
size
 - 2;

304  
	gi
 = 1, 
	gk
 = 1; 
	g§c
[
k
] >= 0; i++ )

306 
	gcode_cou¡
 = 
§c
[
k
++];

308  
	gcode_cou¡
 +
k
; 
	gk
 < code_count; k++ )

310 
	gvÆ
 = 
§c
[
k
] >> 
huff_vÆ_shi·
;

311 
	gcode
 = 
§c
[
k
] & 
huff_code_mask
;

313 
	gèbÀ
[
vÆ
 - 
mö_vÆ
 + 2] = (
code
 << 8Ë| 
i
;

316  
	gåue
;

319 * 
¸óãSour˚Huffm™TabÀ
(c⁄° 
uch¨
* 
§c
, * 
d°
,

320 
max_bôs
, 
fú°_bôs
)

322 
	gi
, 
	gvÆ_idx
, 
	gcode
 = 0;

323 * 
	gèbÀ
 = 
d°
;

324 *
	gd°
++ = 
fú°_bôs
;

325 
	gi
 = 1, 
	gvÆ_idx
 = 
max_bôs
; i <= max_bits; i++)

327 
	gcode_cou¡
 = 
§c
[
i
 - 1];

328 
	gd°
[0] = 
code_cou¡
;

329 
	gcode
 <<= 1;

330 
	gk
 = 0; k < 
	gcode_cou¡
; k++)

332 
	gd°
[
k
 + 1] = (
§c
[
vÆ_idx
 + k] << 
huff_vÆ_shi·
Ë| (
code
 + k);

334 
	gcode
 +
code_cou¡
;

335 
	gd°
 +
code_cou¡
 + 1;

336 
	gvÆ_idx
 +
code_cou¡
;

338 
	gd°
[0] = -1;

339  
	gèbÀ
;

342 
	g¥Ÿe˘ed
:

343 
°d
::
ve˘‹
<
uch¨
> 
m_buf
;

344 
uch¨
* 
	gm_°¨t
;

345 
uch¨
* 
	gm_íd
;

346 
uch¨
* 
	gm_cuºít
;

347 
size_t
 
	gm_pos
;

348 
boﬁ
 
	gm_is_›íed
;

349 
FILE
* 
	gm_f
;

353 ˛as†
	cMŸi⁄J≥gWrôî
 : 
public
 
IVideoWrôî


355 
public
:

356 
MŸi⁄J≥gWrôî
(Ë{ 
øw°ªam
 = 
Ál£
; }

357 
MŸi⁄J≥gWrôî
(c⁄° 
Såög
& 
fûíame
, 
Âs
, 
Size
 
size
, 
boﬁ
 
iscﬁ‹
)

359 
	gøw°ªam
 = 
Ál£
;

360 
›í
(
fûíame
, 
Âs
, 
size
, 
iscﬁ‹
);

362 ~
MŸi⁄J≥gWrôî
(Ë{ 
˛o£
(); }

364 
˛o£
()

366 if–!
	g°rm
.
isO≥√d
() )

369 if–!
	g‰ameOff£t
.
em±y
(Ë&& !
	gøw°ªam
 )

371 
ídWrôeChunk
();

372 
wrôeIndex
();

373 
föishWrôeAVI
();

375 
	g°rm
.
˛o£
();

376 
	g‰ameOff£t
.
˛ór
();

377 
	g‰ameSize
.
˛ór
();

378 
	gAVIChunkSizeIndex
.
˛ór
();

379 
	g‰ameNumIndexes
.
˛ór
();

382 
boﬁ
 
›í
(c⁄° 
Såög
& 
fûíame
, 
Âs
, 
Size
 
size
, boﬁ 
iscﬁ‹
)

384 
˛o£
();

386 if–
	gfûíame
.
em±y
() )

387  
	gÁl£
;

388 c⁄° * 
	gext
 = 
°ºchr
(
fûíame
.
c_°r
(), '.');

389 if–!
	gext
 )

390  
	gÁl£
;

391 if–
°rcmp
(
ext
, ".avi") != 0 && strcmp(ext, ".AVI") != 0 && strcmp(ext, ".Avi") != 0 )

392  
Ál£
;

394 
boﬁ
 
	gok
 = 
°rm
.
›í
(
fûíame
);

395 if–!
	gok
 )

396  
	gÁl£
;

398 
CV_As£π
(
Âs
 >= 1);

399 
	goutÂs
 = 
cvRound
(
Âs
);

400 
	gwidth
 = 
size
.
width
;

401 
	gheight
 = 
size
.
height
;

402 
	gquÆôy
 = 75;

403 
	gøw°ªam
 = 
Ál£
;

404 
	gch™√ls
 = 
iscﬁ‹
 ? 3 : 1;

406 if–!
	gøw°ªam
 )

408 
°¨tWrôeAVI
();

409 
wrôeSåómHódî
();

412  
	gåue
;

415 
boﬁ
 
isO≥√d
(Ëc⁄° {  
	g°rm
.isOpened(); }

417 
°¨tWrôeAVI
()

419 
°¨tWrôeChunk
(
fourCC
('R', 'I', 'F', 'F'));

421 
	g°rm
.
putI¡
(
fourCC
('A', 'V', 'I', ' '));

423 
°¨tWrôeChunk
(
fourCC
('L', 'I', 'S', 'T'));

425 
	g°rm
.
putI¡
(
fourCC
('h', 'd', 'r', 'l'));

426 
	g°rm
.
putI¡
(
fourCC
('a', 'v', 'i', 'h'));

427 
	g°rm
.
putI¡
(
AVIH_STRH_SIZE
);

428 
	g°rm
.
putI¡
(
cvRound
(1e6 / 
outÂs
));

429 
	g°rm
.
putI¡
(
MAX_BYTES_PER_SEC
);

430 
	g°rm
.
putI¡
(0);

431 
	g°rm
.
putI¡
(
AVI_DWFLAG
);

433 
	g‰ameNumIndexes
.
push_back
(
°rm
.
gëPos
());

435 
	g°rm
.
putI¡
(0);

436 
	g°rm
.
putI¡
(0);

437 
	g°rm
.
putI¡
(1);

438 
	g°rm
.
putI¡
(
SUG_BUFFER_SIZE
);

439 
	g°rm
.
putI¡
(
width
);

440 
	g°rm
.
putI¡
(
height
);

441 
	g°rm
.
putI¡
(0);

442 
	g°rm
.
putI¡
(0);

443 
	g°rm
.
putI¡
(0);

444 
	g°rm
.
putI¡
(0);

447 
wrôeSåómHódî
()

450 
°¨tWrôeChunk
(
fourCC
('L', 'I', 'S', 'T'));

452 
	g°rm
.
putI¡
(
fourCC
('s', 't', 'r', 'l'));

453 
	g°rm
.
putI¡
(
fourCC
('s', 't', 'r', 'h'));

454 
	g°rm
.
putI¡
(
AVIH_STRH_SIZE
);

455 
	g°rm
.
putI¡
(
fourCC
('v', 'i', 'd', 's'));

456 
	g°rm
.
putI¡
(
fourCC
('M', 'J', 'P', 'G'));

457 
	g°rm
.
putI¡
(0);

458 
	g°rm
.
putI¡
(0);

459 
	g°rm
.
putI¡
(0);

460 
	g°rm
.
putI¡
(
AVI_DWSCALE
);

461 
	g°rm
.
putI¡
(
outÂs
);

462 
	g°rm
.
putI¡
(0);

464 
	g‰ameNumIndexes
.
push_back
(
°rm
.
gëPos
());

466 
	g°rm
.
putI¡
(0);

467 
	g°rm
.
putI¡
(
SUG_BUFFER_SIZE
);

468 
	g°rm
.
putI¡
(
AVI_DWQUALITY
);

469 
	g°rm
.
putI¡
(0);

470 
	g°rm
.
putSh‹t
(0);

471 
	g°rm
.
putSh‹t
(0);

472 
	g°rm
.
putSh‹t
(
width
);

473 
	g°rm
.
putSh‹t
(
height
);

476 
°¨tWrôeChunk
(
fourCC
('s', 't', 'r', 'f'));

478 
	g°rm
.
putI¡
(
STRF_SIZE
);

479 
	g°rm
.
putI¡
(
width
);

480 
	g°rm
.
putI¡
(
height
);

481 
	g°rm
.
putSh‹t
(1);

483 
	g°rm
.
putSh‹t
(
ch™√ls
);

484 
	g°rm
.
putI¡
(
fourCC
('M', 'J', 'P', 'G'));

485 
	g°rm
.
putI¡
(
width
 * 
height
 * 
ch™√ls
);

486 
	g°rm
.
putI¡
(0);

487 
	g°rm
.
putI¡
(0);

488 
	g°rm
.
putI¡
(0);

489 
	g°rm
.
putI¡
(0);

491 
ídWrôeChunk
();

492 
ídWrôeChunk
();

495 
°¨tWrôeChunk
(
fourCC
('L', 'I', 'S', 'T'));

496 
	g°rm
.
putI¡
(
fourCC
('o', 'd', 'm', 'l'));

497 
°¨tWrôeChunk
(
fourCC
('d', 'm', 'l', 'h'));

499 
	g‰ameNumIndexes
.
push_back
(
°rm
.
gëPos
());

501 
	g°rm
.
putI¡
(0);

502 
	g°rm
.
putI¡
(0);

504 
ídWrôeChunk
();

505 
ídWrôeChunk
();

507 
ídWrôeChunk
();

510 
°¨tWrôeChunk
(
fourCC
('J', 'U', 'N', 'K'));

511 
size_t
 
	gpos
 = 
°rm
.
gëPos
();

512  ; 
	gpos
 < (
	gsize_t
)
	gJUNK_SEEK
;Öos += 4 )

513 
°rm
.
putI¡
(0);

514 
ídWrôeChunk
();

516 
°¨tWrôeChunk
(
fourCC
('L', 'I', 'S', 'T'));

517 
	gmoviPoöãr
 = 
°rm
.
gëPos
();

518 
	g°rm
.
putI¡
(
fourCC
('m', 'o', 'v', 'i'));

521 
°¨tWrôeChunk
(
fourcc
)

523 
CV_As£π
(
fourcc
 != 0);

524 
	g°rm
.
putI¡
(
fourcc
);

526 
	gAVIChunkSizeIndex
.
push_back
(
°rm
.
gëPos
());

527 
	g°rm
.
putI¡
(0);

530 
ídWrôeChunk
()

532 if–!
	gAVIChunkSizeIndex
.
em±y
() )

534 
size_t
 
	gcuºpos
 = 
°rm
.
gëPos
();

535 
size_t
 
	gpo•os
 = 
AVIChunkSizeIndex
.
back
();

536 
	gAVIChunkSizeIndex
.
p›_back
();

537 
	gchunksz
 = ()(
cuºpos
 - (
po•os
 + 4));

538 
	g°rm
.
∑tchI¡
(
chunksz
, 
po•os
);

542 
wrôeIndex
()

545 
°¨tWrôeChunk
(
fourCC
('i', 'd', 'x', '1'));

546 
	gn‰ames
 = ()
‰ameOff£t
.
size
();

547  
	gi
 = 0; i < 
	gn‰ames
; i++ )

549 
	g°rm
.
putI¡
(
fourCC
('0', '0', 'd', 'c'));

550 
	g°rm
.
putI¡
(
AVIIF_KEYFRAME
);

551 
	g°rm
.
putI¡
(()
‰ameOff£t
[
i
]);

552 
	g°rm
.
putI¡
(()
‰ameSize
[
i
]);

554 
ídWrôeChunk
();

557 
föishWrôeAVI
()

559 
	gn‰ames
 = ()
‰ameOff£t
.
size
();

561 !
	g‰ameNumIndexes
.
em±y
())

563 
size_t
 
	gµos
 = 
‰ameNumIndexes
.
back
();

564 
	g‰ameNumIndexes
.
p›_back
();

565 
	g°rm
.
∑tchI¡
(
n‰ames
, 
µos
);

567 
ídWrôeChunk
();

570 
wrôe
(
I≈utAºay
 
_img
)

572 
M©
 
	gimg
 = 
_img
.
gëM©
();

573 
size_t
 
	gchunkPoöãr
 = 
°rm
.
gëPos
();

574 
	göput_ch™√ls
 = 
img
.
ch™√ls
();

575 
	gcﬁ‹•a˚
 = -1;

577 if–
	göput_ch™√ls
 =1 && 
ch™√ls
 == 1 )

579 
CV_As£π
–
img
.
cﬁs
 =
width
 && img.
rows
 =
height
 );

580 
	gcﬁ‹•a˚
 = 
COLORSPACE_GRAY
;

582 if–
	göput_ch™√ls
 == 4 )

584 
CV_As£π
–
img
.
cﬁs
 =
width
 && img.
rows
 =
height
 && 
ch™√ls
 == 3 );

585 
	gcﬁ‹•a˚
 = 
COLORSPACE_RGBA
;

587 if–
	göput_ch™√ls
 == 3 )

589 
CV_As£π
–
img
.
cﬁs
 =
width
 && img.
rows
 =
height
 && 
ch™√ls
 == 3 );

590 
	gcﬁ‹•a˚
 = 
COLORSPACE_BGR
;

592 if–
	göput_ch™√ls
 =1 && 
ch™√ls
 == 3 )

594 
CV_As£π
–
img
.
cﬁs
 =
width
 && img.
rows
 =
height
*3 );

595 
	gcﬁ‹•a˚
 = 
COLORSPACE_YUV444P
;

598 
CV_Eº‹
(
CV_StsBadArg
, "Invalid combination of specified video colorspaceándÅhe input image colorspace");

600 if–!
	gøw°ªam
 )

601 
°¨tWrôeChunk
(
fourCC
('0', '0', 'd', 'c'));

603 
wrôeFømeD©a
(
img
.
d©a
, ()img.
°ï
, 
cﬁ‹•a˚
, 
öput_ch™√ls
);

605 if–!
	gøw°ªam
 )

607 
	g‰ameOff£t
.
push_back
(
chunkPoöãr
 - 
moviPoöãr
);

608 
	g‰ameSize
.
push_back
(
°rm
.
gëPos
(Ë- 
chunkPoöãr
 - 8);

609 
ídWrôeChunk
();

613 
gëPr›îty
(
¥›Id
) const

615 if–
	g¥›Id
 =
VIDEOWRITER_PROP_QUALITY
 )

616  
quÆôy
;

617 if–
	g¥›Id
 =
VIDEOWRITER_PROP_FRAMEBYTES
 )

618  
‰ameSize
.
em±y
(Ë? 0. : ()‰ameSize.
back
();

622 
boﬁ
 
£tPr›îty
(
¥›Id
, 
vÆue
)

624 if–
	g¥›Id
 =
VIDEOWRITER_PROP_QUALITY
 )

626 
quÆôy
 = 
vÆue
;

627  
	gåue
;

629  
	gÁl£
;

632 
wrôeFømeD©a
–c⁄° 
uch¨
* 
d©a
, 
°ï
, 
cﬁ‹•a˚
, 
öput_ch™√ls
 );

634 
	g¥Ÿe˘ed
:

635 
outÂs
;

636 
	gwidth
, 
	gheight
, 
	gch™√ls
;

637 
	gquÆôy
;

638 
size_t
 
	gmoviPoöãr
;

639 
	g°d
::
ve˘‹
<
size_t
> 
‰ameOff£t
, 
	g‰ameSize
, 
	gAVIChunkSizeIndex
, 
	g‰ameNumIndexes
;

640 
boﬁ
 
	gøw°ªam
;

642 
BôSåóm
 
	g°rm
;

645 
	#DCT_DESCALE
(
x
, 
n
Ë(((xË+ ((()1Ë<< (“Ë- 1))Ë>> (n))

	)

646 
	#fix
(
x
, 
n
Ë()((x)*(1 << (n)Ë+ .5);

	)

650 
	gfixb
 = 14,

651 
	gfixc
 = 12,

652 
	gpo°shi·
 = 14

655 c⁄° 
	gC0_707
 = 
fix
(0.707106781f, 
fixb
);

656 c⁄° 
	gC0_541
 = 
fix
(0.541196100f, 
fixb
);

657 c⁄° 
	gC0_382
 = 
fix
(0.382683432f, 
fixb
);

658 c⁄° 
	gC1_306
 = 
fix
(1.306562965f, 
fixb
);

660 c⁄° 
	gy_r
 = 
fix
(0.299, 
fixc
);

661 c⁄° 
	gy_g
 = 
fix
(0.587, 
fixc
);

662 c⁄° 
	gy_b
 = 
fix
(0.114, 
fixc
);

664 c⁄° 
	gcb_r
 = -
fix
(0.1687, 
fixc
);

665 c⁄° 
	gcb_g
 = -
fix
(0.3313, 
fixc
);

666 c⁄° 
	gcb_b
 = 
fix
(0.5, 
fixc
);

668 c⁄° 
	g¸_r
 = 
fix
(0.5, 
fixc
);

669 c⁄° 
	g¸_g
 = -
fix
(0.4187, 
fixc
);

670 c⁄° 
	g¸_b
 = -
fix
(0.0813, 
fixc
);

673 c⁄° 
uch¨
 
	gj≥gTabÀK1_T
[] =

685 c⁄° 
uch¨
 
	gj≥gTabÀK2_T
[] =

700 c⁄° 
uch¨
 
	gj≥gTabÀK3
[] =

707 c⁄° 
uch¨
 
	gj≥gTabÀK4
[] =

714 c⁄° 
uch¨
 
	gj≥gTabÀK5
[] =

741 c⁄° 
uch¨
 
	gj≥gTabÀK6
[] =

767 c⁄° 
uch¨
 
	gzigzag
[] =

777 c⁄° 
	gid˘_¥esˇÀ
[] =

789 c⁄° 
	gj≥gHódî
[] =

799 #ifde‡
WITH_NEON


801 
Øn_fd˘8x8
–c⁄° *
§c
, *
d°
,

802 
°ï
, c⁄° *
po°sˇÀ
 )

805 
öt16x8_t
 
	gx0
 = 
vld1q_s16
(
§c
); i¡16x8_à
	gx1
 = vld1q_s16(§¯+ 
°ï
*7);

806 
öt16x8_t
 
	gx2
 = 
vld1q_s16
(
§c
 + 
°ï
*3); i¡16x8_à
	gx3
 = vld1q_s16(src + step*4);

808 
öt16x8_t
 
	gx4
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx0
 = 
vsubq_s16
(x0, x1);

809 
	gx1
 = 
vaddq_s16
(
x2
, 
x3
); 
	gx2
 = 
vsubq_s16
(x2, x3);

811 
öt16x8_t
 
	gt1
 = 
x0
; i¡16x8_à
	gt2
 = 
x2
;

813 
	gx2
 = 
vaddq_s16
(
x4
, 
x1
); 
	gx4
 = 
vsubq_s16
(x4, x1);

815 
	gx0
 = 
vld1q_s16
(
§c
 + 
°ï
); 
	gx3
 = vld1q_s16(src + step*6);

817 
	gx1
 = 
vaddq_s16
(
x0
, 
x3
); 
	gx0
 = 
vsubq_s16
(x0, x3);

818 
öt16x8_t
 
	gt3
 = 
x0
;

820 
	gx0
 = 
vld1q_s16
(
§c
 + 
°ï
*2); 
	gx3
 = vld1q_s16(src + step*5);

822 
öt16x8_t
 
	gt4
 = 
vsubq_s16
(
x0
, 
x3
);

824 
	gx0
 = 
vaddq_s16
(
x0
, 
x3
);

825 
	gx3
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx0
 = 
vsubq_s16
(x0, x1);

826 
	gx1
 = 
vaddq_s16
(
x2
, 
x3
); 
	gx2
 = 
vsubq_s16
(x2, x3);

828 
öt16x8_t
 
	gªs0
 = 
x1
;

829 
öt16x8_t
 
	gªs4
 = 
x2
;

830 
	gx0
 = 
vqdmulhq_n_s16
(
vsubq_s16
(
x0
, 
x4
), ()(
C0_707
*2));

831 
	gx1
 = 
vaddq_s16
(
x4
, 
x0
); 
	gx4
 = 
vsubq_s16
(x4, x0);

833 
öt16x8_t
 
	gªs2
 = 
x4
;

834 
öt16x8_t
 
	gªs6
 = 
x1
;

836 
	gx0
 = 
t2
; 
	gx1
 = 
t4
;

837 
	gx2
 = 
t3
; 
	gx3
 = 
t1
;

838 
	gx0
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx1
 = vaddq_s16(x1, 
x2
); 
	gx2
 = vaddq_s16(x2, 
x3
);

839 
	gx1
 =
vqdmulhq_n_s16
(
x1
, ()(
C0_707
*2));

841 
	gx4
 = 
vaddq_s16
(
x1
, 
x3
); 
	gx3
 = 
vsubq_s16
(x3, x1);

842 
	gx1
 = 
vqdmulhq_n_s16
(
vsubq_s16
(
x0
, 
x2
), ()(
C0_382
*2));

843 
	gx0
 = 
vaddq_s16
(
vqdmulhq_n_s16
(
x0
, ()(
C0_541
*2)), 
x1
);

844 
	gx2
 = 
vaddq_s16
(
vshlq_n_s16
(
vqdmulhq_n_s16
(
x2
, ()
C1_306
), 1), 
x1
);

846 
	gx1
 = 
vaddq_s16
(
x0
, 
x3
); 
	gx3
 = 
vsubq_s16
(x3, x0);

847 
	gx0
 = 
vaddq_s16
(
x4
, 
x2
); 
	gx4
 = 
vsubq_s16
(x4, x2);

849 
öt16x8_t
 
	gªs1
 = 
x0
;

850 
öt16x8_t
 
	gªs3
 = 
x3
;

851 
öt16x8_t
 
	gªs5
 = 
x1
;

852 
öt16x8_t
 
	gªs7
 = 
x4
;

867 
öt16x4_t
 
	gªs0_0
 = 
vgë_low_s16
(
ªs0
);

868 
öt16x4_t
 
	gªs1_0
 = 
vgë_low_s16
(
ªs1
);

869 
öt16x4x2_t
 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

870 
öt32x4_t
 
	gl0
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

872 
	gªs0_0
 = 
vgë_low_s16
(
ªs2
);

873 
	gªs1_0
 = 
vgë_low_s16
(
ªs3
);

874 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

875 
öt32x4_t
 
	gl1
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

877 
öt32x4x2_t
 
	gåes1
 = 
vånq_s32
(
l0
, 
l1
);

880 
	gªs0_0
 = 
vgë_low_s16
(
ªs4
);

881 
	gªs1_0
 = 
vgë_low_s16
(
ªs5
);

882 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

883 
	gl0
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

885 
	gªs0_0
 = 
vgë_low_s16
(
ªs6
);

886 
	gªs1_0
 = 
vgë_low_s16
(
ªs7
);

888 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

889 
	gl1
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

891 
öt32x4x2_t
 
	gåes2
 = 
vånq_s32
(
l0
, 
l1
);

894 
öt16x8_t
 
	gå™•_ªs0
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_low_s32
(
åes1
.
vÆ
[0]), vgë_low_s32(
åes2
.val[0])));

895 
öt16x8_t
 
	gå™•_ªs1
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_high_s32
(
åes1
.
vÆ
[0]), vgë_high_s32(
åes2
.val[0])));

896 
öt16x8_t
 
	gå™•_ªs2
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_low_s32
(
åes1
.
vÆ
[1]), vgë_low_s32(
åes2
.val[1])));

897 
öt16x8_t
 
	gå™•_ªs3
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_high_s32
(
åes1
.
vÆ
[1]), vgë_high_s32(
åes2
.val[1])));

900 
	gªs0_0
 = 
vgë_high_s16
(
ªs0
);

901 
	gªs1_0
 = 
vgë_high_s16
(
ªs1
);

902 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

903 
	gl0
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

905 
	gªs0_0
 = 
vgë_high_s16
(
ªs2
);

906 
	gªs1_0
 = 
vgë_high_s16
(
ªs3
);

908 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

909 
	gl1
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

911 
	gåes1
 = 
vånq_s32
(
l0
, 
l1
);

914 
	gªs0_0
 = 
vgë_high_s16
(
ªs4
);

915 
	gªs1_0
 = 
vgë_high_s16
(
ªs5
);

916 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

917 
	gl0
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

919 
	gªs0_0
 = 
vgë_high_s16
(
ªs6
);

920 
	gªs1_0
 = 
vgë_high_s16
(
ªs7
);

922 
	gåes
 = 
vån_s16
(
ªs0_0
, 
ªs1_0
);

923 
	gl1
 = 
vcomböe_s32
(
vªöãΩªt_s32_s16
(
åes
.
vÆ
[0]),vreinterpret_s32_s16(tres.val[1]));

925 
	gåes2
 = 
vånq_s32
(
l0
, 
l1
);

928 
öt16x8_t
 
	gå™•_ªs4
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_low_s32
(
åes1
.
vÆ
[0]), vgë_low_s32(
åes2
.val[0])));

929 
öt16x8_t
 
	gå™•_ªs5
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_high_s32
(
åes1
.
vÆ
[0]), vgë_high_s32(
åes2
.val[0])));

930 
öt16x8_t
 
	gå™•_ªs6
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_low_s32
(
åes1
.
vÆ
[1]), vgë_low_s32(
åes2
.val[1])));

931 
öt16x8_t
 
	gå™•_ªs7
 = 
vªöãΩªtq_s16_s32
(
vcomböe_s32
(
vgë_high_s32
(
åes1
.
vÆ
[1]), vgë_high_s32(
åes2
.val[1])));

934 
	#STORE_DESCALED
(
addr
, 
ªg
, 
mul_addr
Ë
po°sˇÀ_löe
 = 
	`vld1q_s16
((mul_addr)); \

935 
mask
 = 
	`vªöãΩªtq_s16_u16
(
	`v˛tq_s16
((
ªg
), 
z
)); \

936 
ªg
 = 
	`vabsq_s16
(reg); \

937 
ªg
 = 
	`vqdmulhq_s16
(
	`vqaddq_s16
(‘eg), (ªg)), 
po°sˇÀ_löe
); \

938 
ªg
 = 
	`vsubq_s16
(
	`ve‹q_s16
‘eg, 
mask
), mask); \

939 
	`v°1q_s16
((
addr
), 
ªg
);

	)

941 
öt16x8_t
 
	gz
 = 
vdupq_n_s16
(0), 
	gpo°sˇÀ_löe
, 
	gmask
;

944 
	gx0
 = 
å™•_ªs0
; 
	gx1
 = 
å™•_ªs7
;

945 
	gx2
 = 
å™•_ªs3
; 
	gx3
 = 
å™•_ªs4
;

947 
	gx4
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx0
 = 
vsubq_s16
(x0, x1);

948 
	gx1
 = 
vaddq_s16
(
x2
, 
x3
); 
	gx2
 = 
vsubq_s16
(x2, x3);

950 
	gt1
 = 
x0
; 
	gt2
 = 
x2
;

952 
	gx2
 = 
vaddq_s16
(
x4
, 
x1
); 
	gx4
 = 
vsubq_s16
(x4, x1);

954 
	gx0
 = 
å™•_ªs1
;

955 
	gx3
 = 
å™•_ªs6
;

957 
	gx1
 = 
vaddq_s16
(
x0
, 
x3
); 
	gx0
 = 
vsubq_s16
(x0, x3);

959 
	gt3
 = 
x0
;

961 
	gx0
 = 
å™•_ªs2
; 
	gx3
 = 
å™•_ªs5
;

963 
	gt4
 = 
vsubq_s16
(
x0
, 
x3
);

965 
	gx0
 = 
vaddq_s16
(
x0
, 
x3
);

967 
	gx3
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx0
 = 
vsubq_s16
(x0, x1);

968 
	gx1
 = 
vaddq_s16
(
x2
, 
x3
); 
	gx2
 = 
vsubq_s16
(x2, x3);

970 
STORE_DESCALED
(
d°
, 
x1
, 
po°sˇÀ
);

971 
STORE_DESCALED
(
d°
 + 4*8, 
x2
, 
po°sˇÀ
 + 4*8);

973 
	gx0
 = 
vqdmulhq_n_s16
(
vsubq_s16
(
x0
, 
x4
), ()(
C0_707
*2));

975 
	gx1
 = 
vaddq_s16
(
x4
, 
x0
); 
	gx4
 = 
vsubq_s16
(x4, x0);

977 
STORE_DESCALED
(
d°
 + 2*8, 
x4
,
po°sˇÀ
 + 2*8);

978 
STORE_DESCALED
(
d°
 + 6*8, 
x1
,
po°sˇÀ
 + 6*8);

980 
	gx0
 = 
t2
; 
	gx1
 = 
t4
;

981 
	gx2
 = 
t3
; 
	gx3
 = 
t1
;

983 
	gx0
 = 
vaddq_s16
(
x0
, 
x1
); 
	gx1
 = vaddq_s16(x1, 
x2
); 
	gx2
 = vaddq_s16(x2, 
x3
);

985 
	gx1
 =
vqdmulhq_n_s16
(
x1
, ()(
C0_707
*2));

987 
	gx4
 = 
vaddq_s16
(
x1
, 
x3
); 
	gx3
 = 
vsubq_s16
(x3, x1);

989 
	gx1
 = 
vqdmulhq_n_s16
(
vsubq_s16
(
x0
, 
x2
), ()(
C0_382
*2));

990 
	gx0
 = 
vaddq_s16
(
vqdmulhq_n_s16
(
x0
, ()(
C0_541
*2)), 
x1
);

991 
	gx2
 = 
vaddq_s16
(
vshlq_n_s16
(
vqdmulhq_n_s16
(
x2
, ()
C1_306
), 1), 
x1
);

993 
	gx1
 = 
vaddq_s16
(
x0
, 
x3
); 
	gx3
 = 
vsubq_s16
(x3, x0);

994 
	gx0
 = 
vaddq_s16
(
x4
, 
x2
); 
	gx4
 = 
vsubq_s16
(x4, x2);

996 
STORE_DESCALED
(
d°
 + 5*8, 
x1
,
po°sˇÀ
 + 5*8);

997 
STORE_DESCALED
(
d°
 + 1*8, 
x0
,
po°sˇÀ
 + 1*8);

998 
STORE_DESCALED
(
d°
 + 7*8, 
x4
,
po°sˇÀ
 + 7*8);

999 
STORE_DESCALED
(
d°
 + 3*8, 
x3
,
po°sˇÀ
 + 3*8);

1004 
Øn_fd˘8x8
–c⁄° *
§c
, *
d°
,

1005 
°ï
, c⁄° *
po°sˇÀ
 )

1007 
	gw‹k•a˚
[64], *
	gw‹k
 = 
w‹k•a˚
;

1008 
	gi
;

1011  
	gi
 = 8; i > 0; i--, 
	g§c
 +
°ï
, 
	gw‹k
 += 8 )

1013 
x0
 = 
§c
[0], 
	gx1
 = src[7];

1014 
	gx2
 = 
§c
[3], 
	gx3
 = src[4];

1016 
	gx4
 = 
x0
 + 
x1
; 
	gx0
 -= x1;

1017 
	gx1
 = 
x2
 + 
x3
; 
	gx2
 -= x3;

1019 
	gw‹k
[7] = 
x0
; w‹k[1] = 
x2
;

1020 
	gx2
 = 
x4
 + 
x1
; 
	gx4
 -= x1;

1022 
	gx0
 = 
§c
[1]; 
	gx3
 = src[6];

1023 
	gx1
 = 
x0
 + 
x3
; 
	gx0
 -= x3;

1024 
	gw‹k
[5] = 
x0
;

1026 
	gx0
 = 
§c
[2]; 
	gx3
 = src[5];

1027 
	gw‹k
[3] = 
x0
 - 
x3
; 
	gx0
 += x3;

1029 
	gx3
 = 
x0
 + 
x1
; 
	gx0
 -= x1;

1030 
	gx1
 = 
x2
 + 
x3
; 
	gx2
 -= x3;

1032 
	gw‹k
[0] = 
x1
; w‹k[4] = 
x2
;

1034 
	gx0
 = 
DCT_DESCALE
((
x0
 - 
x4
)*
C0_707
, 
fixb
);

1035 
	gx1
 = 
x4
 + 
x0
; 
	gx4
 -= x0;

1036 
	gw‹k
[2] = 
x4
; w‹k[6] = 
x1
;

1038 
	gx0
 = 
w‹k
[1]; 
	gx1
 = work[3];

1039 
	gx2
 = 
w‹k
[5]; 
	gx3
 = work[7];

1041 
	gx0
 +
x1
; 
	gx1
 +
x2
; 
	gx2
 +
x3
;

1042 
	gx1
 = 
DCT_DESCALE
(
x1
*
C0_707
, 
fixb
);

1044 
	gx4
 = 
x1
 + 
x3
; 
	gx3
 -= x1;

1045 
	gx1
 = (
x0
 - 
x2
)*
C0_382
;

1046 
	gx0
 = 
DCT_DESCALE
(
x0
*
C0_541
 + 
x1
, 
fixb
);

1047 
	gx2
 = 
DCT_DESCALE
(
x2
*
C1_306
 + 
x1
, 
fixb
);

1049 
	gx1
 = 
x0
 + 
x3
; 
	gx3
 -= x0;

1050 
	gx0
 = 
x4
 + 
x2
; 
	gx4
 -= x2;

1052 
	gw‹k
[5] = 
x1
; w‹k[1] = 
x0
;

1053 
	gw‹k
[7] = 
x4
; w‹k[3] = 
x3
;

1056 
	gw‹k
 = 
w‹k•a˚
;

1058  
	gi
 = 8; i > 0; i--, 
	gw‹k
++, 
	gpo°sˇÀ
 +8, 
	gd°
 += 8 )

1060 
x0
 = 
w‹k
[8*0], 
	gx1
 = work[8*7];

1061 
	gx2
 = 
w‹k
[8*3], 
	gx3
 = work[8*4];

1063 
	gx4
 = 
x0
 + 
x1
; 
	gx0
 -= x1;

1064 
	gx1
 = 
x2
 + 
x3
; 
	gx2
 -= x3;

1066 
	gw‹k
[8*7] = 
x0
; w‹k[8*0] = 
x2
;

1067 
	gx2
 = 
x4
 + 
x1
; 
	gx4
 -= x1;

1069 
	gx0
 = 
w‹k
[8*1]; 
	gx3
 = work[8*6];

1070 
	gx1
 = 
x0
 + 
x3
; 
	gx0
 -= x3;

1071 
	gw‹k
[8*4] = 
x0
;

1073 
	gx0
 = 
w‹k
[8*2]; 
	gx3
 = work[8*5];

1074 
	gw‹k
[8*3] = 
x0
 - 
x3
; 
	gx0
 += x3;

1076 
	gx3
 = 
x0
 + 
x1
; 
	gx0
 -= x1;

1077 
	gx1
 = 
x2
 + 
x3
; 
	gx2
 -= x3;

1079 
	gd°
[0] = ()
DCT_DESCALE
(
x1
*
po°sˇÀ
[0], 
po°shi·
);

1080 
	gd°
[4] = ()
DCT_DESCALE
(
x2
*
po°sˇÀ
[4], 
po°shi·
);

1082 
	gx0
 = 
DCT_DESCALE
((
x0
 - 
x4
)*
C0_707
, 
fixb
);

1083 
	gx1
 = 
x4
 + 
x0
; 
	gx4
 -= x0;

1085 
	gd°
[2] = ()
DCT_DESCALE
(
x4
*
po°sˇÀ
[2], 
po°shi·
);

1086 
	gd°
[6] = ()
DCT_DESCALE
(
x1
*
po°sˇÀ
[6], 
po°shi·
);

1088 
	gx0
 = 
w‹k
[8*0]; 
	gx1
 = work[8*3];

1089 
	gx2
 = 
w‹k
[8*4]; 
	gx3
 = work[8*7];

1091 
	gx0
 +
x1
; 
	gx1
 +
x2
; 
	gx2
 +
x3
;

1092 
	gx1
 = 
DCT_DESCALE
(
x1
*
C0_707
, 
fixb
);

1094 
	gx4
 = 
x1
 + 
x3
; 
	gx3
 -= x1;

1095 
	gx1
 = (
x0
 - 
x2
)*
C0_382
;

1096 
	gx0
 = 
DCT_DESCALE
(
x0
*
C0_541
 + 
x1
, 
fixb
);

1097 
	gx2
 = 
DCT_DESCALE
(
x2
*
C1_306
 + 
x1
, 
fixb
);

1099 
	gx1
 = 
x0
 + 
x3
; 
	gx3
 -= x0;

1100 
	gx0
 = 
x4
 + 
x2
; 
	gx4
 -= x2;

1102 
	gd°
[5] = ()
DCT_DESCALE
(
x1
*
po°sˇÀ
[5], 
po°shi·
);

1103 
	gd°
[1] = ()
DCT_DESCALE
(
x0
*
po°sˇÀ
[1], 
po°shi·
);

1104 
	gd°
[7] = ()
DCT_DESCALE
(
x4
*
po°sˇÀ
[7], 
po°shi·
);

1105 
	gd°
[3] = ()
DCT_DESCALE
(
x3
*
po°sˇÀ
[3], 
po°shi·
);

1110 
	gMŸi⁄J≥gWrôî
::
wrôeFømeD©a
–c⁄° 
uch¨
* 
d©a
, 
°ï
, 
cﬁ‹•a˚
, 
öput_ch™√ls
 )

1113 
boﬁ
 
	göô_ˇt_èbÀ
 = 
Ál£
;

1114 c⁄° 
	gCAT_TAB_SIZE
 = 4096;

1115 
uch¨
 
	gˇt_èbÀ
[
CAT_TAB_SIZE
*2+1];

1116 if–!
	göô_ˇt_èbÀ
 )

1118  
	gi
 = -
CAT_TAB_SIZE
; i <= CAT_TAB_SIZE; i++ )

1120 
Cv32suf
 
	ga
;

1121 
	ga
.
	gf
 = ()
i
;

1122 
	gˇt_èbÀ
[
i
+
CAT_TAB_SIZE
] = ((
a
.i >> 23) & 255) - (126 & (i ? -1 : 0));

1124 
	göô_ˇt_èbÀ
 = 
åue
;

1128 
CV_As£π
–
d©a
 && 
width
 > 0 && 
height
 > 0 );

1136 
	gx
, 
	gy
;

1137 
	gi
, 
	gj
;

1138 c⁄° 
	gmax_quÆôy
 = 12;

1139 
	gfd˘_qèb
[2][64];

1140 
	ghuff_dc_èb
[2][16];

1141 
	ghuff_ac_èb
[2][256];

1143 
	gx_sˇÀ
 = 
ch™√ls
 > 1 ? 2 : 1, 
	gy_sˇÀ
 = 
x_sˇÀ
;

1144 
	gdc_¥ed
[] = { 0, 0, 0 };

1145 
	gx_°ï
 = 
x_sˇÀ
 * 8;

1146 
	gy_°ï
 = 
y_sˇÀ
 * 8;

1147 
	gblock
[6][64];

1148 
	gbuf„r
[4096];

1149 * 
	ghbuf„r
 = (*)
buf„r
;

1150 
	gluma_cou¡
 = 
x_sˇÀ
*
y_sˇÀ
;

1151 
	gblock_cou¡
 = 
luma_cou¡
 + 
ch™√ls
 - 1;

1152 
	gY_°ï
 = 
x_sˇÀ
*8;

1153 c⁄° 
	gUV_°ï
 = 16;

1154 
	gu_∂™e_ofs
 = 
°ï
*
height
;

1155 
	gv_∂™e_ofs
 = 
u_∂™e_ofs
 + 
°ï
*
height
;

1156 
	g_quÆôy
 = 
quÆôy
*0.01*
max_quÆôy
;

1158 if–
	g_quÆôy
 < 1. ) _quality = 1.;

1159 if–
	g_quÆôy
 > 
	gmax_quÆôy
 ) _quÆôy = 
max_quÆôy
;

1161 
	göv_quÆôy
 = 1./
_quÆôy
;

1164 
	g°rm
.
putByãs
–(c⁄° 
uch¨
*)
j≥gHódî
, (jpegHeader) - 1 );

1167  
	gi
 = 0; i < (
	gch™√ls
 > 1 ? 2 : 1); i++ )

1169 c⁄° 
uch¨
* 
	gqèbÀ
 = 
i
 =0 ? 
j≥gTabÀK1_T
 : 
j≥gTabÀK2_T
;

1170 
	gchroma_sˇÀ
 = 
i
 > 0 ? 
luma_cou¡
 : 1;

1172 
	g°rm
.
jputSh‹t
( 0xffdb );

1173 
	g°rm
.
jputSh‹t
( 2 + 65*1 );

1174 
	g°rm
.
putByã
–0*16 + 
i
 );

1177  
	gj
 = 0; j < 64; j++ )

1179 
	gidx
 = 
zigzag
[
j
];

1180 
	gqvÆ
 = 
cvRound
(
qèbÀ
[
idx
]*
öv_quÆôy
);

1181 if–
	gqvÆ
 < 1 )

1182 
	gqvÆ
 = 1;

1183 if–
	gqvÆ
 > 255 )

1184 
	gqvÆ
 = 255;

1185 
	gfd˘_qèb
[
i
][
idx
] = ()(
cvRound
((1 << (
po°shi·
 + 11)))/

1186 (
qvÆ
*
chroma_sˇÀ
*
id˘_¥esˇÀ
[
idx
]));

1187 
	g°rm
.
putByã
–
qvÆ
 );

1192  
	gi
 = 0; i < (
	gch™√ls
 > 1 ? 4 : 2); i++ )

1194 c⁄° 
uch¨
* 
	ghèbÀ
 = 
i
 =0 ? 
j≥gTabÀK3
 : i =1 ? 
j≥gTabÀK5
 :

1195 
i
 =2 ? 
j≥gTabÀK4
 : 
j≥gTabÀK6
;

1196 
	gis_ac_èb
 = 
i
 & 1;

1197 
	gidx
 = 
i
 >= 2;

1198 
	gèbÀSize
 = 16 + (
is_ac_èb
 ? 162 : 12);

1200 
	g°rm
.
jputSh‹t
( 0xFFC4 );

1201 
	g°rm
.
jputSh‹t
–3 + 
èbÀSize
 );

1202 
	g°rm
.
putByã
–
is_ac_èb
*16 + 
idx
 );

1203 
	g°rm
.
putByãs
–
hèbÀ
, 
èbÀSize
 );

1205 
	gBôSåóm
::
¸óãEncodeHuffm™TabÀ
–
BôSåóm
::
¸óãSour˚Huffm™TabÀ
(

1206 
hèbÀ
, 
hbuf„r
, 16, 9 ), 
is_ac_èb
 ? 
huff_ac_èb
[
idx
] :

1207 
huff_dc_èb
[
idx
], 
is_ac_èb
 ? 256 : 16 );

1211 
	g°rm
.
jputSh‹t
( 0xFFC0 );

1212 
	g°rm
.
jputSh‹t
–8 + 3*
ch™√ls
 );

1213 
	g°rm
.
putByã
( 8 );

1214 
	g°rm
.
jputSh‹t
–
height
 );

1215 
	g°rm
.
jputSh‹t
–
width
 );

1216 
	g°rm
.
putByã
–
ch™√ls
 );

1218  
	gi
 = 0; i < 
	gch™√ls
; i++ )

1220 
	g°rm
.
putByã
–
i
 + 1 );

1221 if–
	gi
 == 0 )

1222 
°rm
.
putByã
(
x_sˇÀ
*16 + 
y_sˇÀ
);

1224 
	g°rm
.
putByã
(1*16 + 1);

1225 
	g°rm
.
putByã
–
i
 > 0 );

1229 
	g°rm
.
jputSh‹t
( 0xFFDA );

1230 
	g°rm
.
jputSh‹t
–6 + 2*
ch™√ls
 );

1231 
	g°rm
.
putByã
–
ch™√ls
 );

1233  
	gi
 = 0; i < 
	gch™√ls
; i++ )

1235 
	g°rm
.
putByã
–
i
+1 );

1236 
	g°rm
.
putByã
–(
i
>0)*16 + (i>0) );

1239 
	g°rm
.
jputSh‹t
(0*256 + 63);

1242 
	g°rm
.
putByã
( 0 );

1244 
	gcuºvÆ
 = 0, 
	gcode
 = 0, 
	gãmpvÆ
 = 0;

1245 
	gbô_idx
 = 32;

1247 
	#JPUT_BITS
(
vÆ
, 
bôs
) \

1248 
bô_idx
 -(
bôs
); \

1249 
ãmpvÆ
 = (
vÆ
Ë& 
bô_mask
[(
bôs
)]; \

1250 if–
bô_idx
 <= 0 ) \

1252 
°rm
.
	`jput
(
cuºvÆ
 | (()
ãmpvÆ
 >> -
bô_idx
)); \

1253 
bô_idx
 += 32; \

1254 
cuºvÆ
 = 
bô_idx
 < 32 ? (
ãmpvÆ
 << bit_idx) : 0; \

1257 
cuºvÆ
 |(
ãmpvÆ
 << 
bô_idx
)

	)

1259 
	#JPUT_HUFF
(
vÆ
, 
èbÀ
) \

1260 
code
 = 
èbÀ
[(
vÆ
) + 2]; \

1261 
	`JPUT_BITS
(
code
 >> 8, ()(codê& 255))

	)

1264  
	gy
 = 0; y < 
	gheight
; y +
y_°ï
, 
	gd©a
 +y_°ï*
°ï
 )

1266  
x
 = 0; 
	gx
 < 
	gwidth
; x +
x_°ï
 )

1268 
x_limô
 = 
x_°ï
;

1269 
	gy_limô
 = 
y_°ï
;

1270 c⁄° 
uch¨
* 
	gpix_d©a
 = 
d©a
 + 
x
*
öput_ch™√ls
;

1271 * 
	gY_d©a
 = 
block
[0];

1273 if–
	gx
 + 
	gx_limô
 > 
	gwidth
 ) x_limô = 
width
 - 
x
;

1274 if–
	gy
 + 
	gy_limô
 > 
	gheight
 ) y_limô = 
height
 - 
y
;

1276 
mem£t
–
block
, 0, 
block_cou¡
*64*(block[0][0]));

1278 if–
	gch™√ls
 > 1 )

1280 * 
	gUV_d©a
 = 
block
[
luma_cou¡
];

1283 if–
	gcﬁ‹•a˚
 =
COLORSPACE_YUV444P
 && 
y_limô
 =16 && 
x_limô
 == 16 )

1285  
i
 = 0; 
	gi
 < 
	gy_limô
; i +2, 
	gpix_d©a
 +
°ï
*2, 
	gY_d©a
 +
Y_°ï
*2, 
	gUV_d©a
 +
UV_°ï
 )

1287 #ifde‡
WITH_NEON


1289 
uöt16x8_t
 
masklo
 = 
vdupq_n_u16
(255);

1290 
uöt16x8_t
 
	gœ√
 = 
vld1q_u16
((*)(
pix_d©a
+
v_∂™e_ofs
));

1291 
uöt16x8_t
 
	gt1
 = 
vaddq_u16
(
vshrq_n_u16
(
œ√
, 8), 
v™dq_u16
÷™e, 
masklo
));

1292 
	gœ√
 = 
vld1q_u16
((*)(
pix_d©a
 + 
v_∂™e_ofs
 + 
°ï
));

1293 
uöt16x8_t
 
	gt2
 = 
vaddq_u16
(
vshrq_n_u16
(
œ√
, 8), 
v™dq_u16
÷™e, 
masklo
));

1294 
	gt1
 = 
vaddq_u16
(
t1
, 
t2
);

1295 
v°1q_s16
(
UV_d©a
, 
vsubq_s16
(
vªöãΩªtq_s16_u16
(
t1
), 
vdupq_n_s16
(128*4)));

1297 
	gœ√
 = 
vld1q_u16
((*)(
pix_d©a
+
u_∂™e_ofs
));

1298 
	gt1
 = 
vaddq_u16
(
vshrq_n_u16
(
œ√
, 8), 
v™dq_u16
÷™e, 
masklo
));

1299 
	gœ√
 = 
vld1q_u16
((*)(
pix_d©a
 + 
u_∂™e_ofs
 + 
°ï
));

1300 
	gt2
 = 
vaddq_u16
(
vshrq_n_u16
(
œ√
, 8), 
v™dq_u16
÷™e, 
masklo
));

1301 
	gt1
 = 
vaddq_u16
(
t1
, 
t2
);

1302 
v°1q_s16
(
UV_d©a
 + 8, 
vsubq_s16
(
vªöãΩªtq_s16_u16
(
t1
), 
vdupq_n_s16
(128*4)));

1306 
öt16x8_t
 
	gœ√
 = 
vªöãΩªtq_s16_u16
(
vmovl_u8
(
vld1_u8
(
pix_d©a
)));

1307 
öt16x8_t
 
	gdñè
 = 
vdupq_n_s16
(128);

1308 
	gœ√
 = 
vsubq_s16
(
œ√
, 
dñè
);

1309 
v°1q_s16
(
Y_d©a
, 
œ√
);

1311 
	gœ√
 = 
vªöãΩªtq_s16_u16
(
vmovl_u8
(
vld1_u8
(
pix_d©a
+8)));

1312 
	gœ√
 = 
vsubq_s16
(
œ√
, 
dñè
);

1313 
v°1q_s16
(
Y_d©a
 + 8, 
œ√
);

1315 
	gœ√
 = 
vªöãΩªtq_s16_u16
(
vmovl_u8
(
vld1_u8
(
pix_d©a
+
°ï
)));

1316 
	gœ√
 = 
vsubq_s16
(
œ√
, 
dñè
);

1317 
v°1q_s16
(
Y_d©a
+
Y_°ï
, 
œ√
);

1319 
	gœ√
 = 
vªöãΩªtq_s16_u16
(
vmovl_u8
(
vld1_u8
(
pix_d©a
 + 
°ï
 + 8)));

1320 
	gœ√
 = 
vsubq_s16
(
œ√
, 
dñè
);

1321 
v°1q_s16
(
Y_d©a
+
Y_°ï
 + 8, 
œ√
);

1324  
	gj
 = 0; j < 
	gx_limô
; j +2, 
	gpix_d©a
 += 2 )

1326 
Y_d©a
[
j
] = 
pix_d©a
[0] - 128;

1327 
	gY_d©a
[
j
+1] = 
pix_d©a
[1] - 128;

1328 
	gY_d©a
[
j
+
Y_°ï
] = 
pix_d©a
[
°ï
] - 128;

1329 
	gY_d©a
[
j
+
Y_°ï
+1] = 
pix_d©a
[
°ï
+1] - 128;

1331 
	gUV_d©a
[
j
>>1] = 
pix_d©a
[
v_∂™e_ofs
] +Öix_data[v_plane_ofs+1] +

1332 
pix_d©a
[
v_∂™e_ofs
+
°ï
] +Öix_data[v_plane_ofs+step+1] - 128*4;

1333 
	gUV_d©a
[(
j
>>1)+8] = 
pix_d©a
[
u_∂™e_ofs
] +Öix_data[u_plane_ofs+1] +

1334 
pix_d©a
[
u_∂™e_ofs
+
°ï
] +Öix_data[u_plane_ofs+step+1] - 128*4;

1338 
	gpix_d©a
 -
x_limô
*
öput_ch™√ls
;

1344  
	gi
 = 0; i < 
	gy_limô
; i++, 
	gpix_d©a
 +
°ï
, 
	gY_d©a
 +
Y_°ï
 )

1346  
j
 = 0; 
	gj
 < 
	gx_limô
; j++, 
	gpix_d©a
 +
öput_ch™√ls
 )

1348 
Y
, 
U
, 
V
;

1350 if–
	gcﬁ‹•a˚
 =
COLORSPACE_BGR
 )

1352 
r
 = 
pix_d©a
[2];

1353 
	gg
 = 
pix_d©a
[1];

1354 
	gb
 = 
pix_d©a
[0];

1356 
	gY
 = 
DCT_DESCALE
–
r
*
y_r
 + 
g
*
y_g
 + 
b
*
y_b
, 
fixc
) - 128;

1357 
	gU
 = 
DCT_DESCALE
–
r
*
cb_r
 + 
g
*
cb_g
 + 
b
*
cb_b
, 
fixc
 );

1358 
	gV
 = 
DCT_DESCALE
–
r
*
¸_r
 + 
g
*
¸_g
 + 
b
*
¸_b
, 
fixc
 );

1360 if–
	gcﬁ‹•a˚
 =
COLORSPACE_RGBA
 )

1362 
r
 = 
pix_d©a
[0];

1363 
	gg
 = 
pix_d©a
[1];

1364 
	gb
 = 
pix_d©a
[2];

1366 
	gY
 = 
DCT_DESCALE
–
r
*
y_r
 + 
g
*
y_g
 + 
b
*
y_b
, 
fixc
) - 128;

1367 
	gU
 = 
DCT_DESCALE
–
r
*
cb_r
 + 
g
*
cb_g
 + 
b
*
cb_b
, 
fixc
 );

1368 
	gV
 = 
DCT_DESCALE
–
r
*
¸_r
 + 
g
*
¸_g
 + 
b
*
¸_b
, 
fixc
 );

1372 
	gY
 = 
pix_d©a
[0] - 128;

1373 
	gU
 = 
pix_d©a
[
v_∂™e_ofs
] - 128;

1374 
	gV
 = 
pix_d©a
[
u_∂™e_ofs
] - 128;

1377 
	gj2
 = 
j
 >> (
x_sˇÀ
 - 1);

1378 
	gY_d©a
[
j
] = ()
Y
;

1379 
	gUV_d©a
[
j2
] = ()(
UV_d©a
[j2] + 
U
);

1380 
	gUV_d©a
[
j2
 + 8] = ()(
UV_d©a
[j2 + 8] + 
V
);

1383 
	gpix_d©a
 -
x_limô
*
öput_ch™√ls
;

1384 if–((
	gi
+1Ë& (
	gy_sˇÀ
 - 1)) == 0 )

1386 
UV_d©a
 +
UV_°ï
;

1395  
	gi
 = 0; i < 
	gy_limô
; i++, 
	gpix_d©a
 +
°ï
, 
	gY_d©a
 +
Y_°ï
 )

1397  
j
 = 0; 
	gj
 < 
	gx_limô
; j++ )

1398 
	gY_d©a
[
j
] = ()(
pix_d©a
[j]*4 - 128*4);

1402  
	gi
 = 0; i < 
	gblock_cou¡
; i++ )

1404 
	gis_chroma
 = 
i
 >
luma_cou¡
;

1405 
	g§c_°ï
 = 
x_sˇÀ
 * 8;

1406 
	grun
 = 0, 
	gvÆ
;

1407 c⁄° * 
	g§c_±r
 = 
block
[
i
 & -2] + (i & 1)*8;

1408 c⁄° * 
	ghèbÀ
 = 
huff_ac_èb
[
is_chroma
];

1411 
Øn_fd˘8x8
–
§c_±r
, 
buf„r
, 
§c_°ï
, 
fd˘_qèb
[
is_chroma
] );

1414 
	gj
 = 
is_chroma
 + (
i
 > 
luma_cou¡
);

1415 
	gvÆ
 = 
buf„r
[0] - 
dc_¥ed
[
j
];

1416 
	gdc_¥ed
[
j
] = 
buf„r
[0];

1419 
	gˇt
 = 
ˇt_èbÀ
[
vÆ
 + 
CAT_TAB_SIZE
];

1422 
JPUT_HUFF
–
ˇt
, 
huff_dc_èb
[
is_chroma
] );

1423 
JPUT_BITS
–
vÆ
 - (vÆ < 0 ? 1 : 0), 
ˇt
 );

1426  
	gj
 = 1; j < 64; j++ )

1428 
	gvÆ
 = 
buf„r
[
zigzag
[
j
]];

1430 if–
	gvÆ
 == 0 )

1432 
run
++;

1436  
	grun
 >= 16 )

1438 
JPUT_HUFF
–0xF0, 
hèbÀ
 );

1439 
	grun
 -= 16;

1443 
	gˇt
 = 
ˇt_èbÀ
[
vÆ
 + 
CAT_TAB_SIZE
];

1445 
JPUT_HUFF
–
ˇt
 + 
run
*16, 
hèbÀ
 );

1446 
JPUT_BITS
–
vÆ
 - (vÆ < 0 ? 1 : 0), 
ˇt
 );

1449 
	grun
 = 0;

1453 if–
	grun
 )

1455 
JPUT_HUFF
–0x00, 
hèbÀ
 );

1462 
	g°rm
.
jÊush
(
cuºvÆ
, 
bô_idx
);

1463 
	g°rm
.
jputSh‹t
( 0xFFD9 );

1467 
size_t
 
	gpos
 = 
°rm
.
gëPos
();

1468 
size_t
 
	gpos1
 = (
pos
 + 3) & ~3;

1469  ; 
	gpos
 < 
	gpos1
;Öos++ )

1470 
	g°rm
.
putByã
(0);

1475 
	gPå
<
	gIVideoWrôî
> 
	$¸óãMŸi⁄J≥gWrôî
–c⁄° 
Såög
& 
fûíame
, 
Âs
, 
Size
 
‰ameSize
, 
boﬁ
 
iscﬁ‹
 )

1477 
På
<
IVideoWrôî
> 
iwrôî
 = 
makePå
<
mj≥g
::
MŸi⁄J≥gWrôî
>(
fûíame
, 
Âs
, 
‰ameSize
, 
iscﬁ‹
);

1478 if–!
iwrôî
->
	`isO≥√d
() )

1479 
iwrôî
.
	`ªÀa£
();

1480  
iwrôî
;

1481 
	}
}

	@src/cap_msmf.cpp

41 
	~"¥ecomp.hµ
"

42 #i‡(
deföed
 
WIN32
 || deföed 
_WIN32
Ë&& deföed 
HAVE_MSMF


51 #i‡
WINVER
 < 
_WIN32_WINNT_WIN7


52 #unde‡
WINVER


53 
	#WINVER
 
_WIN32_WINNT_WIN7


	)

55 #i‡
deföed
 
_MSC_VER
 && _MSC_VER >= 1600

56 
	#HAVE_CONCURRENCY


	)

58 
	~<wödows.h
>

59 
	~<guiddef.h
>

60 
	~<mfidl.h
>

61 
	~<MÁpi.h
>

62 
	~<mÂœy.h
>

63 
	~<mfobje˘s.h
>

64 
	~<tch¨.h
>

65 
	~<°rß„.h
>

66 
	~<M‰ódwrôe.h
>

67 
	~<√w
>

68 
	~<m≠
>

69 
	~<ve˘‹
>

70 
	~<°rög
>

71 
	~<°dio.h
>

72 
	~<°d¨g.h
>

73 
	~<°rög.h
>

75 #ifde‡
_MSC_VER


76 #¥agm®
w¨nög
(
dißbÀ
:4503)

77 #¥agm®
commít
(
lib
, "mfplat")

78 #¥agm®
commít
(
lib
, "mf")

79 #¥agm®
commít
(
lib
, "mfuuid")

80 #¥agm®
commít
(
lib
, "Strmiids")

81 #¥agm®
commít
(
lib
, "Mfreadwrite")

82 #i‡(
WINVER
 >= 0x0602)

83 #¥agm®
commít
(
lib
, "MinCore_Downlevel")

87 
	~<m„º‹.h
>

89 #ifde‡
WINRT


91 
	~<wæ/˛õ¡.h
>

92 #ifde‡
__˝lu•lus_wöπ


93 
	~<agûe.h
>

94 
	~<vcc‹lib.h
>

97 
	~<wæ\async.h
>

98 
	~<wæ\im∂emíts.h
>

99 
	~<wæ\moduÀ.h
>

100 
	~<wæ\wøµîs\c‹ewøµîs.h
>

101 
	~<wödows.medü.ˇ±uª.h
>

102 
	~<wödows.devi˚s.íumî©i⁄.h
>

103 #ifde‡
HAVE_CONCURRENCY


104 
	~<c⁄¸t.h
>

105 #i‚de‡
__˝lu•lus_wöπ


106 
	$__de˛•ec
(
n‹ëu∫
Ë
__°dˇŒ
 
	`__abi_WöRTøi£Ex˚±i⁄
();

108 
ölöe
 
	$__abi_ThrowIfFaûed
(
__hrArg
)

110 i‡(
__hrArg
 < 0)

112 
	`__abi_WöRTøi£Ex˚±i⁄
(
__hrArg
);

114 
	}
}

116 
	sGuid


118 
	mpublic
:

119 
Guid
();

120 
Guid
(
__rcGUID_t
);

121 
	m›î©‹
 ::
__rcGUID_t
();

122 
boﬁ
 
EquÆs
(
Guid
 
__guidArg
);

123 
boﬁ
 
EquÆs
(
__rcGUID_t
 
__guidArg
);

124 
Guid
(
__aArg
, 
__bArg
, 
__cArg
, 
__öt8
 
__dArg
,

125 
__öt8
 
__eArg
, __öt8 
__fArg
, __öt8 
__gArg
, __öt8 
__hArg
,

126 
__öt8
 
__iArg
, __öt8 
__jArg
, __öt8 
__kArg
);

127 
Guid
(
__aArg
, 
__bArg
, 
__cArg
, c⁄° 
__öt8
* 
__dArg
);

128 
	m¥iv©e
:

129 
__a
;

130 
	m__b
;

131 
	m__c
;

132 
	m__d
;

133 
	m__e
;

134 
	m__f
;

135 
	m__g
;

136 
	m__h
;

137 
	m__i
;

138 
	m__j
;

139 
	m__k
;

142 
°©ic_as£π
((
Guid
Ë=(::
_GUID
), "Incorect size for Guid");

143 
°©ic_as£π
((
__rcGUID_t
Ë=(::
_GUID
), "Incorect size for __rcGUID_t");

146 
ölöe
 
	gGuid
::
	$Guid
(Ë: 
	`__a
(0), 
	`__b
(0), 
	`__c
(0), 
	`__d
(0), 
	`__e
(0), 
	`__f
(0), 
	`__g
(0), 
	`__h
(0), 
	`__i
(0), 
	`__j
(0), 
	$__k
(0)

148 
	}
}

150 
ölöe
 
	gGuid
::
	$Guid
(
__rcGUID_t
 
__guid
) :

151 
	`__a
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a1
),

152 
	`__b
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a2
),

153 
	`__c
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a3
),

154 
	`__d
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[0]),

155 
	`__e
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[1]),

156 
	`__f
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[2]),

157 
	`__g
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[3]),

158 
	`__h
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[4]),

159 
	`__i
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[5]),

160 
	`__j
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[6]),

161 
	`__k
(
ªöãΩªt_ˇ°
<c⁄° 
__s_GUID
&>(
__guid
).
D©a4
[7])

163 
	}
}

165 
ölöe
 
	gGuid
::
›î©‹
 ::
	$__rcGUID_t
()

167  
ªöãΩªt_ˇ°
<
__rcGUID_t
>(*
this
);

168 
	}
}

170 
ölöe
 
boﬁ
 
	gGuid
::
	$EquÆs
(
Guid
 
__guidArg
)

172  *
this
 =
__guidArg
;

173 
	}
}

175 
ölöe
 
boﬁ
 
	gGuid
::
	$EquÆs
(
__rcGUID_t
 
__guidArg
)

177  *
this
 =
°©ic_ˇ°
< 
Guid
>(
__guidArg
);

178 
	}
}

180 
ölöe
 
boﬁ
 
	g›î©‹
==(
Guid
 
__aArg
, Guid 
	g__bArg
)

182 autÿ
	g__a
 = 
ªöãΩªt_ˇ°
<*>(&
__aArg
);

183 autÿ
	g__b
 = 
ªöãΩªt_ˇ°
<*>(&
__bArg
);

185  (
	g__a
[0] =
__b
[0] && 
__a
[1] == __b[1] && __a[2] == __b[2] && __a[3] == __b[3]);

188 
ölöe
 
boﬁ
 
	g›î©‹
!=(
Guid
 
__aArg
, Guid 
	g__bArg
)

190  !(
	g__aArg
 =
__bArg
);

193 
ölöe
 
boﬁ
 
	g›î©‹
<(
Guid
 
	g__aArg
, Guid 
	g__bArg
)

195 autÿ
	g__a
 = 
ªöãΩªt_ˇ°
<*>(&
__aArg
);

196 autÿ
	g__b
 = 
ªöãΩªt_ˇ°
<*>(&
__bArg
);

198 i‡(
	g__a
[0] !
__b
[0])

200  
__a
[0] < 
__b
[0];

203 i‡(
	g__a
[1] !
__b
[1])

205  
__a
[1] < 
__b
[1];

208 i‡(
	g__a
[2] !
__b
[2])

210  
__a
[2] < 
__b
[2];

213 i‡(
	g__a
[3] !
__b
[3])

215  
__a
[3] < 
__b
[3];

218  
	gÁl£
;

221 
ölöe
 
	gGuid
::
	$Guid
(
__aArg
, 
__bArg
, 
__cArg
, 
__öt8
 
__dArg
,

222 
__öt8
 
__eArg
, __öt8 
__fArg
, __öt8 
__gArg
, __öt8 
__hArg
,

223 
__öt8
 
__iArg
, __öt8 
__jArg
, __öt8 
__kArg
) :

224 
	`__a
(
__aArg
), 
	`__b
(
__bArg
), 
	`__c
(
__cArg
), 
	`__d
(
__dArg
), 
	`__e
(
__eArg
), 
	`__f
(
__fArg
), 
	`__g
(
__gArg
), 
	`__h
(
__hArg
), 
	`__i
(
__iArg
), 
	`__j
(
__jArg
), 
	$__k
(
__kArg
)

226 
	}
}

228 
ölöe
 
	gGuid
::
	$Guid
(
__aArg
, 
__bArg
, 
__cArg
, c⁄° 
__öt8
 
__dArg
[8]) :

229 
	`__a
(
__aArg
), 
	`__b
(
__bArg
), 
	$__c
(
__cArg
)

231 
__d
 = 
__dArg
[0];

232 
__e
 = 
__dArg
[1];

233 
__f
 = 
__dArg
[2];

234 
__g
 = 
__dArg
[3];

235 
__h
 = 
__dArg
[4];

236 
__i
 = 
__dArg
[5];

237 
__j
 = 
__dArg
[6];

238 
__k
 = 
__dArg
[7];

239 
	}
}

241 
	$__de˛•ec
(
£À˘™y
Ë
Guid
 
	`__wöπ_GUID_NULL
(0x00000000, 0x0000, 0x0000, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00);

254 
__öãrÁ˚
 
	`__de˛•ec
(
	`uuid
("00000000-0000-0000-C000-000000000046")Ë
__abi_IUnknown


256 
public
:

257 
vútuÆ
 
__°dˇŒ
 
	`__abi_QuîyI¡îÁ˚
(
Guid
&, **) = 0;

258 
vútuÆ
 
__°dˇŒ
 
	`__abi_AddRef
() = 0;

259 
vútuÆ
 
__°dˇŒ
 
	`__abi_Rñó£
() = 0;

260 
	}
};

262 
	~"µ…asks_wöπ.h
"

265 
	~<comdef.h
>

268 
	gIMFMedüTy≥
;

269 #i‚de‡
WINRT


270 
	gIMFA˘iv©e
;

271 
	gIMFMedüSour˚
;

273 
	gIMFAâribuãs
;

275 
	g«me•a˚


278 
	gãm∂©e
 <
˛ass
 
	gT
> 
Sa„Rñó£
(
T
 **
µT
)

280 i‡(*
	gµT
)

282 (*
	gµT
)->
Rñó£
();

283 *
	gµT
 = 
NULL
;

287 #ifde‡
_DEBUG


289 ˛as†
	cDPO


291 
	gpublic
:

292 ~
DPO
();

293 
	gDPO
& 
gëIn°™˚
();

294 
¥ötOut
(c⁄° 
wch¨_t
 *
f‹m©
, ...);

295 
£tVîbo£
(
boﬁ
 
°©e
);

296 
boﬁ
 
	gvîbo£
;

297 
	g¥iv©e
:

298 
DPO
();

300 
	#DebugPrötOut
(...Ë
DPO
::
	`gëIn°™˚
().
	$¥ötOut
(
__VA_ARGS__
)

	)

302 
	#DebugPrötOut
(...Ë()

	)

305 
	~"ˇp_msmf.hµ
"

308 
	sMedüTy≥


310 
MF_MT_FRAME_SIZE
;

311 
height
;

312 
width
;

313 
MF_MT_YUV_MATRIX
;

314 
MF_MT_VIDEO_LIGHTING
;

315 
MF_MT_DEFAULT_STRIDE
;

316 
MF_MT_VIDEO_CHROMA_SITING
;

317 
GUID
 
MF_MT_AM_FORMAT_TYPE
;

318 
wch¨_t
 *
pMF_MT_AM_FORMAT_TYPEName
;

319 
MF_MT_FIXED_SIZE_SAMPLES
;

320 
MF_MT_VIDEO_NOMINAL_RANGE
;

321 
MF_MT_FRAME_RATE_NUMERATOR
;

322 
MF_MT_FRAME_RATE_DENOMINATOR
;

323 
MF_MT_PIXEL_ASPECT_RATIO
;

324 
MF_MT_PIXEL_ASPECT_RATIO_low
;

325 
MF_MT_ALL_SAMPLES_INDEPENDENT
;

326 
MF_MT_FRAME_RATE_RANGE_MIN
;

327 
MF_MT_FRAME_RATE_RANGE_MIN_low
;

328 
MF_MT_SAMPLE_SIZE
;

329 
MF_MT_VIDEO_PRIMARIES
;

330 
MF_MT_INTERLACE_MODE
;

331 
MF_MT_FRAME_RATE_RANGE_MAX
;

332 
MF_MT_FRAME_RATE_RANGE_MAX_low
;

333 
GUID
 
MF_MT_MAJOR_TYPE
;

334 
GUID
 
MF_MT_SUBTYPE
;

335 
wch¨_t
 *
pMF_MT_MAJOR_TYPEName
;

336 
wch¨_t
 *
pMF_MT_SUBTYPEName
;

337 
	`MedüTy≥
();

338 ~
	`MedüTy≥
();

339 
	`CÀ¨
();

340 
	}
};

343 ˛as†
	cF‹m©Ródî


345 
	gpublic
:

346 
MedüTy≥
 
Ród
(
IMFMedüTy≥
 *
pTy≥
);

347 ~
F‹m©Ródî
();

348 
	g¥iv©e
:

349 
F‹m©Ródî
();

352 
DWORD
 
WINAPI
 
MaöThªadFun˘i⁄
–
LPVOID
 
ÕP¨am
 );

353 (*
	temîgísySt›EvítCÆlback
)(, *);

355 ˛as†
	cRawImage


357 
public
:

358 ~
	`RawImage
();

360 
	`Cª©eIn°™˚
(
RawImage
 **
µRImage
,
size
);

361 
	`£tC›y
(c⁄° 
BYTE
 * 
pSam∂eBuf„r
);

362 
	`Á°C›y
(c⁄° 
BYTE
 * 
pSam∂eBuf„r
);

363 * 
	`gëpPixñs
();

364 
boﬁ
 
	`isNew
();

365 
	`gëSize
();

366 
¥iv©e
:

367 
boﬁ
 
ri_√w
;

368 
ri_size
;

369 *
ri_pixñs
;

370 
	`RawImage
(
size
);

371 
	}
};

373 ˛as†
	cImageGøbbîCÆlback
 : 
public
 
IMFSam∂eGøbbîSökCÆlback


375 
public
:

376 
∑u£Gøbbög
();

377 
ªsumeGøbbög
();

378 
RawImage
 *
gëRawImage
();

380 
STDMETHODIMP
 
OnClockSèπ
(
MFTIME
 
hnsSy°emTime
, 
LONGLONG
 
ŒClockSèπOff£t
);

381 
STDMETHODIMP
 
OnClockSt›
(
MFTIME
 
hnsSy°emTime
);

382 
STDMETHODIMP
 
OnClockPau£
(
MFTIME
 
hnsSy°emTime
);

383 
STDMETHODIMP
 
OnClockRe°¨t
(
MFTIME
 
hnsSy°emTime
);

384 
STDMETHODIMP
 
OnClockSëR©e
(
MFTIME
 
hnsSy°emTime
, 
ÊR©e
);

386 
STDMETHODIMP
 
OnSëPª£¡©i⁄Clock
(
IMFPª£¡©i⁄Clock
* 
pClock
);

387 
STDMETHODIMP
 
OnPro˚ssSam∂e
(
REFGUID
 
guidMaj‹MedüTy≥
, 
DWORD
 
dwSam∂eFœgs
,

388 
LONGLONG
 
ŒSam∂eTime
, LONGLONG 
ŒSam∂eDuøti⁄
, c⁄° 
BYTE
 * 
pSam∂eBuf„r
,

389 
DWORD
 
dwSam∂eSize
);

390 
STDMETHODIMP
 
OnShutdown
();

392 c⁄° 
HANDLE
 
	gig_hFømeRódy
;

393 c⁄° 
HANDLE
 
	gig_hFømeGøbbed
;

394 c⁄° 
HANDLE
 
	gig_hFöish
;

395 
	g¥Ÿe˘ed
:

396 
ImageGøbbîCÆlback
(
boﬁ
 
synchr⁄ous
);

397 
boﬁ
 
	gig_RIE
;

398 
boﬁ
 
	gig_Clo£
;

399 
boﬁ
 
	gig_Synchr⁄ous
;

400 
	gm_cRef
;

402 
RawImage
 *
	gig_RIFú°
;

403 
RawImage
 *
	gig_RISec⁄d
;

404 
RawImage
 *
	gig_RIOut
;

405 
	g¥iv©e
:

406 
ImageGøbbîCÆlback
& 
›î©‹
=(const ImageGrabberCallback&);

409 #ifde‡
WINRT


410 c⁄° 
	$__de˛•ec
(
£À˘™y
Ë
WCHAR
 
Ru¡imeCœss_CV_ImageGøbbîWöRT
[] = 
L
"cv.ImageGrabberWinRT";

412 
˛ass
 
ImageGøbbîWöRT
 :

413 
public
 
Mi¸oso·
::
WRL
::
Ru¡imeCœss
<

414 
Mi¸oso·
::
WRL
::
Ru¡imeCœssFœgs
< Mi¸oso·::WRL::
Ru¡imeCœssTy≥
::
WöRtCœssicComMix
>,

415 
IMFSam∂eGøbbîSökCÆlback
>, 
public
 
ImageGøbbîCÆlback


417 
	`In•e˘abÀCœss
(
Ru¡imeCœss_CV_ImageGøbbîWöRT
, 
Ba£Tru°
)

418 
public
:

419 
	`ImageGøbbîWöRT
(
boﬁ
 
synchr⁄ous
);

420 ~
	`ImageGøbbîWöRT
();

422 
HRESULT
 
	`öôImageGøbbî
(
	`MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
,

423 
GUID
 
VideoF‹m©
);

424 
HRESULT
 
	`°¨tGøbbög
(
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)* 
a˘i⁄
);

425 
HRESULT
 
	`°›Gøbbög
(
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)* 
a˘i⁄
);

427 
STDMETHODIMP
 
	`OnClockSèπ
(
MFTIME
 
hnsSy°emTime
, 
LONGLONG
 
ŒClockSèπOff£t
Ë{  
ImageGøbbîCÆlback
::OnClockStart(hnsSystemTime,ÜlClockStartOffset); }

428 
STDMETHODIMP
 
	`OnClockSt›
(
MFTIME
 
hnsSy°emTime
Ë{  
ImageGøbbîCÆlback
::OnClockStop(hnsSystemTime); }

429 
STDMETHODIMP
 
	`OnClockPau£
(
MFTIME
 
hnsSy°emTime
Ë{  
ImageGøbbîCÆlback
::OnClockPause(hnsSystemTime); }

430 
STDMETHODIMP
 
	`OnClockRe°¨t
(
MFTIME
 
hnsSy°emTime
Ë{  
ImageGøbbîCÆlback
::OnClockRestart(hnsSystemTime); }

431 
STDMETHODIMP
 
	`OnClockSëR©e
(
MFTIME
 
hnsSy°emTime
, 
ÊR©e
Ë{  
ImageGøbbîCÆlback
::OnClockSetRate(hnsSystemTime, flRate); }

433 
STDMETHODIMP
 
	`OnSëPª£¡©i⁄Clock
(
IMFPª£¡©i⁄Clock
* 
pClock
Ë{  
ImageGøbbîCÆlback
::OnSetPresentationClock(pClock); }

434 
STDMETHODIMP
 
	`OnPro˚ssSam∂e
(
REFGUID
 
guidMaj‹MedüTy≥
, 
DWORD
 
dwSam∂eFœgs
,

435 
LONGLONG
 
ŒSam∂eTime
, LONGLONG 
ŒSam∂eDuøti⁄
, c⁄° 
BYTE
 * 
pSam∂eBuf„r
,

436 
DWORD
 
dwSam∂eSize
Ë{  
ImageGøbbîCÆlback
::
	`OnPro˚ssSam∂e
(
guidMaj‹MedüTy≥
, 
dwSam∂eFœgs
, 
ŒSam∂eTime
, 
ŒSam∂eDuøti⁄
, 
pSam∂eBuf„r
, dwSampleSize); }

437 
STDMETHODIMP
 
	`OnShutdown
(Ë{  
ImageGøbbîCÆlback
::OnShutdown(); }

439 
HRESULT
 
	`Cª©eIn°™˚
(
ImageGøbbîWöRT
 **
µIG
, 
boﬁ
 
synchr⁄ous
 = 
Ál£
);

440 
¥iv©e
:

441 
	`MAKE_WRL_AGILE_REF
(
_MedüC≠tuª
Ë
ig_pMedC≠Sour˚
;

442 
MedüSök
* 
ig_pMedüSök
;

443 
	}
};

447 ˛as†
	cImageGøbbî
 : 
public
 
ImageGøbbîCÆlback


449 
public
:

450 ~
ImageGøbbî
();

451 
HRESULT
 
öôImageGøbbî
(
IMFMedüSour˚
 *
pSour˚
);

452 
HRESULT
 
°¨tGøbbög
();

453 
°›Gøbbög
();

455 
STDMETHODIMP
 
QuîyI¡îÁ˚
(
REFIID
 
iid
, ** 
µv
);

456 
STDMETHODIMP_
(
ULONG
Ë
AddRef
();

457 
STDMETHODIMP_
(
ULONG
Ë
Rñó£
();

459 
HRESULT
 
Cª©eIn°™˚
(
ImageGøbbî
 **
µIG
, 
devi˚ID
, 
boﬁ
 
synchr⁄ous
 = 
Ál£
);

461 
	g¥iv©e
:

462 
ig_Devi˚ID
;

464 
IMFMedüSour˚
 *
	gig_pSour˚
;

465 
IMFMedüSessi⁄
 *
	gig_pSessi⁄
;

466 
IMFT›ﬁogy
 *
	gig_pT›ﬁogy
;

467 
ImageGøbbî
(
devi˚ID
, 
boﬁ
 
synchr⁄ous
);

468 
HRESULT
 
Cª©eT›ﬁogy
(
IMFMedüSour˚
 *
pSour˚
, 
IMFA˘iv©e
 *
pSökA˘iv©e
, 
IMFT›ﬁogy
 **
µT›o
);

469 
HRESULT
 
AddSour˚Node
(
IMFT›ﬁogy
 *
pT›ﬁogy
, 
IMFMedüSour˚
 *
pSour˚
,

470 
IMFPª£¡©i⁄Des¸ùt‹
 *
pPD
, 
IMFSåómDes¸ùt‹
 *
pSD
, 
IMFT›ﬁogyNode
 **
µNode
);

471 
HRESULT
 
AddOuçutNode
(
IMFT›ﬁogy
 *
pT›ﬁogy
, 
IMFA˘iv©e
 *
pA˘iv©e
, 
DWORD
 
dwId
, 
IMFT›ﬁogyNode
 **
µNode
);

473 
	gImageGøbbî
& 
	g›î©‹
=(c⁄° 
ImageGøbbî
&);

477 ˛as†
	cImageGøbbîThªad


479 
‰õnd
 
DWORD
 
WINAPI
 
MaöThªadFun˘i⁄
–
LPVOID
 
ÕP¨am
 );

480 
	gpublic
:

481 ~
ImageGøbbîThªad
();

482 
HRESULT
 
Cª©eIn°™˚
(
ImageGøbbîThªad
 **
µIGT
, 
IMFMedüSour˚
 *
pSour˚
, 
devi˚ID
, 
boﬁ
 
synchr⁄ious
 = 
Ál£
);

483 
°¨t
();

484 
°›
();

485 
£tEmîgícySt›Evít
(*
u£rD©a
, (*
func
)(, *));

486 
ImageGøbbî
 *
gëImageGøbbî
();

487 
	g¥Ÿe˘ed
:

488 
vútuÆ
 
run
();

489 
	g¥iv©e
:

490 
ImageGøbbîThªad
(
IMFMedüSour˚
 *
pSour˚
, 
devi˚ID
, 
boﬁ
 
synchr⁄ious
);

491 
HANDLE
 
	gigt_H™dÀ
;

492 
DWORD
 
	gigt_ThªadIdAºay
;

493 
ImageGøbbî
 *
	gigt_pImageGøbbî
;

494 
emîgísySt›EvítCÆlback
 
	gigt_func
;

495 *
	gigt_u£rD©a
;

496 
boﬁ
 
	gigt_°›
;

497 
	gigt_Devi˚ID
;

501 
	sP¨amër


503 
	gCuºítVÆue
;

504 
	gMö
;

505 
	gMax
;

506 
	gSãp
;

507 
	gDeÁu…
;

508 
	gFœg
;

509 
P¨amër
();

513 
	sCamP¨amërs


515 
P¨amër
 
	gBrighäess
;

516 
P¨amër
 
	gC⁄åa°
;

517 
P¨amër
 
	gHue
;

518 
P¨amër
 
	gS©uøti⁄
;

519 
P¨amër
 
	gSh¨≤ess
;

520 
P¨amër
 
	gGamma
;

521 
P¨amër
 
	gCﬁ‹E«bÀ
;

522 
P¨amër
 
	gWhôeBÆ™˚
;

523 
P¨amër
 
	gBacklightCom≥nßti⁄
;

524 
P¨amër
 
	gGaö
;

525 
P¨amër
 
	gP™
;

526 
P¨amër
 
	gTût
;

527 
P¨amër
 
	gRﬁl
;

528 
P¨amër
 
	gZoom
;

529 
P¨amër
 
	gExposuª
;

530 
P¨amër
 
	gIris
;

531 
P¨amër
 
	gFocus
;

534 
	g°d
::
	tw°rög
 
	tSåög
;

535 
	g°d
::
	tve˘‹
<> 
	tve˘‹Num
;

536 
	g°d
::
	tm≠
<
	tSåög
, 
	tve˘‹Num
> 
	tSUBTYPEM≠
;

537 
	g°d
::
	tm≠
<
	tUINT64
, 
	tSUBTYPEM≠
> 
	tFømeR©eM≠
;

538 (*
	temîgísySt›EvítCÆlback
)(, *);

541 ˛as†
	cvideoDevi˚


543 
public
:

544 
	`videoDevi˚
();

545 ~
	`videoDevi˚
();

546 
	`˛o£Devi˚
();

547 
CamP¨amërs
 
	`gëP¨amërs
();

548 
	`£tP¨amërs
(
CamP¨amërs
 
∑ømërs
);

549 
	`£tEmîgícySt›Evít
(*
u£rD©a
, (*
func
)(, *));

550 #ifde‡
WINRT


551 
	`ªadInfoOfDevi˚
(
	`MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
Ë
pDevi˚
, 
Num
);

552 
	`waôF‹Devi˚
()

554 i‡(
vd_pA˘i⁄
) {

555 #ifde‡
HAVE_CONCURRENCY


556 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
vd_pA˘i⁄
).
	`waô
();

558 
vd_pA˘i⁄
 = 
nuŒ±r
;

562 
	`ªadInfoOfDevi˚
(
IMFA˘iv©e
 *
pA˘iv©e
, 
Num
);

564 
wch¨_t
 *
	`gëName
();

565 
	`gëCou¡F‹m©s
();

566 
	`gëWidth
();

567 
	`gëHeight
();

568 
	`gëFømeR©e
() const;

569 
MedüTy≥
 
	`gëF‹m©
(
id
);

570 
boﬁ
 
	`£tupDevi˚
(
w
, 
h
, 
idólFømî©e
 = 0);

571 
boﬁ
 
	`£tupDevi˚
(
id
);

572 
boﬁ
 
	`isDevi˚Sëup
();

573 
boﬁ
 
	`isDevi˚MedüSour˚
();

574 
boﬁ
 
	`isDevi˚RawD©aSour˚
();

575 
boﬁ
 
	`isFømeNew
();

576 
IMFMedüSour˚
 *
	`gëMedüSour˚
();

577 
RawImage
 *
	`gëRawImageOut
();

578 
¥iv©e
:

579 
	ety≥Lock


581 
MedüSour˚Lock
,

582 
RawD©aLock
,

583 
O≥nLock


584 } 
vd_LockOut
;

585 
wch¨_t
 *
vd_pFrõndlyName
;

586 
ImageGøbbîThªad
 *
vd_pImGrTh
;

587 
CamP¨amërs
 
vd_PªvP¨amërs
;

588 
vd_Width
;

589 
vd_Height
;

590 
vd_FømeR©e
;

591 
vd_CuºítNumbî
;

592 
boﬁ
 
vd_IsSëu≥d
;

593 
°d
::
m≠
<
UINT64
, 
FømeR©eM≠
> 
vd_C≠tuªF‹m©s
;

594 
°d
::
ve˘‹
<
MedüTy≥
> 
vd_CuºítF‹m©s
;

595 
IMFMedüSour˚
 *
vd_pSour˚
;

596 #ifde‡
WINRT


597 
	`MAKE_WRL_AGILE_REF
(
_MedüC≠tuª
Ë
vd_pMedC≠
;

598 
EvítRegi°øti⁄Tokí
 
vd_cookõ
;

599 
ImageGøbbîWöRT
 *
vd_pImGr
;

600 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
vd_pA˘i⁄
;

601 #ifde‡
HAVE_CONCURRENCY


602 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
 
vd_lock
;

605 
emîgísySt›EvítCÆlback
 
vd_func
;

606 *
vd_u£rD©a
;

607 
HRESULT
 
	`íumî©eC≠tuªF‹m©s
(
IMFMedüSour˚
 *
pSour˚
);

608 
	`£tDevi˚F‹m©
(
IMFMedüSour˚
 *
pSour˚
, 
dwF‹m©Index
);

609 
	`buûdLibøryofTy≥s
();

610 
	`födTy≥
(
size
, 
‰ameR©e
 = 0);

611 #ifde‡
WINRT


612 
HRESULT
 
	`íumî©eC≠tuªF‹m©s
(
	`MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
);

613 
	`£tDevi˚F‹m©
(
	`MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
, 
dwF‹m©Index
, MAKE_WRL_REF(
_AsyncA˘i⁄
)* 
pA˘i⁄
);

614 
	`ª£tDevi˚
(
	`MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
Ë
pDevi˚
);

615 #ifde‡
HAVE_CONCURRENCY


616 
	`checkDevi˚
(
_Devi˚Cœss
 
devCœss
, 
DEFINE_TASK
<>* 
pTask
, 
	`MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
)* 
µDevi˚
);

619 
	`ª£tDevi˚
(
IMFA˘iv©e
 *
pA˘iv©e
);

620 
	`checkDevi˚
(
IMFAâribuãs
 *
pAâribuãs
, 
IMFA˘iv©e
 **
pDevi˚
);

622 
	`öôDevi˚
();

623 
	}
};

626 ˛as†
	cvideoDevi˚s


628 
	gpublic
:

629 ~
videoDevi˚s
();

630 #ifde‡
WINRT


631 
öôDevi˚s
(
_Devi˚Cœss
 
devCœss
);

632 
waôInô
() {

633 i‡(
	gvds_íumTask
) {

634 #ifde‡
HAVE_CONCURRENCY


635 
CREATE_TASK
 
DEFINE_RET_TYPE
()(
	gvds_íumTask
).
waô
();

637 
	gvds_íumTask
 = 
nuŒ±r
;

641 
öôDevi˚s
(
IMFAâribuãs
 *
pAâribuãs
);

643 
	gvideoDevi˚s
& 
gëIn°™˚
();

644 
videoDevi˚
 *
gëDevi˚
(
i
);

645 
gëCou¡
();

646 
˛órDevi˚s
();

647 
	g¥iv©e
:

648 
UINT32
 
cou¡
;

649 #ifde‡
WINRT


650 
MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
	gvds_íumTask
;

652 
	g°d
::
ve˘‹
<
videoDevi˚
 *> 
vds_Devi˚s
;

653 
videoDevi˚s
();

657 ˛as†
	cMedü_Found©i⁄


659 
	gpublic
:

660 
vútuÆ
 ~
Medü_Found©i⁄
();

661 
	gMedü_Found©i⁄
& 
gëIn°™˚
();

662 
boﬁ
 
buûdLi°OfDevi˚s
();

663 
	g¥iv©e
:

664 
Medü_Found©i⁄
();

668 ˛as†
	cvideoI≈ut


670 
	gpublic
:

671 
vútuÆ
 ~
videoI≈ut
();

673 
	gvideoI≈ut
& 
gëIn°™˚
();

675 
˛o£Devi˚
(
devi˚ID
);

677 
£tEmîgícySt›Evít
(
devi˚ID
, *
u£rD©a
, (*
func
)(, *));

679 
˛o£AŒDevi˚s
();

681 
CamP¨amërs
 
gëP¨amërs
(
devi˚ID
);

683 
£tP¨amërs
(
devi˚ID
, 
CamP¨amërs
 
∑ømërs
);

685 
li°Devi˚s
(
boﬁ
 
sûít
 = 
Ál£
);

687 
gëCou¡F‹m©s
(
devi˚ID
) const;

689 
gëWidth
(
devi˚ID
) const;

691 
gëHeight
(
devi˚ID
) const;

693 
gëFømeR©e
(
devi˚ID
) const;

695 
wch¨_t
 *
gëNameVideoDevi˚
(
devi˚ID
);

697 
IMFMedüSour˚
 *
gëMedüSour˚
(
devi˚ID
);

699 
MedüTy≥
 
gëF‹m©
(
devi˚ID
, 
id
);

701 
boﬁ
 
isDevi˚sAc˚abÀ
();

703 
boﬁ
 
isDevi˚Sëup
(
devi˚ID
);

705 
boﬁ
 
isDevi˚MedüSour˚
(
devi˚ID
);

707 
boﬁ
 
isDevi˚RawD©aSour˚
(
devi˚ID
);

708 #ifde‡
_DEBUG


710 
£tVîbo£
(
boﬁ
 
°©e
);

713 
boﬁ
 
£tupDevi˚
(
devi˚ID
, 
id
 = 0);

715 
boﬁ
 
£tupDevi˚
(
devi˚ID
, 
w
, 
h
, 
idólFømî©e
 = 30);

717 
boﬁ
 
isFømeNew
(
devi˚ID
);

718 #ifde‡
WINRT


719 
waôF‹Devi˚
(
devi˚ID
);

722 
boﬁ
 
gëPixñs
(
devi˚ID
, * 
pixñs
, boﬁ 
ÊùRedAndBlue
 = 
Ál£
, boﬁ 
ÊùImage
 = false);

723 
¥o˚ssPixñs
(* 
§c
, * 
d°
, 
width
, 
height
, 
bµ
, 
boﬁ
 
bRGB
, boﬁ 
bFlù
);

724 
	g¥iv©e
:

725 
boﬁ
 
ac˚ssToDevi˚s
;

726 
videoI≈ut
();

727 
upd©eLi°OfDevi˚s
();

730 #ifde‡
_DEBUG


731 
	gDPO
::
	$DPO
():
	$vîbo£
(
åue
)

733 
	}
}

735 
DPO
::~
	$DPO
()

737 
	}
}

739 
DPO
& DPO::
	$gëIn°™˚
()

741 
DPO
 
ö°™˚
;

742  
ö°™˚
;

743 
	}
}

745 
	gDPO
::
	$¥ötOut
(c⁄° 
wch¨_t
 *
f‹m©
, ...)

747 if(
vîbo£
)

749 
i
 = 0;

750 
wch¨_t
 *
p
 = 
NULL
;

751 
va_li°
 
¨gs
;

752 
	`va_°¨t
(
¨gs
, 
f‹m©
);

753 if–::
	`IsDebuggîPª£¡
() )

755 
WCHAR
 
szMsg
[512];

756 ::
	`SåögCchVPrötfW
(
szMsg
, (szMsg)/(szMsg[0]), 
f‹m©
, 
¨gs
);

757 ::
	`OuçutDebugSåögW
(
szMsg
);

761 if(
	`wcscmp
(
f‹m©
, 
L
"%i"))

763 
i
 = 
	`va_¨g
 (
¨gs
, );

765 if(
	`wcscmp
(
f‹m©
, 
L
"%s"))

767 
p
 = 
	`va_¨g
 (
¨gs
, 
wch¨_t
 *);

769 
	`w¥ötf
(
f‹m©
, 
i
,
p
);

771 
	`va_íd
 (
¨gs
);

773 
	}
}

775 
	gDPO
::
	$£tVîbo£
(
boﬁ
 
°©e
)

777 
vîbo£
 = 
°©e
;

778 
	}
}

781 
LPCWSTR
 
GëGUIDNameC⁄°New
(c⁄° 
GUID
& 
guid
);

782 
HRESULT
 
GëGUIDNameNew
(c⁄° 
GUID
& 
guid
, 
WCHAR
 **
µwsz
);

783 
HRESULT
 
LogAâribuãVÆueByIndexNew
(
IMFAâribuãs
 *
pAâr
, 
DWORD
 
ödex
);

784 
HRESULT
 
S≥cülCa£AâribuãVÆueNew
(
GUID
 
guid
, c⁄° 
PROPVARIANT
& 
v¨
, 
MedüTy≥
 &
out
);

786 *
	$GëP¨amër
(
GUID
 
guid
, 
MedüTy≥
 &
out
)

788 if(
guid
 =
MF_MT_YUV_MATRIX
)

789  &(
out
.
MF_MT_YUV_MATRIX
);

790 if(
guid
 =
MF_MT_VIDEO_LIGHTING
)

791  &(
out
.
MF_MT_VIDEO_LIGHTING
);

792 if(
guid
 =
MF_MT_DEFAULT_STRIDE
)

793  (*)&(
out
.
MF_MT_DEFAULT_STRIDE
);

794 if(
guid
 =
MF_MT_VIDEO_CHROMA_SITING
)

795  &(
out
.
MF_MT_VIDEO_CHROMA_SITING
);

796 if(
guid
 =
MF_MT_VIDEO_NOMINAL_RANGE
)

797  &(
out
.
MF_MT_VIDEO_NOMINAL_RANGE
);

798 if(
guid
 =
MF_MT_ALL_SAMPLES_INDEPENDENT
)

799  &(
out
.
MF_MT_ALL_SAMPLES_INDEPENDENT
);

800 if(
guid
 =
MF_MT_FIXED_SIZE_SAMPLES
)

801  &(
out
.
MF_MT_FIXED_SIZE_SAMPLES
);

802 if(
guid
 =
MF_MT_SAMPLE_SIZE
)

803  &(
out
.
MF_MT_SAMPLE_SIZE
);

804 if(
guid
 =
MF_MT_VIDEO_PRIMARIES
)

805  &(
out
.
MF_MT_VIDEO_PRIMARIES
);

806 if(
guid
 =
MF_MT_INTERLACE_MODE
)

807  &(
out
.
MF_MT_INTERLACE_MODE
);

808  
NULL
;

809 
	}
}

811 
HRESULT
 
	$LogAâribuãVÆueByIndexNew
(
IMFAâribuãs
 *
pAâr
, 
DWORD
 
ödex
, 
MedüTy≥
 &
out
)

813 
WCHAR
 *
pGuidName
 = 
NULL
;

814 
WCHAR
 *
pGuidVÆName
 = 
NULL
;

815 
GUID
 
guid
 = { 0 };

816 
PROPVARIANT
 
v¨
;

817 
	`Pr›V¨ü¡Inô
(&
v¨
);

818 
HRESULT
 
hr
 = 
pAâr
->
	`GëIãmByIndex
(
ödex
, &
guid
, &
v¨
);

819 i‡(
	`FAILED
(
hr
))

821 
d⁄e
;

823 
hr
 = 
	`GëGUIDNameNew
(
guid
, &
pGuidName
);

824 i‡(
	`FAILED
(
hr
))

826 
d⁄e
;

828 
hr
 = 
	`S≥cülCa£AâribuãVÆueNew
(
guid
, 
v¨
, 
out
);

829 *
p
;

830 i‡(
	`FAILED
(
hr
))

832 
d⁄e
;

834 i‡(
hr
 =
S_FALSE
)

836 
v¨
.
vt
)

838 
VT_UI4
:

839 
p
 = 
	`GëP¨amër
(
guid
, 
out
);

840 if(
p
)

842 *
p
 = 
v¨
.
ulVÆ
;

845 
VT_UI8
:

847 
VT_R8
:

849 
VT_CLSID
:

850 if(
guid
 =
MF_MT_AM_FORMAT_TYPE
)

852 
hr
 = 
	`GëGUIDNameNew
(*
v¨
.
puuid
, &
pGuidVÆName
);

853 i‡(
	`SUCCEEDED
(
hr
))

855 
out
.
MF_MT_AM_FORMAT_TYPE
 = *
v¨
.
puuid
;

856 
out
.
pMF_MT_AM_FORMAT_TYPEName
 = 
pGuidVÆName
;

857 
pGuidVÆName
 = 
NULL
;

860 if(
guid
 =
MF_MT_MAJOR_TYPE
)

862 
hr
 = 
	`GëGUIDNameNew
(*
v¨
.
puuid
, &
pGuidVÆName
);

863 i‡(
	`SUCCEEDED
(
hr
))

865 
out
.
MF_MT_MAJOR_TYPE
 = *
v¨
.
puuid
;

866 
out
.
pMF_MT_MAJOR_TYPEName
 = 
pGuidVÆName
;

867 
pGuidVÆName
 = 
NULL
;

870 if(
guid
 =
MF_MT_SUBTYPE
)

872 
hr
 = 
	`GëGUIDNameNew
(*
v¨
.
puuid
, &
pGuidVÆName
);

873 i‡(
	`SUCCEEDED
(
hr
))

875 
out
.
MF_MT_SUBTYPE
 = *
v¨
.
puuid
;

876 
out
.
pMF_MT_SUBTYPEName
 = 
pGuidVÆName
;

877 
pGuidVÆName
 = 
NULL
;

881 
VT_LPWSTR
:

883 
VT_VECTOR
 | 
VT_UI1
:

885 
VT_UNKNOWN
:

891 
d⁄e
:

892 
	`CoTaskMemFªe
(
pGuidName
);

893 
	`CoTaskMemFªe
(
pGuidVÆName
);

894 
	`Pr›V¨ü¡CÀ¨
(&
v¨
);

895  
hr
;

896 
	}
}

898 
HRESULT
 
	$GëGUIDNameNew
(c⁄° 
GUID
& 
guid
, 
WCHAR
 **
µwsz
)

900 
HRESULT
 
hr
 = 
S_OK
;

901 
WCHAR
 *
pName
 = 
NULL
;

902 
LPCWSTR
 
pcwsz
 = 
	`GëGUIDNameC⁄°New
(
guid
);

903 i‡(
pcwsz
)

905 
size_t
 
cchLígth
 = 0;

906 
hr
 = 
	`SåögCchLígthW
(
pcwsz
, 
STRSAFE_MAX_CCH
, &
cchLígth
);

907 i‡(
	`FAILED
(
hr
))

909 
d⁄e
;

911 
pName
 = (
WCHAR
*)
	`CoTaskMemAŒoc
((
cchLígth
 + 1) * (WCHAR));

912 i‡(
pName
 =
NULL
)

914 
hr
 = 
E_OUTOFMEMORY
;

915 
d⁄e
;

917 
hr
 = 
	`SåögCchC›yW
(
pName
, 
cchLígth
 + 1, 
pcwsz
);

918 i‡(
	`FAILED
(
hr
))

920 
d⁄e
;

925 
hr
 = 
	`SåögFromCLSID
(
guid
, &
pName
);

927 
d⁄e
:

928 i‡(
	`FAILED
(
hr
))

930 *
µwsz
 = 
NULL
;

931 
	`CoTaskMemFªe
(
pName
);

935 *
µwsz
 = 
pName
;

937  
hr
;

938 
	}
}

940 
	$LogUINT32AsUINT64New
(c⁄° 
PROPVARIANT
& 
v¨
, 
UINT32
 &
uHigh
, UINT32 &
uLow
)

942 
	`U≈ack2UINT32AsUINT64
(
v¨
.
uhVÆ
.
QuadP¨t
, &
uHigh
, &
uLow
);

943 
	}
}

945 
	$Off£tToFlﬂtNew
(c⁄° 
MFOff£t
& 
off£t
)

947  
off£t
.
vÆue
 + (
°©ic_ˇ°
<>(off£t.
‰a˘
) / 65536.0f);

948 
	}
}

950 
HRESULT
 
	$LogVideoAªaNew
(c⁄° 
PROPVARIANT
& 
v¨
)

952 i‡(
v¨
.
ˇub
.
cEÀms
 < (
MFVideoAªa
))

954  
S_OK
;

956  
S_OK
;

957 
	}
}

959 
HRESULT
 
	$S≥cülCa£AâribuãVÆueNew
(
GUID
 
guid
, c⁄° 
PROPVARIANT
& 
v¨
, 
MedüTy≥
 &
out
)

961 i‡(
guid
 =
MF_MT_DEFAULT_STRIDE
)

963 
out
.
MF_MT_DEFAULT_STRIDE
 = 
v¨
.
ötVÆ
;

965 i‡(
guid
 =
MF_MT_FRAME_SIZE
)

967 
UINT32
 
uHigh
 = 0, 
uLow
 = 0;

968 
	`LogUINT32AsUINT64New
(
v¨
, 
uHigh
, 
uLow
);

969 
out
.
width
 = 
uHigh
;

970 
out
.
height
 = 
uLow
;

971 
out
.
MF_MT_FRAME_SIZE
 = out.
width
 * out.
height
;

974 i‡(
guid
 =
MF_MT_FRAME_RATE
)

976 
UINT32
 
uHigh
 = 0, 
uLow
 = 0;

977 
	`LogUINT32AsUINT64New
(
v¨
, 
uHigh
, 
uLow
);

978 
out
.
MF_MT_FRAME_RATE_NUMERATOR
 = 
uHigh
;

979 
out
.
MF_MT_FRAME_RATE_DENOMINATOR
 = 
uLow
;

982 i‡(
guid
 =
MF_MT_FRAME_RATE_RANGE_MAX
)

984 
UINT32
 
uHigh
 = 0, 
uLow
 = 0;

985 
	`LogUINT32AsUINT64New
(
v¨
, 
uHigh
, 
uLow
);

986 
out
.
MF_MT_FRAME_RATE_RANGE_MAX
 = 
uHigh
;

987 
out
.
MF_MT_FRAME_RATE_RANGE_MAX_low
 = 
uLow
;

990 i‡(
guid
 =
MF_MT_FRAME_RATE_RANGE_MIN
)

992 
UINT32
 
uHigh
 = 0, 
uLow
 = 0;

993 
	`LogUINT32AsUINT64New
(
v¨
, 
uHigh
, 
uLow
);

994 
out
.
MF_MT_FRAME_RATE_RANGE_MIN
 = 
uHigh
;

995 
out
.
MF_MT_FRAME_RATE_RANGE_MIN_low
 = 
uLow
;

998 i‡(
guid
 =
MF_MT_PIXEL_ASPECT_RATIO
)

1000 
UINT32
 
uHigh
 = 0, 
uLow
 = 0;

1001 
	`LogUINT32AsUINT64New
(
v¨
, 
uHigh
, 
uLow
);

1002 
out
.
MF_MT_PIXEL_ASPECT_RATIO
 = 
uHigh
;

1003 
out
.
MF_MT_PIXEL_ASPECT_RATIO_low
 = 
uLow
;

1007  
S_FALSE
;

1009  
S_OK
;

1010 
	}
}

1012 #i‚de‡
IF_EQUAL_RETURN


1013 
	#IF_EQUAL_RETURN
(
∑øm
, 
vÆ
Ëif(vÆ =∑ømË 
L
#vÆ

	)

1016 
LPCWSTR
 
	$GëGUIDNameC⁄°New
(c⁄° 
GUID
& 
guid
)

1018 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MAJOR_TYPE
);

1019 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MAJOR_TYPE
);

1020 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_SUBTYPE
);

1021 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_ALL_SAMPLES_INDEPENDENT
);

1022 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_FIXED_SIZE_SAMPLES
);

1023 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_COMPRESSED
);

1024 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_SAMPLE_SIZE
);

1025 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_WRAPPED_TYPE
);

1026 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_NUM_CHANNELS
);

1027 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_SAMPLES_PER_SECOND
);

1028 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_FLOAT_SAMPLES_PER_SECOND
);

1029 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_AVG_BYTES_PER_SECOND
);

1030 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_BLOCK_ALIGNMENT
);

1031 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_BITS_PER_SAMPLE
);

1032 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_VALID_BITS_PER_SAMPLE
);

1033 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_SAMPLES_PER_BLOCK
);

1034 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_CHANNEL_MASK
);

1035 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_FOLDDOWN_MATRIX
);

1036 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_WMADRC_PEAKREF
);

1037 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_WMADRC_PEAKTARGET
);

1038 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_WMADRC_AVGREF
);

1039 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_WMADRC_AVGTARGET
);

1040 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AUDIO_PREFER_WAVEFORMATEX
);

1041 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AAC_PAYLOAD_TYPE
);

1042 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AAC_AUDIO_PROFILE_LEVEL_INDICATION
);

1043 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_FRAME_SIZE
);

1044 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_FRAME_RATE
);

1045 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_FRAME_RATE_RANGE_MAX
);

1046 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_FRAME_RATE_RANGE_MIN
);

1047 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_PIXEL_ASPECT_RATIO
);

1048 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DRM_FLAGS
);

1049 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_PAD_CONTROL_FLAGS
);

1050 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_SOURCE_CONTENT_HINT
);

1051 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_VIDEO_CHROMA_SITING
);

1052 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_INTERLACE_MODE
);

1053 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_TRANSFER_FUNCTION
);

1054 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_VIDEO_PRIMARIES
);

1055 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_CUSTOM_VIDEO_PRIMARIES
);

1056 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_YUV_MATRIX
);

1057 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_VIDEO_LIGHTING
);

1058 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_VIDEO_NOMINAL_RANGE
);

1059 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_GEOMETRIC_APERTURE
);

1060 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MINIMUM_DISPLAY_APERTURE
);

1061 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_PAN_SCAN_APERTURE
);

1062 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_PAN_SCAN_ENABLED
);

1063 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AVG_BITRATE
);

1064 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AVG_BIT_ERROR_RATE
);

1065 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MAX_KEYFRAME_SPACING
);

1066 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DEFAULT_STRIDE
);

1067 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_PALETTE
);

1068 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_USER_DATA
);

1069 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_AM_FORMAT_TYPE
);

1070 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG_START_TIME_CODE
);

1071 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG2_PROFILE
);

1072 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG2_LEVEL
);

1073 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG2_FLAGS
);

1074 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG_SEQUENCE_HEADER
);

1075 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_AAUX_SRC_PACK_0
);

1076 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_AAUX_CTRL_PACK_0
);

1077 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_AAUX_SRC_PACK_1
);

1078 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_AAUX_CTRL_PACK_1
);

1079 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_VAUX_SRC_PACK
);

1080 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_DV_VAUX_CTRL_PACK
);

1081 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_ARBITRARY_HEADER
);

1082 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_ARBITRARY_FORMAT
);

1083 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_IMAGE_LOSS_TOLERANT
);

1084 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG4_SAMPLE_DESCRIPTION
);

1085 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_MPEG4_CURRENT_SAMPLE_ENTRY
);

1086 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_ORIGINAL_4CC
);

1087 
	`IF_EQUAL_RETURN
(
guid
, 
MF_MT_ORIGINAL_WAVE_FORMAT_TAG
);

1089 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_Audio
);

1090 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_Video
);

1091 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_PrŸe˘ed
);

1092 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_SAMI
);

1093 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_S¸ùt
);

1094 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_Image
);

1095 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_HTML
);

1096 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_Bö¨y
);

1097 
	`IF_EQUAL_RETURN
(
guid
, 
MFMedüTy≥_FûeTøns„r
);

1098 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_AI44
);

1099 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_ARGB32
);

1100 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_AYUV
);

1101 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_DV25
);

1102 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_DV50
);

1103 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_DVH1
);

1104 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_DVSD
);

1105 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_DVSL
);

1106 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_H264
);

1107 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_I420
);

1108 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_IYUV
);

1109 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_M4S2
);

1110 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MJPG
);

1111 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MP43
);

1112 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MP4S
);

1113 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MP4V
);

1114 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MPG1
);

1115 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MSS1
);

1116 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_MSS2
);

1117 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_NV11
);

1118 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_NV12
);

1119 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_P010
);

1120 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_P016
);

1121 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_P210
);

1122 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_P216
);

1123 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_RGB24
);

1124 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_RGB32
);

1125 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_RGB555
);

1126 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_RGB565
);

1127 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_RGB8
);

1128 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_UYVY
);

1129 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_v210
);

1130 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_v410
);

1131 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_WMV1
);

1132 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_WMV2
);

1133 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_WMV3
);

1134 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_WVC1
);

1135 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y210
);

1136 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y216
);

1137 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y410
);

1138 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y416
);

1139 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y41P
);

1140 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_Y41T
);

1141 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_YUY2
);

1142 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_YV12
);

1143 
	`IF_EQUAL_RETURN
(
guid
, 
MFVideoF‹m©_YVYU
);

1144 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_PCM
);

1145 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_Flﬂt
);

1146 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_DTS
);

1147 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_Dﬁby_AC3_SPDIF
);

1148 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_DRM
);

1149 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_WMAudioV8
);

1150 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_WMAudioV9
);

1151 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_WMAudio_Los¶ess
);

1152 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_WMASPDIF
);

1153 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_MSP1
);

1154 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_MP3
);

1155 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_MPEG
);

1156 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_AAC
);

1157 
	`IF_EQUAL_RETURN
(
guid
, 
MFAudioF‹m©_ADTS
);

1158  
NULL
;

1159 
	}
}

1161 
	gF‹m©Ródî
::
	$F‹m©Ródî
()

1163 
	}
}

1165 
MedüTy≥
 
F‹m©Ródî
::
	$Ród
(
IMFMedüTy≥
 *
pTy≥
)

1167 
UINT32
 
cou¡
 = 0;

1168 
MedüTy≥
 
out
;

1169 
HRESULT
 
hr
 = 
pTy≥
->
	`LockSt‹e
();

1170 i‡(
	`FAILED
(
hr
))

1172  
out
;

1174 
hr
 = 
pTy≥
->
	`GëCou¡
(&
cou¡
);

1175 i‡(
	`FAILED
(
hr
))

1177  
out
;

1179 
UINT32
 
i
 = 0; i < 
cou¡
; i++)

1181 
hr
 = 
	`LogAâribuãVÆueByIndexNew
(
pTy≥
, 
i
, 
out
);

1182 i‡(
	`FAILED
(
hr
))

1187 
hr
 = 
pTy≥
->
	`U∆ockSt‹e
();

1188 i‡(
	`FAILED
(
hr
))

1190  
out
;

1192  
out
;

1193 
	}
}

1195 
	gF‹m©Ródî
::~
	$F‹m©Ródî
()

1197 
	}
}

1199 
	#CHECK_HR
(
x
Ëi‡(
	$FAILED
(
x
)Ë{ 
d⁄e
; 
	}

	)
}

1201 
	gImageGøbbîCÆlback
::
	$ImageGøbbîCÆlback
(
boﬁ
 
synchr⁄ous
):

1202 
	`m_cRef
(1),

1203 
	`ig_RIE
(
åue
),

1204 
	`ig_Clo£
(
Ál£
),

1205 
	`ig_Synchr⁄ous
(
synchr⁄ous
),

1206 
	`ig_hFømeRódy
(
synchr⁄ous
 ? 
	$Cª©eEvít
(
NULL
, 
FALSE
, FALSE, NULL): 0),

1207 
	`ig_hFømeGøbbed
(
synchr⁄ous
 ? 
	$Cª©eEvít
(
NULL
, 
FALSE
, 
TRUE
, NULL): 0),

1208 
	`ig_hFöish
(
	$Cª©eEvít
(
NULL
, 
TRUE
, 
FALSE
, NULL))

1209 {
	}
}

1211 
	gImageGøbbî
::
	$ImageGøbbî
(
devi˚ID
, 
boﬁ
 
synchr⁄ous
):

1212 
	`ImageGøbbîCÆlback
(
synchr⁄ous
),

1213 
	`ig_Devi˚ID
(
devi˚ID
),

1214 
	`ig_pSour˚
(
NULL
),

1215 
	`ig_pSessi⁄
(
NULL
),

1216 
	$ig_pT›ﬁogy
(
NULL
)

1217 {
	}
}

1219 
	gImageGøbbî
::~
	$ImageGøbbî
()

1221 i‡(
ig_pSessi⁄
)

1223 
ig_pSessi⁄
->
	`Shutdown
();

1226 
	`Clo£H™dÀ
(
ig_hFöish
);

1228 i‡(
ig_Synchr⁄ous
)

1230 
	`Clo£H™dÀ
(
ig_hFømeRódy
);

1231 
	`Clo£H™dÀ
(
ig_hFømeGøbbed
);

1234 
	`Sa„Rñó£
(&
ig_pSessi⁄
);

1235 
	`Sa„Rñó£
(&
ig_pT›ﬁogy
);

1237 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: De°royög in°™˚ o‡thêImageGøbbî cœss\n", 
ig_Devi˚ID
);

1238 
	}
}

1240 #ifde‡
WINRT


1242 
	gImageGøbbîWöRT
::
	$ImageGøbbîWöRT
(
boﬁ
 
synchr⁄ous
):

1243 
	`ImageGøbbîCÆlback
(
synchr⁄ous
),

1244 
	$ig_pMedüSök
(
NULL
)

1246 
ig_pMedC≠Sour˚
 = 
nuŒ±r
;

1247 
	}
}

1249 
	gImageGøbbîWöRT
::~
	$ImageGøbbîWöRT
()

1252 i‡(
ig_pMedüSök
 !
NULL
) {

1253 ((
IMFMedüSök
*)
ig_pMedüSök
)->
	`Shutdown
();

1255 
	`Sa„Rñó£
(&
ig_pMedüSök
);

1256 
	`RELEASE_AGILE_WRL
(
ig_pMedC≠Sour˚
)

1258 
	`Clo£H™dÀ
(
ig_hFöish
);

1260 i‡(
ig_Synchr⁄ous
)

1262 
	`Clo£H™dÀ
(
ig_hFømeRódy
);

1263 
	`Clo£H™dÀ
(
ig_hFømeGøbbed
);

1266 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE: Destroying instance ofÅhe ImageGrabberWinRT class\n");

1267 
	}
}

1269 
HRESULT
 
	gImageGøbbîWöRT
::
öôImageGøbbî
(
	$MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
,

1270 
GUID
 
VideoF‹m©
)

1272 
HRESULT
 
hr
;

1273 
	`MAKE_WRL_OBJ
(
_VideoDevi˚C⁄åﬁÀr
Ë
pDevC⁄t
;

1274 
	`WRL_PROP_GET
(
pSour˚
, 
VideoDevi˚C⁄åﬁÀr
, 
pDevC⁄t
, 
hr
)

1275 i‡(
	`FAILED
(
hr
))  hr;

1276 
	`GET_WRL_OBJ_FROM_OBJ
(
_MedüDevi˚C⁄åﬁÀr
, 
pMedDevC⁄t
, 
pDevC⁄t
, 
hr
)

1277 i‡(
	`FAILED
(
hr
))  hr;

1278 
	`MAKE_WRL_OBJ
(
_MedüEncodögPr›îtõs
Ë
pMedEncPr›s
;

1279 
	`WRL_METHOD
(
pMedDevC⁄t
, 
GëMedüSåómPr›îtõs
, 
pMedEncPr›s
, 
hr
, 
	`WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
))

1280 i‡(
	`FAILED
(
hr
))  hr;

1281 
	`GET_WRL_OBJ_FROM_OBJ
(
_VideoEncodögPr›îtõs
, 
pVidPr›s
, 
pMedEncPr›s
, 
hr
);

1282 i‡(
	`FAILED
(
hr
))  hr;

1283 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

1284 
hr
 = 
MedüSök
::
	`C⁄vîtPr›îtõsToMedüTy≥
(
	`DEREF_AS_NATIVE_WRL_OBJ
(
ABI
::
Wödows
::
Medü
::
MedüPr›îtõs
::
IMedüEncodögPr›îtõs
, 
pMedEncPr›s
), &
pTy≥
);

1285 i‡(
	`FAILED
(
hr
))  hr;

1286 
MedüTy≥
 
MT
 = 
F‹m©Ródî
::
	`Ród
(
pTy≥
.
	`Gë
());

1287 
sizeRawImage
 = 0;

1288 if(
VideoF‹m©
 =
MFVideoF‹m©_RGB24
)

1290 
sizeRawImage
 = 
MT
.
MF_MT_FRAME_SIZE
 * 3;

1292 if(
VideoF‹m©
 =
MFVideoF‹m©_RGB32
)

1294 
sizeRawImage
 = 
MT
.
MF_MT_FRAME_SIZE
 * 4;

1296 
sizeRawImage
 = 
MT
.
MF_MT_SAMPLE_SIZE
;

1297 
	`CHECK_HR
(
hr
 = 
RawImage
::
	`Cª©eIn°™˚
(&
ig_RIFú°
, 
sizeRawImage
));

1298 
	`CHECK_HR
(
hr
 = 
RawImage
::
	`Cª©eIn°™˚
(&
ig_RISec⁄d
, 
sizeRawImage
));

1299 
ig_RIOut
 = 
ig_RISec⁄d
;

1300 
ig_pMedC≠Sour˚
 = 
pSour˚
;

1301 
d⁄e
:

1302  
hr
;

1303 
	}
}

1305 
HRESULT
 
	gImageGøbbîWöRT
::
°›Gøbbög
(
MAKE_WRL_REF
(
_AsyncA˘i⁄
)* 
a˘i⁄
)

1307 
HRESULT
 
hr
 = 
S_OK
;

1308 i‡(
	gig_pMedC≠Sour˚
 !
nuŒ±r
) {

1309 
GET_WRL_OBJ_FROM_REF
(
_MedüC≠tuªVideoPªvõw
, 
imedPªvC≠
, 
DEREF_AGILE_WRL_OBJ
(
ig_pMedC≠Sour˚
), 
hr
)

1310 i‡(
FAILED
(
hr
))  hr;

1311 
MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
	gpA˘i⁄
;

1312 
WRL_METHOD_BASE
(
imedPªvC≠
, 
St›PªvõwAsync
, 
pA˘i⁄
, 
hr
)

1313 i‡(
SUCCEEDED
(
hr
)) {

1314 #ifde‡
HAVE_CONCURRENCY


1315 
	gDEFINE_TASK
<> 
	g_èsk
 = 
CREATE_TASK
 
DEFINE_RET_TYPE
()(
pA˘i⁄
);

1316 *
	ga˘i⁄
 = 
ªöãΩªt_ˇ°
<
MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
BEGIN_CREATE_ASYNC
(, 
_èsk
, 
this
)

1317 
HRESULT
 
	ghr
 = 
S_OK
;

1318 
	g_èsk
.
waô
();

1319 
Sa„Rñó£
(&
ig_pMedüSök
);

1320 
SëEvít
(
ig_hFöish
);

1321 
END_CREATE_ASYNC
(
hr
));

1323 *
	ga˘i⁄
 = 
nuŒ±r
;

1327  
	ghr
;

1330 
HRESULT
 
	gImageGøbbîWöRT
::
°¨tGøbbög
(
MAKE_WRL_REF
(
_AsyncA˘i⁄
)* 
a˘i⁄
)

1332 
HRESULT
 
hr
 = 
S_OK
;

1333 
GET_WRL_OBJ_FROM_REF
(
_MedüC≠tuªVideoPªvõw
, 
imedPªvC≠
, 
DEREF_AGILE_WRL_OBJ
(
ig_pMedC≠Sour˚
), 
hr
)

1334 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1335 
ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Found©i⁄_CﬁÀ˘i⁄s_Pr›îtySë
, 
_Pr›îtySë
, 
pSë
, 
hr
)

1336 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1337 
GET_WRL_OBJ_FROM_OBJ
(
_M≠
, 
•Sëtög
, 
pSë
, 
hr
)

1338 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1339 
ACTIVATE_STATIC_OBJ
(
Ru¡imeCœss_Wödows_Found©i⁄_Pr›îtyVÆue
, 
MAKE_WRL_OBJ
(
_Pr›îtyVÆueSètics
), 
•Pr›VÆ
, 
hr
)

1340 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1341 
_Obje˘Obj
 
	gpVÆ
;

1342 
boﬁón
 
	gbRïœ˚d
;

1343 
WRL_METHOD
(
•Pr›VÆ
, 
Cª©eUI¡32
, 
pVÆ
, 
hr
, ()
WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
))

1344 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1345 
WRL_METHOD
(
•Sëtög
, 
In£π
, 
bRïœ˚d
, 
hr
, 
DEREF_WRL_OBJ
(
_SåögRe„ªn˚
(
MF_PROP_VIDTYPE
)), DEREF_WRL_OBJ(
pVÆ
))

1346 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1347 
WRL_METHOD
(
•Sëtög
, 
In£π
, 
bRïœ˚d
, 
hr
, 
DEREF_WRL_OBJ
(
_SåögRe„ªn˚
(
MF_PROP_SAMPLEGRABBERCALLBACK
)), 
ªöãΩªt_ˇ°
<
_Obje˘
>(
this
))

1348 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1349 
MAKE_WRL_OBJ
(
_VideoDevi˚C⁄åﬁÀr
Ë
	gpDevC⁄t
;

1350 
WRL_PROP_GET
(
ig_pMedC≠Sour˚
, 
VideoDevi˚C⁄åﬁÀr
, 
pDevC⁄t
, 
hr
)

1351 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1352 
GET_WRL_OBJ_FROM_OBJ
(
_MedüDevi˚C⁄åﬁÀr
, 
pMedDevC⁄t
, 
pDevC⁄t
, 
hr
)

1353 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1354 
MAKE_WRL_OBJ
(
_MedüEncodögPr›îtõs
Ë
	gpMedEncPr›s
;

1355 
WRL_METHOD
(
pMedDevC⁄t
, 
GëMedüSåómPr›îtõs
, 
pMedEncPr›s
, 
hr
, 
WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
))

1356 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1357 
GET_WRL_OBJ_FROM_OBJ
(
_VideoEncodögPr›îtõs
, 
pVidPr›s
, 
pMedEncPr›s
, 
hr
);

1358 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1359 
ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Medü_MedüPr›îtõs_MedüEncodögProfûe
, 
_MedüEncodögProfûe
, 
pEncPr›s
, 
hr
)

1360 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1361 
WRL_PROP_PUT
(
pEncPr›s
, 
Video
, 
DEREF_WRL_OBJ
(
pVidPr›s
), 
hr
)

1362 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1363 
WRL_METHOD
(
•Sëtög
, 
In£π
, 
bRïœ˚d
, 
hr
, 
DEREF_WRL_OBJ
(
_SåögRe„ªn˚
(
MF_PROP_VIDENCPROPS
)), DEREF_WRL_OBJ(
pVidPr›s
))

1364 i‡(
SUCCEEDED
(
hr
)) {

1366 
WRL_METHOD
(
imedPªvC≠
, 
_SèπPªvõwToCu°omSökIdAsync
, *
a˘i⁄
, 
hr
, 
DEREF_WRL_OBJ
(
pEncPr›s
), DEREF_WRL_OBJ(
_SåögRe„ªn˚
(
Ru¡imeCœss_CV_MedüSök
)), DEREF_WRL_OBJ(
pSë
))

1367 i‡(
FAILED
(
hr
Ë&& 
	ghr
 =
REGDB_E_CLASSNOTREG
) {

1368 
hr
 = 
Mi¸oso·
::
WRL
::
Make
<
MedüSök
>().
C›yTo
(&
ig_pMedüSök
);

1369 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1370 
	ghr
 = ((
ABI
::
Wödows
::
Medü
::
IMedüExãnsi⁄
*)
ig_pMedüSök
)->
SëPr›îtõs
(
DEREF_AS_NATIVE_WRL_OBJ
(ABI::Wödows::
Found©i⁄
::
CﬁÀ˘i⁄s
::
IPr›îtySë
, 
pSë
));

1371 i‡(
FAILED
(
hr
)Ë 
	ghr
;

1372 
WRL_METHOD
(
imedPªvC≠
, 
SèπPªvõwToCu°omSökAsync
, *
a˘i⁄
, 
hr
, 
DEREF_WRL_OBJ
(
pEncPr›s
), 
ªöãΩªt_ˇ°
<
MAKE_WRL_REF
(
_MedüExãnsi⁄
)>(
ig_pMedüSök
))

1375  
	ghr
;

1378 
HRESULT
 
	gImageGøbbîWöRT
::
	$Cª©eIn°™˚
(
ImageGøbbîWöRT
 **
µIG
, 
boﬁ
 
synchr⁄ous
)

1380 *
µIG
 = 
Mi¸oso·
::
WRL
::
Make
<
ImageGøbbîWöRT
>(
synchr⁄ous
).
	`Dëach
();

1381 i‡(
µIG
 =
NULL
)

1383  
E_OUTOFMEMORY
;

1385 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE: Creating instance of ImageGrabberWinRT\n");

1386  
S_OK
;

1387 
	}
}

1390 
HRESULT
 
	gImageGøbbî
::
	$öôImageGøbbî
(
IMFMedüSour˚
 *
pSour˚
)

1392 
_ComPå
<
IMFA˘iv©e
> 
pSökA˘iv©e
 = 
NULL
;

1393 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

1394 
_ComPå
<
IMFPª£¡©i⁄Des¸ùt‹
> 
pPD
 = 
NULL
;

1395 
_ComPå
<
IMFSåómDes¸ùt‹
> 
pSD
 = 
NULL
;

1396 
_ComPå
<
IMFMedüTy≥H™dÀr
> 
pH™dÀr
 = 
NULL
;

1397 
_ComPå
<
IMFMedüTy≥
> 
pCuºítTy≥
 = 
NULL
;

1398 
MedüTy≥
 
MT
;

1400 i‡(
ig_pSessi⁄
)

1402 
ig_pSessi⁄
->
	`Shutdown
();

1404 
	`Sa„Rñó£
(&
ig_pSessi⁄
);

1405 
	`Sa„Rñó£
(&
ig_pT›ﬁogy
);

1406 
ig_pSour˚
 = 
pSour˚
;

1407 
HRESULT
 
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(&
pPD
);

1408 i‡(
	`FAILED
(
hr
))

1410 
îr
;

1412 
BOOL
 
fSñe˘ed
;

1413 
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹ByIndex
(0, &
fSñe˘ed
, &
pSD
);

1414 i‡(
	`FAILED
(
hr
)) {

1415 
îr
;

1417 
hr
 = 
pSD
->
	`GëMedüTy≥H™dÀr
(&
pH™dÀr
);

1418 i‡(
	`FAILED
(
hr
)) {

1419 
îr
;

1421 
DWORD
 
cTy≥s
 = 0;

1422 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥Cou¡
(&
cTy≥s
);

1423 i‡(
	`FAILED
(
hr
)) {

1424 
îr
;

1426 if(
cTy≥s
 > 0)

1428 
hr
 = 
pH™dÀr
->
	`GëCuºítMedüTy≥
(&
pCuºítTy≥
);

1429 i‡(
	`FAILED
(
hr
)) {

1430 
îr
;

1432 
MT
 = 
F‹m©Ródî
::
	`Ród
(
pCuºítTy≥
.
	`Gë
());

1434 
îr
:

1435 
	`CHECK_HR
(
hr
);

1436 
	`CHECK_HR
(
hr
 = 
RawImage
::
	`Cª©eIn°™˚
(&
ig_RIFú°
, 
MT
.
MF_MT_SAMPLE_SIZE
));

1437 
	`CHECK_HR
(
hr
 = 
RawImage
::
	`Cª©eIn°™˚
(&
ig_RISec⁄d
, 
MT
.
MF_MT_SAMPLE_SIZE
));

1438 
ig_RIOut
 = 
ig_RISec⁄d
;

1442 
	`CHECK_HR
(
hr
 = 
	`MFCª©eMedüTy≥
(
pTy≥
.
	`GëAddªssOf
()));

1443 
	`CHECK_HR
(
hr
 = 
pTy≥
->
	`SëGUID
(
MF_MT_MAJOR_TYPE
, 
MT
.MF_MT_MAJOR_TYPE));

1444 
	`CHECK_HR
(
hr
 = 
pTy≥
->
	`SëGUID
(
MF_MT_SUBTYPE
, 
MT
.MF_MT_SUBTYPE));

1446 
	`CHECK_HR
(
hr
 = 
	`MFCª©eSam∂eGøbbîSökA˘iv©e
(
pTy≥
.
	`Gë
(), 
this
, 
pSökA˘iv©e
.
	`GëAddªssOf
()));

1448 
	`CHECK_HR
(
hr
 = 
pSökA˘iv©e
->
	`SëUINT32
(
MF_SAMPLEGRABBERSINK_IGNORE_CLOCK
, 
TRUE
));

1450 
	`CHECK_HR
(
hr
 = 
	`MFCª©eMedüSessi⁄
(
NULL
, &
ig_pSessi⁄
));

1452 
	`CHECK_HR
(
hr
 = 
	`Cª©eT›ﬁogy
(
pSour˚
, 
pSökA˘iv©e
.
	`Gë
(), &
ig_pT›ﬁogy
));

1453 
d⁄e
:

1455 i‡(
	`FAILED
(
hr
))

1457 i‡(
ig_pSessi⁄
)

1459 
ig_pSessi⁄
->
	`Shutdown
();

1461 
	`Sa„Rñó£
(&
ig_pSessi⁄
);

1462 
	`Sa„Rñó£
(&
ig_pT›ﬁogy
);

1464  
hr
;

1465 
	}
}

1467 
	gImageGøbbî
::
	$°›Gøbbög
()

1469 if(
ig_pSessi⁄
)

1470 
ig_pSessi⁄
->
	`St›
();

1471 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: St›pög o‡o‡gøbbög o‡images\n", 
ig_Devi˚ID
);

1472 
	}
}

1474 
HRESULT
 
	gImageGøbbî
::
	$°¨tGøbbög
()

1476 
PROPVARIANT
 
v¨
;

1477 
	`Pr›V¨ü¡Inô
(&
v¨
);

1478 
HRESULT
 
hr
 = 
ig_pSessi⁄
->
	`SëT›ﬁogy
(0, 
ig_pT›ﬁogy
);

1479 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: Sèπ Gøbbög o‡thêimages\n", 
ig_Devi˚ID
);

1480 
hr
 = 
ig_pSessi⁄
->
	`Sèπ
(&
GUID_NULL
, &
v¨
);

1483 
_ComPå
<
IMFMedüEvít
> 
pEvít
 = 
NULL
;

1484 
HRESULT
 
hrSètus
 = 
S_OK
;

1485 
MedüEvítTy≥
 
më
;

1486 if(!
ig_pSessi⁄
) ;

1487 
hr
 = 
ig_pSessi⁄
->
	`GëEvít
(0, &
pEvít
);

1488 if(!
	`SUCCEEDED
(
hr
))

1490 
hr
 = 
S_OK
;

1491 
d⁄e
;

1493 
hr
 = 
pEvít
->
	`GëSètus
(&
hrSètus
);

1494 if(!
	`SUCCEEDED
(
hr
))

1496 
hr
 = 
S_OK
;

1497 
d⁄e
;

1499 
hr
 = 
pEvít
->
	`GëTy≥
(&
më
);

1500 if(!
	`SUCCEEDED
(
hr
))

1502 
hr
 = 
S_OK
;

1503 
d⁄e
;

1505 i‡(
më
 =
MESessi⁄Ended
)

1507 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: MESessi⁄Ended\n", 
ig_Devi˚ID
);

1508 
ig_pSessi⁄
->
	`St›
();

1511 i‡(
më
 =
MESessi⁄St›≥d
)

1513 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: MESessi⁄St›≥d \n", 
ig_Devi˚ID
);

1516 #i‡(
WINVER
 >= 0x0602)

1517 i‡(
më
 =
MEVideoC≠tuªDevi˚Removed
)

1519 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: MEVideoC≠tuªDevi˚Removed \n", 
ig_Devi˚ID
);

1523 i‡((
më
 =
MEEº‹
Ë|| (më =
MEN⁄F©ÆEº‹
))

1525 
pEvít
->
	`GëSètus
(&
hrSètus
);

1526 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: MEEº‹ | MEN⁄F©ÆEº‹: %u\n", 
ig_Devi˚ID
, 
hrSètus
);

1530 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: Föish sèπGøbbög \n", 
ig_Devi˚ID
);

1532 
d⁄e
:

1533 
	`SëEvít
(
ig_hFöish
);

1535  
hr
;

1536 
	}
}

1538 
	gImageGøbbîCÆlback
::
	$∑u£Gøbbög
()

1540 
	}
}

1542 
ImageGøbbîCÆlback
::
	$ªsumeGøbbög
()

1544 
	}
}

1546 
HRESULT
 
ImageGøbbî
::
	$Cª©eT›ﬁogy
(
IMFMedüSour˚
 *
pSour˚
, 
IMFA˘iv©e
 *
pSökA˘iv©e
, 
IMFT›ﬁogy
 **
µT›o
)

1548 
IMFT›ﬁogy
* 
pT›ﬁogy
 = 
NULL
;

1549 
_ComPå
<
IMFPª£¡©i⁄Des¸ùt‹
> 
pPD
 = 
NULL
;

1550 
_ComPå
<
IMFSåómDes¸ùt‹
> 
pSD
 = 
NULL
;

1551 
_ComPå
<
IMFMedüTy≥H™dÀr
> 
pH™dÀr
 = 
NULL
;

1552 
_ComPå
<
IMFT›ﬁogyNode
> 
pNode1
 = 
NULL
;

1553 
_ComPå
<
IMFT›ﬁogyNode
> 
pNode2
 = 
NULL
;

1554 
HRESULT
 
hr
 = 
S_OK
;

1555 
DWORD
 
cSåóms
 = 0;

1556 
	`CHECK_HR
(
hr
 = 
	`MFCª©eT›ﬁogy
(&
pT›ﬁogy
));

1557 
	`CHECK_HR
(
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(
pPD
.
	`GëAddªssOf
()));

1558 
	`CHECK_HR
(
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹Cou¡
(&
cSåóms
));

1559 
DWORD
 
i
 = 0; i < 
cSåóms
; i++)

1562 
BOOL
 
fSñe˘ed
 = 
FALSE
;

1563 
GUID
 
maj‹Ty≥
;

1564 
	`CHECK_HR
(
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹ByIndex
(
i
, &
fSñe˘ed
, &
pSD
));

1565 
	`CHECK_HR
(
hr
 = 
pSD
->
	`GëMedüTy≥H™dÀr
(&
pH™dÀr
));

1566 
	`CHECK_HR
(
hr
 = 
pH™dÀr
->
	`GëMaj‹Ty≥
(&
maj‹Ty≥
));

1567 i‡(
maj‹Ty≥
 =
MFMedüTy≥_Video
 && 
fSñe˘ed
)

1569 
	`CHECK_HR
(
hr
 = 
	`AddSour˚Node
(
pT›ﬁogy
, 
pSour˚
, 
pPD
.
	`Gë
(), 
pSD
.Gë(), 
pNode1
.
	`GëAddªssOf
()));

1570 
	`CHECK_HR
(
hr
 = 
	`AddOuçutNode
(
pT›ﬁogy
, 
pSökA˘iv©e
, 0, 
pNode2
.
	`GëAddªssOf
()));

1571 
	`CHECK_HR
(
hr
 = 
pNode1
->
	`C⁄√˘Ouçut
(0, 
pNode2
.
	`Gë
(), 0));

1576 
	`CHECK_HR
(
hr
 = 
pPD
->
	`De£À˘Såóm
(
i
));

1579 *
µT›o
 = 
pT›ﬁogy
;

1580 (*
µT›o
)->
	`AddRef
();

1582 
d⁄e
:

1583  
hr
;

1584 
	}
}

1586 
HRESULT
 
	gImageGøbbî
::
	$AddSour˚Node
(

1587 
IMFT›ﬁogy
 *
pT›ﬁogy
,

1588 
IMFMedüSour˚
 *
pSour˚
,

1589 
IMFPª£¡©i⁄Des¸ùt‹
 *
pPD
,

1590 
IMFSåómDes¸ùt‹
 *
pSD
,

1591 
IMFT›ﬁogyNode
 **
µNode
)

1593 
_ComPå
<
IMFT›ﬁogyNode
> 
pNode
 = 
NULL
;

1594 
HRESULT
 
hr
 = 
S_OK
;

1595 
	`CHECK_HR
(
hr
 = 
	`MFCª©eT›ﬁogyNode
(
MF_TOPOLOGY_SOURCESTREAM_NODE
, 
pNode
.
	`GëAddªssOf
()));

1596 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëUnknown
(
MF_TOPONODE_SOURCE
, 
pSour˚
));

1597 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëUnknown
(
MF_TOPONODE_PRESENTATION_DESCRIPTOR
, 
pPD
));

1598 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëUnknown
(
MF_TOPONODE_STREAM_DESCRIPTOR
, 
pSD
));

1599 
	`CHECK_HR
(
hr
 = 
pT›ﬁogy
->
	`AddNode
(
pNode
.
	`Gë
()));

1601 *
µNode
 = 
pNode
.
	`Gë
();

1602 (*
µNode
)->
	`AddRef
();

1604 
d⁄e
:

1605  
hr
;

1606 
	}
}

1608 
HRESULT
 
	gImageGøbbî
::
	$AddOuçutNode
(

1609 
IMFT›ﬁogy
 *
pT›ﬁogy
,

1610 
IMFA˘iv©e
 *
pA˘iv©e
,

1611 
DWORD
 
dwId
,

1612 
IMFT›ﬁogyNode
 **
µNode
)

1614 
_ComPå
<
IMFT›ﬁogyNode
> 
pNode
 = 
NULL
;

1615 
HRESULT
 
hr
 = 
S_OK
;

1616 
	`CHECK_HR
(
hr
 = 
	`MFCª©eT›ﬁogyNode
(
MF_TOPOLOGY_OUTPUT_NODE
, 
pNode
.
	`GëAddªssOf
()));

1617 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëObje˘
(
pA˘iv©e
));

1618 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëUINT32
(
MF_TOPONODE_STREAMID
, 
dwId
));

1619 
	`CHECK_HR
(
hr
 = 
pNode
->
	`SëUINT32
(
MF_TOPONODE_NOSHUTDOWN_ON_REMOVE
, 
FALSE
));

1620 
	`CHECK_HR
(
hr
 = 
pT›ﬁogy
->
	`AddNode
(
pNode
.
	`Gë
()));

1622 *
µNode
 = 
pNode
.
	`Gë
();

1623 (*
µNode
)->
	`AddRef
();

1625 
d⁄e
:

1626  
hr
;

1627 
	}
}

1629 
HRESULT
 
	gImageGøbbî
::
	$Cª©eIn°™˚
(
ImageGøbbî
 **
µIG
, 
devi˚ID
, 
boﬁ
 
synchr⁄ious
)

1631 *
µIG
 = 
	`√w
 (
°d
::
nŸhrow
Ë
	`ImageGøbbî
(
devi˚ID
, 
synchr⁄ious
);

1632 i‡(
µIG
 =
NULL
)

1634  
E_OUTOFMEMORY
;

1636 
	`DebugPrötOut
(
L
"IMAGEGRABBER VIDEODEVICE %i: Cª©ög in°™˚ o‡ImageGøbbî\n", 
devi˚ID
);

1637  
S_OK
;

1638 
	}
}

1640 
STDMETHODIMP
 
	gImageGøbbî
::
	$QuîyI¡îÁ˚
(
REFIID
 
riid
, ** 
µv
)

1642 
HRESULT
 
hr
 = 
E_NOINTERFACE
;

1643 *
µv
 = 
NULL
;

1644 if(
riid
 =
IID_IUnknown
 ||Ñiid =
IID_IMFSam∂eGøbbîSökCÆlback
)

1646 *
µv
 = 
°©ic_ˇ°
<
IMFSam∂eGøbbîSökCÆlback
 *>(
this
);

1647 
hr
 = 
S_OK
;

1649 if(
riid
 =
IID_IMFClockSèãSök
)

1651 *
µv
 = 
°©ic_ˇ°
<
IMFClockSèãSök
 *>(
this
);

1652 
hr
 = 
S_OK
;

1654 if(
	`SUCCEEDED
(
hr
))

1656 
ªöãΩªt_ˇ°
<
IUnknown
 *>(*
µv
)->
	`AddRef
();

1658  
hr
;

1659 
	}
}

1661 
	$STDMETHODIMP_
(
ULONG
Ë
ImageGøbbî
::
	$AddRef
()

1663  
	`I¡îlockedIn¸emít
(&
m_cRef
);

1664 
	}
}

1666 
	$STDMETHODIMP_
(
ULONG
Ë
ImageGøbbî
::
	$Rñó£
()

1668 
ULONG
 
cRef
 = 
	`I¡îlockedDe¸emít
(&
m_cRef
);

1669 i‡(
cRef
 == 0)

1671 
dñëe
 
this
;

1673  
cRef
;

1674 
	}
}

1676 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnClockSèπ
(
MFTIME
 
hnsSy°emTime
, 
LONGLONG
 
ŒClockSèπOff£t
)

1678 ()
hnsSy°emTime
;

1679 ()
ŒClockSèπOff£t
;

1680  
S_OK
;

1681 
	}
}

1683 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnClockSt›
(
MFTIME
 
hnsSy°emTime
)

1685 ()
hnsSy°emTime
;

1686  
S_OK
;

1687 
	}
}

1689 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnClockPau£
(
MFTIME
 
hnsSy°emTime
)

1691 ()
hnsSy°emTime
;

1692  
S_OK
;

1693 
	}
}

1695 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnClockRe°¨t
(
MFTIME
 
hnsSy°emTime
)

1697 ()
hnsSy°emTime
;

1698  
S_OK
;

1699 
	}
}

1701 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnClockSëR©e
(
MFTIME
 
hnsSy°emTime
, 
ÊR©e
)

1703 ()
ÊR©e
;

1704 ()
hnsSy°emTime
;

1705  
S_OK
;

1706 
	}
}

1708 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnSëPª£¡©i⁄Clock
(
IMFPª£¡©i⁄Clock
* 
pClock
)

1710 ()
pClock
;

1711  
S_OK
;

1712 
	}
}

1714 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnPro˚ssSam∂e
(
REFGUID
 
guidMaj‹MedüTy≥
, 
DWORD
 
dwSam∂eFœgs
,

1715 
LONGLONG
 
ŒSam∂eTime
, LONGLONG 
ŒSam∂eDuøti⁄
, c⁄° 
BYTE
 * 
pSam∂eBuf„r
,

1716 
DWORD
 
dwSam∂eSize
)

1718 ()
guidMaj‹MedüTy≥
;

1719 ()
ŒSam∂eTime
;

1720 ()
dwSam∂eFœgs
;

1721 ()
ŒSam∂eDuøti⁄
;

1722 ()
dwSam∂eSize
;

1724 
HANDLE
 
tmp
[] = {
ig_hFöish
, 
ig_hFømeGøbbed
, 
NULL
};

1726 
DWORD
 
°©us
 = 
	`WaôF‹Mu…ùÀObje˘s
(2, 
tmp
, 
FALSE
, 
INFINITE
);

1727 i‡(
°©us
 =
WAIT_OBJECT_0
)

1729 
	`DebugPrötOut
(
L
"OnProcessFrame calledáfter ig_hFinishÉvent\n");

1730  
S_OK
;

1733 if(
ig_RIE
)

1735 
ig_RIFú°
->
	`Á°C›y
(
pSam∂eBuf„r
);

1736 
ig_RIOut
 = 
ig_RIFú°
;

1740 
ig_RISec⁄d
->
	`Á°C›y
(
pSam∂eBuf„r
);

1741 
ig_RIOut
 = 
ig_RISec⁄d
;

1744 i‡(
ig_Synchr⁄ous
)

1746 
	`SëEvít
(
ig_hFømeRódy
);

1750 
ig_RIE
 = !ig_RIE;

1753  
S_OK
;

1754 
	}
}

1756 
STDMETHODIMP
 
	gImageGøbbîCÆlback
::
	$OnShutdown
()

1758 
	`SëEvít
(
ig_hFöish
);

1759  
S_OK
;

1760 
	}
}

1762 
RawImage
 *
	gImageGøbbîCÆlback
::
	$gëRawImage
()

1764  
ig_RIOut
;

1765 
	}
}

1767 
DWORD
 
WINAPI
 
	$MaöThªadFun˘i⁄
–
LPVOID
 
ÕP¨am
 )

1769 
ImageGøbbîThªad
 *
pIGT
 = (ImageGøbbîThªad *)
ÕP¨am
;

1770 
pIGT
->
	`run
();

1772 
	}
}

1774 
HRESULT
 
	gImageGøbbîThªad
::
	$Cª©eIn°™˚
(
ImageGøbbîThªad
 **
µIGT
, 
IMFMedüSour˚
 *
pSour˚
, 
devi˚ID
, 
boﬁ
 
synchr⁄ious
)

1776 *
µIGT
 = 
	`√w
 (
°d
::
nŸhrow
Ë
	`ImageGøbbîThªad
(
pSour˚
, 
devi˚ID
, 
synchr⁄ious
);

1777 i‡(
µIGT
 =
NULL
)

1779 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Mem‹y c™nŸ bêÆloˇãd\n", 
devi˚ID
);

1780  
E_OUTOFMEMORY
;

1783 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Cª©ög o‡thêö°™˚ o‡ImageGøbbîThªad\n", 
devi˚ID
);

1784  
S_OK
;

1785 
	}
}

1787 
	gImageGøbbîThªad
::
	$ImageGøbbîThªad
(
IMFMedüSour˚
 *
pSour˚
, 
devi˚ID
, 
boﬁ
 
synchr⁄ious
) :

1788 
	`igt_func
(
NULL
),

1789 
	`igt_H™dÀ
(
NULL
),

1790 
	$igt_°›
(
Ál£
)

1792 
HRESULT
 
hr
 = 
ImageGøbbî
::
	`Cª©eIn°™˚
(&
igt_pImageGøbbî
, 
devi˚ID
, 
synchr⁄ious
);

1793 
igt_Devi˚ID
 = 
devi˚ID
;

1794 if(
	`SUCCEEDED
(
hr
))

1796 
hr
 = 
igt_pImageGøbbî
->
	`öôImageGøbbî
(
pSour˚
);

1797 if(!
	`SUCCEEDED
(
hr
))

1799 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Thîêi†®¥obÀm wôh inôüliz©i⁄ o‡thêö°™˚ o‡thêImageGøbbî cœss\n", 
devi˚ID
);

1803 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Inôüliz©i⁄ o‡ö°™˚ o‡thêImageGøbbî cœss\n", 
devi˚ID
);

1808 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Thîêi†®¥obÀm wôh cª©i⁄ o‡thêö°™˚ o‡thêImageGøbbî cœss\n", 
devi˚ID
);

1810 
	}
}

1812 
	gImageGøbbîThªad
::
£tEmîgícySt›Evít
(*
u£rD©a
, (*
func
)(, *))

1814 if(
func
)

1816 
igt_func
 = 
func
;

1817 
igt_u£rD©a
 = 
u£rD©a
;

1819 
	}
}

1821 
	gImageGøbbîThªad
::~
	$ImageGøbbîThªad
()

1823 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: De°roög ImageGøbbîThªad\n", 
igt_Devi˚ID
);

1824 i‡(
igt_H™dÀ
)

1825 
	`WaôF‹SögÀObje˘
(
igt_H™dÀ
, 
INFINITE
);

1826 
dñëe
 
igt_pImageGøbbî
;

1827 
	}
}

1829 
	gImageGøbbîThªad
::
	$°›
()

1831 
igt_°›
 = 
åue
;

1832 if(
igt_pImageGøbbî
)

1834 
igt_pImageGøbbî
->
	`°›Gøbbög
();

1836 
	}
}

1838 
	gImageGøbbîThªad
::
	$°¨t
()

1840 
igt_H™dÀ
 = 
	`Cª©eThªad
(

1841 
NULL
,

1843 
MaöThªadFun˘i⁄
,

1844 
this
,

1846 &
igt_ThªadIdAºay
);

1847 
	}
}

1849 
	gImageGøbbîThªad
::
	$run
()

1851 if(
igt_pImageGøbbî
)

1853 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Thªad f‹ gøbbög image†i†°¨ãd\n", 
igt_Devi˚ID
);

1854 
HRESULT
 
hr
 = 
igt_pImageGøbbî
->
	`°¨tGøbbög
();

1855 if(!
	`SUCCEEDED
(
hr
))

1857 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Thîêi†®¥obÀm wôh sèπögÅhê¥o˚s†o‡gøbbög\n", 
igt_Devi˚ID
);

1862 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %òThêthªad i†föished wôhouàexecuti⁄ o‡gøbbög\n", 
igt_Devi˚ID
);

1864 if(!
igt_°›
)

1866 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: Emîgícy St›Åhªad\n", 
igt_Devi˚ID
);

1867 if(
igt_func
)

1869 
	`igt_func
(
igt_Devi˚ID
, 
igt_u£rD©a
);

1873 
	`DebugPrötOut
(
L
"IMAGEGRABBERTHREAD VIDEODEVICE %i: FöishÅhªad\n", 
igt_Devi˚ID
);

1874 
	}
}

1876 
ImageGøbbî
 *
	gImageGøbbîThªad
::
	$gëImageGøbbî
()

1878  
igt_pImageGøbbî
;

1879 
	}
}

1881 
	gMedü_Found©i⁄
::
	$Medü_Found©i⁄
()

1883 
HRESULT
 
hr
 = 
	`MFSèπup
(
MF_VERSION
);

1884 if(!
	`SUCCEEDED
(
hr
))

1886 
	`DebugPrötOut
(
L
"MEDIA FOUNDATION: It cannot be created!!!\n");

1888 
	}
}

1890 
	gMedü_Found©i⁄
::~
	$Medü_Found©i⁄
()

1892 
HRESULT
 
hr
 = 
	`MFShutdown
();

1893 if(!
	`SUCCEEDED
(
hr
))

1895 
	`DebugPrötOut
(
L
"MEDIA FOUNDATION: Resources cannot beÑeleased\n");

1897 
	}
}

1899 
boﬁ
 
	gMedü_Found©i⁄
::
	$buûdLi°OfDevi˚s
()

1901 
HRESULT
 
hr
 = 
S_OK
;

1902 #ifde‡
WINRT


1903 
videoDevi˚s
 *
vDs
 = &videoDevi˚s::
	`gëIn°™˚
();

1904 
hr
 = 
vDs
->
	`öôDevi˚s
(
	`WRL_ENUM_GET
(
_Devi˚Cœss
, 
Devi˚Cœss
, 
VideoC≠tuª
));

1906 
_ComPå
<
IMFAâribuãs
> 
pAâribuãs
 = 
NULL
;

1907 
	`CoInôülize
(
NULL
);

1908 
hr
 = 
	`MFCª©eAâribuãs
(
pAâribuãs
.
	`GëAddªssOf
(), 1);

1909 i‡(
	`SUCCEEDED
(
hr
))

1911 
hr
 = 
pAâribuãs
->
	`SëGUID
(

1912 
MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE
,

1913 
MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_GUID


1916 i‡(
	`SUCCEEDED
(
hr
))

1918 
videoDevi˚s
 *
vDs
 = &videoDevi˚s::
	`gëIn°™˚
();

1919 
hr
 = 
vDs
->
	`öôDevi˚s
(
pAâribuãs
.
	`Gë
());

1922 i‡(
	`FAILED
(
hr
))

1924 
	`DebugPrötOut
(
L
"MEDIA FOUNDATION: TheáccessÅoÅhe video cameras denied\n");

1927  (
	`SUCCEEDED
(
hr
));

1928 
	}
}

1930 
	gMedü_Found©i⁄
& Medü_Found©i⁄::
	$gëIn°™˚
()

1932 
Medü_Found©i⁄
 
ö°™˚
;

1933  
ö°™˚
;

1934 
	}
}

1936 
	gRawImage
::
	$RawImage
(
size
): 
	`ri_√w
(
Ál£
), 
	$ri_pixñs
(
NULL
)

1938 
ri_size
 = 
size
;

1939 
ri_pixñs
 = 
√w
 [
size
];

1940 
	`mem£t
((*)
ri_pixñs
,0,
ri_size
);

1941 
	}
}

1943 
boﬁ
 
	gRawImage
::
	$isNew
()

1945  
ri_√w
;

1946 
	}
}

1948 
	gRawImage
::
	$gëSize
()

1950  
ri_size
;

1951 
	}
}

1953 
	gRawImage
::~
	$RawImage
()

1955 
dñëe
 []
ri_pixñs
;

1956 
ri_pixñs
 = 
NULL
;

1957 
	}
}

1959 
	gRawImage
::
	$Cª©eIn°™˚
(
RawImage
 **
µRImage
,
size
)

1961 *
µRImage
 = 
	`√w
 (
°d
::
nŸhrow
Ë
	`RawImage
(
size
);

1962 i‡(
µRImage
 =
NULL
)

1964  
E_OUTOFMEMORY
;

1966  
S_OK
;

1967 
	}
}

1969 
	gRawImage
::
	$£tC›y
(c⁄° 
BYTE
 * 
pSam∂eBuf„r
)

1971 
	`mem˝y
(
ri_pixñs
, 
pSam∂eBuf„r
, 
ri_size
);

1972 
ri_√w
 = 
åue
;

1973 
	}
}

1975 
	gRawImage
::
	$Á°C›y
(c⁄° 
BYTE
 * 
pSam∂eBuf„r
)

1977 
	`mem˝y
(
ri_pixñs
, 
pSam∂eBuf„r
, 
ri_size
);

1978 
ri_√w
 = 
åue
;

1979 
	}
}

1981 * 
	gRawImage
::
	$gëpPixñs
()

1983 
ri_√w
 = 
Ál£
;

1984  
ri_pixñs
;

1985 
	}
}

1987 
	gvideoDevi˚
::
	$videoDevi˚
(): 
	`vd_IsSëu≥d
(
Ál£
), 
	`vd_LockOut
(
O≥nLock
), 
	`vd_pFrõndlyName
(
NULL
),

1988 
	`vd_Width
(0), 
	`vd_Height
(0), 
	`vd_FømeR©e
(0), 
	`vd_pSour˚
(
NULL
), 
	`vd_pImGrTh
(NULL), 
	`vd_func
(NULL), 
	$vd_u£rD©a
(
NULL
)

1990 #ifde‡
WINRT


1991 
vd_pMedC≠
 = 
nuŒ±r
;

1992 
vd_cookõ
.
vÆue
 = 0;

1993 
vd_pImGr
 = 
NULL
;

1994 
vd_pA˘i⁄
 = 
nuŒ±r
;

1996 
	}
}

1998 
	gvideoDevi˚
::
	$£tP¨amërs
(
CamP¨amërs
 
∑ømërs
)

2000 if(
vd_IsSëu≥d
)

2002 if(
vd_pSour˚
)

2004 
P¨amër
 *
pP¨amër
 = (P¨amë∏*)(&
∑ømërs
);

2005 
P¨amër
 *
pPªvP¨amër
 = (P¨amë∏*)(&
vd_PªvP¨amërs
);

2006 
IAMVideoProcAmp
 *
pProcAmp
 = 
NULL
;

2007 
HRESULT
 
hr
 = 
vd_pSour˚
->
	`QuîyI¡îÁ˚
(
	`IID_PPV_ARGS
(&
pProcAmp
));

2008 i‡(
	`SUCCEEDED
(
hr
))

2010 
i
 = 0; i < 10; i++)

2012 if(
pPªvP¨amër
[
i
].
CuºítVÆue
 !
pP¨amër
[i].CuºítVÆuê||ÖPªvP¨amër[i].
Fœg
 !=ÖParametr[i].Flag)

2013 
hr
 = 
pProcAmp
->
	`Së
(
VideoProcAmp_Brighäess
 + 
i
, 
pP¨amër
[i].
CuºítVÆue
,ÖP¨amër[i].
Fœg
);

2015 
pProcAmp
->
	`Rñó£
();

2017 
IAMCamîaC⁄åﬁ
 *
pProcC⁄åﬁ
 = 
NULL
;

2018 
hr
 = 
vd_pSour˚
->
	`QuîyI¡îÁ˚
(
	`IID_PPV_ARGS
(&
pProcC⁄åﬁ
));

2019 i‡(
	`SUCCEEDED
(
hr
))

2021 
i
 = 0; i < 7; i++)

2023 if(
pPªvP¨amër
[10 + 
i
].
CuºítVÆue
 !
pP¨amër
[10 + i].CuºítVÆuê||ÖPªvP¨amër[10 + i].
Fœg
 !=ÖParametr[10 + i].Flag)

2024 
hr
 = 
pProcC⁄åﬁ
->
	`Së
(
CamîaC⁄åﬁ_P™
+
i
, 
pP¨amër
[10 + i].
CuºítVÆue
,ÖP¨amër[10 + i].
Fœg
);

2026 
pProcC⁄åﬁ
->
	`Rñó£
();

2028 
vd_PªvP¨amërs
 = 
∑ømërs
;

2031 
	}
}

2033 
CamP¨amërs
 
	gvideoDevi˚
::
	$gëP¨amërs
()

2035 
CamP¨amërs
 
out
;

2036 if(
vd_IsSëu≥d
)

2038 if(
vd_pSour˚
)

2040 
P¨amër
 *
pP¨amër
 = (P¨amë∏*)(&
out
);

2041 
IAMVideoProcAmp
 *
pProcAmp
 = 
NULL
;

2042 
HRESULT
 
hr
 = 
vd_pSour˚
->
	`QuîyI¡îÁ˚
(
	`IID_PPV_ARGS
(&
pProcAmp
));

2043 i‡(
	`SUCCEEDED
(
hr
))

2045 
i
 = 0; i < 10; i++)

2047 
P¨amër
 
ãmp
;

2048 
hr
 = 
pProcAmp
->
	`GëR™ge
(
VideoProcAmp_Brighäess
+
i
, &
ãmp
.
Mö
, &ãmp.
Max
, &ãmp.
Sãp
, &ãmp.
DeÁu…
, &ãmp.
Fœg
);

2049 i‡(
	`SUCCEEDED
(
hr
))

2051 
ãmp
.
CuºítVÆue
 =Åemp.
DeÁu…
;

2052 
pP¨amër
[
i
] = 
ãmp
;

2055 
pProcAmp
->
	`Rñó£
();

2057 
IAMCamîaC⁄åﬁ
 *
pProcC⁄åﬁ
 = 
NULL
;

2058 
hr
 = 
vd_pSour˚
->
	`QuîyI¡îÁ˚
(
	`IID_PPV_ARGS
(&
pProcC⁄åﬁ
));

2059 i‡(
	`SUCCEEDED
(
hr
))

2061 
i
 = 0; i < 7; i++)

2063 
P¨amër
 
ãmp
;

2064 
hr
 = 
pProcC⁄åﬁ
->
	`GëR™ge
(
CamîaC⁄åﬁ_P™
+
i
, &
ãmp
.
Mö
, &ãmp.
Max
, &ãmp.
Sãp
, &ãmp.
DeÁu…
, &ãmp.
Fœg
);

2065 i‡(
	`SUCCEEDED
(
hr
))

2067 
ãmp
.
CuºítVÆue
 =Åemp.
DeÁu…
;

2068 
pP¨amër
[10 + 
i
] = 
ãmp
;

2071 
pProcC⁄åﬁ
->
	`Rñó£
();

2075  
out
;

2076 
	}
}

2078 #ifde‡
WINRT


2079 
	gvideoDevi˚
::
ª£tDevi˚
(
	$MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
Ë
pDevi˚
)

2081 
videoDevi˚
::
	$ª£tDevi˚
(
IMFA˘iv©e
 *
pA˘iv©e
)

2084 
HRESULT
 
hr
 = 
E_FAIL
;

2085 
vd_CuºítF‹m©s
.
	`˛ór
();

2086 if(
vd_pFrõndlyName
)

2087 
	`CoTaskMemFªe
(
vd_pFrõndlyName
);

2088 
vd_pFrõndlyName
 = 
NULL
;

2089 #ifde‡
WINRT


2090 i‡(
pDevi˚
)

2092 
	`ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Medü_C≠tuª_MedüC≠tuª
, 
_MedüC≠tuª
, 
pIMedC≠
, 
hr
)

2093 i‡(
	`FAILED
(
hr
))  hr;

2094 
	`ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Medü_C≠tuª_MedüC≠tuªInôüliz©i⁄Sëtögs
, 
_MedüC≠tuªInôüliz©i⁄Sëtögs
, 
pC≠InôSë
, 
hr
)

2095 i‡(
	`FAILED
(
hr
))  hr;

2096 
_SåögObj
 
°r
;

2097 
	`WRL_PROP_GET
(
pDevi˚
, 
Name
, *
	`REF_WRL_OBJ
(
°r
), 
hr
)

2098 i‡(
	`FAILED
(
hr
))  hr;

2099 
Àngth
 = 0;

2100 
PCWSTR
 
w°r
 = 
	`WödowsGëSåögRawBuf„r
(
ªöãΩªt_ˇ°
<
HSTRING
>(
	`DEREF_WRL_OBJ
(
°r
)), &
Àngth
);

2101 
vd_pFrõndlyName
 = (
wch¨_t
*)
	`CoTaskMemAŒoc
((
Àngth
 + 1) * (wchar_t));

2102 
	`wcs˝y
(
vd_pFrõndlyName
, 
w°r
);

2103 
	`WRL_PROP_GET
(
pDevi˚
, 
Id
, *
	`REF_WRL_OBJ
(
°r
), 
hr
)

2104 i‡(
	`FAILED
(
hr
))  hr;

2105 
	`WRL_PROP_PUT
(
pC≠InôSë
, 
VideoDevi˚Id
, 
	`DEREF_WRL_OBJ
(
°r
), 
hr
)

2106 i‡(
	`FAILED
(
hr
))  hr;

2107 
	`WRL_PROP_PUT
(
pC≠InôSë
, 
SåómögC≠tuªMode
, 
	`WRL_ENUM_GET
(
_SåómögC≠tuªMode
, SåómögC≠tuªMode, 
Video
), 
hr
)

2108 i‡(
	`FAILED
(
hr
))  hr;

2109 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pA˘i⁄
;

2110 
	`WRL_METHOD
(
	`DEREF_WRL_OBJ
(
pIMedC≠
), 
_InôülizeWôhSëtögsAsync
, 
pA˘i⁄
, 
hr
, DEREF_WRL_OBJ(
pC≠InôSë
))

2111 #ifde‡
HAVE_CONCURRENCY


2112 
DEFINE_TASK
<> 
_èsk
 = 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
pA˘i⁄
);

2113 i‡(
	`FAILED
(
hr
))  hr;

2114 
	`MAKE_WRL_AGILE_REF
(
_MedüC≠tuª
Ë
pAgûeMedC≠
;

2115 
pAgûeMedC≠
 = 
	`PREPARE_TRANSFER_WRL_OBJ
(
pIMedC≠
);

2116 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
vd_lock
);

2117 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pOldA˘i⁄
 = 
vd_pA˘i⁄
;

2118 
	`SAVE_CURRENT_CONTEXT
(
c⁄ãxt
);

2119 
vd_pA˘i⁄
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
_èsk
, 
pOldA˘i⁄
, 
c⁄ãxt
, &
pAgûeMedC≠
, 
this
)

2120 
HRESULT
 
hr
 = 
S_OK
;

2121 i‡(
pOldA˘i⁄
Ë
CREATE_TASK
 
	`DEFINE_RET_TYPE
()’OldA˘i⁄).
	`waô
();

2122 
_èsk
.
	`waô
();

2123 i‡(
	`SUCCEEDED
(
hr
)) {

2125 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
pAgûeMedC≠
, 
this
)

2126 
	`íumî©eC≠tuªF‹m©s
(
	`DEREF_AGILE_WRL_OBJ
(
pAgûeMedC≠
));

2127 
END_CALL_IN_CONTEXT_BASE


2129 
	`buûdLibøryofTy≥s
();

2130 
	`RELEASE_AGILE_WRL
(
pAgûeMedC≠
)

2131 
	`END_CREATE_ASYNC
(
hr
));

2135 if(
pA˘iv©e
)

2137 
IMFMedüSour˚
 *
pSour˚
 = 
NULL
;

2138 
hr
 = 
pA˘iv©e
->
	`GëAŒoˇãdSåög
(

2139 
MF_DEVSOURCE_ATTRIBUTE_FRIENDLY_NAME
,

2140 &
vd_pFrõndlyName
,

2141 
NULL


2143 
hr
 = 
pA˘iv©e
->
	`A˘iv©eObje˘
(

2144 
	`__uuidof
(
IMFMedüSour˚
),

2145 (**)&
pSour˚


2147 
	`íumî©eC≠tuªF‹m©s
(
pSour˚
);

2148 
	`buûdLibøryofTy≥s
();

2149 
	`Sa„Rñó£
(&
pSour˚
);

2150 if(
	`FAILED
(
hr
))

2152 
vd_pFrõndlyName
 = 
NULL
;

2153 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: IMFMedüSour˚ i¡îÁ˚ c™nŸ bê¸óãd \n", 
vd_CuºítNumbî
);

2157  
hr
;

2158 
	}
}

2160 #ifde‡
WINRT


2161 
	gvideoDevi˚
::
ªadInfoOfDevi˚
(
	$MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
Ë
pDevi˚
, 
Num
)

2163 
HRESULT
 
hr
 = -1;

2164 
vd_CuºítNumbî
 = 
Num
;

2165 
hr
 = 
	`ª£tDevi˚
(
pDevi˚
);

2166  
hr
;

2167 
	}
}

2169 
	gvideoDevi˚
::
	$ªadInfoOfDevi˚
(
IMFA˘iv©e
 *
pA˘iv©e
, 
Num
)

2171 
vd_CuºítNumbî
 = 
Num
;

2172  
	`ª£tDevi˚
(
pA˘iv©e
);

2173 
	}
}

2176 #ifde‡
WINRT


2177 #ifde‡
HAVE_CONCURRENCY


2178 
	gvideoDevi˚
::
checkDevi˚
(
_Devi˚Cœss
 
devCœss
, 
DEFINE_TASK
<>* 
pTask
, 
MAKE_WRL_REF
(
_IDevi˚Inf‹m©i⁄
)* 
µDevi˚
)

2180 
HRESULT
 
	ghr
 = 
S_OK
;

2181 
ACTIVATE_STATIC_OBJ
(
Ru¡imeCœss_Wödows_Devi˚s_Enumî©i⁄_Devi˚Inf‹m©i⁄
, 
MAKE_WRL_OBJ
(
_Devi˚Inf‹m©i⁄Sètics
), 
pDevSèt
, 
hr
)

2182 i‡(
FAILED
(
hr
)Ë 
	ghr
;

2183 
MAKE_WRL_REF
(
_AsyncO≥øti⁄
<MAKE_WRL_REF(
_Devi˚Inf‹m©i⁄CﬁÀ˘i⁄
)>Ë
	gpA˘i⁄
;

2184 
WRL_METHOD
(
pDevSèt
, 
_FödAŒAsyncDevi˚Cœss
, 
pA˘i⁄
, 
hr
, 
devCœss
)

2185 i‡(
SUCCEEDED
(
hr
)) {

2186 *
	gpTask
 = 
CREATE_TASK
 
DEFINE_RET_TYPE
()([
pA˘i⁄
, &
µDevi˚
, 
this
](Ë-> 
DEFINE_RET_FORMAL
() {

2187 
HRESULT
 
	ghr
 = 
S_OK
;

2188 
MAKE_WRL_OBJ
(
_Ve˘‹Võw
<
MAKE_WRL_REF
(
_Devi˚Inf‹m©i⁄
)>Ë
	gpVe˘‹
 =

2189 
CREATE_TASK
 
DEFINE_RET_TYPE
(
MAKE_WRL_REF
(
_Ve˘‹Võw
<MAKE_WRL_REF(
_Devi˚Inf‹m©i⁄
)>))(
pA˘i⁄
).
gë
();

2190 
UINT32
 
	gcou¡
 = 0;

2191 i‡(
SUCCEEDED
(
hr
)Ë
WRL_PROP_GET
(
pVe˘‹
, 
Size
, 
cou¡
, hr)

2192 i‡(
SUCCEEDED
(
hr
Ë&& 
	gcou¡
 > 0) {

2193 
UINT32
 
	gi
 = 0; i < 
	gcou¡
; i++) {

2194 
MAKE_WRL_OBJ
(
_IDevi˚Inf‹m©i⁄
Ë
	gpDevi˚
;

2195 
WRL_METHOD
(
pVe˘‹
, 
GëAt
, 
pDevi˚
, 
hr
, 
i
)

2196 i‡(
SUCCEEDED
(
hr
)) {

2197 
_SåögObj
 
	g°r
;

2198 
	gÀngth
 = 0;

2199 
WRL_PROP_GET
(
pDevi˚
, 
Name
, *
REF_WRL_OBJ
(
°r
), 
hr
)

2200 
PCWSTR
 
	gw°r
 = 
WödowsGëSåögRawBuf„r
(
ªöãΩªt_ˇ°
<
HSTRING
>(
DEREF_WRL_OBJ
(
°r
)), &
Àngth
);

2201 i‡(
wcscmp
(
w°r
, 
vd_pFrõndlyName
) == 0) {

2202 *
µDevi˚
 = 
PREPARE_TRANSFER_WRL_OBJ
(
pDevi˚
);

2207 
	gRET_VAL_BASE
;

2210  
	ghr
;

2214 
	gvideoDevi˚
::
	$checkDevi˚
(
IMFAâribuãs
 *
pAâribuãs
, 
IMFA˘iv©e
 **
pDevi˚
)

2216 
IMFA˘iv©e
 **
µDevi˚s
 = 
NULL
;

2217 
UINT32
 
cou¡
;

2218 
wch¨_t
 *
√wFrõndlyName
 = 
NULL
;

2219 
HRESULT
 
hr
 = 
	`MFEnumDevi˚Sour˚s
(
pAâribuãs
, &
µDevi˚s
, &
cou¡
);

2220 i‡(
	`SUCCEEDED
(
hr
))

2222 if(
cou¡
 > 0)

2224 if(
cou¡
 > 
vd_CuºítNumbî
)

2226 
hr
 = 
µDevi˚s
[
vd_CuºítNumbî
]->
	`GëAŒoˇãdSåög
(

2227 
MF_DEVSOURCE_ATTRIBUTE_FRIENDLY_NAME
,

2228 &
√wFrõndlyName
,

2229 
NULL


2231 i‡(
	`SUCCEEDED
(
hr
))

2233 if(
	`wcscmp
(
√wFrõndlyName
, 
vd_pFrõndlyName
) != 0)

2235 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Cho£¿devi˚ c™nŸ bêfound \n", 
vd_CuºítNumbî
);

2236 
hr
 = 
E_INVALIDARG
;

2237 
pDevi˚
 = 
NULL
;

2241 *
pDevi˚
 = 
µDevi˚s
[
vd_CuºítNumbî
];

2242 (*
pDevi˚
)->
	`AddRef
();

2247 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Namêo‡devi˚ c™nŸ bêgŸã¿\n", 
vd_CuºítNumbî
);

2252 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Numbî o‡devi˚†m‹êth™ c‹ª¡Çumbî o‡thêdevi˚ \n", 
vd_CuºítNumbî
);

2253 
hr
 = 
E_INVALIDARG
;

2255 
UINT32
 
i
 = 0; i < 
cou¡
; i++)

2257 
	`Sa„Rñó£
(&
µDevi˚s
[
i
]);

2259 
	`Sa„Rñó£
(
µDevi˚s
);

2262 
hr
 = 
E_FAIL
;

2266 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Li° o‡Devi˚Sour˚†ˇ¬Ÿ bêíumî©ed \n", 
vd_CuºítNumbî
);

2268  
hr
;

2269 
	}
}

2272 
	gvideoDevi˚
::
	$öôDevi˚
()

2274 
HRESULT
 
hr
 = 
S_OK
;

2275 
	`CoInôülize
(
NULL
);

2276 #ifde‡
WINRT


2277 #ifde‡
HAVE_CONCURRENCY


2278 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
vd_lock
);

2279 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pOldA˘i⁄
 = 
vd_pA˘i⁄
;

2280 
	`SAVE_CURRENT_CONTEXT
(
c⁄ãxt
);

2281 
vd_pA˘i⁄
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
pOldA˘i⁄
, 
c⁄ãxt
, 
this
)

2282 
HRESULT
 
hr
;

2283 i‡(
pOldA˘i⁄
Ë
CREATE_TASK
 
	`DEFINE_RET_TYPE
()’OldA˘i⁄).
	`waô
();

2284 
DEFINE_TASK
<> 
pTask
;

2285 
	`MAKE_WRL_OBJ
(
_IDevi˚Inf‹m©i⁄
Ë
pDevInfo
;

2286 
hr
 = 
	`checkDevi˚
(
	`WRL_ENUM_GET
(
_Devi˚Cœss
, 
Devi˚Cœss
, 
VideoC≠tuª
), &
pTask
, 
	`REF_WRL_OBJ
(
pDevInfo
));

2287 i‡(
	`SUCCEEDED
(
hr
)Ë
pTask
.
	`waô
();

2288 i‡(
	`SUCCEEDED
(
hr
)) {

2289 
DEFINE_TASK
<> 
_èsk
;

2290 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
pDevInfo
, &
_èsk
, c⁄ãxt, 
this
)

2291 
HRESULT
 
hr
;

2292 
	`ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Medü_C≠tuª_MedüC≠tuª
, 
_MedüC≠tuª
, 
pIMedC≠
, 
hr
)

2293 i‡(
	`SUCCEEDED
(
hr
)) {

2294 
	`RELEASE_WRL
(
vd_pMedC≠
);

2295 
vd_pMedC≠
 = 
	`PREPARE_TRANSFER_WRL_OBJ
(
pIMedC≠
);

2296 
	`ACTIVATE_OBJ
(
Ru¡imeCœss_Wödows_Medü_C≠tuª_MedüC≠tuªInôüliz©i⁄Sëtögs
, 
_MedüC≠tuªInôüliz©i⁄Sëtögs
, 
pC≠InôSë
, 
hr
)

2297 
_SåögObj
 
°r
;

2298 i‡(
	`SUCCEEDED
(
hr
)) {

2299 
	`WRL_PROP_GET
(
pDevInfo
, 
Id
, *
	`REF_WRL_OBJ
(
°r
), 
hr
)

2300 i‡(
	`SUCCEEDED
(
hr
)) {

2301 
	`WRL_PROP_PUT
(
pC≠InôSë
, 
VideoDevi˚Id
, 
	`DEREF_WRL_OBJ
(
°r
), 
hr
)

2304 i‡(
	`SUCCEEDED
(
hr
))

2305 
	`WRL_PROP_PUT
(
pC≠InôSë
, 
SåómögC≠tuªMode
, 
	`WRL_ENUM_GET
(
_SåómögC≠tuªMode
, SåómögC≠tuªMode, 
Video
), 
hr
)

2306 i‡(
	`SUCCEEDED
(
hr
)Ë
ªöãΩªt_ˇ°
<
ABI
::
Wödows
::
Medü
::
C≠tuª
::
IMedüC≠tuª
*>(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
))->
	`add_Faûed
(
Mi¸oso·
::
WRL
::
CÆlback
<ABI::Wödows::Medü::C≠tuª::
IMedüC≠tuªFaûedEvítH™dÀr
>([
this
, 
c⁄ãxt
](ABI::Wödows::Medü::C≠tuª::IMedüC≠tuª*, ABI::Wödows::Medü::C≠tuª::
IMedüC≠tuªFaûedEvítArgs
*Ë-> 
HRESULT
 {

2307 
HRESULT
 
hr
;

2308 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
this
)

2309 
	`˛o£Devi˚
();

2310 
END_CALL_IN_CONTEXT_BASE


2311  
hr
;

2312 }).
	`Gë
(), &
vd_cookõ
);

2313 
	`MAKE_WRL_OBJ
(
_AsyncA˘i⁄
Ë
pA˘i⁄
;

2314 i‡(
	`SUCCEEDED
(
hr
)Ë
	`WRL_METHOD
(
vd_pMedC≠
, 
_InôülizeWôhSëtögsAsync
, *
	`REF_WRL_OBJ
(
pA˘i⁄
), hr, 
	`DEREF_WRL_OBJ
(
pC≠InôSë
))

2315 i‡(
	`SUCCEEDED
(
hr
)Ë
_èsk
 = 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
	`DEREF_WRL_OBJ
(
pA˘i⁄
));

2317 
	`END_CALL_IN_CONTEXT
(
hr
)

2318 
_èsk
.
	`waô
();

2320 
	`END_CREATE_ASYNC
(
hr
));

2323 
_ComPå
<
IMFAâribuãs
> 
pAâribuãs
 = 
NULL
;

2324 
IMFA˘iv©e
 *
vd_pA˘iv©e
 = 
NULL
;

2325 
hr
 = 
	`MFCª©eAâribuãs
(
pAâribuãs
.
	`GëAddªssOf
(), 1);

2326 i‡(
	`SUCCEEDED
(
hr
))

2328 
hr
 = 
pAâribuãs
->
	`SëGUID
(

2329 
MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE
,

2330 
MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_GUID


2333 i‡(
	`SUCCEEDED
(
hr
))

2335 
hr
 = 
	`checkDevi˚
(
pAâribuãs
.
	`Gë
(), &
vd_pA˘iv©e
);

2336 i‡(
	`SUCCEEDED
(
hr
Ë&& 
vd_pA˘iv©e
)

2338 
	`Sa„Rñó£
(&
vd_pSour˚
);

2339 
hr
 = 
vd_pA˘iv©e
->
	`A˘iv©eObje˘
(

2340 
	`__uuidof
(
IMFMedüSour˚
),

2341 (**)&
vd_pSour˚


2343 i‡(
	`SUCCEEDED
(
hr
))

2346 
	`Sa„Rñó£
(&
vd_pA˘iv©e
);

2350 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Devi˚Åhîêi†nŸ \n", 
vd_CuºítNumbî
);

2355 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Thê©åibuã o‡videÿˇmîa†ˇ¬Ÿ bêgëtög \n", 
vd_CuºítNumbî
);

2358  
hr
;

2359 
	}
}

2361 
MedüTy≥
 
	gvideoDevi˚
::
	$gëF‹m©
(
id
)

2363 if(
id
 < 
vd_CuºítF‹m©s
.
	`size
())

2365  
vd_CuºítF‹m©s
[
id
];

2367  
	`MedüTy≥
();

2368 
	}
}

2369 
	gvideoDevi˚
::
	$gëCou¡F‹m©s
()

2371  ()
vd_CuºítF‹m©s
.
	`size
();

2372 
	}
}

2373 
	gvideoDevi˚
::
£tEmîgícySt›Evít
(*
u£rD©a
, (*
func
)(, *))

2375 
vd_func
 = 
func
;

2376 
vd_u£rD©a
 = 
u£rD©a
;

2377 
	}
}

2378 
	gvideoDevi˚
::
	$˛o£Devi˚
()

2380 if(
vd_IsSëu≥d
)

2382 
vd_IsSëu≥d
 = 
Ál£
;

2384 #ifde‡
WINRT


2385 #ifde‡
HAVE_CONCURRENCY


2386 i‡(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
)) {

2387 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
a˘i⁄
;

2388 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
vd_lock
);

2389 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pOldA˘i⁄
 = 
vd_pA˘i⁄
;

2390 
vd_pImGr
->
	`°›Gøbbög
(&
a˘i⁄
);

2391 
ªöãΩªt_ˇ°
<
ABI
::
Wödows
::
Medü
::
C≠tuª
::
IMedüC≠tuª
*>(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
))->
	`ªmove_Faûed
(
vd_cookõ
);

2392 
vd_cookõ
.
vÆue
 = 0;

2393 
vd_pA˘i⁄
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
a˘i⁄
, 
pOldA˘i⁄
, 
this
)

2394 
HRESULT
 
hr
 = 
S_OK
;

2395 i‡(
pOldA˘i⁄
Ë
CREATE_TASK
 
	`DEFINE_RET_TYPE
()’OldA˘i⁄).
	`waô
();

2396 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
a˘i⁄
).
	`waô
();

2397 
	`RELEASE_WRL
(
vd_pMedC≠
)

2398 if(
vd_LockOut
 =
RawD©aLock
) {

2399 
dñëe
 
vd_pImGr
;

2401 
vd_pImGr
 = 
NULL
;

2402 
vd_LockOut
 = 
O≥nLock
;

2403 
	`END_CREATE_ASYNC
(
hr
));

2409 
vd_pSour˚
->
	`Shutdown
();

2410 
	`Sa„Rñó£
(&
vd_pSour˚
);

2411 if(
vd_LockOut
 =
RawD©aLock
)

2413 
vd_pImGrTh
->
	`°›
();

2414 
	`SÀï
(500);

2415 
dñëe
 
vd_pImGrTh
;

2417 
vd_pImGrTh
 = 
NULL
;

2418 
vd_LockOut
 = 
O≥nLock
;

2419 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Devi˚ i†°›≥d \n", 
vd_CuºítNumbî
);

2421 
	}
}

2422 
	gvideoDevi˚
::
	$gëWidth
()

2424 if(
vd_IsSëu≥d
)

2425  
vd_Width
;

2428 
	}
}

2429 
	gvideoDevi˚
::
	$gëHeight
()

2431 if(
vd_IsSëu≥d
)

2432  
vd_Height
;

2435 
	}
}

2437 
	gvideoDevi˚
::
	$gëFømeR©e
() const

2439 if(
vd_IsSëu≥d
)

2440  
vd_FømeR©e
;

2443 
	}
}

2445 
IMFMedüSour˚
 *
	gvideoDevi˚
::
	$gëMedüSour˚
()

2447 
IMFMedüSour˚
 *
out
 = 
NULL
;

2448 if(
vd_LockOut
 =
O≥nLock
)

2450 
vd_LockOut
 = 
MedüSour˚Lock
;

2451 
out
 = 
vd_pSour˚
;

2453  
out
;

2454 
	}
}

2455 
	gvideoDevi˚
::
	$födTy≥
(
size
, 
‰ameR©e
)

2459 
FømeR©eM≠
 
FRM
;

2460 
°d
::
m≠
<
UINT64
, 
FømeR©eM≠
>::
c⁄°_ôî©‹
 
fmt
;

2461 
fmt
 = 
vd_C≠tuªF‹m©s
.
	`föd
(
size
);

2462 if–
fmt
 !
vd_C≠tuªF‹m©s
.
	`íd
() )

2463 
FRM
 = 
fmt
->
£c⁄d
;

2464 if–!
vd_C≠tuªF‹m©s
.
	`em±y
() )

2465 
FRM
 = 
vd_C≠tuªF‹m©s
.
	`rbegö
()->
£c⁄d
;

2467 if–
FRM
.
	`em±y
() )

2470 
UINT64
 
‰ameR©eMax
 = 0; 
SUBTYPEM≠
 
STMMax
;

2471 if(
‰ameR©e
 == 0)

2473 
°d
::
m≠
<
UINT64
, 
SUBTYPEM≠
>::
ôî©‹
 
f
 = 
FRM
.
	`begö
();

2474 ; 
f
 !
FRM
.
	`íd
(); f++)

2477 if((*
f
).
fú°
 >
‰ameR©eMax
)

2479 
‰ameR©eMax
 = (*
f
).
fú°
;

2480 
STMMax
 = (*
f
).
£c⁄d
;

2486 
°d
::
m≠
<
UINT64
, 
SUBTYPEM≠
>::
ôî©‹
 
f
 = 
FRM
.
	`begö
();

2487 ; 
f
 !
FRM
.
	`íd
(); f++)

2490 if–(*
f
).
fú°
 >
‰ameR©eMax
 && (*f).fú° <
‰ameR©e
 )

2492 
‰ameR©eMax
 = (*
f
).
fú°
;

2493 
STMMax
 = (*
f
).
£c⁄d
;

2498 if–
STMMax
.
	`em±y
() )

2499 
STMMax
 = 
FRM
.
	`begö
()->
£c⁄d
;

2502 if–
STMMax
.
	`em±y
() )

2505 
ve˘‹Num
 
VN
 = 
STMMax
.
	`begö
()->
£c⁄d
;

2506 if–
VN
.
	`em±y
() )

2509  
VN
[0];

2510 
	}
}

2512 
	gvideoDevi˚
::
	$buûdLibøryofTy≥s
()

2514 
size
;

2515 
‰amî©e
;

2516 
°d
::
ve˘‹
<
MedüTy≥
>::
ôî©‹
 
i
 = 
vd_CuºítF‹m©s
.
	`begö
();

2517 
cou¡
 = 0;

2518 ; 
i
 !
vd_CuºítF‹m©s
.
	`íd
(); i++)

2521 if–(*
i
).
MF_MT_SUBTYPE
 =
MFVideoF‹m©_RGB24
 )

2523 
size
 = (*
i
).
MF_MT_FRAME_SIZE
;

2524 
‰amî©e
 = (*
i
).
MF_MT_FRAME_RATE_NUMERATOR
 / (*i).
MF_MT_FRAME_RATE_DENOMINATOR
;

2525 
FømeR©eM≠
 
FRM
 = 
vd_C≠tuªF‹m©s
[
size
];

2526 
SUBTYPEM≠
 
STM
 = 
FRM
[
‰amî©e
];

2527 
Såög
 
	`subTy≥
((*
i
).
pMF_MT_SUBTYPEName
);

2528 
ve˘‹Num
 
VN
 = 
STM
[
subTy≥
];

2529 
VN
.
	`push_back
(
cou¡
);

2530 
STM
[
subTy≥
] = 
VN
;

2531 
FRM
[
‰amî©e
] = 
STM
;

2532 
vd_C≠tuªF‹m©s
[
size
] = 
FRM
;

2534 
cou¡
++;

2536 
	}
}

2538 #ifde‡
WINRT


2539 
	gvideoDevi˚
::
£tDevi˚F‹m©
(
	$MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
, 
dwF‹m©Index
, 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)* 
pA˘i⁄
)

2541 
HRESULT
 
hr
;

2542 
	`MAKE_WRL_OBJ
(
_VideoDevi˚C⁄åﬁÀr
Ë
pDevC⁄t
;

2543 
	`WRL_PROP_GET
(
pSour˚
, 
VideoDevi˚C⁄åﬁÀr
, 
pDevC⁄t
, 
hr
)

2544 i‡(
	`FAILED
(
hr
))  hr;

2545 
	`GET_WRL_OBJ_FROM_OBJ
(
_MedüDevi˚C⁄åﬁÀr
, 
pMedDevC⁄t
, 
pDevC⁄t
, 
hr
)

2546 i‡(
	`FAILED
(
hr
))  hr;

2547 
	`MAKE_WRL_OBJ
(
_Ve˘‹Võw
<
	`MAKE_WRL_REF
(
_MedüEncodögPr›îtõs
)>Ë
pVe˘‹
;

2548 
	`WRL_METHOD
(
pMedDevC⁄t
, 
GëAvaûabÀMedüSåómPr›îtõs
, 
pVe˘‹
, 
hr
, 
	`WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
))

2549 i‡(
	`FAILED
(
hr
))  hr;

2550 
	`MAKE_WRL_OBJ
(
_MedüEncodögPr›îtõs
Ë
pMedEncPr›s
;

2551 
	`WRL_METHOD
(
pVe˘‹
, 
GëAt
, 
pMedEncPr›s
, 
hr
, 
dwF‹m©Index
)

2552 i‡(
	`FAILED
(
hr
))  hr;

2553 
	`WRL_METHOD
(
pMedDevC⁄t
, 
SëMedüSåómPr›îtõsAsync
, *
pA˘i⁄
, 
hr
, 
	`WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
), 
	`DEREF_WRL_OBJ
(
pMedEncPr›s
))

2554  
hr
;

2555 
	}
}

2558 
	gvideoDevi˚
::
	$£tDevi˚F‹m©
(
IMFMedüSour˚
 *
pSour˚
, 
dwF‹m©Index
)

2560 
_ComPå
<
IMFPª£¡©i⁄Des¸ùt‹
> 
pPD
 = 
NULL
;

2561 
_ComPå
<
IMFSåómDes¸ùt‹
> 
pSD
 = 
NULL
;

2562 
_ComPå
<
IMFMedüTy≥H™dÀr
> 
pH™dÀr
 = 
NULL
;

2563 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

2564 
HRESULT
 
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(
pPD
.
	`GëAddªssOf
());

2565 i‡(
	`FAILED
(
hr
))

2567 
d⁄e
;

2569 
BOOL
 
fSñe˘ed
;

2570 
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹ByIndex
(0, &
fSñe˘ed
, 
pSD
.
	`GëAddªssOf
());

2571 i‡(
	`FAILED
(
hr
))

2573 
d⁄e
;

2575 
hr
 = 
pSD
->
	`GëMedüTy≥H™dÀr
(
pH™dÀr
.
	`GëAddªssOf
());

2576 i‡(
	`FAILED
(
hr
))

2578 
d⁄e
;

2580 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥ByIndex
((
DWORD
)
dwF‹m©Index
, 
pTy≥
.
	`GëAddªssOf
());

2581 i‡(
	`FAILED
(
hr
))

2583 
d⁄e
;

2585 
hr
 = 
pH™dÀr
->
	`SëCuºítMedüTy≥
(
pTy≥
.
	`Gë
());

2587 
d⁄e
:

2588  
hr
;

2589 
	}
}

2591 
boﬁ
 
	gvideoDevi˚
::
	$isDevi˚Sëup
()

2593  
vd_IsSëu≥d
;

2594 
	}
}

2596 
RawImage
 * 
	gvideoDevi˚
::
	$gëRawImageOut
()

2598 if(!
vd_IsSëu≥d
Ë 
NULL
;

2599 #ifde‡
WINRT


2600 if(
vd_pImGr
Ë vd_pImGr->
	`gëRawImage
();

2602 if(
vd_pImGrTh
)

2603  
vd_pImGrTh
->
	`gëImageGøbbî
()->
	`gëRawImage
();

2606 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Thêö°™˚ o‡ImageGøbbîThªad cœs†d€†nŸÉxi° \n", 
vd_CuºítNumbî
);

2608  
NULL
;

2609 
	}
}

2611 
boﬁ
 
	gvideoDevi˚
::
	$isFømeNew
()

2613 if(!
vd_IsSëu≥d
Ë 
Ál£
;

2614 if(
vd_LockOut
 =
RawD©aLock
 || vd_LockOuà=
O≥nLock
)

2616 if(
vd_LockOut
 =
O≥nLock
)

2618 
vd_LockOut
 = 
RawD©aLock
;

2621 #ifde‡
WINRT


2622 i‡(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
)) {

2623 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
a˘i⁄
;

2624 i‡(
	`FAILED
(
ImageGøbbîWöRT
::
	`Cª©eIn°™˚
(&
vd_pImGr
))Ë 
Ál£
;

2625 i‡(
	`FAILED
(
vd_pImGr
->
	`öôImageGøbbî
(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
), 
MFVideoF‹m©_RGB24
)Ë|| FAILED(vd_pImGr->
	`°¨tGøbbög
(&
a˘i⁄
))) {

2626 
dñëe
 
vd_pImGr
;

2627  
Ál£
;

2629 #ifde‡
HAVE_CONCURRENCY


2630 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
vd_lock
);

2631 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pOldA˘i⁄
 = 
vd_pA˘i⁄
;

2632 
DEFINE_TASK
<> 
_èsk
 = 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
a˘i⁄
);

2633 
vd_pA˘i⁄
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
_èsk
, 
pOldA˘i⁄
, 
this
)

2634 
HRESULT
 
hr
 = 
S_OK
;

2635 i‡(
pOldA˘i⁄
Ë
CREATE_TASK
 
	`DEFINE_RET_TYPE
()’OldA˘i⁄).
	`waô
();

2636 
_èsk
.
	`waô
();

2637 
	`END_CREATE_ASYNC
(
hr
));

2639  
åue
;

2642 
HRESULT
 
hr
 = 
ImageGøbbîThªad
::
	`Cª©eIn°™˚
(&
vd_pImGrTh
, 
vd_pSour˚
, 
vd_CuºítNumbî
);

2643 if(
	`FAILED
(
hr
))

2645 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Thêö°™˚ o‡ImageGøbbîThªad cœs†ˇ¬Ÿ bê¸óãd.\n", 
vd_CuºítNumbî
);

2646  
Ál£
;

2648 
vd_pImGrTh
->
	`£tEmîgícySt›Evít
(
vd_u£rD©a
, 
vd_func
);

2649 
vd_pImGrTh
->
	`°¨t
();

2650  
åue
;

2652 #ifde‡
WINRT


2653 if(
vd_pImGr
)

2654  
vd_pImGr
->
	`gëRawImage
()->
	`isNew
();

2656 if(
vd_pImGrTh
)

2657  
vd_pImGrTh
->
	`gëImageGøbbî
()->
	`gëRawImage
()->
	`isNew
();

2659  
Ál£
;

2660 
	}
}

2662 
boﬁ
 
	gvideoDevi˚
::
	$isDevi˚MedüSour˚
()

2664 if(
vd_LockOut
 =
MedüSour˚Lock
Ë 
åue
;

2665  
Ál£
;

2666 
	}
}

2668 
boﬁ
 
	gvideoDevi˚
::
	$isDevi˚RawD©aSour˚
()

2670 if(
vd_LockOut
 =
RawD©aLock
Ë 
åue
;

2671  
Ál£
;

2672 
	}
}

2674 
boﬁ
 
	gvideoDevi˚
::
	$£tupDevi˚
(
id
)

2676 if(!
vd_IsSëu≥d
)

2678 
HRESULT
 
hr
 = 
	`öôDevi˚
();

2679 if(
	`SUCCEEDED
(
hr
))

2681 #ifde‡
WINRT


2682 #ifde‡
HAVE_CONCURRENCY


2683 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
vd_lock
);

2684 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pOldA˘i⁄
 = 
vd_pA˘i⁄
;

2685 
	`SAVE_CURRENT_CONTEXT
(
c⁄ãxt
);

2686 
vd_pA˘i⁄
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
pOldA˘i⁄
, 
c⁄ãxt
, 
id
, 
this
)

2687 
HRESULT
 
hr
;

2688 i‡(
pOldA˘i⁄
Ë
CREATE_TASK
 
	`DEFINE_RET_TYPE
()’OldA˘i⁄).
	`waô
();

2691 
vd_Width
 = 
vd_CuºítF‹m©s
[
id
].
width
;

2692 
vd_Height
 = 
vd_CuºítF‹m©s
[
id
].
height
;

2693 
vd_FømeR©e
 = 
vd_CuºítF‹m©s
[
id
].
MF_MT_FRAME_RATE_NUMERATOR
 /

2694 
vd_CuºítF‹m©s
[
id
].
MF_MT_FRAME_RATE_DENOMINATOR
;

2695 #ifde‡
WINRT


2696 #ifde‡
HAVE_CONCURRENCY


2697 i‡(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
)) {

2698 
DEFINE_TASK
<> 
_èsk
;

2699 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
id
, &
_èsk
, 
this
)

2700 
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
Ë
pA˘i⁄
;

2701 
HRESULT
 
hr
 = 
	`£tDevi˚F‹m©
(
	`DEREF_AGILE_WRL_OBJ
(
vd_pMedC≠
), (
DWORD
Ë
id
, &
pA˘i⁄
);

2702 i‡(
	`SUCCEEDED
(
hr
)Ë
_èsk
 = 
CREATE_TASK
 
	`DEFINE_RET_TYPE
()(
pA˘i⁄
);

2703 
	`END_CALL_IN_CONTEXT
(
hr
)

2704 i‡(
	`SUCCEEDED
(
hr
)Ë
_èsk
.
	`waô
();

2708 
hr
 = 
	`£tDevi˚F‹m©
(
vd_pSour˚
, (
DWORD
Ë
id
);

2709 
vd_IsSëu≥d
 = (
	`SUCCEEDED
(
hr
));

2710 if(
vd_IsSëu≥d
)

2711 
	`DebugPrötOut
(
L
"\n\nVIDEODEVICE %i: Devi˚ i†£tu≥d \n", 
vd_CuºítNumbî
);

2712 
vd_PªvP¨amërs
 = 
	`gëP¨amërs
();

2713 #ifde‡
WINRT


2714 #ifde‡
HAVE_CONCURRENCY


2715 
	`END_CREATE_ASYNC
(
hr
));

2717  
åue
;

2719  
vd_IsSëu≥d
;

2724 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: I¡îÁ˚ IMFMedüSour˚ c™nŸ bêgŸ \n", 
vd_CuºítNumbî
);

2725  
Ál£
;

2730 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Devi˚ i†£tu≥dáÃódy \n", 
vd_CuºítNumbî
);

2731  
Ál£
;

2733 
	}
}

2735 
boﬁ
 
	gvideoDevi˚
::
	$£tupDevi˚
(
w
, 
h
, 
idólFømî©e
)

2737 
id
 = 
	`födTy≥
(
w
 * 
h
, 
idólFømî©e
);

2738 if–
id
 < 0 )

2739  
Ál£
;

2741  
	`£tupDevi˚
(
id
);

2742 
	}
}

2744 
wch¨_t
 *
	gvideoDevi˚
::
	$gëName
()

2746  
vd_pFrõndlyName
;

2747 
	}
}

2749 
	gvideoDevi˚
::~
	$videoDevi˚
()

2751 
	`˛o£Devi˚
();

2752 #ifde‡
WINRT


2753 
	`RELEASE_WRL
(
vd_pMedC≠
)

2755 
	`Sa„Rñó£
(&
vd_pSour˚
);

2756 if(
vd_pFrõndlyName
)

2757 
	`CoTaskMemFªe
(
vd_pFrõndlyName
);

2758 
	}
}

2760 #ifde‡
WINRT


2761 
HRESULT
 
	gvideoDevi˚
::
íumî©eC≠tuªF‹m©s
(
	$MAKE_WRL_REF
(
_MedüC≠tuª
Ë
pSour˚
)

2763 
HRESULT
 
hr
;

2764 
	`MAKE_WRL_OBJ
(
_VideoDevi˚C⁄åﬁÀr
Ë
pDevC⁄t
;

2765 
	`WRL_PROP_GET
(
pSour˚
, 
VideoDevi˚C⁄åﬁÀr
, 
pDevC⁄t
, 
hr
)

2766 i‡(
	`FAILED
(
hr
))  hr;

2767 
	`GET_WRL_OBJ_FROM_OBJ
(
_MedüDevi˚C⁄åﬁÀr
, 
pMedDevC⁄t
, 
pDevC⁄t
, 
hr
)

2768 i‡(
	`FAILED
(
hr
))  hr;

2769 
	`MAKE_WRL_OBJ
(
_Ve˘‹Võw
<
	`MAKE_WRL_REF
(
_MedüEncodögPr›îtõs
)>Ë
pVe˘‹
;

2770 
	`WRL_METHOD
(
pMedDevC⁄t
, 
GëAvaûabÀMedüSåómPr›îtõs
, 
pVe˘‹
, 
hr
, 
	`WRL_ENUM_GET
(
_MedüSåómTy≥
, 
MedüSåómTy≥
, 
VideoPªvõw
))

2771 i‡(
	`FAILED
(
hr
))  hr;

2772 
UINT32
 
cou¡
;

2773 
	`WRL_PROP_GET
(
pVe˘‹
, 
Size
, 
cou¡
, 
hr
)

2774 i‡(
	`FAILED
(
hr
))  hr;

2775 
UINT32
 
i
 = 0; i < 
cou¡
; i++) {

2776 
	`MAKE_WRL_OBJ
(
_MedüEncodögPr›îtõs
Ë
pMedEncPr›s
;

2777 
	`WRL_METHOD
(
pVe˘‹
, 
GëAt
, 
pMedEncPr›s
, 
hr
, 
i
)

2778 i‡(
	`FAILED
(
hr
))  hr;

2779 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

2780 
hr
 = 
MedüSök
::
	`C⁄vîtPr›îtõsToMedüTy≥
(
	`DEREF_AS_NATIVE_WRL_OBJ
(
ABI
::
Wödows
::
Medü
::
MedüPr›îtõs
::
IMedüEncodögPr›îtõs
, 
pMedEncPr›s
), &
pTy≥
);

2781 i‡(
	`FAILED
(
hr
))  hr;

2782 
MedüTy≥
 
MT
 = 
F‹m©Ródî
::
	`Ród
(
pTy≥
.
	`Gë
());

2783 
vd_CuºítF‹m©s
.
	`push_back
(
MT
);

2785  
hr
;

2786 
	}
}

2789 
HRESULT
 
	gvideoDevi˚
::
	$íumî©eC≠tuªF‹m©s
(
IMFMedüSour˚
 *
pSour˚
)

2791 
_ComPå
<
IMFPª£¡©i⁄Des¸ùt‹
> 
pPD
 = 
NULL
;

2792 
_ComPå
<
IMFSåómDes¸ùt‹
> 
pSD
 = 
NULL
;

2793 
_ComPå
<
IMFMedüTy≥H™dÀr
> 
pH™dÀr
 = 
NULL
;

2794 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

2795 
HRESULT
 
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(
pPD
.
	`GëAddªssOf
());

2796 i‡(
	`FAILED
(
hr
))

2798 
d⁄e
;

2800 
BOOL
 
fSñe˘ed
;

2801 
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹ByIndex
(0, &
fSñe˘ed
, 
pSD
.
	`GëAddªssOf
());

2802 i‡(
	`FAILED
(
hr
))

2804 
d⁄e
;

2806 
hr
 = 
pSD
->
	`GëMedüTy≥H™dÀr
(
pH™dÀr
.
	`GëAddªssOf
());

2807 i‡(
	`FAILED
(
hr
))

2809 
d⁄e
;

2811 
DWORD
 
cTy≥s
 = 0;

2812 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥Cou¡
(&
cTy≥s
);

2813 i‡(
	`FAILED
(
hr
))

2815 
d⁄e
;

2817 
DWORD
 
i
 = 0; i < 
cTy≥s
; i++)

2819 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥ByIndex
(
i
, 
pTy≥
.
	`GëAddªssOf
());

2820 i‡(
	`FAILED
(
hr
))

2822 
d⁄e
;

2824 
MedüTy≥
 
MT
 = 
F‹m©Ródî
::
	`Ród
(
pTy≥
.
	`Gë
());

2825 
vd_CuºítF‹m©s
.
	`push_back
(
MT
);

2828 
d⁄e
:

2829  
hr
;

2830 
	}
}

2832 
	gvideoDevi˚s
::
	$videoDevi˚s
(): 
	$cou¡
(0)

2834 #ifde‡
WINRT


2835 
vds_íumTask
 = 
nuŒ±r
;

2837 
	}
}

2839 
	gvideoDevi˚s
::
	$˛órDevi˚s
()

2841 
°d
::
ve˘‹
<
videoDevi˚
 *>::
ôî©‹
 
i
 = 
vds_Devi˚s
.
	`begö
();

2842 ; 
i
 !
vds_Devi˚s
.
	`íd
(); ++i)

2843 
	`dñëe
 (*
i
);

2844 
vds_Devi˚s
.
	`˛ór
();

2845 
	}
}

2847 
	gvideoDevi˚s
::~
	$videoDevi˚s
()

2849 
	`˛órDevi˚s
();

2850 
	}
}

2852 
videoDevi˚
 * 
	gvideoDevi˚s
::
	$gëDevi˚
(
i
)

2854 if(
i
 >
vds_Devi˚s
.
	`size
())

2856  
NULL
;

2858 if(
i
 < 0)

2860  
NULL
;

2862  
vds_Devi˚s
[
i
];

2863 
	}
}

2865 #ifde‡
WINRT


2866 
	gvideoDevi˚s
::
	$öôDevi˚s
(
_Devi˚Cœss
 
devCœss
)

2868 
HRESULT
 
hr
 = 
S_OK
;

2869 
	`ACTIVATE_STATIC_OBJ
(
Ru¡imeCœss_Wödows_Devi˚s_Enumî©i⁄_Devi˚Inf‹m©i⁄
, 
	`MAKE_WRL_OBJ
(
_Devi˚Inf‹m©i⁄Sètics
), 
pDevSèt
, 
hr
)

2870 i‡(
	`FAILED
(
hr
))  hr;

2871 
	`MAKE_WRL_REF
(
_AsyncO≥øti⁄
<MAKE_WRL_REF(
_Devi˚Inf‹m©i⁄CﬁÀ˘i⁄
)>Ë
pA˘i⁄
;

2872 
	`WRL_METHOD
(
pDevSèt
, 
_FödAŒAsyncDevi˚Cœss
, 
pA˘i⁄
, 
hr
, 
devCœss
)

2873 i‡(
	`SUCCEEDED
(
hr
)) {

2874 #ifde‡
HAVE_CONCURRENCY


2875 
	`SAVE_CURRENT_CONTEXT
(
c⁄ãxt
);

2876 
vds_íumTask
 = 
ªöãΩªt_ˇ°
<
	`MAKE_WRL_REF
(
_AsyncA˘i⁄
)>(
	`BEGIN_CREATE_ASYNC
(, 
pA˘i⁄
, 
c⁄ãxt
, 
this
)

2877 
HRESULT
 
hr
 = 
S_OK
;

2878 
	`MAKE_WRL_OBJ
(
_Ve˘‹Võw
<
	`MAKE_WRL_REF
(
_Devi˚Inf‹m©i⁄
)>Ë
pVe˘‹
 =

2879 
CREATE_TASK
 
	`DEFINE_RET_TYPE
(
	`MAKE_WRL_REF
(
_Ve˘‹Võw
<MAKE_WRL_REF(
_Devi˚Inf‹m©i⁄
)>))(
pA˘i⁄
).
	`gë
();

2880 i‡(
	`SUCCEEDED
(
hr
)Ë
	`WRL_PROP_GET
(
pVe˘‹
, 
Size
, 
cou¡
, hr)

2881 i‡(
	`SUCCEEDED
(
hr
Ë&& 
cou¡
 > 0) {

2882 
UINT32
 
i
 = 0; i < 
cou¡
; i++) {

2883 
videoDevi˚
 *
vd
 = 
√w
 videoDevice;

2884 
	`MAKE_WRL_OBJ
(
_IDevi˚Inf‹m©i⁄
Ë
pDevi˚
;

2885 
	`WRL_METHOD
(
pVe˘‹
, 
GëAt
, 
pDevi˚
, 
hr
, 
i
)

2886 i‡(
	`SUCCEEDED
(
hr
)) {

2887 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
vd
, 
pDevi˚
, 
i
)

2888 
vd
->
	`ªadInfoOfDevi˚
(
	`DEREF_WRL_OBJ
(
pDevi˚
), 
i
);

2889 
END_CALL_IN_CONTEXT_BASE


2890 
vds_Devi˚s
.
	`push_back
(
vd
);

2894 
	`END_CREATE_ASYNC
(
hr
));

2897  
hr
;

2898 
	}
}

2900 
	gvideoDevi˚s
::
	$öôDevi˚s
(
IMFAâribuãs
 *
pAâribuãs
)

2902 
	`˛órDevi˚s
();

2903 
IMFA˘iv©e
 **
µDevi˚s
 = 
NULL
;

2904 
HRESULT
 
hr
 = 
	`MFEnumDevi˚Sour˚s
(
pAâribuãs
, &
µDevi˚s
, &
cou¡
);

2905 i‡(
	`SUCCEEDED
(
hr
))

2907 if(
cou¡
 > 0)

2909 
UINT32
 
i
 = 0; i < 
cou¡
; i++)

2911 
videoDevi˚
 *
vd
 = 
√w
 videoDevice;

2912 
vd
->
	`ªadInfoOfDevi˚
(
µDevi˚s
[
i
], i);

2913 
vds_Devi˚s
.
	`push_back
(
vd
);

2914 
	`Sa„Rñó£
(&
µDevi˚s
[
i
]);

2916 
	`Sa„Rñó£
(
µDevi˚s
);

2919 
hr
 = 
E_INVALIDARG
;

2923 
	`DebugPrötOut
(
L
"VIDEODEVICES: The instances ofÅhe videoDevice class cannot be created\n");

2925  
hr
;

2926 
	}
}

2929 
	gvideoDevi˚s
::
	$gëCou¡
()

2931  ()
vds_Devi˚s
.
	`size
();

2932 
	}
}

2934 
	gvideoDevi˚s
& videoDevi˚s::
	$gëIn°™˚
()

2936 
videoDevi˚s
 
ö°™˚
;

2937  
ö°™˚
;

2938 
	}
}

2940 
	gP¨amër
::
	$P¨amër
()

2942 
CuºítVÆue
 = 0;

2943 
Mö
 = 0;

2944 
Max
 = 0;

2945 
Sãp
 = 0;

2946 
DeÁu…
 = 0;

2947 
Fœg
 = 0;

2948 
	}
}

2950 
	gMedüTy≥
::
	$MedüTy≥
()

2952 
pMF_MT_AM_FORMAT_TYPEName
 = 
NULL
;

2953 
pMF_MT_MAJOR_TYPEName
 = 
NULL
;

2954 
pMF_MT_SUBTYPEName
 = 
NULL
;

2955 
	`CÀ¨
();

2956 
	}
}

2958 
	gMedüTy≥
::~
	$MedüTy≥
()

2960 
	`CÀ¨
();

2961 
	}
}

2963 
	gMedüTy≥
::
	$CÀ¨
()

2965 
MF_MT_FRAME_SIZE
 = 0;

2966 
height
 = 0;

2967 
width
 = 0;

2968 
MF_MT_YUV_MATRIX
 = 0;

2969 
MF_MT_VIDEO_LIGHTING
 = 0;

2970 
MF_MT_DEFAULT_STRIDE
 = 0;

2971 
MF_MT_VIDEO_CHROMA_SITING
 = 0;

2972 
MF_MT_FIXED_SIZE_SAMPLES
 = 0;

2973 
MF_MT_VIDEO_NOMINAL_RANGE
 = 0;

2974 
MF_MT_FRAME_RATE_NUMERATOR
 = 0;

2975 
MF_MT_FRAME_RATE_DENOMINATOR
 = 0;

2976 
MF_MT_PIXEL_ASPECT_RATIO
 = 0;

2977 
MF_MT_PIXEL_ASPECT_RATIO_low
 = 0;

2978 
MF_MT_ALL_SAMPLES_INDEPENDENT
 = 0;

2979 
MF_MT_FRAME_RATE_RANGE_MIN
 = 0;

2980 
MF_MT_FRAME_RATE_RANGE_MIN_low
 = 0;

2981 
MF_MT_SAMPLE_SIZE
 = 0;

2982 
MF_MT_VIDEO_PRIMARIES
 = 0;

2983 
MF_MT_INTERLACE_MODE
 = 0;

2984 
MF_MT_FRAME_RATE_RANGE_MAX
 = 0;

2985 
MF_MT_FRAME_RATE_RANGE_MAX_low
 = 0;

2986 
	`mem£t
(&
MF_MT_MAJOR_TYPE
, 0, (
GUID
));

2987 
	`mem£t
(&
MF_MT_AM_FORMAT_TYPE
, 0, (
GUID
));

2988 
	`mem£t
(&
MF_MT_SUBTYPE
, 0, (
GUID
));

2989 
	}
}

2991 
	gvideoI≈ut
::
	$videoI≈ut
(): 
	$ac˚ssToDevi˚s
(
Ál£
)

2993 
	`DebugPrötOut
(
L
"\n***** VIDEOINPUT LIBRARY - 2013 (Author: Evgeny Pereguda) *****\n\n");

2994 
	`upd©eLi°OfDevi˚s
();

2995 if(!
ac˚ssToDevi˚s
)

2996 
	`DebugPrötOut
(
L
"INITIALIZATION: There isÇotány suitable video device\n");

2997 
	}
}

2999 
	gvideoI≈ut
::
	$upd©eLi°OfDevi˚s
()

3001 
Medü_Found©i⁄
 *
MF
 = &Medü_Found©i⁄::
	`gëIn°™˚
();

3002 
ac˚ssToDevi˚s
 = 
MF
->
	`buûdLi°OfDevi˚s
();

3003 if(!
ac˚ssToDevi˚s
)

3004 
	`DebugPrötOut
(
L
"UPDATING: There isÇotány suitable video device\n");

3005 
	}
}

3007 
	gvideoI≈ut
::~
	$videoI≈ut
()

3009 
	`DebugPrötOut
(
L
"\n***** CLOSE VIDEOINPUT LIBRARY - 2013 *****\n\n");

3010 
	}
}

3012 
IMFMedüSour˚
 *
	gvideoI≈ut
::
	$gëMedüSour˚
(
devi˚ID
)

3014 if(
ac˚ssToDevi˚s
)

3016 
videoDevi˚
 * 
VD
 = 
videoDevi˚s
::
	`gëIn°™˚
().
	`gëDevi˚
(
devi˚ID
);

3017 if(
VD
)

3019 
IMFMedüSour˚
 *
out
 = 
VD
->
	`gëMedüSour˚
();

3020 if(!
out
)

3021 
	`DebugPrötOut
(
L
"VideoDevi˚ %i: Thîêi†nŸány suôabÀ IMFMedüSour˚ i¡îÁ˚\n", 
devi˚ID
);

3022  
out
;

3027 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3029  
NULL
;

3030 
	}
}

3032 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚ID
, 
id
)

3034 i‡(
devi˚ID
 < 0 )

3036 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3037  
Ál£
;

3039 if(
ac˚ssToDevi˚s
)

3041 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3042 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3043 if(
VD
)

3045 
boﬁ
 
out
 = 
VD
->
	`£tupDevi˚
(
id
);

3046 if(!
out
)

3047 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: Thi†devi˚ c™nŸ bê°¨ãd\n", 
devi˚ID
);

3048  
out
;

3053 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3055  
Ál£
;

3056 
	}
}

3058 
boﬁ
 
	gvideoI≈ut
::
	$£tupDevi˚
(
devi˚ID
, 
w
, 
h
, 
idólFømî©e
)

3060 i‡(
devi˚ID
 < 0 )

3062 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3063  
Ál£
;

3065 if(
ac˚ssToDevi˚s
)

3067 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3068 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3069 if(
VD
)

3071 
boﬁ
 
out
 = 
VD
->
	`£tupDevi˚
(
w
, 
h
, 
idólFømî©e
);

3072 if(!
out
)

3073 
	`DebugPrötOut
(
L
"VIDEODEVICE %i:Åhi†devi˚ c™nŸ bê°¨ãd\n", 
devi˚ID
);

3074  
out
;

3079 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): Thîêi†nŸány suôabÀ videÿdevi˚\n", 
devi˚ID
);

3081  
Ál£
;

3082 
	}
}

3084 
MedüTy≥
 
	gvideoI≈ut
::
	$gëF‹m©
(
devi˚ID
, 
id
)

3086 i‡(
devi˚ID
 < 0)

3088 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3089  
	`MedüTy≥
();

3091 if(
ac˚ssToDevi˚s
)

3093 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3094 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3095 if(
VD
)

3096  
VD
->
	`gëF‹m©
(
id
);

3100 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3102  
	`MedüTy≥
();

3103 
	}
}

3105 
boﬁ
 
	gvideoI≈ut
::
	$isDevi˚Sëup
(
devi˚ID
)

3107 i‡(
devi˚ID
 < 0)

3109 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3110  
Ál£
;

3112 if(
ac˚ssToDevi˚s
)

3114 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3115 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3116 if(
VD
)

3117  
VD
->
	`isDevi˚Sëup
();

3121 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3123  
Ál£
;

3124 
	}
}

3126 
boﬁ
 
	gvideoI≈ut
::
	$isDevi˚MedüSour˚
(
devi˚ID
)

3128 i‡(
devi˚ID
 < 0)

3130 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3131  
Ál£
;

3133 if(
ac˚ssToDevi˚s
)

3135 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3136 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3137 if(
VD
)

3138  
VD
->
	`isDevi˚MedüSour˚
();

3142 
	`DebugPrötOut
(
L
"Device(s): There isÇotány suitable video device\n");

3144  
Ál£
;

3145 
	}
}

3147 
boﬁ
 
	gvideoI≈ut
::
	$isDevi˚RawD©aSour˚
(
devi˚ID
)

3149 i‡(
devi˚ID
 < 0)

3151 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3152  
Ál£
;

3154 if(
ac˚ssToDevi˚s
)

3156 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3157 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3158 if(
VD
)

3160 
boﬁ
 
isRaw
 = 
VD
->
	`isDevi˚RawD©aSour˚
();

3161  
isRaw
;

3166 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3168  
Ál£
;

3169 
	}
}

3171 
boﬁ
 
	gvideoI≈ut
::
	$isFømeNew
(
devi˚ID
)

3173 i‡(
devi˚ID
 < 0)

3175 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3176  
Ál£
;

3178 if(
ac˚ssToDevi˚s
)

3180 if(!
	`isDevi˚Sëup
(
devi˚ID
))

3182 if(
	`isDevi˚MedüSour˚
(
devi˚ID
))

3183  
Ál£
;

3185 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3186 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3187 if(
VD
)

3189  
VD
->
	`isFømeNew
();

3194 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3196  
Ál£
;

3197 
	}
}

3199 #ifde‡
WINRT


3200 
	gvideoI≈ut
::
	$waôF‹Devi˚
(
devi˚ID
)

3202 i‡(
devi˚ID
 < 0)

3204 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3207 if(
ac˚ssToDevi˚s
)

3209 if(!
	`isDevi˚Sëup
(
devi˚ID
))

3211 if(
	`isDevi˚MedüSour˚
(
devi˚ID
))

3214 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3215 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3216 if(
VD
)

3218 
VD
->
	`waôF‹Devi˚
();

3223 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3226 
	}
}

3229 
	gvideoI≈ut
::
	$gëCou¡F‹m©s
(
devi˚ID
) const

3231 i‡(
devi˚ID
 < 0)

3233 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3236 if(
ac˚ssToDevi˚s
)

3238 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3239 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3240 if(
VD
)

3241  
VD
->
	`gëCou¡F‹m©s
();

3245 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3248 
	}
}

3250 
	gvideoI≈ut
::
	$˛o£AŒDevi˚s
()

3252 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3253 
i
 = 0; i < 
VDS
->
	`gëCou¡
(); i++)

3254 
	`˛o£Devi˚
(
i
);

3255 
	}
}

3257 
	gvideoI≈ut
::
	$£tP¨amërs
(
devi˚ID
, 
CamP¨amërs
 
∑ømërs
)

3259 i‡(
devi˚ID
 < 0)

3261 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3264 if(
ac˚ssToDevi˚s
)

3266 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3267 
videoDevi˚
 *
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3268 if(
VD
)

3269 
VD
->
	`£tP¨amërs
(
∑ømërs
);

3273 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3275 
	}
}

3277 
CamP¨amërs
 
	gvideoI≈ut
::
	$gëP¨amërs
(
devi˚ID
)

3279 
CamP¨amërs
 
out
;

3280 i‡(
devi˚ID
 < 0)

3282 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3283  
out
;

3285 if(
ac˚ssToDevi˚s
)

3287 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3288 
videoDevi˚
 *
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3289 if(
VD
)

3290 
out
 = 
VD
->
	`gëP¨amërs
();

3294 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3296  
out
;

3297 
	}
}

3299 
	gvideoI≈ut
::
	$˛o£Devi˚
(
devi˚ID
)

3301 i‡(
devi˚ID
 < 0)

3303 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3306 if(
ac˚ssToDevi˚s
)

3308 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3309 
videoDevi˚
 *
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3310 if(
VD
)

3311 
VD
->
	`˛o£Devi˚
();

3315 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3317 
	}
}

3319 
	gvideoI≈ut
::
	$gëWidth
(
devi˚ID
) const

3321 i‡(
devi˚ID
 < 0)

3323 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3326 if(
ac˚ssToDevi˚s
)

3328 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3329 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3330 if(
VD
)

3331  
VD
->
	`gëWidth
();

3335 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3338 
	}
}

3340 
	gvideoI≈ut
::
	$gëHeight
(
devi˚ID
) const

3342 i‡(
devi˚ID
 < 0)

3344 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3347 if(
ac˚ssToDevi˚s
)

3349 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3350 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3351 if(
VD
)

3352  
VD
->
	`gëHeight
();

3356 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3359 
	}
}

3361 
	gvideoI≈ut
::
	$gëFømeR©e
(
devi˚ID
) const

3363 i‡(
devi˚ID
 < 0)

3365 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3368 if(
ac˚ssToDevi˚s
)

3370 
videoDevi˚
 * 
VD
 = 
videoDevi˚s
::
	`gëIn°™˚
().
	`gëDevi˚
(
devi˚ID
);

3371 if(
VD
)

3372  
VD
->
	`gëFømeR©e
();

3376 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3379 
	}
}

3381 
wch¨_t
 *
	gvideoI≈ut
::
	$gëNameVideoDevi˚
(
devi˚ID
)

3383 i‡(
devi˚ID
 < 0)

3385 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3386  
NULL
;

3388 if(
ac˚ssToDevi˚s
)

3390 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3391 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3392 if(
VD
)

3393  
VD
->
	`gëName
();

3397 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3399  
L
"Empty";

3400 
	}
}

3402 
	gvideoI≈ut
::
	$li°Devi˚s
(
boﬁ
 
sûít
)

3404 
out
 = 0;

3405 if(
ac˚ssToDevi˚s
)

3407 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3408 #ifde‡
WINRT


3409 
VDS
->
	`waôInô
();

3411 
out
 = 
VDS
->
	`gëCou¡
();

3412 if(!
sûít
Ë
	`DebugPrötOut
(
L
"\nVIDEOINPUT SPY MODE!\n\n");

3413 if(!
sûít
Ë
	`DebugPrötOut
(
L
"SETUP: Looking For Capture Devices\n");

3414 
i
 = 0; i < 
out
; i++)

3416 if(!
sûít
Ë
	`DebugPrötOut
(
L
"SETUP: %iË%†\n",
i
, 
	`gëNameVideoDevi˚
(i));

3418 if(!
sûít
Ë
	`DebugPrötOut
(
L
"SETUP: %òDevi˚(sËfound\n\n", 
out
);

3422 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3424  
out
;

3425 
	}
}

3427 
	gvideoI≈ut
& videoI≈ut::
	$gëIn°™˚
()

3429 
videoI≈ut
 
ö°™˚
;

3430  
ö°™˚
;

3431 
	}
}

3433 
boﬁ
 
	gvideoI≈ut
::
	$isDevi˚sAc˚abÀ
()

3435  
ac˚ssToDevi˚s
;

3436 
	}
}

3438 #ifde‡
_DEBUG


3439 
	gvideoI≈ut
::
	$£tVîbo£
(
boﬁ
 
°©e
)

3441 
DPO
 *
dpo
 = &DPO::
	`gëIn°™˚
();

3442 
dpo
->
	`£tVîbo£
(
°©e
);

3443 
	}
}

3446 
	gvideoI≈ut
::
£tEmîgícySt›Evít
(
devi˚ID
, *
u£rD©a
, (*
func
)(, *))

3448 i‡(
devi˚ID
 < 0)

3450 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3453 if(
ac˚ssToDevi˚s
)

3455 if(
func
)

3457 
videoDevi˚s
 *
VDS
 = &videoDevi˚s::
	`gëIn°™˚
();

3458 
videoDevi˚
 * 
VD
 = 
VDS
->
	`gëDevi˚
(
devi˚ID
);

3459 if(
VD
)

3460 
VD
->
	`£tEmîgícySt›Evít
(
u£rD©a
, 
func
);

3465 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3467 
	}
}

3469 
boﬁ
 
	gvideoI≈ut
::
	$gëPixñs
(
devi˚ID
, * 
d°Buf„r
, 
boﬁ
 
ÊùRedAndBlue
, boﬁ 
ÊùImage
)

3471 
boﬁ
 
suc˚ss
 = 
Ál£
;

3472 i‡(
devi˚ID
 < 0)

3474 
	`DebugPrötOut
(
L
"VIDEODEVICE %i: InvÆid devi˚ ID\n", 
devi˚ID
);

3475  
suc˚ss
;

3477 if(
ac˚ssToDevi˚s
)

3479 
boﬁ
 
isRaw
 = 
	`isDevi˚RawD©aSour˚
(
devi˚ID
);

3480 if(
isRaw
)

3482 
videoDevi˚
 *
VD
 = 
videoDevi˚s
::
	`gëIn°™˚
().
	`gëDevi˚
(
devi˚ID
);

3483 
RawImage
 *
RIOut
 = 
VD
->
	`gëRawImageOut
();

3484 if(
RIOut
)

3486 c⁄° 
byãs
 = 3;

3487 c⁄° 
height
 = 
VD
->
	`gëHeight
();

3488 c⁄° 
width
 = 
VD
->
	`gëWidth
();

3489 c⁄° 
size
 = 
byãs
 * 
width
 * 
height
;

3490 if(
size
 =
RIOut
->
	`gëSize
())

3492 
	`¥o˚ssPixñs
(
RIOut
->
	`gëpPixñs
(), 
d°Buf„r
, 
width
, 
height
, 
byãs
, 
ÊùRedAndBlue
, 
ÊùImage
);

3493 
suc˚ss
 = 
åue
;

3497 
	`DebugPrötOut
(
L
"ERROR: GetPixels() - bufferSizes doÇot match!\n");

3502 
	`DebugPrötOut
(
L
"ERROR: GëPixñs(Ë- U«bÀÅÿgøb fømêf‹ devi˚ %i\n", 
devi˚ID
);

3507 
	`DebugPrötOut
(
L
"ERROR: GëPixñs(Ë- NŸÑaw d©®sour˚ devi˚ %i\n", 
devi˚ID
);

3512 
	`DebugPrötOut
(
L
"VIDEODEVICE(s): There isÇotány suitable video device\n");

3514  
suc˚ss
;

3515 
	}
}

3517 
	gvideoI≈ut
::
	$¥o˚ssPixñs
(* 
§c
, * 
d°
, 
width
,

3518 
height
, 
bµ
, 
boﬁ
 
bRGB
, boﬁ 
bFlù
)

3520 
widthInByãs
 = 
width
 * 
bµ
;

3521 
numByãs
 = 
widthInByãs
 * 
height
;

3522 *
d°I¡
, *
§cI¡
;

3523 if(!
bRGB
)

3525 if(
bFlù
)

3527 
y
 = 0; y < 
height
; y++)

3529 
d°I¡
 = (*)(
d°
 + (
y
 * 
widthInByãs
));

3530 
§cI¡
 = (*)(
§c
 + ( (
height
 -
y
 -1Ë* 
widthInByãs
));

3531 
	`mem˝y
(
d°I¡
, 
§cI¡
, 
widthInByãs
);

3536 
	`mem˝y
(
d°
, 
§c
, 
numByãs
);

3541 if(
bFlù
)

3543 
x
 = 0;

3544 
y
 = (
height
 - 1Ë* 
widthInByãs
;

3545 
§c
 +
y
;

3546 
i
 = 0; i < 
numByãs
; i+=3)

3548 if(
x
 >
width
)

3550 
x
 = 0;

3551 
§c
 -
widthInByãs
*2;

3553 *
d°
 = *(
§c
+2);

3554 
d°
++;

3555 *
d°
 = *(
§c
+1);

3556 
d°
++;

3557 *
d°
 = *
§c
;

3558 
d°
++;

3559 
§c
+=3;

3560 
x
++;

3565 
i
 = 0; i < 
numByãs
; i+=3)

3567 *
d°
 = *(
§c
+2);

3568 
d°
++;

3569 *
d°
 = *(
§c
+1);

3570 
d°
++;

3571 *
d°
 = *
§c
;

3572 
d°
++;

3573 
§c
+=3;

3577 
	}
}

3581 ˛as†
	cCvC≠tuªCAM_MSMF
 : 
public
 
CvC≠tuª


3583 
public
:

3584 
CvC≠tuªCAM_MSMF
();

3585 
	mvútuÆ
 ~
CvC≠tuªCAM_MSMF
();

3586 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

3587 
vútuÆ
 
˛o£
();

3588 
vútuÆ
 
	$gëPr›îty
() const;

3589 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

3590 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

3591 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

3592 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_MSMF
; }

3593 
¥Ÿe˘ed
:

3594 
	`öô
();

3595 
ödex
, 
width
, 
height
, 
fourcc
;

3596 
I∂Image
* 
‰ame
;

3597 
videoI≈ut
 
VI
;

3598 #ifde‡
WINRT


3599 #ifde‡
HAVE_CONCURRENCY


3600 
DEFINE_TASK
<
boﬁ
> 
›íTask
;

3601 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
 
lock
;

3604 
	}
};

3606 #ifde‡
_DEBUG


3607 
	sSuµªssVideoI≈utMesßges


3609 
SuµªssVideoI≈utMesßges
(Ë{ 
	mvideoI≈ut
::
£tVîbo£
(
åue
); }

3612 
SuµªssVideoI≈utMesßges
 
	gdo_ô
;

3615 
	gCvC≠tuªCAM_MSMF
::
	$CvC≠tuªCAM_MSMF
():

3616 
	`ödex
(-1),

3617 
	`width
(-1),

3618 
	`height
(-1),

3619 
	`fourcc
(-1),

3620 
	`‰ame
(
NULL
),

3621 
	`VI
(
videoI≈ut
::
	$gëIn°™˚
())

3623 
	`CoInôülize
(0);

3624 
	}
}

3626 
	gCvC≠tuªCAM_MSMF
::~
	$CvC≠tuªCAM_MSMF
()

3628 
	`˛o£
();

3629 
	`CoUnöôülize
();

3630 
	}
}

3632 
	gCvC≠tuªCAM_MSMF
::
	$˛o£
()

3634 if–
ödex
 >= 0 )

3636 
VI
.
	`˛o£Devi˚
(
ödex
);

3637 
ödex
 = -1;

3638 
	`cvRñó£Image
(&
‰ame
);

3640 
width
 = 
height
 = -1;

3641 
	}
}

3644 
boﬁ
 
	gCvC≠tuªCAM_MSMF
::
	$›í
–
_ödex
 )

3646 #ifde‡
WINRT


3647 #ifde‡
HAVE_CONCURRENCY


3648 
	`SAVE_CURRENT_CONTEXT
(
c⁄ãxt
);

3649 autÿ
func
 = [
_ödex
, 
c⁄ãxt
, 
this
](
	`DEFINE_RET_VAL
(
boﬁ
)Ë-> 
	`DEFINE_RET_FORMAL
(bool) {

3652 
åy_ödex
 = 
_ödex
;

3653 
devi˚s
 = 0;

3654 
	`˛o£
();

3655 
devi˚s
 = 
VI
.
	`li°Devi˚s
(
åue
);

3656 i‡(
devi˚s
 == 0)

3657  
Ál£
;

3658 
åy_ödex
 =Åry_ödex < 0 ? 0 : (åy_ödex > 
devi˚s
-1 ? devices-1 :Åry_index);

3659 #ifde‡
WINRT


3660 
HRESULT
 
hr
;

3661 #ifde‡
HAVE_CONCURRENCY


3662 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
this
, 
åy_ödex
)

3665 
VI
.
	`£tupDevi˚
(
åy_ödex
, 0, 0, 0);

3666 #ifde‡
WINRT


3667 #ifde‡
HAVE_CONCURRENCY


3668 
END_CALL_IN_CONTEXT_BASE


3669 
VI
.
	`waôF‹Devi˚
(
åy_ödex
);

3670 
	`BEGIN_CALL_IN_CONTEXT
(
hr
, 
c⁄ãxt
, 
this
, 
åy_ödex
)

3671 
HRESULT
 
hr
 = 
S_OK
;

3674 if–!
VI
.
	`isFømeNew
(
åy_ödex
) )

3675 #ifde‡
WINRT


3676 
hr
 = 
E_FAIL
;

3678  
Ál£
;

3680 
ödex
 = 
åy_ödex
;

3681 #ifde‡
WINRT


3682 #ifde‡
HAVE_CONCURRENCY


3683 
END_CALL_IN_CONTEXT_BASE


3684 
	`RET_VAL
(
åue
)

3686 
C⁄cuºícy
::
¸ôiˇl_£˘i⁄
::
sc›ed_lock
 
	`_LockHﬁdî
(
lock
);

3687 
	`CREATE_OR_CONTINUE_TASK
(
›íTask
, 
boﬁ
, 
func
)

3690  
åue
;

3691 
	}
}

3693 
boﬁ
 
	gCvC≠tuªCAM_MSMF
::
	$gøbFøme
()

3695 
VI
.
	`isDevi˚Sëup
(
ödex
Ë&& !VI.
	`isFømeNew
(index))

3696 
	`SÀï
(1);

3697  
VI
.
	`isDevi˚Sëup
(
ödex
);

3698 
	}
}

3700 
I∂Image
* 
	gCvC≠tuªCAM_MSMF
::
	$ªåõveFøme
()

3702 c⁄° 
w
 = ()
VI
.
	`gëWidth
(
ödex
);

3703 c⁄° 
h
 = ()
VI
.
	`gëHeight
(
ödex
);

3704 if–!
‰ame
 || 
w
 !‰ame->
width
 || 
h
 !‰ame->
height
 )

3706 i‡(
‰ame
)

3707 
	`cvRñó£Image
–&
‰ame
 );

3708 
‰ame
 = 
	`cvCª©eImage
–
	`cvSize
(
w
,
h
), 8, 3 );

3710 
VI
.
	`gëPixñs
–
ödex
, (
uch¨
*)
‰ame
->
imageD©a
, 
Ál£
, 
åue
 );

3711  
‰ame
;

3712 
	}
}

3714 
	gCvC≠tuªCAM_MSMF
::
	$gëPr›îty
–
¥›îty_id
 ) const

3717  
¥›îty_id
 )

3719 
CV_CAP_PROP_FRAME_WIDTH
:

3720  
VI
.
	`gëWidth
(
ödex
);

3721 
CV_CAP_PROP_FRAME_HEIGHT
:

3722  
VI
.
	`gëHeight
(
ödex
);

3723 
CV_CAP_PROP_FPS
:

3724  
VI
.
	`gëFømeR©e
(
ödex
);

3729 
	}
}

3730 
boﬁ
 
	gCvC≠tuªCAM_MSMF
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

3733 
Âs
 = 0;

3734 
boﬁ
 
h™dÀd
 = 
Ál£
;

3735  
¥›îty_id
 )

3737 
CV_CAP_PROP_FRAME_WIDTH
:

3738 
width
 = 
	`cvRound
(
vÆue
);

3739 
Âs
 = 
VI
.
	`gëFømeR©e
(
ödex
);

3740 
h™dÀd
 = 
åue
;

3742 
CV_CAP_PROP_FRAME_HEIGHT
:

3743 
height
 = 
	`cvRound
(
vÆue
);

3744 
Âs
 = 
VI
.
	`gëFømeR©e
(
ödex
);

3745 
h™dÀd
 = 
åue
;

3747 
CV_CAP_PROP_FPS
:

3748 
width
 = ()
VI
.
	`gëHeight
(
ödex
);

3749 
height
 = ()
VI
.
	`gëWidth
(
ödex
);

3750 
Âs
 = 
	`cvRound
(
vÆue
);

3754 i‡–
h™dÀd
 ) {

3755 if–
width
 > 0 && 
height
 > 0 )

3757 if–(
width
 !()
VI
.
	`gëWidth
(
ödex
Ë|| 
height
 !()VI.
	`gëHeight
(ödexË|| 
Âs
 !VI.
	`gëFømeR©e
(index))

3758 && 
VI
.
	`isDevi˚Sëup
(
ödex
))

3760 
VI
.
	`˛o£Devi˚
(
ödex
);

3761 
VI
.
	`£tupDevi˚
(
ödex
, 
width
, 
height
, 
Âs
);

3763 
width
 = 
height
 = -1;

3764  
VI
.
	`isDevi˚Sëup
(
ödex
);

3766  
åue
;

3769  
Ál£
;

3770 
	}
}

3772 ˛as†
	cCvC≠tuªFûe_MSMF
 : 
public
 
CvC≠tuª


3774 
public
:

3775 
CvC≠tuªFûe_MSMF
();

3776 
	mvútuÆ
 ~
CvC≠tuªFûe_MSMF
();

3778 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
 );

3779 
vútuÆ
 
˛o£
();

3781 
vútuÆ
 
	$gëPr›îty
() const;

3782 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

3783 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

3784 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

3785 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_MSMF
; }

3786 
¥Ÿe˘ed
:

3787 
ImageGøbbîThªad
* 
gøbbîThªad
;

3788 
IMFMedüSour˚
* 
videoFûeSour˚
;

3789 
°d
::
ve˘‹
<
MedüTy≥
> 
ˇ±uªF‹m©s
;

3790 
ˇ±uªF‹m©Index
;

3791 
I∂Image
* 
‰ame
;

3792 
boﬁ
 
isO≥√d
;

3794 
HRESULT
 
	`íumî©eC≠tuªF‹m©s
(
IMFMedüSour˚
 *
pSour˚
);

3795 
HRESULT
 
	$gëSour˚Duøti⁄
(
IMFMedüSour˚
 *
pSour˚
, 
MFTIME
 *
pDuøti⁄
) const;

3796 
	}
};

3798 
	gCvC≠tuªFûe_MSMF
::
	$CvC≠tuªFûe_MSMF
():

3799 
	`gøbbîThªad
(
NULL
),

3800 
	`videoFûeSour˚
(
NULL
),

3801 
	`ˇ±uªF‹m©Index
(0),

3802 
	`‰ame
(
NULL
),

3803 
	$isO≥√d
(
Ál£
)

3805 
	`MFSèπup
(
MF_VERSION
);

3806 
	}
}

3808 
	gCvC≠tuªFûe_MSMF
::~
	$CvC≠tuªFûe_MSMF
()

3810 
	`˛o£
();

3811 
	`MFShutdown
();

3812 
	}
}

3814 
boﬁ
 
	gCvC≠tuªFûe_MSMF
::
	$›í
(c⁄° * 
fûíame
)

3816 i‡(!
fûíame
)

3817  
Ál£
;

3819 
wch¨_t
* 
unicodeFûeName
 = 
√w
 wch¨_t[
	`°æí
(
fûíame
)+1];

3820 
	`Mu…iByãToWideCh¨
(
CP_ACP
, 0, 
fûíame
, -1, 
unicodeFûeName
, ()
	`°æí
(filename)+1);

3822 
MF_OBJECT_TYPE
 
Obje˘Ty≥
 = 
MF_OBJECT_INVALID
;

3824 
_ComPå
<
IMFSour˚Resﬁvî
> 
pSour˚Resﬁvî
 = 
NULL
;

3825 
IUnknown
* 
pUnkSour˚
 = 
NULL
;

3827 
HRESULT
 
hr
 = 
	`MFCª©eSour˚Resﬁvî
(
pSour˚Resﬁvî
.
	`GëAddªssOf
());

3829 i‡(
	`SUCCEEDED
(
hr
))

3831 
hr
 = 
pSour˚Resﬁvî
->
	`Cª©eObje˘FromURL
(

3832 
unicodeFûeName
,

3833 
MF_RESOLUTION_MEDIASOURCE
,

3834 
NULL
,

3835 &
Obje˘Ty≥
,

3836 &
pUnkSour˚


3841 i‡(
	`SUCCEEDED
(
hr
))

3843 
hr
 = 
pUnkSour˚
->
	`QuîyI¡îÁ˚
(
	`IID_PPV_ARGS
(&
videoFûeSour˚
));

3846 
	`Sa„Rñó£
(&
pUnkSour˚
);

3848 i‡(
	`SUCCEEDED
(
hr
))

3850 
hr
 = 
	`íumî©eC≠tuªF‹m©s
(
videoFûeSour˚
);

3853 if–
ˇ±uªF‹m©s
.
	`em±y
() )

3855 
isO≥√d
 = 
Ál£
;

3859 i‡(
	`SUCCEEDED
(
hr
))

3861 
hr
 = 
ImageGøbbîThªad
::
	`Cª©eIn°™˚
(&
gøbbîThªad
, 
videoFûeSour˚
, ()-2, 
åue
);

3864 
isO≥√d
 = 
	`SUCCEEDED
(
hr
);

3867 i‡(
isO≥√d
)

3869 
gøbbîThªad
->
	`°¨t
();

3872  
isO≥√d
;

3873 
	}
}

3875 
	gCvC≠tuªFûe_MSMF
::
	$˛o£
()

3877 i‡(
gøbbîThªad
)

3879 
isO≥√d
 = 
Ál£
;

3880 
	`SëEvít
(
gøbbîThªad
->
	`gëImageGøbbî
()->
ig_hFöish
);

3881 
gøbbîThªad
->
	`°›
();

3882 
dñëe
 
gøbbîThªad
;

3885 i‡(
videoFûeSour˚
)

3887 
videoFûeSour˚
->
	`Shutdown
();

3889 
	}
}

3891 
boﬁ
 
	gCvC≠tuªFûe_MSMF
::
	$£tPr›îty
(
¥›îty_id
, 
vÆue
)

3895 (Ë
¥›îty_id
;

3896 (Ë
vÆue
;

3897  
Ál£
;

3898 
	}
}

3900 
	gCvC≠tuªFûe_MSMF
::
	$gëPr›îty
(
¥›îty_id
) const

3903  
¥›îty_id
 )

3905 
CV_CAP_PROP_FRAME_WIDTH
:

3906  
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
width
;

3907 
CV_CAP_PROP_FRAME_HEIGHT
:

3908  
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
height
;

3909 
CV_CAP_PROP_FRAME_COUNT
:

3911 
MFTIME
 
duøti⁄
;

3912 
	`gëSour˚Duøti⁄
(
this
->
videoFûeSour˚
, &
duøti⁄
);

3913 
Âs
 = (()
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_FRAME_RATE_NUMERATOR
) /

3914 (()
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_FRAME_RATE_DENOMINATOR
);

3915  ()
	`Êo‹
((()
duøti⁄
/1e7)*
Âs
+0.5);

3917 
CV_CAP_PROP_FOURCC
:

3918  
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_SUBTYPE
.
D©a1
;

3919 
CV_CAP_PROP_FPS
:

3920  (()
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_FRAME_RATE_NUMERATOR
) /

3921 (()
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_FRAME_RATE_DENOMINATOR
);

3925 
	}
}

3927 
boﬁ
 
	gCvC≠tuªFûe_MSMF
::
	$gøbFøme
()

3929 
DWORD
 
waôResu…
 = (DWORD)-1;

3930 i‡(
isO≥√d
)

3932 
	`SëEvít
(
gøbbîThªad
->
	`gëImageGøbbî
()->
ig_hFømeGøbbed
);

3933 
HANDLE
 
tmp
[] = {
gøbbîThªad
->
	`gëImageGøbbî
()->
ig_hFømeRódy
, gøbbîThªad->gëImageGøbbî()->
ig_hFöish
, 0};

3934 
waôResu…
 = 
	`WaôF‹Mu…ùÀObje˘s
(2, 
tmp
, 
FALSE
, 
INFINITE
);

3937  
isO≥√d
 && 
gøbbîThªad
->
	`gëImageGøbbî
()->
	`gëRawImage
()->
	`isNew
(Ë&& (
waôResu…
 =
WAIT_OBJECT_0
);

3938 
	}
}

3940 
I∂Image
* 
	gCvC≠tuªFûe_MSMF
::
	$ªåõveFøme
()

3942 
width
 = 
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].width;

3943 
height
 = 
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].height;

3944 
byãs
 = 3;

3945 if–!
‰ame
 || ()
width
 !‰ame->width || ()
height
 != frame->height )

3947 i‡(
‰ame
)

3948 
	`cvRñó£Image
–&
‰ame
 );

3949 
‰ame
 = 
	`cvCª©eImage
–
	`cvSize
(
width
,
height
), 8, 3 );

3952 
RawImage
 *
RIOut
 = 
gøbbîThªad
->
	`gëImageGøbbî
()->
	`gëRawImage
();

3953 
size
 = 
byãs
 * 
width
 * 
height
;

3955 
boﬁ
 
vîtiˇlFlù
 = 
ˇ±uªF‹m©s
[
ˇ±uªF‹m©Index
].
MF_MT_DEFAULT_STRIDE
 < 0;

3957 if(
RIOut
 && 
size
 =RIOut->
	`gëSize
())

3959 
videoI≈ut
::
	`¥o˚ssPixñs
(
RIOut
->
	`gëpPixñs
(), (*)
‰ame
->
imageD©a
, 
width
,

3960 
height
, 
byãs
, 
Ál£
, 
vîtiˇlFlù
);

3963  
‰ame
;

3964 
	}
}

3966 
HRESULT
 
	gCvC≠tuªFûe_MSMF
::
	$íumî©eC≠tuªF‹m©s
(
IMFMedüSour˚
 *
pSour˚
)

3968 
_ComPå
<
IMFPª£¡©i⁄Des¸ùt‹
> 
pPD
 = 
NULL
;

3969 
_ComPå
<
IMFSåómDes¸ùt‹
> 
pSD
 = 
NULL
;

3970 
_ComPå
<
IMFMedüTy≥H™dÀr
> 
pH™dÀr
 = 
NULL
;

3971 
_ComPå
<
IMFMedüTy≥
> 
pTy≥
 = 
NULL
;

3972 
HRESULT
 
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(
pPD
.
	`GëAddªssOf
());

3973 i‡(
	`FAILED
(
hr
))

3975 
d⁄e
;

3978 
BOOL
 
fSñe˘ed
;

3979 
hr
 = 
pPD
->
	`GëSåómDes¸ùt‹ByIndex
(0, &
fSñe˘ed
, 
pSD
.
	`GëAddªssOf
());

3980 i‡(
	`FAILED
(
hr
))

3982 
d⁄e
;

3984 
hr
 = 
pSD
->
	`GëMedüTy≥H™dÀr
(
pH™dÀr
.
	`GëAddªssOf
());

3985 i‡(
	`FAILED
(
hr
))

3987 
d⁄e
;

3989 
DWORD
 
cTy≥s
 = 0;

3990 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥Cou¡
(&
cTy≥s
);

3991 i‡(
	`FAILED
(
hr
))

3993 
d⁄e
;

3995 
DWORD
 
i
 = 0; i < 
cTy≥s
; i++)

3997 
hr
 = 
pH™dÀr
->
	`GëMedüTy≥ByIndex
(
i
, 
pTy≥
.
	`GëAddªssOf
());

3998 i‡(
	`FAILED
(
hr
))

4000 
d⁄e
;

4002 
MedüTy≥
 
MT
 = 
F‹m©Ródî
::
	`Ród
(
pTy≥
.
	`Gë
());

4004 if–
MT
.
MF_MT_SUBTYPE
 =
MFVideoF‹m©_RGB24
 )

4005 
ˇ±uªF‹m©s
.
	`push_back
(
MT
);

4008 
d⁄e
:

4009  
hr
;

4010 
	}
}

4012 
HRESULT
 
	gCvC≠tuªFûe_MSMF
::
	$gëSour˚Duøti⁄
(
IMFMedüSour˚
 *
pSour˚
, 
MFTIME
 *
pDuøti⁄
) const

4014 *
pDuøti⁄
 = 0;

4016 
IMFPª£¡©i⁄Des¸ùt‹
 *
pPD
 = 
NULL
;

4018 
HRESULT
 
hr
 = 
pSour˚
->
	`Cª©ePª£¡©i⁄Des¸ùt‹
(&
pPD
);

4019 i‡(
	`SUCCEEDED
(
hr
))

4021 
hr
 = 
pPD
->
	`GëUINT64
(
MF_PD_DURATION
, (
UINT64
*)
pDuøti⁄
);

4022 
pPD
->
	`Rñó£
();

4024  
hr
;

4025 
	}
}

4027 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_MSMF
–
ödex
 )

4029 
CvC≠tuªCAM_MSMF
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_MSMF;

4030 
åy


4032 if–
ˇ±uª
->
	`›í
–
ödex
 ))

4033  
ˇ±uª
;

4035 
	`ˇtch
(...)

4037 
dñëe
 
ˇ±uª
;

4038 
throw
;

4040 
dñëe
 
ˇ±uª
;

4042 
	}
}

4044 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_MSMF
 (c⁄° * 
fûíame
)

4046 
CvC≠tuªFûe_MSMF
* 
ˇ±uª
 = 
√w
 CvCaptureFile_MSMF;

4047 
åy


4049 if–
ˇ±uª
->
	`›í
(
fûíame
) )

4050  
ˇ±uª
;

4053 
dñëe
 
ˇ±uª
;

4054  
NULL
;

4057 
	`ˇtch
(...)

4059 
dñëe
 
ˇ±uª
;

4060 
throw
;

4062 
	}
}

4070 ˛as†
	cCvVideoWrôî_MSMF
 : 
public
 
CvVideoWrôî


4072 
public
:

4073 
CvVideoWrôî_MSMF
();

4074 
	mvútuÆ
 ~
CvVideoWrôî_MSMF
();

4075 
vútuÆ
 
boﬁ
 
›í
(c⁄° * 
fûíame
, 
fourcc
,

4076 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
);

4077 
vútuÆ
 
˛o£
();

4078 
vútuÆ
 
boﬁ
 
wrôeFøme
(c⁄° 
I∂Image
* 
img
);

4080 
	m¥iv©e
:

4081 
UINT32
 
videoWidth
;

4082 
UINT32
 
	mvideoHeight
;

4083 
	mÂs
;

4084 
UINT32
 
	mbôR©e
;

4085 
UINT32
 
	m‰ameSize
;

4086 
GUID
 
	mícodögF‹m©
;

4087 
GUID
 
	möputF‹m©
;

4089 
DWORD
 
	m°ªamIndex
;

4090 
	m_ComPå
<
	mIMFSökWrôî
> 
	msökWrôî
;

4092 
boﬁ
 
	möôüãd
;

4094 
LONGLONG
 
	mπSèπ
;

4095 
UINT64
 
	mπDuøti⁄
;

4097 
HRESULT
 
InôülizeSökWrôî
(c⁄° * 
fûíame
);

4098 c⁄° 
GUID
 
FourCC2GUID
(
fourcc
);

4099 
HRESULT
 
WrôeFøme
(
DWORD
 *
videoFømeBuf„r
, c⁄° 
LONGLONG
& 
πSèπ
, c⁄° LONGLONG& 
πDuøti⁄
);

4102 
	gCvVideoWrôî_MSMF
::
	$CvVideoWrôî_MSMF
():

4103 
	$öôüãd
(
Ál£
)

4105 
	}
}

4107 
CvVideoWrôî_MSMF
::~
	$CvVideoWrôî_MSMF
()

4109 
	`˛o£
();

4110 
	}
}

4112 c⁄° 
GUID
 
	gCvVideoWrôî_MSMF
::
	$FourCC2GUID
(
fourcc
)

4114 
fourcc
)

4116 
	`CV_FOURCC_MACRO
('d', 'v', '2', '5'):

4117  
MFVideoF‹m©_DV25
; ;

4118 
	`CV_FOURCC_MACRO
('d', 'v', '5', '0'):

4119  
MFVideoF‹m©_DV50
; ;

4120 
	`CV_FOURCC_MACRO
('d', 'v', 'c', ' '):

4121  
MFVideoF‹m©_DVC
; ;

4122 
	`CV_FOURCC_MACRO
('d', 'v', 'h', '1'):

4123  
MFVideoF‹m©_DVH1
; ;

4124 
	`CV_FOURCC_MACRO
('d', 'v', 'h', 'd'):

4125  
MFVideoF‹m©_DVHD
; ;

4126 
	`CV_FOURCC_MACRO
('d', 'v', 's', 'd'):

4127  
MFVideoF‹m©_DVSD
; ;

4128 
	`CV_FOURCC_MACRO
('d', 'v', 's', 'l'):

4129  
MFVideoF‹m©_DVSL
; ;

4130 #i‡(
WINVER
 >= 0x0602)

4131 
	`CV_FOURCC_MACRO
('H', '2', '6', '3'):

4132  
MFVideoF‹m©_H263
; ;

4134 
	`CV_FOURCC_MACRO
('H', '2', '6', '4'):

4135  
MFVideoF‹m©_H264
; ;

4136 
	`CV_FOURCC_MACRO
('M', '4', 'S', '2'):

4137  
MFVideoF‹m©_M4S2
; ;

4138 
	`CV_FOURCC_MACRO
('M', 'J', 'P', 'G'):

4139  
MFVideoF‹m©_MJPG
; ;

4140 
	`CV_FOURCC_MACRO
('M', 'P', '4', '3'):

4141  
MFVideoF‹m©_MP43
; ;

4142 
	`CV_FOURCC_MACRO
('M', 'P', '4', 'S'):

4143  
MFVideoF‹m©_MP4S
; ;

4144 
	`CV_FOURCC_MACRO
('M', 'P', '4', 'V'):

4145  
MFVideoF‹m©_MP4V
; ;

4146 
	`CV_FOURCC_MACRO
('M', 'P', 'G', '1'):

4147  
MFVideoF‹m©_MPG1
; ;

4148 
	`CV_FOURCC_MACRO
('M', 'S', 'S', '1'):

4149  
MFVideoF‹m©_MSS1
; ;

4150 
	`CV_FOURCC_MACRO
('M', 'S', 'S', '2'):

4151  
MFVideoF‹m©_MSS2
; ;

4152 
	`CV_FOURCC_MACRO
('W', 'M', 'V', '1'):

4153  
MFVideoF‹m©_WMV1
; ;

4154 
	`CV_FOURCC_MACRO
('W', 'M', 'V', '2'):

4155  
MFVideoF‹m©_WMV2
; ;

4156 
	`CV_FOURCC_MACRO
('W', 'M', 'V', '3'):

4157  
MFVideoF‹m©_WMV3
; ;

4158 
	`CV_FOURCC_MACRO
('W', 'V', 'C', '1'):

4159  
MFVideoF‹m©_WVC1
; ;

4161  
MFVideoF‹m©_H264
;

4163 
	}
}

4165 
boﬁ
 
	gCvVideoWrôî_MSMF
::
	$›í
–c⁄° * 
fûíame
, 
fourcc
,

4166 
_Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 )

4168 
videoWidth
 = 
‰ameSize
.
width
;

4169 
videoHeight
 = 
‰ameSize
.
height
;

4170 
Âs
 = 
_Âs
;

4171 
bôR©e
 = (
UINT32
)
Âs
*
videoWidth
*
videoHeight
;

4172 
ícodögF‹m©
 = 
	`FourCC2GUID
(
fourcc
);

4173 
öputF‹m©
 = 
MFVideoF‹m©_RGB32
;

4175 
HRESULT
 
hr
 = 
	`CoInôülizeEx
(
NULL
, 
COINIT_APARTMENTTHREADED
);

4176 i‡(
	`SUCCEEDED
(
hr
))

4178 
hr
 = 
	`MFSèπup
(
MF_VERSION
);

4179 i‡(
	`SUCCEEDED
(
hr
))

4181 
hr
 = 
	`InôülizeSökWrôî
(
fûíame
);

4182 i‡(
	`SUCCEEDED
(
hr
))

4184 
öôüãd
 = 
åue
;

4185 
πSèπ
 = 0;

4186 
	`MFFømeR©eToAvîageTimePîFøme
((
UINT32
)
Âs
, 1, &
πDuøti⁄
);

4191  
	`SUCCEEDED
(
hr
);

4192 
	}
}

4194 
	gCvVideoWrôî_MSMF
::
	$˛o£
()

4196 i‡(!
öôüãd
)

4201 
öôüãd
 = 
Ál£
;

4202 
sökWrôî
->
	`FöÆize
();

4203 
	`MFShutdown
();

4204 
	}
}

4206 
boﬁ
 
	gCvVideoWrôî_MSMF
::
	$wrôeFøme
(c⁄° 
I∂Image
* 
img
)

4208 i‡(!
img
)

4209  
Ál£
;

4211 
Àngth
 = 
img
->
width
 * img->
height
 * 4;

4212 
DWORD
* 
èrgë
 = 
√w
 DWORD[
Àngth
];

4214 
rowIdx
 = 0;ÑowIdx < 
img
->
height
;ÑowIdx++)

4216 * 
rowSèπ
 = 
img
->
imageD©a
 + 
rowIdx
*img->
widthSãp
;

4217 
cﬁIdx
 = 0; cﬁIdx < 
img
->
width
; colIdx++)

4219 
BYTE
 
b
 = 
rowSèπ
[
cﬁIdx
 * 
img
->
nCh™√ls
 + 0];

4220 
BYTE
 
g
 = 
rowSèπ
[
cﬁIdx
 * 
img
->
nCh™√ls
 + 1];

4221 
BYTE
 
r
 = 
rowSèπ
[
cﬁIdx
 * 
img
->
nCh™√ls
 + 2];

4223 
èrgë
[
rowIdx
*
img
->
width
+
cﬁIdx
] = (
r
 << 16Ë+ (
g
 << 8Ë+ 
b
;

4228 
HRESULT
 
hr
 = 
	`WrôeFøme
(
èrgë
, 
πSèπ
, 
πDuøti⁄
);

4229 i‡(
	`FAILED
(
hr
))

4231 
dñëe
[] 
èrgë
;

4232  
Ál£
;

4234 
πSèπ
 +
πDuøti⁄
;

4236 
dñëe
[] 
èrgë
;

4238  
åue
;

4239 
	}
}

4241 
HRESULT
 
	gCvVideoWrôî_MSMF
::
	$InôülizeSökWrôî
(c⁄° * 
fûíame
)

4243 
_ComPå
<
IMFAâribuãs
> 
•Aâr
;

4244 
_ComPå
<
IMFMedüTy≥
> 
medüTy≥Out
;

4245 
_ComPå
<
IMFMedüTy≥
> 
medüTy≥In
;

4246 
_ComPå
<
IMFByãSåóm
> 
•ByãSåóm
;

4248 
	`MFCª©eAâribuãs
(&
•Aâr
, 10);

4249 
•Aâr
->
	`SëUINT32
(
MF_READWRITE_ENABLE_HARDWARE_TRANSFORMS
, 
åue
);

4251 
wch¨_t
* 
unicodeFûeName
 = 
√w
 wch¨_t[
	`°æí
(
fûíame
)+1];

4252 
	`Mu…iByãToWideCh¨
(
CP_ACP
, 0, 
fûíame
, -1, 
unicodeFûeName
, ()
	`°æí
(filename)+1);

4254 
HRESULT
 
hr
 = 
	`MFCª©eSökWrôîFromURL
(
unicodeFûeName
, 
NULL
, 
•Aâr
.
	`Gë
(), &
sökWrôî
);

4256 
dñëe
[] 
unicodeFûeName
;

4259 i‡(
	`SUCCEEDED
(
hr
))

4261 
hr
 = 
	`MFCª©eMedüTy≥
(&
medüTy≥Out
);

4263 i‡(
	`SUCCEEDED
(
hr
))

4265 
hr
 = 
medüTy≥Out
->
	`SëGUID
(
MF_MT_MAJOR_TYPE
, 
MFMedüTy≥_Video
);

4267 i‡(
	`SUCCEEDED
(
hr
))

4269 
hr
 = 
medüTy≥Out
->
	`SëGUID
(
MF_MT_SUBTYPE
, 
ícodögF‹m©
);

4271 i‡(
	`SUCCEEDED
(
hr
))

4273 
hr
 = 
medüTy≥Out
->
	`SëUINT32
(
MF_MT_AVG_BITRATE
, 
bôR©e
);

4275 i‡(
	`SUCCEEDED
(
hr
))

4277 
hr
 = 
medüTy≥Out
->
	`SëUINT32
(
MF_MT_INTERLACE_MODE
, 
MFVideoI¡îœ˚_Progªssive
);

4279 i‡(
	`SUCCEEDED
(
hr
))

4281 
hr
 = 
	`MFSëAâribuãSize
(
medüTy≥Out
.
	`Gë
(), 
MF_MT_FRAME_SIZE
, 
videoWidth
, 
videoHeight
);

4283 i‡(
	`SUCCEEDED
(
hr
))

4285 
hr
 = 
	`MFSëAâribuãR©io
(
medüTy≥Out
.
	`Gë
(), 
MF_MT_FRAME_RATE
, (
UINT32
)
Âs
, 1);

4287 i‡(
	`SUCCEEDED
(
hr
))

4289 
hr
 = 
	`MFSëAâribuãR©io
(
medüTy≥Out
.
	`Gë
(), 
MF_MT_PIXEL_ASPECT_RATIO
, 1, 1);

4292 i‡(
	`SUCCEEDED
(
hr
))

4294 
hr
 = 
sökWrôî
->
	`AddSåóm
(
medüTy≥Out
.
	`Gë
(), &
°ªamIndex
);

4298 i‡(
	`SUCCEEDED
(
hr
))

4300 
hr
 = 
	`MFCª©eMedüTy≥
(&
medüTy≥In
);

4302 i‡(
	`SUCCEEDED
(
hr
))

4304 
hr
 = 
medüTy≥In
->
	`SëGUID
(
MF_MT_MAJOR_TYPE
, 
MFMedüTy≥_Video
);

4306 i‡(
	`SUCCEEDED
(
hr
))

4308 
hr
 = 
medüTy≥In
->
	`SëGUID
(
MF_MT_SUBTYPE
, 
öputF‹m©
);

4310 i‡(
	`SUCCEEDED
(
hr
))

4312 
hr
 = 
medüTy≥In
->
	`SëUINT32
(
MF_MT_INTERLACE_MODE
, 
MFVideoI¡îœ˚_Progªssive
);

4314 i‡(
	`SUCCEEDED
(
hr
))

4316 
hr
 = 
	`MFSëAâribuãSize
(
medüTy≥In
.
	`Gë
(), 
MF_MT_FRAME_SIZE
, 
videoWidth
, 
videoHeight
);

4318 i‡(
	`SUCCEEDED
(
hr
))

4320 
hr
 = 
	`MFSëAâribuãR©io
(
medüTy≥In
.
	`Gë
(), 
MF_MT_FRAME_RATE
, (
UINT32
)
Âs
, 1);

4322 i‡(
	`SUCCEEDED
(
hr
))

4324 
hr
 = 
	`MFSëAâribuãR©io
(
medüTy≥In
.
	`Gë
(), 
MF_MT_PIXEL_ASPECT_RATIO
, 1, 1);

4327 i‡(
	`SUCCEEDED
(
hr
))

4329 
hr
 = 
sökWrôî
->
	`SëI≈utMedüTy≥
(
°ªamIndex
, 
medüTy≥In
.
	`Gë
(), 
NULL
);

4333 i‡(
	`SUCCEEDED
(
hr
))

4335 
hr
 = 
sökWrôî
->
	`BegöWrôög
();

4338  
hr
;

4339 
	}
}

4341 
HRESULT
 
	gCvVideoWrôî_MSMF
::
	$WrôeFøme
(
DWORD
 *
videoFømeBuf„r
, c⁄° 
LONGLONG
& 
Sèπ
, c⁄° LONGLONG& 
Duøti⁄
)

4343 
_ComPå
<
IMFSam∂e
> 
ßm∂e
;

4344 
_ComPå
<
IMFMedüBuf„r
> 
buf„r
;

4346 c⁄° 
LONG
 
cbWidth
 = 4 * 
videoWidth
;

4347 c⁄° 
DWORD
 
cbBuf„r
 = 
cbWidth
 * 
videoHeight
;

4349 
BYTE
 *
pD©a
 = 
NULL
;

4352 
HRESULT
 
hr
 = 
	`MFCª©eMem‹yBuf„r
(
cbBuf„r
, &
buf„r
);

4355 i‡(
	`SUCCEEDED
(
hr
))

4357 
hr
 = 
buf„r
->
	`Lock
(&
pD©a
, 
NULL
, NULL);

4360 i‡(
	`SUCCEEDED
(
hr
))

4362 #i‡
	`deföed
(
_M_ARM
)

4363 
hr
 = 
	`MFC›yImage
(

4364 
pD©a
,

4365 -
cbWidth
,

4366 (
BYTE
*)
videoFømeBuf„r
,

4367 
cbWidth
,

4368 
cbWidth
,

4369 
videoHeight


4372 
hr
 = 
	`MFC›yImage
(

4373 
pD©a
,

4374 
cbWidth
,

4375 (
BYTE
*)
videoFømeBuf„r
,

4376 
cbWidth
,

4377 
cbWidth
,

4378 
videoHeight


4383 i‡(
buf„r
)

4385 
buf„r
->
	`U∆ock
();

4389 i‡(
	`SUCCEEDED
(
hr
))

4391 
hr
 = 
buf„r
->
	`SëCuºítLígth
(
cbBuf„r
);

4395 i‡(
	`SUCCEEDED
(
hr
))

4397 
hr
 = 
	`MFCª©eSam∂e
(&
ßm∂e
);

4399 i‡(
	`SUCCEEDED
(
hr
))

4401 
hr
 = 
ßm∂e
->
	`AddBuf„r
(
buf„r
.
	`Gë
());

4405 i‡(
	`SUCCEEDED
(
hr
))

4407 
hr
 = 
ßm∂e
->
	`SëSam∂eTime
(
Sèπ
);

4409 i‡(
	`SUCCEEDED
(
hr
))

4411 
hr
 = 
ßm∂e
->
	`SëSam∂eDuøti⁄
(
Duøti⁄
);

4415 i‡(
	`SUCCEEDED
(
hr
))

4417 
hr
 = 
sökWrôî
->
	`WrôeSam∂e
(
°ªamIndex
, 
ßm∂e
.
	`Gë
());

4420  
hr
;

4421 
	}
}

4423 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_MSMF
–c⁄° * 
fûíame
, 
fourcc
,

4424 
Âs
, 
CvSize
 
‰ameSize
, 
isCﬁ‹
 )

4426 
CvVideoWrôî_MSMF
* 
wrôî
 = 
√w
 CvVideoWriter_MSMF;

4427 if–
wrôî
->
	`›í
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
 != 0 ))

4428  
wrôî
;

4429 
dñëe
 
wrôî
;

4430  
NULL
;

4431 
	}
}

	@src/cap_openni.cpp

41 
	~"¥ecomp.hµ
"

42 
	~"›ícv2/c‹e.hµ
"

43 
	~"›ícv2/img¥oc.hµ
"

45 #ifde‡
HAVE_OPENNI


47 #i‡
deföed
 
TBB_INTERFACE_VERSION
 && TBB_INTERFACE_VERSION < 5000

48 #unde‡
HAVE_TBB


51 
	~<queue
>

53 #i‚de‡
i386


54 
	#i386
 0

	)

56 #i‚de‡
__¨m__


57 
	#__¨m__
 0

	)

59 #i‚de‡
_ARC


60 
	#_ARC
 0

	)

62 #i‚de‡
__APPLE__


63 
	#__APPLE__
 0

	)

66 
	~"XnCµWøµî.h
"

68 c⁄° 
	gcv
::
Såög
 
XMLC⁄fig
 =

98 ˛as†
	cAµroxim©eSyncGøbbî


100 
	mpublic
:

101 
Aµroxim©eSyncGøbbî
–
xn
::
C⁄ãxt
 &
_c⁄ãxt
,

102 
xn
::
DïthGíî©‹
 &
_dïthGíî©‹
,

103 
xn
::
ImageGíî©‹
 &
_imageGíî©‹
,

104 
_maxBuf„rSize
, 
boﬁ
 
_isCú˛eBuf„r
, 
_maxTimeDuøti⁄
 ) :

105 
c⁄ãxt
(
_c⁄ãxt
), 
dïthGíî©‹
(
_dïthGíî©‹
), 
imageGíî©‹
(
_imageGíî©‹
),

106 
maxBuf„rSize
(
_maxBuf„rSize
), 
isCú˛eBuf„r
(
_isCú˛eBuf„r
), 
	$maxTimeDuøti⁄
(
_maxTimeDuøti⁄
)

108 #ifde‡
HAVE_TBB


109 
èsk
 = 0;

112 
	`CV_As£π
–
dïthGíî©‹
.
	`IsVÆid
() );

113 
	`CV_As£π
–
imageGíî©‹
.
	`IsVÆid
() );

116 
	$£tMaxBuf„rSize
–
_maxBuf„rSize
 )

118 
maxBuf„rSize
 = 
_maxBuf„rSize
;

119 #ifde‡
HAVE_TBB


120 
èsk
->
	`£tMaxBuf„rSize
();

122 
	}
}

123 
ölöe
 
	$gëMaxBuf„rSize
(Ëc⁄° {  
maxBuf„rSize
; 
	}
}

125 
	$£tIsCú˛eBuf„r
–
boﬁ
 
_isCú˛eBuf„r
 ) { 
isCú˛eBuf„r
 = _isCú˛eBuf„r; 
	}
}

126 
boﬁ
 
	$gëIsCú˛eBuf„r
(Ëc⁄° {  
isCú˛eBuf„r
; 
	}
}

128 
	$£tMaxTimeDuøti⁄
–
_maxTimeDuøti⁄
 ) { 
maxTimeDuøti⁄
 = _maxTimeDuøti⁄; 
	}
}

129 
	$gëMaxTimeDuøti⁄
(Ëc⁄° {  
maxTimeDuøti⁄
; 
	}
}

131 
boﬁ
 
gøb
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
,

132 
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

134 
CV_As£π
–
èsk
 );

137  
	gèsk
->
gøb
(
dïthMëaD©a
, 
imageMëaD©a
Ë=
Ál£
 )

139 #i‚de‡
HAVE_TBB


140 
èsk
->
•ö
();

143  
	gåue
;

147 
	$°¨t
()

149 
	`CV_As£π
–
dïthGíî©‹
.
	`IsVÆid
() );

150 
	`CV_As£π
–
imageGíî©‹
.
	`IsVÆid
() );

151 #ifde‡
HAVE_TBB


152 
èsk
 = 
	`√w
–
tbb
::èsk::
	`Æloˇã_roŸ
(ËË
	`TBBAµroxim©eSynchr⁄izîTask
–*
this
 );

153 
tbb
::
èsk
::
	`íqueue
(*task);

155 
èsk
.
	`ª£t
–
√w
 
	`Aµroxim©eSynchr⁄izî
–*
this
 ) );

157 
	}
}

159 
	$föish
()

161 #ifde‡
HAVE_TBB


162 if–
èsk
 )

163 
tbb
::
èsk
::
	`de°roy
( *task );

165 
èsk
.
	`ªÀa£
();

167 
	}
}

169 
boﬁ
 
	$isRun
(Ëc⁄° {  
èsk
 !0; 
	}
}

171 
	gxn
::
C⁄ãxt
 &
c⁄ãxt
;

172 
	gxn
::
DïthGíî©‹
 &
dïthGíî©‹
;

173 
	gxn
::
ImageGíî©‹
 &
imageGíî©‹
;

175 
	g¥iv©e
:

176 
Aµroxim©eSyncGøbbî
(const ApproximateSyncGrabber&);

177 
	gAµroxim©eSyncGøbbî
& 
	g›î©‹
=(c⁄° 
Aµroxim©eSyncGøbbî
&);

179 
	gmaxBuf„rSize
;

180 
boﬁ
 
	gisCú˛eBuf„r
;

181 
	gmaxTimeDuøti⁄
;

183 ˛as†
	cAµroxim©eSynchr⁄izîBa£


185 
	gpublic
:

186 
Aµroxim©eSynchr⁄izîBa£
–
Aµroxim©eSyncGøbbî
& 
_≠¥oxSyncGøbbî
 ) :

187 
≠¥oxSyncGøbbî
(
_≠¥oxSyncGøbbî
), 
isDïthFûÀd
(
Ál£
), 
isImageFûÀd
(false)

190 
	gvútuÆ
 ~
Aµroxim©eSynchr⁄izîBa£
() {}

192 
vútuÆ
 
boﬁ
 
isSpöC⁄töue
() const = 0;

193 
vútuÆ
 
pushDïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 ) = 0;

194 
vútuÆ
 
pushImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 ) = 0;

195 
vútuÆ
 
boﬁ
 
p›DïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 ) = 0;

196 
vútuÆ
 
boﬁ
 
p›ImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 ) = 0;

198 
•ö
()

200 
isSpöC⁄töue
(Ë=
åue
)

202 
XnSètus
 
°©us
 = 
≠¥oxSyncGøbbî
.
c⁄ãxt
.
WaôAnyUpd©eAŒ
();

203 if–
	g°©us
 !
XN_STATUS_OK
 )

208 
	g≠¥oxSyncGøbbî
.
	gdïthGíî©‹
.
GëMëaD©a
(
dïth
);

209 
	g≠¥oxSyncGøbbî
.
	gimageGíî©‹
.
GëMëaD©a
(
image
);

211 if–
	gdïth
.
D©a
(Ë&& dïth.
IsD©aNew
() )

212 
pushDïthMëaD©a
–
dïth
 );

214 if–
	gimage
.
D©a
(Ë&& image.
IsD©aNew
() )

215 
pushImageMëaD©a
–
image
 );

219 
vútuÆ
 
boﬁ
 
gøb
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
,

220 
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

224 if–!
	gisDïthFûÀd
 )

225 
	gisDïthFûÀd
 = 
p›DïthMëaD©a
(
dïth
);

226 if–!
	gisImageFûÀd
 )

227 
	gisImageFûÀd
 = 
p›ImageMëaD©a
(
image
);

229 if–!
	gisDïthFûÀd
 || !
	gisImageFûÀd
 )

232 
	gtimeDiff
 = 1e-3 * 
°d
::
abs
(
°©ic_ˇ°
<>(
dïth
.
Time°amp
()Ë- sètic_ˇ°<>(
image
.Timestamp()));

234 if–
	gtimeDiff
 <
≠¥oxSyncGøbbî
.
maxTimeDuøti⁄
 )

236 
dïthMëaD©a
.
InôFrom
(
dïth
);

237 
	gimageMëaD©a
.
InôFrom
(
image
);

238 
	gisDïthFûÀd
 = 
isImageFûÀd
 = 
Ál£
;

239  
	gåue
;

243 if–
	gdïth
.
Time°amp
(Ë< 
	gimage
.Timestamp() )

244 
	gisDïthFûÀd
 = 
Ál£
;

246 
	gisImageFûÀd
 = 
Ál£
;

250  
	gÁl£
;

253 
	g¥Ÿe˘ed
:

254 
Aµroxim©eSyncGøbbî
& 
≠¥oxSyncGøbbî
;

255 
	gxn
::
DïthMëaD©a
 
dïth
;

256 
	gxn
::
ImageMëaD©a
 
image
;

257 
boﬁ
 
	gisDïthFûÀd
;

258 
boﬁ
 
	gisImageFûÀd
;

262 ˛as†
	cAµroxim©eSynchr⁄izî
: 
public
 
Aµroxim©eSynchr⁄izîBa£


264 
public
:

265 
Aµroxim©eSynchr⁄izî
–
Aµroxim©eSyncGøbbî
& 
_≠¥oxSyncGøbbî
 ) :

266 
Aµroxim©eSynchr⁄izîBa£
(
_≠¥oxSyncGøbbî
)

269 
vútuÆ
 
boﬁ
 
isSpöC⁄töue
() const

271 
maxBuf„rSize
 = 
≠¥oxSyncGøbbî
.
gëMaxBuf„rSize
();

272  (
	gmaxBuf„rSize
 <0Ë|| (
°©ic_ˇ°
<>(
dïthQueue
.
size
()Ë< 
maxBuf„rSize
 &&

273 
°©ic_ˇ°
<>(
imageQueue
.
size
()Ë< 
maxBuf„rSize
);

276 
vútuÆ
 
ölöe
 
pushDïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 )

278 
cv
::
På
<
xn
::
DïthMëaD©a
> 
dïthPå
 = cv::
makePå
<xn::DepthMetaData>();

279 
	gdïthPå
->
C›yFrom
(
dïthMëaD©a
);

280 
	gdïthQueue
.
push
(
dïthPå
);

282 
vútuÆ
 
ölöe
 
pushImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

284 
cv
::
På
<
xn
::
ImageMëaD©a
> 
imagePå
 = cv::
makePå
<xn::ImageMetaData>();

285 
	gimagePå
->
C›yFrom
(
imageMëaD©a
);

286 
	gimageQueue
.
push
(
imagePå
);

288 
vútuÆ
 
ölöe
 
boﬁ
 
p›DïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 )

290 if–
dïthQueue
.
em±y
() )

291  
Ál£
;

293 
	gdïthMëaD©a
.
C›yFrom
(*
dïthQueue
.
‰⁄t
());

294 
	gdïthQueue
.
p›
();

295  
	gåue
;

297 
vútuÆ
 
ölöe
 
boﬁ
 
p›ImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

299 if–
imageQueue
.
em±y
() )

300  
Ál£
;

302 
	gimageMëaD©a
.
C›yFrom
(*
imageQueue
.
‰⁄t
());

303 
	gimageQueue
.
p›
();

304  
	gåue
;

307 
	g¥iv©e
:

308 
°d
::
queue
<
cv
::
På
<
xn
::
DïthMëaD©a
> > 
dïthQueue
;

309 
	g°d
::
queue
<
cv
::
På
<
xn
::
ImageMëaD©a
> > 
imageQueue
;

312 #ifde‡
HAVE_TBB


314 ˛as†
	cTBBAµroxim©eSynchr⁄izî
: 
public
 
Aµroxim©eSynchr⁄izîBa£


316 
public
:

317 
TBBAµroxim©eSynchr⁄izî
–
Aµroxim©eSyncGøbbî
& 
_≠¥oxSyncGøbbî
 ) :

318 
Aµroxim©eSynchr⁄izîBa£
(
_≠¥oxSyncGøbbî
)

320 
£tMaxBuf„rSize
();

323 
£tMaxBuf„rSize
()

325 
	gmaxBuf„rSize
 = 
≠¥oxSyncGøbbî
.
gëMaxBuf„rSize
();

326 if–
	gmaxBuf„rSize
 >= 0 )

328 
dïthQueue
.
£t_ˇ∑côy
–
maxBuf„rSize
 );

329 
	gimageQueue
.
£t_ˇ∑côy
–
maxBuf„rSize
 );

333 
vútuÆ
 
ölöe
 
boﬁ
 
isSpöC⁄töue
(Ëc⁄° {  
	gåue
; }

335 
vútuÆ
 
ölöe
 
pushDïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 )

337 
cv
::
På
<
xn
::
DïthMëaD©a
> 
dïthPå
 = cv::
makePå
<xn::DïthMëaD©a>(), 
	gtmp
;

338 
	gdïthPå
->
C›yFrom
(
dïthMëaD©a
);

340 
	gtbb
::
muãx
 
mtx
;

341 
	gmtx
.
lock
();

342 if–
	gdïthQueue
.
åy_push
(
dïthPå
Ë=
Ál£
 )

344 if–
≠¥oxSyncGøbbî
.
gëIsCú˛eBuf„r
() )

346 
CV_As£π
–
dïthQueue
.
åy_p›
(
tmp
) );

347 
CV_As£π
–
dïthQueue
.
åy_push
(
dïthPå
) );

350 
	gmtx
.
u∆ock
();

353 
vútuÆ
 
ölöe
 
pushImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

355 
cv
::
På
<
xn
::
ImageMëaD©a
> 
imagePå
 = cv::
makePå
<xn::ImageMëaD©a>(), 
	gtmp
;

356 
	gimagePå
->
C›yFrom
(
imageMëaD©a
);

358 
	gtbb
::
muãx
 
mtx
;

359 
	gmtx
.
lock
();

360 if–
	gimageQueue
.
åy_push
(
imagePå
Ë=
Ál£
 )

362 if–
≠¥oxSyncGøbbî
.
gëIsCú˛eBuf„r
() )

364 
CV_As£π
–
imageQueue
.
åy_p›
(
tmp
) );

365 
CV_As£π
–
imageQueue
.
åy_push
(
imagePå
) );

368 
	gmtx
.
u∆ock
();

371 
vútuÆ
 
ölöe
 
boﬁ
 
p›DïthMëaD©a
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
 )

373 
cv
::
På
<
xn
::
DïthMëaD©a
> 
dïthPå
;

374 
boﬁ
 
	gisP›
 = 
dïthQueue
.
åy_p›
(
dïthPå
);

375 if–
	gisP›
 )

376 
	gdïthMëaD©a
.
C›yFrom
(*
dïthPå
);

377  
	gisP›
;

379 
vútuÆ
 
ölöe
 
boﬁ
 
p›ImageMëaD©a
–
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

381 
cv
::
På
<
xn
::
ImageMëaD©a
> 
imagePå
;

382 
boﬁ
 
	gisP›
 = 
imageQueue
.
åy_p›
(
imagePå
);

383 if–
	gisP›
 )

384 
	gimageMëaD©a
.
C›yFrom
(*
imagePå
);

385  
	gisP›
;

388 
	g¥iv©e
:

389 
tbb
::
c⁄cuºít_bounded_queue
<
cv
::
På
<
xn
::
DïthMëaD©a
> > 
dïthQueue
;

390 
	gtbb
::
c⁄cuºít_bounded_queue
<
cv
::
På
<
xn
::
ImageMëaD©a
> > 
imageQueue
;

393 ˛as†
	cTBBAµroxim©eSynchr⁄izîTask
: 
public
 
tbb
::
èsk


395 
public
:

396 
TBBAµroxim©eSynchr⁄izîTask
–
Aµroxim©eSyncGøbbî
& 
≠¥oxSyncGøbbî
 ) :

397 
synchr⁄izî
(
≠¥oxSyncGøbbî
)

400 
£tMaxBuf„rSize
()

402 
synchr⁄izî
.
£tMaxBuf„rSize
();

405 
boﬁ
 
gøb
–
xn
::
DïthMëaD©a
& 
dïthMëaD©a
,

406 
xn
::
ImageMëaD©a
& 
imageMëaD©a
 )

408  
synchr⁄izî
.
gøb
–
dïthMëaD©a
, 
imageMëaD©a
 );

411 
	g¥iv©e
:

412 
tbb
::
èsk
* 
execuã
()

414 
synchr⁄izî
.
•ö
();

417 
TBBAµroxim©eSynchr⁄izî
 
	gsynchr⁄izî
;

421 #ifde‡
HAVE_TBB


422 
TBBAµroxim©eSynchr⁄izîTask
* 
	gèsk
;

424 
	gcv
::
På
<
Aµroxim©eSynchr⁄izî
> 
èsk
;

429 ˛as†
	cCvC≠tuª_O≥nNI
 : 
public
 
CvC≠tuª


431 
public
:

432 íum { 
DEVICE_DEFAULT
=0, 
	mDEVICE_MS_KINECT
=0, 
	mDEVICE_ASUS_XTION
=1, 
	mDEVICE_MAX
=1 };

434 c⁄° 
	gINVALID_PIXEL_VAL
 = 0;

435 c⁄° 
	gINVALID_COORDINATE_VAL
 = 0;

437 #ifde‡
HAVE_TBB


438 c⁄° 
	gDEFAULT_MAX_BUFFER_SIZE
 = 8;

440 c⁄° 
	gDEFAULT_MAX_BUFFER_SIZE
 = 2;

442 c⁄° 
	gDEFAULT_IS_CIRCLE_BUFFER
 = 0;

443 c⁄° 
	gDEFAULT_MAX_TIME_DURATION
 = 20;

445 
CvC≠tuª_O≥nNI
(
ödex
=0);

446 
CvC≠tuª_O≥nNI
(c⁄° * 
fûíame
);

447 
	gvútuÆ
 ~
CvC≠tuª_O≥nNI
();

449 
vútuÆ
 
	$gëPr›îty
(
¥›Idx
) const;

450 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(
¥obIdx
, 
¥›VÆ
);

451 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

452 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
(
ouçutTy≥
);

454 
boﬁ
 
	$isO≥√d
() const;

456 
¥Ÿe˘ed
:

457 
	sOuçutM≠


459 
public
:

460 
cv
::
M©
 
m©
;

461 
I∂Image
* 
	`gëI∂ImagePå
();

462 
¥iv©e
:

463 
I∂Image
 
ùlHódî
;

464 
	}
};

466 c⁄° 
	gouçutM≠sTy≥sCou¡
 = 7;

468 
XnM≠OuçutMode
 
deÁu…M≠OuçutMode
();

470 
I∂Image
* 
ªåõveDïthM≠
();

471 
I∂Image
* 
ªåõvePoötCloudM≠
();

472 
I∂Image
* 
ªåõveDi•¨ôyM≠
();

473 
I∂Image
* 
ªåõveDi•¨ôyM≠_32F
();

474 
I∂Image
* 
ªåõveVÆidDïthMask
();

475 
I∂Image
* 
ªåõveBGRImage
();

476 
I∂Image
* 
ªåõveGøyImage
();

478 
boﬁ
 
ªadCamîasP¨ams
();

480 
	$gëDïthGíî©‹Pr›îty
(
¥›Idx
) const;

481 
boﬁ
 
	`£tDïthGíî©‹Pr›îty
(
¥›Idx
, 
¥›VÆ
);

482 
	$gëImageGíî©‹Pr›îty
(
¥›Idx
) const;

483 
boﬁ
 
	`£tImageGíî©‹Pr›îty
(
¥›Idx
, 
¥›VÆ
);

484 
	$gëComm⁄Pr›îty
(
¥›Idx
) const;

485 
boﬁ
 
	`£tComm⁄Pr›îty
(
¥›Idx
, 
¥›VÆ
);

488 
xn
::
C⁄ãxt
 
c⁄ãxt
;

489 
boﬁ
 
isC⁄ãxtO≥√d
;

491 
xn
::
Produ˘i⁄Node
 
¥odu˘i⁄Node
;

494 
xn
::
DïthGíî©‹
 
dïthGíî©‹
;

495 
xn
::
DïthMëaD©a
 
dïthMëaD©a
;

497 
xn
::
ImageGíî©‹
 
imageGíî©‹
;

498 
xn
::
ImageMëaD©a
 
imageMëaD©a
;

500 
maxBuf„rSize
, 
maxTimeDuøti⁄
;

501 
boﬁ
 
isCú˛eBuf„r
;

502 
cv
::
På
<
Aµroxim©eSyncGøbbî
> 
≠¥oxSyncGøbbî
;

507 
XnDoubÀ
 
ba£löe
;

509 
XnUI¡64
 
dïthFoˇlLígth_VGA
;

512 
XnUI¡64
 
shadowVÆue
;

514 
XnUI¡64
 
noSam∂eVÆue
;

516 
°d
::
ve˘‹
<
OuçutM≠
> 
ouçutM≠s
;

517 
	}
};

519 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
OuçutM≠
::
	$gëI∂ImagePå
()

521 if–
m©
.
	`em±y
() )

524 
ùlHódî
 = 
	`I∂Image
(
m©
);

525  &
ùlHódî
;

526 
	}
}

528 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$isO≥√d
() const

530  
isC⁄ãxtO≥√d
;

531 
	}
}

533 
XnM≠OuçutMode
 
	gCvC≠tuª_O≥nNI
::
	$deÁu…M≠OuçutMode
()

535 
XnM≠OuçutMode
 
mode
;

536 
mode
.
nXRes
 = 
XN_VGA_X_RES
;

537 
mode
.
nYRes
 = 
XN_VGA_Y_RES
;

538 
mode
.
nFPS
 = 30;

539  
mode
;

540 
	}
}

542 
	gCvC≠tuª_O≥nNI
::
	$CvC≠tuª_O≥nNI
–
ödex
 )

544 
devi˚Ty≥
 = 
DEVICE_DEFAULT
;

545 
XnSètus
 
°©us
;

547 
isC⁄ãxtO≥√d
 = 
Ál£
;

548 
maxBuf„rSize
 = 
DEFAULT_MAX_BUFFER_SIZE
;

549 
isCú˛eBuf„r
 = 
DEFAULT_IS_CIRCLE_BUFFER
;

550 
maxTimeDuøti⁄
 = 
DEFAULT_MAX_TIME_DURATION
;

552 if–
ödex
 >= 10 )

554 
devi˚Ty≥
 = 
ödex
 / 10;

555 
ödex
 %= 10;

558 if–
devi˚Ty≥
 > 
DEVICE_MAX
 )

562 
°©us
 = 
c⁄ãxt
.
	`Inô
();

563 if–
°©us
 !
XN_STATUS_OK
 )

565 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿöôülizêthêc⁄ãxt: %s\n", 
	`xnGëSètusSåög
(
°©us
));

570 
xn
::
NodeInfoLi°
 
devi˚sLi°
;

571 
°©us
 = 
c⁄ãxt
.
	`Enumî©eProdu˘i⁄Tªes
–
XN_NODE_TYPE_DEVICE
, 
NULL
, 
devi˚sLi°
, 0 );

572 if–
°©us
 !
XN_STATUS_OK
 )

574 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿíumî©ê¥odu˘i⁄Åªes: %s\n", 
	`xnGëSètusSåög
(
°©us
));

579 
xn
::
NodeInfoLi°
::
Iãøt‹
 
ô
 = 
devi˚sLi°
.
	`Begö
();

580  
i
 = 0; i < 
ödex
 && 
ô
!=
devi˚sLi°
.
	`End
(); ++i ) it++;

581 i‡–
ô
 =
devi˚sLi°
.
	`End
() )

583 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : Faûed devi˚ wôh index %d\n", 
ödex
);

587 
xn
::
NodeInfo
 
devi˚Node
 = *
ô
;

588 
°©us
 = 
c⁄ãxt
.
	`Cª©eProdu˘i⁄Tªe
–
devi˚Node
, 
¥odu˘i⁄Node
 );

589 if–
°©us
 !
XN_STATUS_OK
 )

591 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿ¸óãÖrodu˘i⁄Åªe: %s\n", 
	`xnGëSètusSåög
(
°©us
));

595 
xn
::
S¸ùtNode
 
s¸ùtNode
;

596 
°©us
 = 
c⁄ãxt
.
	`RunXmlS¸ùt
–
XMLC⁄fig
.
	`c_°r
(), 
s¸ùtNode
 );

597 if–
°©us
 !
XN_STATUS_OK
 )

599 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿru¿xm»s¸ùt: %s\n", 
	`xnGëSètusSåög
(
°©us
));

605 
xn
::
NodeInfoLi°
 
dïthLi°
;

606 
°©us
 = 
c⁄ãxt
.
	`Enumî©eExi°ögNodes
–
dïthLi°
, 
XN_NODE_TYPE_DEPTH
 );

607 if–
°©us
 !
XN_STATUS_OK
 )

609 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿíumî©êdïth gíî©‹s: %s\n", 
	`xnGëSètusSåög
(
°©us
));

612 if–
dïthLi°
.
	`IsEm±y
() )

614 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::CvCapture_OpenNI : The device doesn't have depth generator. Such devicesáren't supportedÇow.\n");

617 
°©us
 = 
dïthGíî©‹
.
	`Cª©e
–
c⁄ãxt
 );

618 if–
°©us
 !
XN_STATUS_OK
 )

620 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿ¸óã dïth gíî©‹: %s\n", 
	`xnGëSètusSåög
(
°©us
));

625 
xn
::
NodeInfoLi°
 
imageLi°
;

626 
°©us
 = 
c⁄ãxt
.
	`Enumî©eExi°ögNodes
–
imageLi°
, 
XN_NODE_TYPE_IMAGE
 );

627 if–
°©us
 !
XN_STATUS_OK
 )

629 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿíumî©êimagêgíî©‹s: %s\n", 
	`xnGëSètusSåög
(
°©us
));

633 if–!
imageLi°
.
	`IsEm±y
() )

635 
°©us
 = 
imageGíî©‹
.
	`Cª©e
–
c⁄ãxt
 );

636 if–
°©us
 !
XN_STATUS_OK
 )

638 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿ¸óã imagêgíî©‹: %s\n", 
	`xnGëSètusSåög
(
°©us
));

644 if–
dïthGíî©‹
.
	`IsVÆid
() )

646 
	`CV_DbgAs£π
–
dïthGíî©‹
.
	`SëM≠OuçutMode
(
	`deÁu…M≠OuçutMode
()Ë=
XN_STATUS_OK
 );

648 if–
imageGíî©‹
.
	`IsVÆid
() )

650 
	`CV_DbgAs£π
–
imageGíî©‹
.
	`SëM≠OuçutMode
(
	`deÁu…M≠OuçutMode
()Ë=
XN_STATUS_OK
 );

653 if–
devi˚Ty≥
 =
DEVICE_ASUS_XTION
 )

656 
imageGíî©‹
.
	`SëI¡Pr›îty
("InputFormat", 1 );

657 
imageGíî©‹
.
	`SëPixñF‹m©
(
XN_PIXEL_FORMAT_RGB24
);

658 
dïthGíî©‹
.
	`SëI¡Pr›îty
("RegistrationType", 1 );

662 
°©us
 = 
c⁄ãxt
.
	`SèπGíî©ögAŒ
();

663 if–
°©us
 !
XN_STATUS_OK
 )

665 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿ°¨àgíî©ög O≥nNI d©a: %s\n", 
	`xnGëSètusSåög
(
°©us
));

669 if–!
	`ªadCamîasP¨ams
() )

671 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::CvCapture_OpenNI : CouldÇotÑead camerasÖarameters\n");

675 
ouçutM≠s
.
	`ªsize
–
ouçutM≠sTy≥sCou¡
 );

677 
isC⁄ãxtO≥√d
 = 
åue
;

679 
	`£tPr›îty
(
CV_CAP_PROP_OPENNI_REGISTRATION
, 1.0);

680 
	}
}

682 
	gCvC≠tuª_O≥nNI
::
	$CvC≠tuª_O≥nNI
(c⁄° * 
fûíame
)

684 
XnSètus
 
°©us
;

686 
isC⁄ãxtO≥√d
 = 
Ál£
;

687 
maxBuf„rSize
 = 
DEFAULT_MAX_BUFFER_SIZE
;

688 
isCú˛eBuf„r
 = 
DEFAULT_IS_CIRCLE_BUFFER
;

689 
maxTimeDuøti⁄
 = 
DEFAULT_MAX_TIME_DURATION
;

692 
°©us
 = 
c⁄ãxt
.
	`Inô
();

693 if–
°©us
 !
XN_STATUS_OK
 )

695 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿöôülizêthêc⁄ãxt: %s\n", 
	`xnGëSètusSåög
(
°©us
));

700 
°©us
 = 
c⁄ãxt
.
	`O≥nFûeRec‹dög
–
fûíame
, 
¥odu˘i⁄Node
 );

701 if–
°©us
 !
XN_STATUS_OK
 )

703 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::CvC≠tuª_O≥nNI : FaûedÅÿ›í i≈uàfûê(%s): %s\n", 
fûíame
, 
	`xnGëSètusSåög
(
°©us
));

707 
c⁄ãxt
.
	`FödExi°ögNode
–
XN_NODE_TYPE_DEPTH
, 
dïthGíî©‹
 );

708 
c⁄ãxt
.
	`FödExi°ögNode
–
XN_NODE_TYPE_IMAGE
, 
imageGíî©‹
 );

710 if–!
	`ªadCamîasP¨ams
() )

712 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::CvCapture_OpenNI : CouldÇotÑead camerasÖarameters\n");

716 
ouçutM≠s
.
	`ªsize
–
ouçutM≠sTy≥sCou¡
 );

718 
isC⁄ãxtO≥√d
 = 
åue
;

719 
	}
}

721 
	gCvC≠tuª_O≥nNI
::~
	$CvC≠tuª_O≥nNI
()

723 
c⁄ãxt
.
	`St›Gíî©ögAŒ
();

724 
c⁄ãxt
.
	`Rñó£
();

725 
	}
}

727 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$ªadCamîasP¨ams
()

729 
XnDoubÀ
 
pixñSize
 = 0;

730 if–
dïthGíî©‹
.
	`GëRólPr›îty
–"ZPPS", 
pixñSize
 ) !
XN_STATUS_OK
 )

732 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::readCamerasParams : CouldÇotÑeadÖixel size!\n");

733  
Ál£
;

737 
pixñSize
 *= 2.0;

740 
XnUI¡64
 
zîoPœnDi°™˚
;

741 if–
dïthGíî©‹
.
	`GëI¡Pr›îty
–"ZPD", 
zîoPœnDi°™˚
 ) !
XN_STATUS_OK
 )

743 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::readCamerasParams : CouldÇotÑead virtualÖlane distance!\n");

744  
Ál£
;

747 if–
dïthGíî©‹
.
	`GëRólPr›îty
–"LDDIS", 
ba£löe
 ) !
XN_STATUS_OK
 )

749 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::readCamerasParams : CouldÇotÑead baseÜine!\n");

750  
Ál£
;

754 
ba£löe
 *= 10;

757 
dïthFoˇlLígth_VGA
 = (
XnUI¡64
)(()
zîoPœnDi°™˚
 / ()
pixñSize
);

759 if–
dïthGíî©‹
.
	`GëI¡Pr›îty
–"ShadowVÆue", 
shadowVÆue
 ) !
XN_STATUS_OK
 )

761 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::readCamerasParams : CouldÇotÑeadÖroperty \"ShadowValue\"!\n");

762  
Ál£
;

765 if–
dïthGíî©‹
.
	`GëI¡Pr›îty
("NoSam∂eVÆue", 
noSam∂eVÆue
 ) !
XN_STATUS_OK
 )

767 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::readCamerasParams : CouldÇotÑeadÖroperty \"NoSampleValue\"!\n");

768  
Ál£
;

771  
åue
;

772 
	}
}

774 
	gCvC≠tuª_O≥nNI
::
	$gëPr›îty
–
¥›Idx
 ) const

776 
¥›VÆue
 = 0;

778 if–
	`isO≥√d
() )

780 
puªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_OPENNI_GENERATORS_MASK
;

782 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_IMAGE_GENERATOR
 )

784 
¥›VÆue
 = 
	`gëImageGíî©‹Pr›îty
–
puªPr›Idx
 );

786 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_DEPTH_GENERATOR
 )

788 
¥›VÆue
 = 
	`gëDïthGíî©‹Pr›îty
–
puªPr›Idx
 );

792 
¥›VÆue
 = 
	`gëComm⁄Pr›îty
–
puªPr›Idx
 );

796  
¥›VÆue
;

797 
	}
}

799 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$£tPr›îty
–
¥›Idx
, 
¥›VÆue
 )

801 
boﬁ
 
isSë
 = 
Ál£
;

802 if–
	`isO≥√d
() )

804 
puªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_OPENNI_GENERATORS_MASK
;

806 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_IMAGE_GENERATOR
 )

808 
isSë
 = 
	`£tImageGíî©‹Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

810 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_DEPTH_GENERATOR
 )

812 
isSë
 = 
	`£tDïthGíî©‹Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

816 
isSë
 = 
	`£tComm⁄Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

820  
isSë
;

821 
	}
}

823 
	gCvC≠tuª_O≥nNI
::
	$gëComm⁄Pr›îty
–
¥›Idx
 ) const

825 
¥›VÆue
 = 0;

827  
¥›Idx
 )

834 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

835 
CV_CAP_PROP_FRAME_WIDTH
 :

836 
CV_CAP_PROP_FRAME_HEIGHT
 :

837 
CV_CAP_PROP_FPS
 :

838 
CV_CAP_PROP_OPENNI_FRAME_MAX_DEPTH
 :

839 
CV_CAP_PROP_OPENNI_BASELINE
 :

840 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
 :

841 
CV_CAP_PROP_OPENNI_REGISTRATION
 :

842 
¥›VÆue
 = 
	`gëDïthGíî©‹Pr›îty
–
¥›Idx
 );

844 
CV_CAP_PROP_OPENNI_APPROX_FRAME_SYNC
 :

845 
¥›VÆue
 = !
≠¥oxSyncGøbbî
.
	`em±y
(Ë&&áµroxSyncGøbbî->
	`isRun
() ? 1. : 0.;

847 
CV_CAP_PROP_OPENNI_MAX_BUFFER_SIZE
 :

848 
¥›VÆue
 = 
maxBuf„rSize
;

850 
CV_CAP_PROP_OPENNI_CIRCLE_BUFFER
 :

851 
¥›VÆue
 = 
isCú˛eBuf„r
 ? 1. : 0.;

853 
CV_CAP_PROP_OPENNI_MAX_TIME_DURATION
 :

854 
¥›VÆue
 = 
maxTimeDuøti⁄
;

857 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("SuchÖ¨amëî (¥›Idx=%dËi¢'àsuµ‹ãd f‹ gëtög.\n", 
¥›Idx
) );

860  
¥›VÆue
;

861 
	}
}

863 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$£tComm⁄Pr›îty
–
¥›Idx
, 
¥›VÆue
 )

865 
boﬁ
 
isSë
 = 
Ál£
;

867  
¥›Idx
 )

871 
CV_CAP_PROP_OPENNI_REGISTRATION
:

872 
isSë
 = 
	`£tDïthGíî©‹Pr›îty
–
¥›Idx
, 
¥›VÆue
 );

874 
CV_CAP_PROP_OPENNI_APPROX_FRAME_SYNC
 :

875 if–
¥›VÆue
 && 
dïthGíî©‹
.
	`IsVÆid
(Ë&& 
imageGíî©‹
.IsValid() )

878 if–
≠¥oxSyncGøbbî
.
	`em±y
() )

880 
≠¥oxSyncGøbbî
.
	`ª£t
(
√w
 
	`Aµroxim©eSyncGøbbî
–
c⁄ãxt
, 
dïthGíî©‹
, 
imageGíî©‹
, 
maxBuf„rSize
, 
isCú˛eBuf„r
, 
maxTimeDuøti⁄
 ));

884 
≠¥oxSyncGøbbî
->
	`föish
();

887 
≠¥oxSyncGøbbî
->
	`£tMaxBuf„rSize
(
maxBuf„rSize
);

888 
≠¥oxSyncGøbbî
->
	`£tIsCú˛eBuf„r
(
isCú˛eBuf„r
);

889 
≠¥oxSyncGøbbî
->
	`£tMaxTimeDuøti⁄
(
maxTimeDuøti⁄
);

891 
≠¥oxSyncGøbbî
->
	`°¨t
();

893 if–!
¥›VÆue
 && !
≠¥oxSyncGøbbî
.
	`em±y
() )

896 
≠¥oxSyncGøbbî
->
	`föish
();

899 
CV_CAP_PROP_OPENNI_MAX_BUFFER_SIZE
 :

900 
maxBuf„rSize
 = 
	`cvRound
(
¥›VÆue
);

901 if–!
≠¥oxSyncGøbbî
.
	`em±y
() )

902 
≠¥oxSyncGøbbî
->
	`£tMaxBuf„rSize
(
maxBuf„rSize
);

904 
CV_CAP_PROP_OPENNI_CIRCLE_BUFFER
 :

905 if–!
≠¥oxSyncGøbbî
.
	`em±y
() )

906 
≠¥oxSyncGøbbî
->
	`£tIsCú˛eBuf„r
(
isCú˛eBuf„r
);

908 
CV_CAP_PROP_OPENNI_MAX_TIME_DURATION
 :

909 
maxTimeDuøti⁄
 = 
	`cvRound
(
¥›VÆue
);

910 if–!
≠¥oxSyncGøbbî
.
	`em±y
() )

911 
≠¥oxSyncGøbbî
->
	`£tMaxTimeDuøti⁄
(
maxTimeDuøti⁄
);

914 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("SuchÖ¨amëî (¥›Idx=%dËi¢'àsuµ‹ãd f‹ sëtög.\n", 
¥›Idx
) );

917  
isSë
;

918 
	}
}

920 
	gCvC≠tuª_O≥nNI
::
	$gëDïthGíî©‹Pr›îty
–
¥›Idx
 ) const

922 
¥›VÆue
 = 0;

923 if–!
dïthGíî©‹
.
	`IsVÆid
() )

924  
¥›VÆue
;

926 
XnM≠OuçutMode
 
mode
;

928  
¥›Idx
 )

930 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

931 
	`CV_DbgAs£π
–
dïthGíî©‹
.
	`IsVÆid
() );

932 
¥›VÆue
 = 1.;

934 
CV_CAP_PROP_FRAME_WIDTH
 :

935 if–
dïthGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

936 
¥›VÆue
 = 
mode
.
nXRes
;

938 
CV_CAP_PROP_FRAME_HEIGHT
 :

939 if–
dïthGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

940 
¥›VÆue
 = 
mode
.
nYRes
;

942 
CV_CAP_PROP_FPS
 :

943 if–
dïthGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

944 
¥›VÆue
 = 
mode
.
nFPS
;

946 
CV_CAP_PROP_OPENNI_FRAME_MAX_DEPTH
 :

947 
¥›VÆue
 = 
dïthGíî©‹
.
	`GëDevi˚MaxDïth
();

949 
CV_CAP_PROP_OPENNI_BASELINE
 :

950 
¥›VÆue
 = 
ba£löe
;

952 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
 :

953 
¥›VÆue
 = ()
dïthFoˇlLígth_VGA
;

955 
CV_CAP_PROP_OPENNI_REGISTRATION
 :

956 
¥›VÆue
 = 
dïthGíî©‹
.
	`GëA…î«tiveVõwPoötC≠
().
	`IsVõwPoötAs
(
c⁄°_ˇ°
<
CvC≠tuª_O≥nNI
 *>(
this
)->
imageGíî©‹
) ? 1.0 : 0.0;

958 
CV_CAP_PROP_POS_MSEC
 :

959 
¥›VÆue
 = ()
dïthGíî©‹
.
	`GëTime°amp
();

961 
CV_CAP_PROP_POS_FRAMES
 :

962 
¥›VÆue
 = 
dïthGíî©‹
.
	`GëFømeID
();

965 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Dïth gíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ gëtög.\n", 
¥›Idx
) );

968  
¥›VÆue
;

969 
	}
}

971 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$£tDïthGíî©‹Pr›îty
–
¥›Idx
, 
¥›VÆue
 )

973 
boﬁ
 
isSë
 = 
Ál£
;

975 
	`CV_As£π
–
dïthGíî©‹
.
	`IsVÆid
() );

977  
¥›Idx
 )

979 
CV_CAP_PROP_OPENNI_REGISTRATION
:

981 if–
¥›VÆue
 != 0.0 )

985 if–
imageGíî©‹
.
	`IsVÆid
() )

987 if–!
dïthGíî©‹
.
	`GëA…î«tiveVõwPoötC≠
().
	`IsVõwPoötAs
(
imageGíî©‹
) )

989 if–
dïthGíî©‹
.
	`GëA…î«tiveVõwPoötC≠
().
	`IsVõwPoötSuµ‹ãd
(
imageGíî©‹
) )

991 
XnSètus
 
°©us
 = 
dïthGíî©‹
.
	`GëA…î«tiveVõwPoötC≠
().
	`SëVõwPoöt
(
imageGíî©‹
);

992 if–
°©us
 !
XN_STATUS_OK
 )

993 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::£tDïthGíî©‹Pr›îty : %s\n", 
	`xnGëSètusSåög
(
°©us
));

995 
isSë
 = 
åue
;

998 
	`Ârötf
(
°dîr
, "CvCapture_OpenNI::setDepthGeneratorProperty : Unsupported viewpoint.\n");

1001 
isSë
 = 
åue
;

1006 
XnSètus
 
°©us
 = 
dïthGíî©‹
.
	`GëA…î«tiveVõwPoötC≠
().
	`Re£tVõwPoöt
();

1007 if–
°©us
 !
XN_STATUS_OK
 )

1008 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::£tDïthGíî©‹Pr›îty : %s\n", 
	`xnGëSètusSåög
(
°©us
));

1010 
isSë
 = 
åue
;

1015 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Dïth gíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ sëtög.\n", 
¥›Idx
) );

1018  
isSë
;

1019 
	}
}

1021 
	gCvC≠tuª_O≥nNI
::
	$gëImageGíî©‹Pr›îty
–
¥›Idx
 ) const

1023 
¥›VÆue
 = 0.;

1024 if–!
imageGíî©‹
.
	`IsVÆid
() )

1025  
¥›VÆue
;

1027 
XnM≠OuçutMode
 
mode
;

1028  
¥›Idx
 )

1030 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

1031 
	`CV_DbgAs£π
–
imageGíî©‹
.
	`IsVÆid
() );

1032 
¥›VÆue
 = 1.;

1034 
CV_CAP_PROP_FRAME_WIDTH
 :

1035 if–
imageGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

1036 
¥›VÆue
 = 
mode
.
nXRes
;

1038 
CV_CAP_PROP_FRAME_HEIGHT
 :

1039 if–
imageGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

1040 
¥›VÆue
 = 
mode
.
nYRes
;

1042 
CV_CAP_PROP_FPS
 :

1043 if–
imageGíî©‹
.
	`GëM≠OuçutMode
(
mode
Ë=
XN_STATUS_OK
 )

1044 
¥›VÆue
 = 
mode
.
nFPS
;

1046 
CV_CAP_PROP_POS_MSEC
 :

1047 
¥›VÆue
 = ()
imageGíî©‹
.
	`GëTime°amp
();

1049 
CV_CAP_PROP_POS_FRAMES
 :

1050 
¥›VÆue
 = ()
imageGíî©‹
.
	`GëFømeID
();

1053 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Imagêgíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ gëtög.\n", 
¥›Idx
) );

1056  
¥›VÆue
;

1057 
	}
}

1059 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$£tImageGíî©‹Pr›îty
–
¥›Idx
, 
¥›VÆue
 )

1061 
boﬁ
 
isSë
 = 
Ál£
;

1062 if–!
imageGíî©‹
.
	`IsVÆid
() )

1063  
isSë
;

1065  
¥›Idx
 )

1067 
CV_CAP_PROP_OPENNI_OUTPUT_MODE
 :

1069 
XnM≠OuçutMode
 
mode
;

1071  
	`cvRound
(
¥›VÆue
) )

1073 
CV_CAP_OPENNI_VGA_30HZ
 :

1074 
mode
.
nXRes
 = 
XN_VGA_X_RES
;

1075 
mode
.
nYRes
 = 
XN_VGA_Y_RES
;

1076 
mode
.
nFPS
 = 30;

1078 
CV_CAP_OPENNI_SXGA_15HZ
 :

1079 
mode
.
nXRes
 = 
XN_SXGA_X_RES
;

1080 
mode
.
nYRes
 = 
XN_SXGA_Y_RES
;

1081 
mode
.
nFPS
 = 15;

1083 
CV_CAP_OPENNI_SXGA_30HZ
 :

1084 
mode
.
nXRes
 = 
XN_SXGA_X_RES
;

1085 
mode
.
nYRes
 = 
XN_SXGA_Y_RES
;

1086 
mode
.
nFPS
 = 30;

1088 
CV_CAP_OPENNI_QVGA_30HZ
 :

1089 
mode
.
nXRes
 = 
XN_QVGA_X_RES
;

1090 
mode
.
nYRes
 = 
XN_QVGA_Y_RES
;

1091 
mode
.
nFPS
 = 30;

1093 
CV_CAP_OPENNI_QVGA_60HZ
 :

1094 
mode
.
nXRes
 = 
XN_QVGA_X_RES
;

1095 
mode
.
nYRes
 = 
XN_QVGA_Y_RES
;

1096 
mode
.
nFPS
 = 60;

1099 
	`CV_Eº‹
–
CV_StsBadArg
, "Unsupported image generator output mode.\n");

1102 
XnSètus
 
°©us
 = 
imageGíî©‹
.
	`SëM≠OuçutMode
–
mode
 );

1103 if–
°©us
 !
XN_STATUS_OK
 )

1104 
	`Ârötf
(
°dîr
, "CvC≠tuª_O≥nNI::£tImageGíî©‹Pr›îty : %s\n", 
	`xnGëSètusSåög
(
°©us
));

1106 
isSë
 = 
åue
;

1110 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Imagêgíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ sëtög.\n", 
¥›Idx
) );

1113  
isSë
;

1114 
	}
}

1116 
boﬁ
 
	gCvC≠tuª_O≥nNI
::
	$gøbFøme
()

1118 if–!
	`isO≥√d
() )

1119  
Ál£
;

1121 
boﬁ
 
isGøbbed
 = 
Ál£
;

1122 if–!
≠¥oxSyncGøbbî
.
	`em±y
(Ë&&áµroxSyncGøbbî->
	`isRun
() )

1124 
isGøbbed
 = 
≠¥oxSyncGøbbî
->
	`gøb
–
dïthMëaD©a
, 
imageMëaD©a
 );

1128 
XnSètus
 
°©us
 = 
c⁄ãxt
.
	`WaôAndUpd©eAŒ
();

1129 if–
°©us
 !
XN_STATUS_OK
 )

1130  
Ál£
;

1132 if–
dïthGíî©‹
.
	`IsVÆid
() )

1133 
dïthGíî©‹
.
	`GëMëaD©a
–
dïthMëaD©a
 );

1134 if–
imageGíî©‹
.
	`IsVÆid
() )

1135 
imageGíî©‹
.
	`GëMëaD©a
–
imageMëaD©a
 );

1136 
isGøbbed
 = 
åue
;

1139  
isGøbbed
;

1140 
	}
}

1142 
ölöe
 
gëDïthM≠FromMëaD©a
–c⁄° 
xn
::
DïthMëaD©a
& 
dïthMëaD©a
, 
cv
::
M©
& 
dïthM≠
, 
XnUI¡64
 
noSam∂eVÆue
, XnUI¡64 
shadowVÆue
 )

1144 
	gcﬁs
 = 
dïthMëaD©a
.
XRes
();

1145 
	grows
 = 
dïthMëaD©a
.
YRes
();

1147 
	gdïthM≠
.
¸óã
–
rows
, 
cﬁs
, 
CV_16UC1
 );

1149 c⁄° 
XnDïthPixñ
* 
	gpDïthM≠
 = 
dïthMëaD©a
.
D©a
();

1152 
mem˝y
–
dïthM≠
.
d©a
, 
pDïthM≠
, 
cﬁs
*
rows
*(
XnDïthPixñ
) );

1154 
	gcv
::
M©
 
badMask
 = (
dïthM≠
 =()
noSam∂eVÆue
Ë| (dïthM≠ =()
shadowVÆue
) | (depthMap == 0);

1157 
	gdïthM≠
.
£tTo
–
cv
::
Sˇœr
::
Æl
–
CvC≠tuª_O≥nNI
::
INVALID_PIXEL_VAL
 ), 
badMask
 );

1160 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveDïthM≠
()

1162 if–!
dïthMëaD©a
.
	`D©a
() )

1165 
	`gëDïthM≠FromMëaD©a
–
dïthMëaD©a
, 
ouçutM≠s
[
CV_CAP_OPENNI_DEPTH_MAP
].
m©
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1167  
ouçutM≠s
[
CV_CAP_OPENNI_DEPTH_MAP
].
	`gëI∂ImagePå
();

1168 
	}
}

1170 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõvePoötCloudM≠
()

1172 if–!
dïthMëaD©a
.
	`D©a
() )

1175 
cv
::
M©
 
dïth
;

1176 
	`gëDïthM≠FromMëaD©a
–
dïthMëaD©a
, 
dïth
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1178 c⁄° 
badPoöt
 = 
INVALID_PIXEL_VAL
;

1179 c⁄° 
badCo‹d
 = 
INVALID_COORDINATE_VAL
;

1180 
cﬁs
 = 
dïthMëaD©a
.
	`XRes
(), 
rows
 = dïthMëaD©a.
	`YRes
();

1181 
cv
::
M©
 
	`poötCloud_XYZ
–
rows
, 
cﬁs
, 
CV_32FC3
, cv::
Sˇœr
::
	`Æl
(
badPoöt
) );

1183 
°d
::
ve˘‹
<
XnPoöt3D
> 
	`¥oj
(
cﬁs
*
rows
);

1184 
°d
::
ve˘‹
<
XnPoöt3D
> 
	`ªÆ
(
cﬁs
*
rows
);

1185  
y
 = 0; y < 
rows
; y++ )

1187  
x
 = 0; x < 
cﬁs
; x++ )

1189 
öd
 = 
y
*
cﬁs
+
x
;

1190 
¥oj
[
öd
].
X
 = ()
x
;

1191 
¥oj
[
öd
].
Y
 = ()
y
;

1192 
¥oj
[
öd
].
Z
 = 
dïth
.
©
<>(
y
, 
x
);

1195 
dïthGíî©‹
.
	`C⁄vîtProje˘iveToRólW‹ld
(
cﬁs
*
rows
, &
¥oj
.
	`‰⁄t
(), &
ªÆ
.front());

1197  
y
 = 0; y < 
rows
; y++ )

1199  
x
 = 0; x < 
cﬁs
; x++ )

1202 if–
dïth
.
©
<>(
y
, 
x
Ë=
badPoöt
 )

1203 
poötCloud_XYZ
.
©
<
cv
::
Poöt3f
>(
y
,
x
Ëcv::
	`Poöt3f
–
badCo‹d
, badCoord, badCoord );

1206 
öd
 = 
y
*
cﬁs
+
x
;

1207 
poötCloud_XYZ
.
©
<
cv
::
Poöt3f
>(
y
,
x
Ëcv::
	`Poöt3f
–
ªÆ
[
öd
].
X
*0.001f,Ñól[öd].
Y
*0.001f,Ñól[öd].
Z
*0.001f);

1212 
ouçutM≠s
[
CV_CAP_OPENNI_POINT_CLOUD_MAP
].
m©
 = 
poötCloud_XYZ
;

1214  
ouçutM≠s
[
CV_CAP_OPENNI_POINT_CLOUD_MAP
].
	`gëI∂ImagePå
();

1215 
	}
}

1217 
compuãDi•¨ôy_32F
–c⁄° 
xn
::
DïthMëaD©a
& 
dïthMëaD©a
, 
cv
::
M©
& 
di•
, 
XnDoubÀ
 
ba£löe
, 
XnUI¡64
 
F
,

1218 
XnUI¡64
 
noSam∂eVÆue
, XnUI¡64 
shadowVÆue
 )

1220 
	gcv
::
M©
 
dïth
;

1221 
gëDïthM≠FromMëaD©a
–
dïthMëaD©a
, 
dïth
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1222 
CV_As£π
–
dïth
.
ty≥
(Ë=
CV_16UC1
 );

1227 
	gmu…
 = ()(
ba£löe
 * 
F
 );

1229 
	gdi•
.
¸óã
–
dïth
.
size
(), 
CV_32FC1
);

1230 
	gdi•
 = 
cv
::
Sˇœr
::
Æl
–
CvC≠tuª_O≥nNI
::
INVALID_PIXEL_VAL
 );

1231  
	gy
 = 0; y < 
	gdi•
.
	grows
; y++ )

1233  
	gx
 = 0; x < 
	gdi•
.
	gcﬁs
; x++ )

1235 
	gcurDïth
 = 
dïth
.
©
<>(
y
,
	gx
);

1236 if–
	gcurDïth
 !
CvC≠tuª_O≥nNI
::
INVALID_PIXEL_VAL
 )

1237 
di•
.
©
<>(
y
,
	gx
Ë
mu…
 / 
curDïth
;

1242 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveDi•¨ôyM≠
()

1244 if–!
dïthMëaD©a
.
	`D©a
() )

1247 
cv
::
M©
 
di•32
;

1248 
	`compuãDi•¨ôy_32F
–
dïthMëaD©a
, 
di•32
, 
ba£löe
, 
dïthFoˇlLígth_VGA
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1250 
di•32
.
	`c⁄vîtTo
–
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP
].
m©
, 
CV_8UC1
 );

1252  
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP
].
	`gëI∂ImagePå
();

1253 
	}
}

1255 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveDi•¨ôyM≠_32F
()

1257 if–!
dïthMëaD©a
.
	`D©a
() )

1260 
	`compuãDi•¨ôy_32F
–
dïthMëaD©a
, 
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP_32F
].
m©
, 
ba£löe
, 
dïthFoˇlLígth_VGA
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1262  
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP_32F
].
	`gëI∂ImagePå
();

1263 
	}
}

1265 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveVÆidDïthMask
()

1267 if–!
dïthMëaD©a
.
	`D©a
() )

1270 
cv
::
M©
 
dïth
;

1271 
	`gëDïthM≠FromMëaD©a
–
dïthMëaD©a
, 
dïth
, 
noSam∂eVÆue
, 
shadowVÆue
 );

1273 
ouçutM≠s
[
CV_CAP_OPENNI_VALID_DEPTH_MASK
].
m©
 = 
dïth
 !
CvC≠tuª_O≥nNI
::
INVALID_PIXEL_VAL
;

1275  
ouçutM≠s
[
CV_CAP_OPENNI_VALID_DEPTH_MASK
].
	`gëI∂ImagePå
();

1276 
	}
}

1278 
ölöe
 
gëBGRImageFromMëaD©a
–c⁄° 
xn
::
ImageMëaD©a
& 
imageMëaD©a
, 
cv
::
M©
& 
bgrImage
 )

1280 if–
imageMëaD©a
.
PixñF‹m©
(Ë!
XN_PIXEL_FORMAT_RGB24
 )

1281 
CV_Eº‹
–
CV_StsUnsuµ‹ãdF‹m©
, "Unsupported format of grabbed image\n" );

1283 
	gcv
::
M©
 
rgbImage
–
imageMëaD©a
.
YRes
(), imageMëaD©a.
XRes
(), 
CV_8UC3
 );

1284 c⁄° 
XnRGB24Pixñ
* 
	gpRgbImage
 = 
imageMëaD©a
.
RGB24D©a
();

1287 
mem˝y
–
rgbImage
.
d©a
, 
pRgbImage
,ÑgbImage.
tŸÆ
()*(
XnRGB24Pixñ
) );

1288 
	gcv
::
cvtCﬁ‹
–
rgbImage
, 
bgrImage
, 
CV_RGB2BGR
 );

1291 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveBGRImage
()

1293 if–!
imageMëaD©a
.
	`D©a
() )

1296 
	`gëBGRImageFromMëaD©a
–
imageMëaD©a
, 
ouçutM≠s
[
CV_CAP_OPENNI_BGR_IMAGE
].
m©
 );

1298  
ouçutM≠s
[
CV_CAP_OPENNI_BGR_IMAGE
].
	`gëI∂ImagePå
();

1299 
	}
}

1301 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveGøyImage
()

1303 if–!
imageMëaD©a
.
	`D©a
() )

1306 
	`CV_As£π
–
imageMëaD©a
.
	`ByãsPîPixñ
() == 3 );

1308 
cv
::
M©
 
rgbImage
;

1309 
	`gëBGRImageFromMëaD©a
–
imageMëaD©a
, 
rgbImage
 );

1310 
cv
::
	`cvtCﬁ‹
–
rgbImage
, 
ouçutM≠s
[
CV_CAP_OPENNI_GRAY_IMAGE
].
m©
, 
CV_BGR2GRAY
 );

1312  
ouçutM≠s
[
CV_CAP_OPENNI_GRAY_IMAGE
].
	`gëI∂ImagePå
();

1313 
	}
}

1315 
I∂Image
* 
	gCvC≠tuª_O≥nNI
::
	$ªåõveFøme
–
ouçutTy≥
 )

1317 
I∂Image
* 
image
 = 0;

1318 
	`CV_As£π
–
ouçutTy≥
 < 
ouçutM≠sTy≥sCou¡
 && outputType >= 0);

1320 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DEPTH_MAP
 )

1322 
image
 = 
	`ªåõveDïthM≠
();

1324 if–
ouçutTy≥
 =
CV_CAP_OPENNI_POINT_CLOUD_MAP
 )

1326 
image
 = 
	`ªåõvePoötCloudM≠
();

1328 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DISPARITY_MAP
 )

1330 
image
 = 
	`ªåõveDi•¨ôyM≠
();

1332 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DISPARITY_MAP_32F
 )

1334 
image
 = 
	`ªåõveDi•¨ôyM≠_32F
();

1336 if–
ouçutTy≥
 =
CV_CAP_OPENNI_VALID_DEPTH_MASK
 )

1338 
image
 = 
	`ªåõveVÆidDïthMask
();

1340 if–
ouçutTy≥
 =
CV_CAP_OPENNI_BGR_IMAGE
 )

1342 
image
 = 
	`ªåõveBGRImage
();

1344 if–
ouçutTy≥
 =
CV_CAP_OPENNI_GRAY_IMAGE
 )

1346 
image
 = 
	`ªåõveGøyImage
();

1349  
image
;

1350 
	}
}

1353 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_O≥nNI
–
ödex
 )

1355 
CvC≠tuª_O≥nNI
* 
ˇ±uª
 = 
√w
 
	`CvC≠tuª_O≥nNI
–
ödex
 );

1357 if–
ˇ±uª
->
	`isO≥√d
() )

1358  
ˇ±uª
;

1360 
dñëe
 
ˇ±uª
;

1362 
	}
}

1364 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_O≥nNI
–c⁄° * 
fûíame
 )

1366 
CvC≠tuª_O≥nNI
* 
ˇ±uª
 = 
√w
 
	`CvC≠tuª_O≥nNI
–
fûíame
 );

1368 if–
ˇ±uª
->
	`isO≥√d
() )

1369  
ˇ±uª
;

1371 
dñëe
 
ˇ±uª
;

1373 
	}
}

	@src/cap_openni2.cpp

41 
	~"¥ecomp.hµ
"

42 
	~"›ícv2/c‹e.hµ
"

43 
	~"›ícv2/img¥oc.hµ
"

45 #ifde‡
HAVE_OPENNI2


47 #i‡
deföed
 
TBB_INTERFACE_VERSION
 && TBB_INTERFACE_VERSION < 5000

48 #unde‡
HAVE_TBB


51 
	~<queue
>

53 #i‚de‡
i386


54 
	#i386
 0

	)

56 #i‚de‡
__¨m__


57 
	#__¨m__
 0

	)

59 #i‚de‡
_ARC


60 
	#_ARC
 0

	)

62 #i‚de‡
__APPLE__


63 
	#__APPLE__
 0

	)

66 
	#CV_STREAM_TIMEOUT
 2000

	)

68 
	#CV_DEPTH_STREAM
 0

	)

69 
	#CV_COLOR_STREAM
 1

	)

71 
	~"O≥nNI.h
"

72 
	~"PS1080.h
"

75 ˛as†
	cCvC≠tuª_O≥nNI2
 : 
public
 
CvC≠tuª


77 
public
:

78 íum { 
DEVICE_DEFAULT
=0, 
	mDEVICE_MS_KINECT
=0, 
	mDEVICE_ASUS_XTION
=1, 
	mDEVICE_MAX
=1 };

80 c⁄° 
	gINVALID_PIXEL_VAL
 = 0;

81 c⁄° 
	gINVALID_COORDINATE_VAL
 = 0;

83 #ifde‡
HAVE_TBB


84 c⁄° 
	gDEFAULT_MAX_BUFFER_SIZE
 = 8;

86 c⁄° 
	gDEFAULT_MAX_BUFFER_SIZE
 = 2;

88 c⁄° 
	gDEFAULT_IS_CIRCLE_BUFFER
 = 0;

89 c⁄° 
	gDEFAULT_MAX_TIME_DURATION
 = 20;

91 
CvC≠tuª_O≥nNI2
(
ödex
 = 0);

92 
CvC≠tuª_O≥nNI2
(c⁄° * 
fûíame
);

93 
	gvútuÆ
 ~
CvC≠tuª_O≥nNI2
();

95 
vútuÆ
 
	$gëPr›îty
(
¥›Idx
) const;

96 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(
¥obIdx
, 
¥›VÆ
);

97 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

98 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
(
ouçutTy≥
);

100 
boﬁ
 
	$isO≥√d
() const;

102 
¥Ÿe˘ed
:

103 
	sOuçutM≠


105 
public
:

106 
cv
::
M©
 
m©
;

107 
I∂Image
* 
	`gëI∂ImagePå
();

108 
¥iv©e
:

109 
I∂Image
 
ùlHódî
;

110 
	}
};

112 c⁄° 
	gouçutM≠sTy≥sCou¡
 = 7;

114 
	g›íni
::
VideoMode
 
deÁu…Cﬁ‹OuçutMode
();

115 
	g›íni
::
VideoMode
 
deÁu…DïthOuçutMode
();

117 
I∂Image
* 
ªåõveDïthM≠
();

118 
I∂Image
* 
ªåõvePoötCloudM≠
();

119 
I∂Image
* 
ªåõveDi•¨ôyM≠
();

120 
I∂Image
* 
ªåõveDi•¨ôyM≠_32F
();

121 
I∂Image
* 
ªåõveVÆidDïthMask
();

122 
I∂Image
* 
ªåõveBGRImage
();

123 
I∂Image
* 
ªåõveGøyImage
();

125 
boﬁ
 
ªadCamîasP¨ams
();

127 
	$gëDïthGíî©‹Pr›îty
(
¥›Idx
) const;

128 
boﬁ
 
	`£tDïthGíî©‹Pr›îty
(
¥›Idx
, 
¥›VÆ
);

129 
	$gëImageGíî©‹Pr›îty
(
¥›Idx
) const;

130 
boﬁ
 
	`£tImageGíî©‹Pr›îty
(
¥›Idx
, 
¥›VÆ
);

131 
	$gëComm⁄Pr›îty
(
¥›Idx
) const;

132 
boﬁ
 
	`£tComm⁄Pr›îty
(
¥›Idx
, 
¥›VÆ
);

135 
›íni
::
Devi˚
 
devi˚
;

136 
boﬁ
 
isC⁄ãxtO≥√d
;

137 
›íni
::
Rec‹dî
 
ªc‹dî
;

140 
›íni
::
VideoSåóm
 
dïth
, 
cﬁ‹
, **
°ªams
;

141 
›íni
::
VideoFømeRef
 
dïthFøme
, 
cﬁ‹Føme
;

142 
cv
::
M©
 
dïthImage
, 
cﬁ‹Image
;

144 
maxBuf„rSize
, 
maxTimeDuøti⁄
;

145 
boﬁ
 
isCú˛eBuf„r
;

151 
ba£löe
;

153 
dïthFoˇlLígth_VGA
;

156 
shadowVÆue
;

158 
noSam∂eVÆue
;

160 
cuºítSåóm
;

162 
numSåóm
;

163 
°d
::
ve˘‹
<
OuçutM≠
> 
ouçutM≠s
;

164 
	}
};

166 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
OuçutM≠
::
	$gëI∂ImagePå
()

168 if–
m©
.
	`em±y
() )

171 
ùlHódî
 = 
	`I∂Image
(
m©
);

172  &
ùlHódî
;

173 
	}
}

175 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$isO≥√d
() const

177  
isC⁄ãxtO≥√d
;

178 
	}
}

180 
	g›íni
::
VideoMode
 
CvC≠tuª_O≥nNI2
::
	$deÁu…Cﬁ‹OuçutMode
()

182 
›íni
::
VideoMode
 
mode
;

183 
mode
.
	`£tResﬁuti⁄
(640, 480);

184 
mode
.
	`£tFps
(30);

185 
mode
.
	`£tPixñF‹m©
(
›íni
::
PIXEL_FORMAT_RGB888
);

186  
mode
;

187 
	}
}

189 
	g›íni
::
VideoMode
 
CvC≠tuª_O≥nNI2
::
	$deÁu…DïthOuçutMode
()

191 
›íni
::
VideoMode
 
mode
;

192 
mode
.
	`£tResﬁuti⁄
(640, 480);

193 
mode
.
	`£tFps
(30);

194 
mode
.
	`£tPixñF‹m©
(
›íni
::
PIXEL_FORMAT_DEPTH_1_MM
);

195  
mode
;

196 
	}
}

198 
	gCvC≠tuª_O≥nNI2
::
	$CvC≠tuª_O≥nNI2
–
ödex
 )

200 
numSåóm
 = 2;

201 c⁄° * 
devi˚URI
 = 
›íni
::
ANY_DEVICE
;

202 
›íni
::
Sètus
 
°©us
;

203 
devi˚Ty≥
 = 
DEVICE_DEFAULT
;

205 
noSam∂eVÆue
 = 
shadowVÆue
 = 0;

207 
isC⁄ãxtO≥√d
 = 
Ál£
;

208 
maxBuf„rSize
 = 
DEFAULT_MAX_BUFFER_SIZE
;

209 
isCú˛eBuf„r
 = 
DEFAULT_IS_CIRCLE_BUFFER
;

210 
maxTimeDuøti⁄
 = 
DEFAULT_MAX_TIME_DURATION
;

212 if–
ödex
 >= 10 )

214 
devi˚Ty≥
 = 
ödex
 / 10;

215 
ödex
 %= 10;

219 i‡(
devi˚Ty≥
 =
DEVICE_ASUS_XTION
)

220 
numSåóm
 = 1;

222 if–
devi˚Ty≥
 > 
DEVICE_MAX
 )

226 
°©us
 = 
›íni
::
O≥nNI
::
	`öôülize
();

228 i‡(
°©us
 !
›íni
::
STATUS_OK
)

230 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("FaûedÅÿöôülize:", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

234 
°©us
 = 
devi˚
.
	`›í
(
devi˚URI
);

235 if–
°©us
 !
›íni
::
STATUS_OK
 )

237 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("O≥nCVKöe˘: Devi˚ o≥¿Áûed sì: %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

238 
›íni
::
O≥nNI
::
	`shutdown
();

245 
°©us
 = 
dïth
.
	`¸óã
(
devi˚
, 
›íni
::
SENSOR_DEPTH
);

246 i‡(
°©us
 =
›íni
::
STATUS_OK
)

248 i‡(
dïth
.
	`isVÆid
())

250 
	`CV_As£π
(
dïth
.
	`£tVideoMode
(
	`deÁu…DïthOuçutMode
()Ë=
›íni
::
STATUS_OK
);

253 
°©us
 = 
dïth
.
	`°¨t
();

254 i‡(
°©us
 !
›íni
::
STATUS_OK
)

256 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::CvC≠tuª_O≥nNI2 : Couldn'à°¨àdïth såóm: %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

257 
dïth
.
	`de°roy
();

263 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::CvC≠tuª_O≥nNI2 : Couldn'àföd dïth såóm:: %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

267 
°ªams
 = 
√w
 
›íni
::
VideoSåóm
*[
numSåóm
];

268 
°ªams
[
CV_DEPTH_STREAM
] = &
dïth
;

271 
°©us
 = 
cﬁ‹
.
	`¸óã
(
devi˚
, 
›íni
::
SENSOR_COLOR
);

272 i‡(
°©us
 =
›íni
::
STATUS_OK
)

275 i‡(
cﬁ‹
.
	`isVÆid
())

277 
	`CV_As£π
(
cﬁ‹
.
	`£tVideoMode
(
	`deÁu…Cﬁ‹OuçutMode
()Ë=
›íni
::
STATUS_OK
);

279 
°©us
 = 
cﬁ‹
.
	`°¨t
();

280 i‡(
°©us
 !
›íni
::
STATUS_OK
)

282 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::CvC≠tuª_O≥nNI2 : Couldn'à°¨àcﬁ‹ såóm: %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

283 
cﬁ‹
.
	`de°roy
();

286 
°ªams
[
CV_COLOR_STREAM
] = &
cﬁ‹
;

288 i‡(
numSåóm
 == 2)

290 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::CvC≠tuª_O≥nNI2 : Couldn'àföd cﬁ‹ såóm: %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

294 if–!
	`ªadCamîasP¨ams
() )

296 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::CvCapture_OpenNI2 : CouldÇotÑead camerasÖarameters\n"));

309 
ouçutM≠s
.
	`ªsize
–
ouçutM≠sTy≥sCou¡
 );

311 
isC⁄ãxtO≥√d
 = 
åue
;

313 
	`£tPr›îty
(
CV_CAP_PROP_OPENNI_REGISTRATION
, 1.0);

314 
	}
}

316 
	gCvC≠tuª_O≥nNI2
::
	$CvC≠tuª_O≥nNI2
(c⁄° * 
fûíame
)

318 
numSåóm
 = 2;

319 
›íni
::
Sètus
 
°©us
;

321 
isC⁄ãxtO≥√d
 = 
Ál£
;

322 
maxBuf„rSize
 = 
DEFAULT_MAX_BUFFER_SIZE
;

323 
isCú˛eBuf„r
 = 
DEFAULT_IS_CIRCLE_BUFFER
;

324 
maxTimeDuøti⁄
 = 
DEFAULT_MAX_TIME_DURATION
;

327 
°©us
 = 
›íni
::
O≥nNI
::
	`öôülize
();

329 i‡(
°©us
 !
›íni
::
STATUS_OK
)

331 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("FaûedÅÿöôülize:", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

336 
°©us
 = 
devi˚
.
	`›í
(
fûíame
);

337 if–
°©us
 !
›íni
::
STATUS_OK
 )

339 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::CvC≠tuª_O≥nNI2 : FaûedÅÿ›í i≈uàfûê(%s): %s\n", 
fûíame
, 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

343 if–!
	`ªadCamîasP¨ams
() )

345 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::CvCapture_OpenNI2 : CouldÇotÑead camerasÖarameters\n"));

349 
ouçutM≠s
.
	`ªsize
–
ouçutM≠sTy≥sCou¡
 );

351 
isC⁄ãxtO≥√d
 = 
åue
;

352 
	}
}

354 
	gCvC≠tuª_O≥nNI2
::~
	$CvC≠tuª_O≥nNI2
()

356 
this
->
dïthFøme
.
	`ªÀa£
();

357 
this
->
cﬁ‹Føme
.
	`ªÀa£
();

358 
this
->
dïth
.
	`°›
();

359 
this
->
cﬁ‹
.
	`°›
();

360 
›íni
::
O≥nNI
::
	`shutdown
();

361 
	}
}

363 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$ªadCamîasP¨ams
()

365 
pixñSize
 = 0;

366 i‡(
dïth
.
gëPr›îty
<>(
XN_STREAM_PROPERTY_ZERO_PLANE_PIXEL_SIZE
, &
pixñSize
Ë!
›íni
::
STATUS_OK
)

368 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::readCamerasParams : CouldÇotÑeadÖixel size!\n"));

369  
Ál£
;

373 
pixñSize
 *= 2.0;

376 
zîoPœnDi°™˚
;

377 i‡(
dïth
.
	`gëPr›îty
(
XN_STREAM_PROPERTY_ZERO_PLANE_DISTANCE
, &
zîoPœnDi°™˚
Ë!
›íni
::
STATUS_OK
)

379 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::readCamerasParams : CouldÇotÑead virtualÖlane distance!\n"));

380  
Ál£
;

383 i‡(
dïth
.
gëPr›îty
<>(
XN_STREAM_PROPERTY_EMITTER_DCMOS_DISTANCE
, &
ba£löe
Ë!
›íni
::
STATUS_OK
)

385 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::readCamerasParams : CouldÇotÑead baseÜine!\n"));

386  
Ál£
;

390 
ba£löe
 *= 10;

393 
dïthFoˇlLígth_VGA
 = ()(()
zîoPœnDi°™˚
 / ()
pixñSize
);

395  
åue
;

396 
	}
}

398 
	gCvC≠tuª_O≥nNI2
::
	$gëPr›îty
–
¥›Idx
 ) const

400 
¥›VÆue
 = 0;

402 if–
	`isO≥√d
() )

404 
puªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_OPENNI_GENERATORS_MASK
;

406 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_IMAGE_GENERATOR
 )

408 
¥›VÆue
 = 
	`gëImageGíî©‹Pr›îty
–
puªPr›Idx
 );

410 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_DEPTH_GENERATOR
 )

412 
¥›VÆue
 = 
	`gëDïthGíî©‹Pr›îty
–
puªPr›Idx
 );

416 
¥›VÆue
 = 
	`gëComm⁄Pr›îty
–
puªPr›Idx
 );

420  
¥›VÆue
;

421 
	}
}

423 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$£tPr›îty
–
¥›Idx
, 
¥›VÆue
 )

425 
boﬁ
 
isSë
 = 
Ál£
;

426 if–
	`isO≥√d
() )

428 
puªPr›Idx
 = 
¥›Idx
 & ~
CV_CAP_OPENNI_GENERATORS_MASK
;

430 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_IMAGE_GENERATOR
 )

432 
isSë
 = 
	`£tImageGíî©‹Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

434 if–(
¥›Idx
 & 
CV_CAP_OPENNI_GENERATORS_MASK
Ë=
CV_CAP_OPENNI_DEPTH_GENERATOR
 )

436 
isSë
 = 
	`£tDïthGíî©‹Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

440 
isSë
 = 
	`£tComm⁄Pr›îty
–
puªPr›Idx
, 
¥›VÆue
 );

444  
isSë
;

445 
	}
}

447 
	gCvC≠tuª_O≥nNI2
::
	$gëComm⁄Pr›îty
–
¥›Idx
 ) const

449 
¥›VÆue
 = 0;

451  
¥›Idx
 )

458 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

459 
CV_CAP_PROP_FRAME_WIDTH
 :

460 
CV_CAP_PROP_FRAME_HEIGHT
 :

461 
CV_CAP_PROP_FPS
 :

462 
CV_CAP_PROP_OPENNI_FRAME_MAX_DEPTH
 :

463 
CV_CAP_PROP_OPENNI_BASELINE
 :

464 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
 :

465 
CV_CAP_PROP_OPENNI_REGISTRATION
 :

466 
¥›VÆue
 = 
	`gëDïthGíî©‹Pr›îty
–
¥›Idx
 );

468 
CV_CAP_PROP_OPENNI2_SYNC
 :

469 
¥›VÆue
 = 
c⁄°_ˇ°
<
CvC≠tuª_O≥nNI2
 *>(
this
)->
devi˚
.
	`gëDïthCﬁ‹SyncE«bÀd
();

470 
CV_CAP_PROP_OPENNI2_MIRROR
:

472 
boﬁ
 
isMúr‹ög
 = 
cﬁ‹
.
	`gëMúr‹ögE«bÀd
(Ë&& 
dïth
.getMirroringEnabled();

473 
¥›VÆue
 = 
isMúr‹ög
 ? 1.0 : 0.0;

477 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("SuchÖ¨amëî (¥›Idx=%dËi¢'àsuµ‹ãd f‹ gëtög.\n", 
¥›Idx
) );

480  
¥›VÆue
;

481 
	}
}

483 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$£tComm⁄Pr›îty
–
¥›Idx
, 
¥›VÆue
 )

485 
boﬁ
 
isSë
 = 
Ál£
;

487  
¥›Idx
 )

489 
CV_CAP_PROP_OPENNI2_MIRROR
:

491 
boﬁ
 
múr‹
 = 
¥›VÆue
 > 0.0 ? 
åue
 : 
Ál£
;

492 
isSë
 = 
cﬁ‹
.
	`£tMúr‹ögE«bÀd
(
múr‹
Ë=
›íni
::
STATUS_OK
;

493 
isSë
 = 
dïth
.
	`£tMúr‹ögE«bÀd
(
múr‹
Ë=
›íni
::
STATUS_OK
;

498 
CV_CAP_PROP_OPENNI_REGISTRATION
:

499 
isSë
 = 
	`£tDïthGíî©‹Pr›îty
–
¥›Idx
, 
¥›VÆue
 );

501 
CV_CAP_PROP_OPENNI2_SYNC
:

502 
isSë
 = 
devi˚
.
	`£tDïthCﬁ‹SyncE«bÀd
(
¥›VÆue
 > 0.0Ë=
›íni
::
STATUS_OK
;

505 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("SuchÖ¨amëî (¥›Idx=%dËi¢'àsuµ‹ãd f‹ sëtög.\n", 
¥›Idx
) );

508  
isSë
;

509 
	}
}

511 
	gCvC≠tuª_O≥nNI2
::
	$gëDïthGíî©‹Pr›îty
–
¥›Idx
 ) const

513 
¥›VÆue
 = 0;

514 if–!
dïth
.
	`isVÆid
() )

515  
¥›VÆue
;

517 
›íni
::
VideoMode
 
mode
;

519  
¥›Idx
 )

521 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

522 
	`CV_DbgAs£π
(
dïth
.
	`isVÆid
());

523 
¥›VÆue
 = 1.;

525 
CV_CAP_PROP_FRAME_WIDTH
 :

526 
¥›VÆue
 = 
dïth
.
	`gëVideoMode
().
	`gëResﬁuti⁄X
();

528 
CV_CAP_PROP_FRAME_HEIGHT
 :

529 
¥›VÆue
 = 
dïth
.
	`gëVideoMode
().
	`gëResﬁuti⁄Y
();

531 
CV_CAP_PROP_FPS
 :

532 
mode
 = 
dïth
.
	`gëVideoMode
();

533 
¥›VÆue
 = 
mode
.
	`gëFps
();

535 
CV_CAP_PROP_OPENNI_FRAME_MAX_DEPTH
 :

536 
¥›VÆue
 = 
dïth
.
	`gëMaxPixñVÆue
();

538 
CV_CAP_PROP_OPENNI_BASELINE
 :

539 
¥›VÆue
 = 
ba£löe
;

541 
CV_CAP_PROP_OPENNI_FOCAL_LENGTH
 :

542 
¥›VÆue
 = ()
dïthFoˇlLígth_VGA
;

544 
CV_CAP_PROP_OPENNI_REGISTRATION
 :

545 
¥›VÆue
 = 
devi˚
.
	`gëImageRegi°øti⁄Mode
();

547 
CV_CAP_PROP_POS_MSEC
 :

548 
¥›VÆue
 = ()
dïthFøme
.
	`gëTime°amp
();

550 
CV_CAP_PROP_POS_FRAMES
 :

551 
¥›VÆue
 = 
dïthFøme
.
	`gëFømeIndex
();

554 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Dïth gíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ gëtög.\n", 
¥›Idx
) );

557  
¥›VÆue
;

558 
	}
}

560 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$£tDïthGíî©‹Pr›îty
–
¥›Idx
, 
¥›VÆue
 )

562 
boﬁ
 
isSë
 = 
Ál£
;

564 
	`CV_As£π
–
dïth
.
	`isVÆid
() );

566  
¥›Idx
 )

568 
CV_CAP_PROP_OPENNI_REGISTRATION
:

570 if–
¥›VÆue
 < 1.0 )

574 i‡–
cﬁ‹
.
	`isVÆid
() )

576 
›íni
::
ImageRegi°øti⁄Mode
 
mode
 = 
¥›VÆue
 < 1.0 ? o≥¬i::
IMAGE_REGISTRATION_DEPTH_TO_COLOR
 : o≥¬i::
IMAGE_REGISTRATION_OFF
;

577 if–!
devi˚
.
	`gëImageRegi°øti⁄Mode
(Ë=
mode
 )

579 i‡(
devi˚
.
	`isImageRegi°øti⁄ModeSuµ‹ãd
(
mode
))

581 
›íni
::
Sètus
 
°©us
 = 
devi˚
.
	`£tImageRegi°øti⁄Mode
(
mode
);

582 if–
°©us
 !
›íni
::
STATUS_OK
 )

583 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::£tDïthGíî©‹Pr›îty : %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

585 
isSë
 = 
åue
;

588 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvCapture_OpenNI2::setDepthGeneratorProperty : Unsupported viewpoint.\n"));

591 
isSë
 = 
åue
;

596 
›íni
::
Sètus
 
°©us
 = 
devi˚
.
	`£tImageRegi°øti⁄Mode
(›íni::
IMAGE_REGISTRATION_OFF
);

597 if–
°©us
 !
›íni
::
STATUS_OK
 )

598 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::£tDïthGíî©‹Pr›îty : %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

600 
isSë
 = 
åue
;

605 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Dïth gíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ sëtög.\n", 
¥›Idx
) );

608  
isSë
;

609 
	}
}

611 
	gCvC≠tuª_O≥nNI2
::
	$gëImageGíî©‹Pr›îty
–
¥›Idx
 ) const

613 
¥›VÆue
 = 0.;

614 if–!
cﬁ‹
.
	`isVÆid
() )

615  
¥›VÆue
;

617 
›íni
::
VideoMode
 
mode
;

618  
¥›Idx
 )

620 
CV_CAP_PROP_OPENNI_GENERATOR_PRESENT
 :

621 
	`CV_DbgAs£π
–
cﬁ‹
.
	`isVÆid
() );

622 
¥›VÆue
 = 1.;

624 
CV_CAP_PROP_FRAME_WIDTH
 :

625 
¥›VÆue
 = 
cﬁ‹
.
	`gëVideoMode
().
	`gëResﬁuti⁄X
();

627 
CV_CAP_PROP_FRAME_HEIGHT
 :

628 
¥›VÆue
 = 
cﬁ‹
.
	`gëVideoMode
().
	`gëResﬁuti⁄Y
();

630 
CV_CAP_PROP_FPS
 :

631 
¥›VÆue
 = 
cﬁ‹
.
	`gëVideoMode
().
	`gëFps
();

633 
CV_CAP_PROP_POS_MSEC
 :

634 
¥›VÆue
 = ()
cﬁ‹Føme
.
	`gëTime°amp
();

636 
CV_CAP_PROP_POS_FRAMES
 :

637 
¥›VÆue
 = ()
cﬁ‹Føme
.
	`gëFømeIndex
();

640 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Imagêgíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ gëtög.\n", 
¥›Idx
) );

643  
¥›VÆue
;

644 
	}
}

646 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$£tImageGíî©‹Pr›îty
(
¥›Idx
, 
¥›VÆue
)

648 
boﬁ
 
isSë
 = 
Ál£
;

649 if–!
cﬁ‹
.
	`isVÆid
() )

650  
isSë
;

652  
¥›Idx
 )

654 
CV_CAP_PROP_OPENNI_OUTPUT_MODE
 :

656 
›íni
::
VideoMode
 
mode
 = 
cﬁ‹
.
	`gëVideoMode
();

658  
	`cvRound
(
¥›VÆue
) )

660 
CV_CAP_OPENNI_VGA_30HZ
 :

661 
mode
.
	`£tResﬁuti⁄
(640,480);

662 
mode
.
	`£tFps
(30);

664 
CV_CAP_OPENNI_SXGA_15HZ
 :

665 
mode
.
	`£tResﬁuti⁄
(1280, 960);

666 
mode
.
	`£tFps
(15);

668 
CV_CAP_OPENNI_SXGA_30HZ
 :

669 
mode
.
	`£tResﬁuti⁄
(1280, 960);

670 
mode
.
	`£tFps
(30);

672 
CV_CAP_OPENNI_QVGA_30HZ
 :

673 
mode
.
	`£tResﬁuti⁄
(320, 240);

674 
mode
.
	`£tFps
(30);

676 
CV_CAP_OPENNI_QVGA_60HZ
 :

677 
mode
.
	`£tResﬁuti⁄
(320, 240);

678 
mode
.
	`£tFps
(60);

681 
	`CV_Eº‹
–
CV_StsBadArg
, "Unsupported image generator output mode.\n");

684 
›íni
::
Sètus
 
°©us
 = 
cﬁ‹
.
	`£tVideoMode
–
mode
 );

685 if–
°©us
 !
›íni
::
STATUS_OK
 )

686 
	`CV_Eº‹
(
CV_StsEº‹
, 
cv
::
	`f‹m©
("CvC≠tuª_O≥nNI2::£tImageGíî©‹Pr›îty : %s\n", 
›íni
::
O≥nNI
::
	`gëExãndedEº‹
()));

688 
isSë
 = 
åue
;

692 
	`CV_Eº‹
–
CV_StsBadArg
, 
cv
::
	`f‹m©
("Imagêgíî©‹ d€†nŸ suµ‹àsuchÖ¨amëî (¥›Idx=%dËf‹ sëtög.\n", 
¥›Idx
) );

695  
isSë
;

696 
	}
}

698 
boﬁ
 
	gCvC≠tuª_O≥nNI2
::
	$gøbFøme
()

700 if–!
	`isO≥√d
() )

701  
Ál£
;

703 
boﬁ
 
isGøbbed
 = 
Ál£
;

705 
›íni
::
Sètus
 
°©us
 = o≥¬i::
O≥nNI
::
	`waôF‹AnySåóm
(
°ªams
, 
numSåóm
, &
cuºítSåóm
, 
CV_STREAM_TIMEOUT
);

706 if–
°©us
 !
›íni
::
STATUS_OK
 )

707  
Ál£
;

709 if–
dïth
.
	`isVÆid
() )

710 
dïth
.
	`ªadFøme
(&
dïthFøme
);

711 i‡(
cﬁ‹
.
	`isVÆid
())

712 
cﬁ‹
.
	`ªadFøme
(&
cﬁ‹Føme
);

713 
isGøbbed
 = 
åue
;

715  
isGøbbed
;

716 
	}
}

718 
ölöe
 
gëDïthM≠FromMëaD©a
(c⁄° 
›íni
::
VideoFømeRef
& 
dïthMëaD©a
, 
cv
::
M©
& 
dïthM≠
, 
noSam∂eVÆue
, 
shadowVÆue
)

720 
	gdïthM≠
.
¸óã
(
dïthMëaD©a
.
gëHeight
(), dïthMëaD©a.
gëWidth
(), 
CV_16UC1
);

721 
	gdïthM≠
.
	gd©a
 = (
uch¨
*)
dïthMëaD©a
.
gëD©a
();

723 
	gcv
::
M©
 
badMask
 = (
dïthM≠
 =()
noSam∂eVÆue
Ë| (dïthM≠ =()
shadowVÆue
) | (depthMap == 0);

726 
	gdïthM≠
.
£tTo
–
cv
::
Sˇœr
::
Æl
–
CvC≠tuª_O≥nNI2
::
INVALID_PIXEL_VAL
 ), 
badMask
 );

729 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveDïthM≠
()

731 if–!
dïth
.
	`isVÆid
() )

734 
	`gëDïthM≠FromMëaD©a
–
dïthFøme
, 
ouçutM≠s
[
CV_CAP_OPENNI_DEPTH_MAP
].
m©
, 
noSam∂eVÆue
, 
shadowVÆue
 );

736  
ouçutM≠s
[
CV_CAP_OPENNI_DEPTH_MAP
].
	`gëI∂ImagePå
();

737 
	}
}

739 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõvePoötCloudM≠
()

741 if–!
dïthFøme
.
	`isVÆid
() )

744 
cv
::
M©
 
dïthImg
;

745 
	`gëDïthM≠FromMëaD©a
(
dïthFøme
, 
dïthImg
, 
noSam∂eVÆue
, 
shadowVÆue
);

747 c⁄° 
badPoöt
 = 
INVALID_PIXEL_VAL
;

748 c⁄° 
badCo‹d
 = 
INVALID_COORDINATE_VAL
;

749 
cﬁs
 = 
dïthFøme
.
	`gëWidth
(), 
rows
 = dïthFøme.
	`gëHeight
();

750 
cv
::
M©
 
	`poötCloud_XYZ
–
rows
, 
cﬁs
, 
CV_32FC3
, cv::
Sˇœr
::
	`Æl
(
badPoöt
) );

752 
w‹ldX
, 
w‹ldY
, 
w‹ldZ
;

753  
y
 = 0; y < 
rows
; y++ )

755 
x
 = 0; x < 
cﬁs
; x++)

757 
›íni
::
Co‹dö©eC⁄vîãr
::
	`c⁄vîtDïthToW‹ld
(
dïth
, 
x
, 
y
, 
dïthImg
.
©
<>(y, x), &
w‹ldX
, &
w‹ldY
, &
w‹ldZ
);

759 i‡(
dïthImg
.
©
<>(
y
, 
x
Ë=
badPoöt
)

760 
poötCloud_XYZ
.
©
<
cv
::
Poöt3f
>(
y
, 
x
Ëcv::
	`Poöt3f
(
badCo‹d
, badCoord, badCoord);

763 
poötCloud_XYZ
.
©
<
cv
::
Poöt3f
>(
y
, 
x
Ëcv::
	`Poöt3f
(
w‹ldX
*0.001f, 
w‹ldY
*0.001f, 
w‹ldZ
*0.001f);

768 
ouçutM≠s
[
CV_CAP_OPENNI_POINT_CLOUD_MAP
].
m©
 = 
poötCloud_XYZ
;

770  
ouçutM≠s
[
CV_CAP_OPENNI_POINT_CLOUD_MAP
].
	`gëI∂ImagePå
();

771 
	}
}

773 
compuãDi•¨ôy_32F
–c⁄° 
›íni
::
VideoFømeRef
& 
dïthMëaD©a
, 
cv
::
M©
& 
di•
, 
ba£löe
, 
F
, 
noSam∂eVÆue
, 
shadowVÆue
)

775 
	gcv
::
M©
 
dïth
;

776 
gëDïthM≠FromMëaD©a
–
dïthMëaD©a
, 
dïth
, 
noSam∂eVÆue
, 
shadowVÆue
 );

777 
CV_As£π
–
dïth
.
ty≥
(Ë=
CV_16UC1
 );

781 
	gmu…
 = ()(
ba£löe
 * 
F
 );

783 
	gdi•
.
¸óã
–
dïth
.
size
(), 
CV_32FC1
);

784 
	gdi•
 = 
cv
::
Sˇœr
::
Æl
–
CvC≠tuª_O≥nNI2
::
INVALID_PIXEL_VAL
 );

785  
	gy
 = 0; y < 
	gdi•
.
	grows
; y++ )

787  
	gx
 = 0; x < 
	gdi•
.
	gcﬁs
; x++ )

789 
	gcurDïth
 = 
dïth
.
©
<>(
y
,
	gx
);

790 if–
	gcurDïth
 !
CvC≠tuª_O≥nNI2
::
INVALID_PIXEL_VAL
 )

791 
di•
.
©
<>(
y
,
	gx
Ë
mu…
 / 
curDïth
;

796 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveDi•¨ôyM≠
()

798 i‡(!
dïthFøme
.
	`isVÆid
())

801 
cv
::
M©
 
di•32
;

802 
	`compuãDi•¨ôy_32F
(
dïthFøme
, 
di•32
, 
ba£löe
, 
dïthFoˇlLígth_VGA
, 
noSam∂eVÆue
, 
shadowVÆue
);

804 
di•32
.
	`c⁄vîtTo
–
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP
].
m©
, 
CV_8UC1
 );

806  
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP
].
	`gëI∂ImagePå
();

807 
	}
}

809 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveDi•¨ôyM≠_32F
()

811 i‡(!
dïthFøme
.
	`isVÆid
())

814 
	`compuãDi•¨ôy_32F
(
dïthFøme
, 
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP_32F
].
m©
, 
ba£löe
, 
dïthFoˇlLígth_VGA
, 
noSam∂eVÆue
, 
shadowVÆue
);

816  
ouçutM≠s
[
CV_CAP_OPENNI_DISPARITY_MAP_32F
].
	`gëI∂ImagePå
();

817 
	}
}

819 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveVÆidDïthMask
()

821 i‡(!
dïthFøme
.
	`isVÆid
())

824 
cv
::
M©
 
d
;

825 
	`gëDïthM≠FromMëaD©a
(
dïthFøme
, 
d
, 
noSam∂eVÆue
, 
shadowVÆue
);

827 
ouçutM≠s
[
CV_CAP_OPENNI_VALID_DEPTH_MASK
].
m©
 = 
d
 !
CvC≠tuª_O≥nNI2
::
INVALID_PIXEL_VAL
;

829  
ouçutM≠s
[
CV_CAP_OPENNI_VALID_DEPTH_MASK
].
	`gëI∂ImagePå
();

830 
	}
}

832 
ölöe
 
gëBGRImageFromMëaD©a
–c⁄° 
›íni
::
VideoFømeRef
& 
imageMëaD©a
, 
cv
::
M©
& 
bgrImage
 )

834 
cv
::
M©
 
buf„rImage
;

835 if–
	gimageMëaD©a
.
gëVideoMode
().
gëPixñF‹m©
(Ë!
›íni
::
PIXEL_FORMAT_RGB888
 )

836 
CV_Eº‹
–
CV_StsUnsuµ‹ãdF‹m©
, "Unsupported format of grabbed image\n" );

838 
	gbgrImage
.
¸óã
(
imageMëaD©a
.
gëHeight
(), imageMëaD©a.
gëWidth
(), 
CV_8UC3
);

839 
	gbuf„rImage
.
¸óã
(
imageMëaD©a
.
gëHeight
(), imageMëaD©a.
gëWidth
(), 
CV_8UC3
);

840 
	gbuf„rImage
.
	gd©a
 = (
uch¨
*)
imageMëaD©a
.
gëD©a
();

842 
	gcv
::
cvtCﬁ‹
(
buf„rImage
, 
bgrImage
, 
cv
::
COLOR_RGB2BGR
);

845 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveBGRImage
()

847 if–!
cﬁ‹
.
	`isVÆid
() )

850 
	`gëBGRImageFromMëaD©a
–
cﬁ‹Føme
, 
ouçutM≠s
[
CV_CAP_OPENNI_BGR_IMAGE
].
m©
 );

852  
ouçutM≠s
[
CV_CAP_OPENNI_BGR_IMAGE
].
	`gëI∂ImagePå
();

853 
	}
}

855 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveGøyImage
()

857 i‡(!
cﬁ‹Føme
.
	`isVÆid
())

860 
	`CV_As£π
(
cﬁ‹Føme
.
	`gëVideoMode
().
	`gëPixñF‹m©
(Ë=
›íni
::
PIXEL_FORMAT_RGB888
);

862 
cv
::
M©
 
rgbImage
;

863 
	`gëBGRImageFromMëaD©a
(
cﬁ‹Føme
, 
rgbImage
);

864 
cv
::
	`cvtCﬁ‹
–
rgbImage
, 
ouçutM≠s
[
CV_CAP_OPENNI_GRAY_IMAGE
].
m©
, 
CV_BGR2GRAY
 );

866  
ouçutM≠s
[
CV_CAP_OPENNI_GRAY_IMAGE
].
	`gëI∂ImagePå
();

867 
	}
}

869 
I∂Image
* 
	gCvC≠tuª_O≥nNI2
::
	$ªåõveFøme
–
ouçutTy≥
 )

871 
I∂Image
* 
image
 = 0;

872 
	`CV_As£π
–
ouçutTy≥
 < 
ouçutM≠sTy≥sCou¡
 && outputType >= 0);

874 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DEPTH_MAP
 )

876 
image
 = 
	`ªåõveDïthM≠
();

878 if–
ouçutTy≥
 =
CV_CAP_OPENNI_POINT_CLOUD_MAP
 )

880 
image
 = 
	`ªåõvePoötCloudM≠
();

882 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DISPARITY_MAP
 )

884 
image
 = 
	`ªåõveDi•¨ôyM≠
();

886 if–
ouçutTy≥
 =
CV_CAP_OPENNI_DISPARITY_MAP_32F
 )

888 
image
 = 
	`ªåõveDi•¨ôyM≠_32F
();

890 if–
ouçutTy≥
 =
CV_CAP_OPENNI_VALID_DEPTH_MASK
 )

892 
image
 = 
	`ªåõveVÆidDïthMask
();

894 if–
ouçutTy≥
 =
CV_CAP_OPENNI_BGR_IMAGE
 )

896 
image
 = 
	`ªåõveBGRImage
();

898 if–
ouçutTy≥
 =
CV_CAP_OPENNI_GRAY_IMAGE
 )

900 
image
 = 
	`ªåõveGøyImage
();

903  
image
;

904 
	}
}

906 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_O≥nNI
–
ödex
 )

908 
CvC≠tuª_O≥nNI2
* 
ˇ±uª
 = 
√w
 
	`CvC≠tuª_O≥nNI2
–
ödex
 );

910 if–
ˇ±uª
->
	`isO≥√d
() )

911  
ˇ±uª
;

913 
dñëe
 
ˇ±uª
;

915 
	}
}

917 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_O≥nNI
–c⁄° * 
fûíame
 )

919 
CvC≠tuª_O≥nNI2
* 
ˇ±uª
 = 
√w
 
	`CvC≠tuª_O≥nNI2
–
fûíame
 );

921 if–
ˇ±uª
->
	`isO≥√d
() )

922  
ˇ±uª
;

924 
dñëe
 
ˇ±uª
;

926 
	}
}

	@src/cap_pvapi.cpp

46 
	~"¥ecomp.hµ
"

48 #ifde‡
HAVE_PVAPI


49 #i‡!
deföed
 
WIN32
 && !deföed 
_WIN32
 && !deföed 
_LINUX


50 
	#_LINUX


	)

53 #i‡
deföed
(
_x64
Ë|| deföed (
__x86_64
Ë|| deföed (
_M_X64
)

54 
	#_x64
 1

	)

55 #ñi‡
deföed
(
_x86
Ë|| deföed(
__i386
Ë|| deföed (
_M_IX86
)

56 
	#_x86
 1

	)

59 
	~<PvApi.h
>

60 #ifde‡
WIN32


61 
	~<io.h
>

63 
	~<time.h
>

64 
	~<uni°d.h
>

69 
	#MAX_CAMERAS
 10

	)

73 ˛as†
	cCvC≠tuªCAM_PvAPI
 : 
public
 
CvC≠tuª


75 
public
:

76 
CvC≠tuªCAM_PvAPI
();

77 
	mvútuÆ
 ~
	$CvC≠tuªCAM_PvAPI
()

79 
	`˛o£
();

82 
vútuÆ
 
boﬁ
 
	`›í
–
ödex
 );

83 
vútuÆ
 
	`˛o£
();

84 
vútuÆ
 
	$gëPr›îty
() const;

85 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

86 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

87 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

88 
vútuÆ
 
	$gëC≠tuªDomaö
()

90  
CV_CAP_PVAPI
;

91 
	}
}

93 
	g¥Ÿe˘ed
:

94 #i‚de‡
WIN32


95 
vútuÆ
 
SÀï
(
time
);

98 
°›C≠tuª
();

99 
boﬁ
 
°¨tC≠tuª
();

100 
boﬁ
 
ªsizeC≠tuªFøme
 (
‰ameWidth
, 
‰ameHeight
);

104 
	gUID
;

105 
tPvH™dÀ
 
	gH™dÀ
;

106 
tPvFøme
 
	gFøme
;

107 } 
	ttCamîa
;

109 
I∂Image
 *
	g‰ame
;

110 
tCamîa
 
	gCamîa
;

111 
tPvEº
 
	gEºcode
;

115 
	gCvC≠tuªCAM_PvAPI
::
	$CvC≠tuªCAM_PvAPI
()

117 
‰ame
 = 
NULL
;

118 
	`mem£t
(&
this
->
Camîa
, 0, (this->Camera));

119 
	}
}

121 #i‚de‡
WIN32


122 
	gCvC≠tuªCAM_PvAPI
::
	$SÀï
(
time
)

124 
time•ec
 
t
,
r
;

126 
t
.
tv_£c
 = 
time
 / 1000;

127 
t
.
tv_n£c
 = (
time
 % 1000) * 1000000;

129 
	`«no¶ìp
(&
t
,&
r
)==-1)

130 
t
 = 
r
;

131 
	}
}

134 
	gCvC≠tuªCAM_PvAPI
::
	$˛o£
()

137 
	`°›C≠tuª
();

138 
	`PvCamîaClo£
(
Camîa
.
H™dÀ
);

139 
	`PvUnInôülize
();

140 
	}
}

143 
boﬁ
 
	gCvC≠tuªCAM_PvAPI
::
	$›í
–
ödex
 )

145 
tPvCamîaInfo
 
ˇmîaLi°
[
MAX_CAMERAS
];

147 
tPvCamîaInfo
 
ˇmInfo
;

148 
tPvIpSëtögs
 
ùSëtögs
;

151 i‡(
	`PvInôülize
()) {

155 
	`SÀï
(1000);

159 
numCamîas
=
	`PvCamîaLi°
(
ˇmîaLi°
, 
MAX_CAMERAS
, 
NULL
);

161 i‡(
numCamîas
 <0 || 
ödex
 >=ÇumCameras)

162  
Ál£
;

164 
Camîa
.
UID
 = 
ˇmîaLi°
[
ödex
].
UniqueId
;

166 i‡(!
	`PvCamîaInfo
(
Camîa
.
UID
,&
ˇmInfo
Ë&& !
	`PvCamîaIpSëtögsGë
(Camîa.UID,&
ùSëtögs
))

180 
	`Ârötf
(
°dîr
,"ERROR: couldÇotÑetrieve camera IP settings.\n");

181  
Ál£
;

185 i‡(
	`PvCamîaO≥n
(
Camîa
.
UID
, 
ePvAc˚ssMa°î
, &(Camîa.
H™dÀ
))==
ePvEºSuc˚ss
)

187 
tPvUöt32
 
‰ameWidth
, 
‰ameHeight
;

188 
maxSize
;

190 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Width", &
‰ameWidth
);

191 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Height", &
‰ameHeight
);

198 
maxSize
 = 8228;

200 i‡(
	`PvC≠tuªAdju°PackëSize
(
Camîa
.
H™dÀ
,
maxSize
)!=
ePvEºSuc˚ss
)

201  
Ál£
;

203 
	`ªsizeC≠tuªFøme
(
‰ameWidth
, 
‰ameHeight
);

205  
	`°¨tC≠tuª
();

208 
	`Ârötf
(
°dîr
,"Error cannot open camera\n");

209  
Ál£
;

211 
	}
}

213 
boﬁ
 
	gCvC≠tuªCAM_PvAPI
::
	$gøbFøme
()

216  
	`PvC≠tuªQueueFøme
(
Camîa
.
H™dÀ
, &(Camîa.
Føme
), 
NULL
Ë=
ePvEºSuc˚ss
;

217 
	}
}

220 
I∂Image
* 
	gCvC≠tuªCAM_PvAPI
::
	$ªåõveFøme
()

222 i‡(
	`PvC≠tuªWaôF‹FømeD⁄e
(
Camîa
.
H™dÀ
, &(Camîa.
Føme
), 1000Ë=
ePvEºSuc˚ss
)

224  
‰ame
;

226  
NULL
;

227 
	}
}

229 
	gCvC≠tuªCAM_PvAPI
::
	$gëPr›îty
–
¥›îty_id
 ) const

231 
tPvUöt32
 
nTemp
;

233  
¥›îty_id
 )

235 
CV_CAP_PROP_FRAME_WIDTH
:

236 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Width", &
nTemp
);

237  ()
nTemp
;

238 
CV_CAP_PROP_FRAME_HEIGHT
:

239 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Height", &
nTemp
);

240  ()
nTemp
;

241 
CV_CAP_PROP_EXPOSURE
:

242 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
,"ExposuªVÆue",&
nTemp
);

243  ()
nTemp
;

244 
CV_CAP_PROP_FPS
:

245 
tPvFlﬂt32
 
nfTemp
;

246 
	`PvAârFlﬂt32Gë
(
Camîa
.
H™dÀ
, "SètFømeR©e", &
nfTemp
);

247  ()
nfTemp
;

248 
CV_CAP_PROP_PVAPI_MULTICASTIP
:

249 
mE«bÀ
[2];

250 
mIp
[11];

251 
	`PvAârEnumGë
(
Camîa
.
H™dÀ
,"Mu…iˇ°E«bÀ",
mE«bÀ
,(mE«bÀ),
NULL
);

252 i‡(
	`°rcmp
(
mE«bÀ
, "Off") == 0)

258 
ù
;

259 
a
,
b
,
c
,
d
;

260 
	`PvAârSåögGë
(
Camîa
.
H™dÀ
, "Mu…iˇ°IPAddªss",
mIp
,(mIp),
NULL
);

261 
	`ssˇnf
(
mIp
, "%d.%d.%d.%d", &
a
, &
b
, &
c
, &
d
); 
ù
 = ((a*256 + b)*256 + c)*256 + d;

262  ()
ù
;

264 
CV_CAP_PROP_GAIN
:

265 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "GaöVÆue", &
nTemp
);

266  ()
nTemp
;

267 
CV_CAP_PROP_PVAPI_FRAMESTARTTRIGGERMODE
:

268 
åiggîMode
[256];

269 
	`PvAârEnumGë
(
Camîa
.
H™dÀ
, "FømeSèπTriggîMode", 
åiggîMode
, 256, 
NULL
);

270 i‡(
	`°rcmp
(
åiggîMode
, "Freerun")==0)

272 i‡(
	`°rcmp
(
åiggîMode
, "SyncIn1")==0)

274 i‡(
	`°rcmp
(
åiggîMode
, "SyncIn2")==0)

276 i‡(
	`°rcmp
(
åiggîMode
, "FixedRate")==0)

278 i‡(
	`°rcmp
(
åiggîMode
, "Software")==0)

282 
CV_CAP_PROP_PVAPI_DECIMATIONHORIZONTAL
:

283 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Decim©i⁄H‹iz⁄èl", &
nTemp
);

284  ()
nTemp
;

285 
CV_CAP_PROP_PVAPI_DECIMATIONVERTICAL
:

286 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Decim©i⁄Vîtiˇl", &
nTemp
);

287  ()
nTemp
;

288 
CV_CAP_PROP_PVAPI_BINNINGX
:

289 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
,"BönögX",&
nTemp
);

290  ()
nTemp
;

291 
CV_CAP_PROP_PVAPI_BINNINGY
:

292 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
,"BönögY",&
nTemp
);

293  ()
nTemp
;

294 
CV_CAP_PROP_PVAPI_PIXELFORMAT
:

295 
pixñF‹m©
[256];

296 
	`PvAârEnumGë
(
Camîa
.
H™dÀ
, "PixñF‹m©", 
pixñF‹m©
,256,
NULL
);

297 i‡(
	`°rcmp
(
pixñF‹m©
, "Mono8")==0)

299 i‡(
	`°rcmp
(
pixñF‹m©
, "Mono16")==0)

301 i‡(
	`°rcmp
(
pixñF‹m©
, "Bayer8")==0)

303 i‡(
	`°rcmp
(
pixñF‹m©
, "Bayer16")==0)

305 i‡(
	`°rcmp
(
pixñF‹m©
, "Rgb24")==0)

307 i‡(
	`°rcmp
(
pixñF‹m©
, "Bgr24")==0)

309 i‡(
	`°rcmp
(
pixñF‹m©
, "Rgba32")==0)

311 i‡(
	`°rcmp
(
pixñF‹m©
, "Bgra32")==0)

315 
	}
}

317 
boﬁ
 
	gCvC≠tuªCAM_PvAPI
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

319 
tPvEº
 
îr‹
;

321  
¥›îty_id
 )

323 
CV_CAP_PROP_FRAME_WIDTH
:

325 
tPvUöt32
 
cuºHeight
;

327 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Height", &
cuºHeight
);

329 
	`°›C≠tuª
();

331 i‡(!
	`ªsizeC≠tuªFøme
(
vÆue
, 
cuºHeight
))

333 
	`°¨tC≠tuª
();

334  
Ál£
;

337 
	`°¨tC≠tuª
();

341 
CV_CAP_PROP_FRAME_HEIGHT
:

343 
tPvUöt32
 
cuºWidth
;

345 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Width", &
cuºWidth
);

347 
	`°›C≠tuª
();

350 i‡(!
	`ªsizeC≠tuªFøme
(
cuºWidth
, 
vÆue
))

352 
	`°¨tC≠tuª
();

353  
Ál£
;

356 
	`°¨tC≠tuª
();

360 
CV_CAP_PROP_EXPOSURE
:

361 i‡((
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
,"ExposuªVÆue",(
tPvUöt32
)
vÆue
)==
ePvEºSuc˚ss
))

364  
Ál£
;

365 
CV_CAP_PROP_PVAPI_MULTICASTIP
:

366 i‡(
vÆue
==-1)

368 i‡((
	`PvAârEnumSë
(
Camîa
.
H™dÀ
,"Mu…iˇ°E«bÀ", "Off")==
ePvEºSuc˚ss
))

371  
Ál£
;

375 
cv
::
Såög
 
ù
=cv::
	`f‹m©
("%d.%d.%d.%d", (()
vÆue
>>24)&255, (()value>>16)&255, (()value>>8)&255, ()value&255);

376 i‡((
	`PvAârEnumSë
(
Camîa
.
H™dÀ
,"Mu…iˇ°E«bÀ", "On")==
ePvEºSuc˚ss
) &&

377 (
	`PvAârSåögSë
(
Camîa
.
H™dÀ
, "Mu…iˇ°IPAddªss", 
ù
.
	`c_°r
())==
ePvEºSuc˚ss
))

380  
Ál£
;

382 
CV_CAP_PROP_GAIN
:

383 i‡(
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
,"GaöVÆue",(
tPvUöt32
)
vÆue
)!=
ePvEºSuc˚ss
)

385  
Ál£
;

388 
CV_CAP_PROP_PVAPI_FRAMESTARTTRIGGERMODE
:

389 i‡(
vÆue
==0)

390 
îr‹
 = 
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FrameStartTriggerMode", "Freerun");

391 i‡(
vÆue
==1)

392 
îr‹
 = 
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FrameStartTriggerMode", "SyncIn1");

393 i‡(
vÆue
==2)

394 
îr‹
 = 
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FrameStartTriggerMode", "SyncIn2");

395 i‡(
vÆue
==3)

396 
îr‹
 = 
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FrameStartTriggerMode", "FixedRate");

397 i‡(
vÆue
==4)

398 
îr‹
 = 
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FrameStartTriggerMode", "Software");

400 
îr‹
 = 
ePvEºOutOfR™ge
;

401 if(
îr‹
==
ePvEºSuc˚ss
)

404  
Ál£
;

405 
CV_CAP_PROP_PVAPI_DECIMATIONHORIZONTAL
:

406 i‡(
vÆue
 >= 1 && value <= 8)

407 
îr‹
 = 
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "Decim©i⁄H‹iz⁄èl", 
vÆue
);

409 
îr‹
 = 
ePvEºOutOfR™ge
;

410 if(
îr‹
==
ePvEºSuc˚ss
)

413  
Ál£
;

414 
CV_CAP_PROP_PVAPI_DECIMATIONVERTICAL
:

415 i‡(
vÆue
 >= 1 && value <= 8)

416 
îr‹
 = 
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "Decim©i⁄Vîtiˇl", 
vÆue
);

418 
îr‹
 = 
ePvEºOutOfR™ge
;

419 if(
îr‹
==
ePvEºSuc˚ss
)

422  
Ál£
;

423 
CV_CAP_PROP_PVAPI_BINNINGX
:

424 
îr‹
 = 
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "BönögX", 
vÆue
);

425 if(
îr‹
==
ePvEºSuc˚ss
)

428  
Ál£
;

429 
CV_CAP_PROP_PVAPI_BINNINGY
:

430 
îr‹
 = 
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "BönögY", 
vÆue
);

431 if(
îr‹
==
ePvEºSuc˚ss
)

434  
Ál£
;

435 
CV_CAP_PROP_PVAPI_PIXELFORMAT
:

437 
cv
::
Såög
 
pixñF‹m©
;

439 i‡(
vÆue
==1)

440 
pixñF‹m©
 = "Mono8";

441 i‡(
vÆue
==2)

442 
pixñF‹m©
 = "Mono16";

443 i‡(
vÆue
==3)

444 
pixñF‹m©
 = "Bayer8";

445 i‡(
vÆue
==4)

446 
pixñF‹m©
 = "Bayer16";

447 i‡(
vÆue
==5)

448 
pixñF‹m©
 = "Rgb24";

449 i‡(
vÆue
==6)

450 
pixñF‹m©
 = "Bgr24";

451 i‡(
vÆue
==7)

452 
pixñF‹m©
 = "Rgba32";

453 i‡(
vÆue
==8)

454 
pixñF‹m©
 = "Bgra32";

456  
Ál£
;

458 i‡((
	`PvAârEnumSë
(
Camîa
.
H™dÀ
,"PixñF‹m©", 
pixñF‹m©
.
	`c_°r
())==
ePvEºSuc˚ss
))

460 
tPvUöt32
 
cuºWidth
;

461 
tPvUöt32
 
cuºHeight
;

463 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Width", &
cuºWidth
);

464 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Height", &
cuºHeight
);

466 
	`°›C≠tuª
();

468 i‡(!
	`ªsizeC≠tuªFøme
(
cuºWidth
, 
cuºHeight
))

470 
	`°¨tC≠tuª
();

471  
Ál£
;

474 
	`°¨tC≠tuª
();

475  
åue
;

478  
Ál£
;

481  
Ál£
;

483  
åue
;

484 
	}
}

486 
	gCvC≠tuªCAM_PvAPI
::
	$°›C≠tuª
()

488 
	`PvComm™dRun
(
Camîa
.
H™dÀ
, "AcquisitionStop");

489 
	`PvC≠tuªEnd
(
Camîa
.
H™dÀ
);

490 
	}
}

492 
boﬁ
 
	gCvC≠tuªCAM_PvAPI
::
	$°¨tC≠tuª
()

495 
	`PvC≠tuªSèπ
(
Camîa
.
H™dÀ
);

498 if(
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "Acquisôi⁄Mode", "C⁄töuous")!
ePvEºSuc˚ss
)

500 
	`Ârötf
(
°dîr
,"CouldÇot set PvAPI Acquisition Mode\n");

501  
Ál£
;

504 if(
	`PvComm™dRun
(
Camîa
.
H™dÀ
, "Acquisôi⁄Sèπ")!
ePvEºSuc˚ss
)

506 
	`Ârötf
(
°dîr
,"CouldÇot start PvAPIácquisition\n");

507  
Ál£
;

510 if(
	`PvAârEnumSë
(
Camîa
.
H™dÀ
, "FømeSèπTriggîMode", "Fªîun")!
ePvEºSuc˚ss
)

512 
	`Ârötf
(
°dîr
,"Error setting PvAPIÅriggerÅo \"Freerun\"");

513  
Ál£
;

516  
åue
;

517 
	}
}

519 
boﬁ
 
	gCvC≠tuªCAM_PvAPI
::
	$ªsizeC≠tuªFøme
 (
‰ameWidth
, 
‰ameHeight
)

521 
pixñF‹m©
[256];

522 
tPvUöt32
 
‰ameSize
;

523 
tPvUöt32
 
£ns‹Height
;

524 
tPvUöt32
 
£ns‹Width
;

526 i‡(
‰ame
)

528 
	`cvRñó£Image
(&
‰ame
);

529 
‰ame
 = 
NULL
;

532 i‡(
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Sís‹Width", &
£ns‹Width
Ë!
ePvEºSuc˚ss
)

534  
Ál£
;

537 i‡(
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "Sís‹Height", &
£ns‹Height
Ë!
ePvEºSuc˚ss
)

539  
Ál£
;

543 i‡((
‰ameWidth
 < 0Ë|| ((
tPvUöt32
)‰ameWidth > 
£ns‹Width
))

545 
‰ameWidth
 = 
£ns‹Width
;

548 i‡((
‰ameHeight
 < 0Ë|| ((
tPvUöt32
)‰ameHeighà> 
£ns‹Height
))

550 
‰ameHeight
 = 
£ns‹Height
;

554 i‡(
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "Height", 
‰ameHeight
Ë!
ePvEºSuc˚ss
)

556  
Ál£
;

559 i‡(
	`PvAârUöt32Së
(
Camîa
.
H™dÀ
, "Width", 
‰ameWidth
Ë!
ePvEºSuc˚ss
)

561  
Ál£
;

564 
	`PvAârEnumGë
(
Camîa
.
H™dÀ
, "PixñF‹m©", 
pixñF‹m©
,256,
NULL
);

565 
	`PvAârUöt32Gë
(
Camîa
.
H™dÀ
, "TŸÆByãsPîFøme", &
‰ameSize
);

568 i‡–(
	`°rcmp
(
pixñF‹m©
, "Mono8")==0) || (strcmp(pixelFormat, "Bayer8")==0) )

570 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(()
‰ameWidth
, ()
‰ameHeight
), 
IPL_DEPTH_8U
, 1);

571 
‰ame
->
widthSãp
 = ()
‰ameWidth
;

572 
Camîa
.
Føme
.
ImageBuf„rSize
 = 
‰ameSize
;

573 
Camîa
.
Føme
.
ImageBuf„r
 = 
‰ame
->
imageD©a
;

575 i‡–(
	`°rcmp
(
pixñF‹m©
, "Mono16")==0) || (strcmp(pixelFormat, "Bayer16")==0) )

577 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(()
‰ameWidth
, ()
‰ameHeight
), 
IPL_DEPTH_16U
, 1);

578 
‰ame
->
widthSãp
 = ()
‰ameWidth
*2;

579 
Camîa
.
Føme
.
ImageBuf„rSize
 = 
‰ameSize
;

580 
Camîa
.
Føme
.
ImageBuf„r
 = 
‰ame
->
imageD©a
;

582 i‡–(
	`°rcmp
(
pixñF‹m©
, "Rgb24")==0) || (strcmp(pixelFormat, "Bgr24")==0) )

584 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(()
‰ameWidth
, ()
‰ameHeight
), 
IPL_DEPTH_8U
, 3);

585 
‰ame
->
widthSãp
 = ()
‰ameWidth
*3;

586 
Camîa
.
Føme
.
ImageBuf„rSize
 = 
‰ameSize
;

587 
Camîa
.
Føme
.
ImageBuf„r
 = 
‰ame
->
imageD©a
;

589 i‡–(
	`°rcmp
(
pixñF‹m©
, "Rgba32")==0) || (strcmp(pixelFormat, "Bgra32")==0) )

591 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(()
‰ameWidth
, ()
‰ameHeight
), 
IPL_DEPTH_8U
, 4);

592 
‰ame
->
widthSãp
 = ()
‰ameWidth
*4;

593 
Camîa
.
Føme
.
ImageBuf„rSize
 = 
‰ameSize
;

594 
Camîa
.
Føme
.
ImageBuf„r
 = 
‰ame
->
imageD©a
;

597  
Ál£
;

599  
åue
;

600 
	}
}

602 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_PvAPI
–
ödex
 )

604 
CvC≠tuªCAM_PvAPI
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_PvAPI;

606 i‡–
ˇ±uª
->
	`›í
–
ödex
 ))

607  
ˇ±uª
;

609 
dñëe
 
ˇ±uª
;

610  
NULL
;

611 
	}
}

	@src/cap_qt.cpp

43 
	~"¥ecomp.hµ
"

57 
	~<c°dio
>

58 
	~<ˇs£π
>

61 
	~<C¨b⁄/C¨b⁄.h
>

62 
	~<C‹eFound©i⁄/C‹eFound©i⁄.h
>

63 
	~<QuickTime/QuickTime.h
>

67 
	gdid_íãr_movõs
 = 0;

70 #¥agm®
m¨k
 
Ródög
 
Video
 
Fûes


73 
	sCvC≠tuª_QT_Movõ


75 
Movõ
 
	mmyMovõ
;

76 
GW‹ldPå
 
	mmyGW‹ld
;

78 
CvSize
 
	msize
;

79 
TimeVÆue
 
	mmovõ_°¨t_time
;

80 
	mnumbî_of_‰ames
;

81 
	m√xt_‰ame_time
;

82 
	m√xt_‰ame_numbî
;

84 
I∂Image
 * 
	mimage_rgb
;

85 
I∂Image
 * 
	mimage_bgr
;

87 } 
	tCvC≠tuª_QT_Movõ
;

90 
icvO≥nFûe_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, c⁄° * 
fûíame
);

91 
icvClo£_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
);

92 
icvGëPr›îty_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, 
¥›îty_id
);

93 
icvSëPr›îty_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, 
¥›îty_id
, 
vÆue
);

94 
icvGøbFøme_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
);

95 c⁄° * 
icvRërõveFøme_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, );

98 
CvC≠tuª_QT_Movõ
 * 
	$icvC≠tuªFromFûe_QT
 (c⁄° * 
fûíame
)

100 
did_íãr_movõs
 = 0;

101 i‡(! 
did_íãr_movõs
)

103 
	`E¡îMovõs
();

104 
did_íãr_movõs
 = 1;

107 
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
 = 0;

109 i‡(
fûíame
)

111 
ˇ±uª
 = (
CvC≠tuª_QT_Movõ
 *Ë
	`cvAŒoc
 ( (*capture));

112 
	`mem£t
 (
ˇ±uª
, 0, (*capture));

114 i‡(!
	`icvO≥nFûe_QT_Movõ
 (
ˇ±uª
, 
fûíame
))

115 
	`cvFªe
–&
ˇ±uª
 );

118  
ˇ±uª
;

119 
	}
}

132 
	$icvO≥nFûe_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, c⁄° * 
fûíame
)

134 
Re˘
 
myRe˘
;

135 
myResID
 = 0;

136 
H™dÀ
 
myD©aRef
 = 
nû
;

137 
OSTy≥
 
myD©aRefTy≥
 = 0;

138 
OSEº
 
myEº
 = 
noEº
;

142 
	`CÀ¨MovõsStickyEº‹
 ();

145 
ˇ±uª
->
myMovõ
 = 0;

146 
ˇ±uª
->
myGW‹ld
 = 
nû
;

149 
ˇ±uª
->
√xt_‰ame_time
 = -1;

150 
ˇ±uª
->
√xt_‰ame_numbî
 = -1;

151 
ˇ±uª
->
numbî_of_‰ames
 = -1;

152 
ˇ±uª
->
movõ_°¨t_time
 = -1;

153 
ˇ±uª
->
size
 = 
	`cvSize
 (-1,-1);

157 
CFSåögRef
 
öP©h
 = 
	`CFSåögCª©eWôhCSåög
 (
kCFAŒoˇt‹DeÁu…
, 
fûíame
, 
kCFSåögEncodögISOL©ö1
);

158 
	`OPENCV_ASSERT
 ((
öP©h
 !
nû
), "icvOpenFile_QT_Movie", "couldnt create CFString fromá string");

161 
myEº
 = 
	`QTNewD©aRe„ªn˚FromFuŒP©hCFSåög
 (
öP©h
, 
kQTPOSIXP©hStyÀ
, 0, & 
myD©aRef
, & 
myD©aRefTy≥
);

162 i‡(
myEº
 !
noEº
)

164 
	`Ârötf
 (
°dîr
, "Couldn't create QTNewDataReferenceFromFullPathCFString().\n");

169 
myEº
 = 
	`NewMovõFromD©aRef
(& 
ˇ±uª
->
myMovõ
, 
√wMovõA˘ive
 | 
√wMovõAsyncOK
 ,

170 & 
myResID
, 
myD©aRef
, 
myD©aRefTy≥
);

173 
	`Di•o£H™dÀ
 (
myD©aRef
);

176 i‡(
myEº
 !
noEº
)

178 
	`Ârötf
 (
°dîr
, "Couldn'à¸óãá NewMovõFromD©aRef(Ë-Éº‹ i†%d.\n", 
myEº
);

186 
OSTy≥
 
whichMedüTy≥
 = 
VisuÆMedüCh¨a˘îi°ic
;

187 
TimeVÆue
 
theTime
 = -1;

190 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, (
√xtTimeMedüSam∂e
 + 
√xtTimeEdgeOK
),

191 1, & 
whichMedüTy≥
, 
	`TimeVÆue
 (0), 0, & 
theTime
, 
NULL
);

192 i‡(
theTime
 == -1)

194 
	`Ârötf
 (
°dîr
, "Couldn't inquire first frameÅime\n");

197 
ˇ±uª
->
movõ_°¨t_time
 = 
theTime
;

198 
ˇ±uª
->
√xt_‰ame_time
 = 
theTime
;

199 
ˇ±uª
->
√xt_‰ame_numbî
 = 0;

202 
ˇ±uª
->
numbî_of_‰ames
 = 0;

203 
theTime
 >= 0)

205 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, (
√xtTimeMedüSam∂e
),

206 1, & 
whichMedüTy≥
, 
theTime
, 0, &ÅheTime, 
NULL
);

207 
ˇ±uª
->
numbî_of_‰ames
++;

212 
	`GëMovõsEº‹
 ();

213 
	`GëMovõBox
 (
ˇ±uª
->
myMovõ
, & 
myRe˘
);

214 
ˇ±uª
->
size
 = 
	`cvSize
 (
myRe˘
.
right
 - myRe˘.
À·
, myRe˘.
bŸtom
 - myRe˘.
t›
);

217 
myEº
 = 
	`QTNewGW‹ld
 (& 
ˇ±uª
->
myGW‹ld
, 
k32ARGBPixñF‹m©
 ,

218 & 
myRe˘
, 
nû
,Çil, 0);

219 
	`OPENCV_ASSERT
 (
myEº
 =
noEº
, "icvOpenFile_QT_Movie", "couldnt create QTNewGWorld() for output image");

220 
	`SëMovõGW‹ld
 (
ˇ±uª
->
myMovõ
, c≠tuª->
myGW‹ld
, 
nû
);

223 
ˇ±uª
->
image_rgb
 = 
	`cvCª©eImageHódî
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 4);

226 
ˇ±uª
->
image_bgr
 = 
	`cvCª©eImage
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 3);

230 
	}
}

238 
	$icvClo£_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
)

240 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvClose_QT_Movie", "'capture' isá NULL-pointer");

243 i‡(
ˇ±uª
->
myMovõ
)

245 
	`cvRñó£Image
 (& 
ˇ±uª
->
image_bgr
);

246 
	`cvRñó£ImageHódî
 (& 
ˇ±uª
->
image_rgb
);

247 
	`Di•o£GW‹ld
 (
ˇ±uª
->
myGW‹ld
);

248 
	`Di•o£Movõ
 (
ˇ±uª
->
myMovõ
);

253 
	}
}

261 
	$icvGëPr›îty_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, 
¥›îty_id
)

263 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvGetProperty_QT_Movie", "'capture' isá NULL-pointer");

264 
	`OPENCV_ASSERT
 (
ˇ±uª
->
myMovõ
, "icvGetProperty_QT_Movie", "invalid Movie handle");

265 
	`OPENCV_ASSERT
 (
ˇ±uª
->
numbî_of_‰ames
 > 0, "icvGetProperty_QT_Movie", "movie has invalidÇumber of frames");

266 
	`OPENCV_ASSERT
 (
ˇ±uª
->
movõ_°¨t_time
 >= 0, "icvGetProperty_QT_Movie", "movie has invalid startÅime");

269 
¥›îty_id
)

271 
CV_CAP_PROP_POS_FRAMES
:

272  (
ˇ±uª
->
√xt_‰ame_numbî
);

274 
CV_CAP_PROP_POS_MSEC
:

275 
CV_CAP_PROP_POS_AVI_RATIO
:

277 
TimeVÆue
 
posôi⁄
 = 
ˇ±uª
->
√xt_‰ame_time
 - c≠tuª->
movõ_°¨t_time
;

279 i‡(
¥›îty_id
 =
CV_CAP_PROP_POS_MSEC
)

281 
TimeSˇÀ
 
timesˇÀ
 = 
	`GëMovõTimeSˇÀ
 (
ˇ±uª
->
myMovõ
);

282  (
°©ic_ˇ°
<> (
posôi⁄
Ë* 1000.0 / 
timesˇÀ
);

286 
TimeVÆue
 
duøti⁄
 = 
	`GëMovõDuøti⁄
 (
ˇ±uª
->
myMovõ
);

287  (
°©ic_ˇ°
<> (
posôi⁄
Ë/ 
duøti⁄
);

292 
CV_CAP_PROP_FRAME_WIDTH
:

293  
°©ic_ˇ°
<> (
ˇ±uª
->
size
.
width
);

295 
CV_CAP_PROP_FRAME_HEIGHT
:

296  
°©ic_ˇ°
<> (
ˇ±uª
->
size
.
height
);

298 
CV_CAP_PROP_FPS
:

300 
TimeVÆue
 
duøti⁄
 = 
	`GëMovõDuøti⁄
 (
ˇ±uª
->
myMovõ
);

301 
TimeSˇÀ
 
timesˇÀ
 = 
	`GëMovõTimeSˇÀ
 (
ˇ±uª
->
myMovõ
);

303  (
ˇ±uª
->
numbî_of_‰ames
 / (
°©ic_ˇ°
<> (
duøti⁄
Ë/ 
timesˇÀ
));

306 
CV_CAP_PROP_FRAME_COUNT
:

307  
°©ic_ˇ°
<> (
ˇ±uª
->
numbî_of_‰ames
);

309 
CV_CAP_PROP_FOURCC
:

310 
CV_CAP_PROP_FORMAT
:

311 
CV_CAP_PROP_MODE
:

314 
	`OPENCV_ERROR
 (
CV_StsBadArg
, "icvSetProperty_QT_Movie", "unknown or unhandledÖroperty_id");

315  
CV_StsBadArg
;

319 
	}
}

328 
	$icvSëPr›îty_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, 
¥›îty_id
, 
vÆue
)

330 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvSetProperty_QT_Movie", "'capture' isá NULL-pointer");

331 
	`OPENCV_ASSERT
 (
ˇ±uª
->
myMovõ
, "icvSetProperty_QT_Movie", "invalid Movie handle");

332 
	`OPENCV_ASSERT
 (
ˇ±uª
->
numbî_of_‰ames
 > 0, "icvSetProperty_QT_Movie", "movie has invalidÇumber of frames");

333 
	`OPENCV_ASSERT
 (
ˇ±uª
->
movõ_°¨t_time
 >= 0, "icvSetProperty_QT_Movie", "movie has invalid startÅime");

340 
¥›îty_id
)

342 
CV_CAP_PROP_POS_MSEC
:

343 
CV_CAP_PROP_POS_AVI_RATIO
:

345 
TimeVÆue
 
de°ö©i⁄
;

346 
OSTy≥
 
myTy≥
 = 
VisuÆMedüCh¨a˘îi°ic
;

347 
OSEº
 
myEº
 = 
noEº
;

349 i‡(
¥›îty_id
 =
CV_CAP_PROP_POS_MSEC
)

351 
TimeSˇÀ
 
timesˇÀ
 = 
	`GëMovõTimeSˇÀ
 (
ˇ±uª
->
myMovõ
);

352 
de°ö©i⁄
 = 
°©ic_ˇ°
<
TimeVÆue
> (
vÆue
 / 1000.0 * 
timesˇÀ
 + 
ˇ±uª
->
movõ_°¨t_time
);

356 
TimeVÆue
 
duøti⁄
 = 
	`GëMovõDuøti⁄
 (
ˇ±uª
->
myMovõ
);

357 
de°ö©i⁄
 = 
°©ic_ˇ°
<
TimeVÆue
> (
vÆue
 * 
duøti⁄
 + 
ˇ±uª
->
movõ_°¨t_time
);

361 i‡(
ˇ±uª
->
√xt_‰ame_time
 =
de°ö©i⁄
)

365 i‡(
ˇ±uª
->
√xt_‰ame_time
 < 
de°ö©i⁄
)

367 
ˇ±uª
->
√xt_‰ame_time
 < 
de°ö©i⁄
)

369 
ˇ±uª
->
√xt_‰ame_numbî
++;

370 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, 
√xtTimeSãp
, 1, & 
myTy≥
, c≠tuª->
√xt_‰ame_time
,

371 1, & 
ˇ±uª
->
√xt_‰ame_time
, 
NULL
);

372 
myEº
 = 
	`GëMovõsEº‹
();

373 i‡(
myEº
 !
noEº
)

375 
	`Ârötf
 (
°dîr
, "Couldn't go onÅo GetMovieNextInterestingTime() in icvGrabFrame_QT.\n");

382 
ˇ±uª
->
√xt_‰ame_time
 > 
de°ö©i⁄
)

384 
ˇ±uª
->
√xt_‰ame_numbî
--;

385 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, 
√xtTimeSãp
, 1, & 
myTy≥
, c≠tuª->
√xt_‰ame_time
,

386 -1, & 
ˇ±uª
->
√xt_‰ame_time
, 
NULL
);

387 
myEº
 = 
	`GëMovõsEº‹
();

388 i‡(
myEº
 !
noEº
)

390 
	`Ârötf
 (
°dîr
, "Couldn't go backÅo GetMovieNextInterestingTime() in icvGrabFrame_QT.\n");

398 
CV_CAP_PROP_POS_FRAMES
:

400 
TimeVÆue
 
de°ö©i⁄
 = 
°©ic_ˇ°
<TimeVÆue> (
vÆue
);

401 
dúe˘i⁄
 = (
de°ö©i⁄
 > 
ˇ±uª
->
√xt_‰ame_numbî
) ? 1 : -1;

402 
OSTy≥
 
myTy≥
 = 
VisuÆMedüCh¨a˘îi°ic
;

403 
OSEº
 
myEº
 = 
noEº
;

405 
de°ö©i⁄
 !
ˇ±uª
->
√xt_‰ame_numbî
)

407 
ˇ±uª
->
√xt_‰ame_numbî
 +
dúe˘i⁄
;

408 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, 
√xtTimeSãp
, 1, & 
myTy≥
, c≠tuª->
√xt_‰ame_time
,

409 
dúe˘i⁄
, & 
ˇ±uª
->
√xt_‰ame_time
, 
NULL
);

410 
myEº
 = 
	`GëMovõsEº‹
();

411 i‡(
myEº
 !
noEº
)

413 
	`Ârötf
 (
°dîr
, "Couldn't stepÅo desired frameÇumber in icvGrabFrame_QT.\n");

422 
	`OPENCV_ERROR
 (
CV_StsBadArg
, "icvSetProperty_QT_Movie", "unknown or unhandledÖroperty_id");

428 
	}
}

438 
	$icvGøbFøme_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
)

440 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvGrabFrame_QT_Movie", "'capture' isá NULL-pointer");

441 
	`OPENCV_ASSERT
 (
ˇ±uª
->
myMovõ
, "icvGrabFrame_QT_Movie", "invalid Movie handle");

443 
TimeVÆue
 
myCuºTime
;

444 
OSTy≥
 
myTy≥
 = 
VisuÆMedüCh¨a˘îi°ic
;

445 
OSEº
 
myEº
 = 
noEº
;

449 
	`SëMovõTimeVÆue
 (
ˇ±uª
->
myMovõ
, c≠tuª->
√xt_‰ame_time
);

450 
myEº
 = 
	`GëMovõsEº‹
();

451 i‡(
myEº
 !
noEº
)

453 
	`Ârötf
 (
°dîr
, "Couldn't SetMovieTimeValue() in icvGrabFrame_QT_Movie.\n");

458 
myCuºTime
 = 
	`GëMovõTime
 (
ˇ±uª
->
myMovõ
, 
NULL
);

461 
ˇ±uª
->
√xt_‰ame_numbî
++;

462 
	`GëMovõNextI¡îe°ögTime
 (
ˇ±uª
->
myMovõ
, 
√xtTimeSãp
, 1, & 
myTy≥
, 
myCuºTime
, 1, & c≠tuª->
√xt_‰ame_time
, 
NULL
);

463 
myEº
 = 
	`GëMovõsEº‹
();

464 i‡(
myEº
 !
noEº
)

466 
	`Ârötf
 (
°dîr
, "Couldn't GetMovieNextInterestingTime() in icvGrabFrame_QT_Movie.\n");

472 
	}
}

481 c⁄° * 
	$icvRërõveFøme_QT_Movõ
 (
CvC≠tuª_QT_Movõ
 * 
ˇ±uª
, )

483 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvRetrieveFrame_QT_Movie", "'capture' isá NULL-pointer");

484 
	`OPENCV_ASSERT
 (
ˇ±uª
->
myMovõ
, "icvRetrieveFrame_QT_Movie", "invalid Movie handle");

485 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_rgb
, "icvRetrieveFrame_QT_Movie", "invalid source image");

486 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_bgr
, "icvRetrieveFrame_QT_Movie", "invalid destination image");

488 
PixM≠H™dÀ
 
myPixM≠H™dÀ
 = 
nû
;

489 
OSEº
 
myEº
 = 
noEº
;

494 
	`Upd©eMovõ
 (
ˇ±uª
->
myMovõ
);

495 
myEº
 = 
	`GëMovõsEº‹
 ();

496 i‡(
myEº
 !
noEº
)

498 
	`Ârötf
 (
°dîr
, "Couldn't UpdateMovie() in icvRetrieveFrame_QT_Movie().\n");

503 
	`MovõsTask
 (
ˇ±uª
->
myMovõ
, 0L);

504 
myEº
 = 
	`GëMovõsEº‹
 ();

505 i‡(
myEº
 !
noEº
)

507 
	`Ârötf
 (
°dîr
, "MoviesTask() didn't succeed in icvRetrieveFrame_QT_Movie().\n");

515 
myPixM≠H™dÀ
 = 
	`GëGW‹ldPixM≠
 (
ˇ±uª
->
myGW‹ld
);

516 
	`LockPixñs
 (
myPixM≠H™dÀ
);

517 
	`cvSëD©a
 (
ˇ±uª
->
image_rgb
, 
	`GëPixBa£Addr
 (
myPixM≠H™dÀ
Ë+ 1, 
	`GëPixRowByãs
 (myPixMapHandle));

520 
	`cvCvtCﬁ‹
 (
ˇ±uª
->
image_rgb
, c≠tuª->
image_bgr
, 
CV_RGBA2BGR
);

523 
	`U∆ockPixñs
 (
myPixM≠H™dÀ
);

526  
ˇ±uª
->
image_bgr
;

527 
	}
}

531 #¥agm®
m¨k
 -

532 #¥agm®
m¨k
 
C≠turög
 
‰om
 
Video
 
Camîas


534 #ifde‡
USE_VDIG_VERSION


537 
	sCvC≠tuª_QT_Cam_vdig


539 
Comp⁄ítIn°™˚
 
	mgøbbî
;

540 
	mch™√l
;

541 
GW‹ldPå
 
	mmyGW‹ld
;

542 
PixM≠H™dÀ
 
	mpixm≠
;

544 
CvSize
 
	msize
;

545 
	mnumbî_of_‰ames
;

547 
I∂Image
 * 
	mimage_rgb
;

548 
I∂Image
 * 
	mimage_bgr
;

550 } 
	tCvC≠tuª_QT_Cam
;

554 
	sCvC≠tuª_QT_Cam_b¨g


556 
SeqGøbComp⁄ít
 
	mgøbbî
;

557 
SGCh™√l
 
	mch™√l
;

558 
GW‹ldPå
 
	mgw‹ld
;

559 
Re˘
 
	mbounds
;

560 
ImageSequí˚
 
	m£quí˚
;

562 vﬁ©ûê
boﬁ
 
	mgŸ_‰ame
;

564 
CvSize
 
	msize
;

565 
I∂Image
 * 
	mimage_rgb
;

566 
I∂Image
 * 
	mimage_bgr
;

568 } 
	tCvC≠tuª_QT_Cam
;

572 
icvO≥nCamîa_QT
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, c⁄° 
ödex
);

573 
icvClo£_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
);

574 
icvGëPr›îty_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, 
¥›îty_id
);

575 
icvSëPr›îty_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, 
¥›îty_id
, 
vÆue
);

576 
icvGøbFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
);

577 c⁄° * 
icvRërõveFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, );

586 
CvC≠tuª_QT_Cam
 * 
	$icvC≠tuªFromCam_QT
 (c⁄° 
ödex
)

588 i‡(! 
did_íãr_movõs
)

590 
	`E¡îMovõs
();

591 
did_íãr_movõs
 = 1;

594 
CvC≠tuª_QT_Cam
 * 
ˇ±uª
 = 0;

596 i‡(
ödex
 >= 0)

598 
ˇ±uª
 = (
CvC≠tuª_QT_Cam
 *Ë
	`cvAŒoc
 ( (*capture));

599 
	`mem£t
 (
ˇ±uª
, 0, (*capture));

601 i‡(!
	`icvO≥nCamîa_QT
 (
ˇ±uª
, 
ödex
))

602 
	`cvFªe
 (&
ˇ±uª
);

605  
ˇ±uª
;

606 
	}
}

609 
	$icvGëPr›îty_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, 
¥›îty_id
)

611 
	`as£π
 (0);

613 
	}
}

616 
	$icvSëPr›îty_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, 
¥›îty_id
, 
vÆue
)

618 
	`as£π
 (0);

620 
	}
}

622 #ifde‡
USE_VDIG_VERSION


623 #¥agm®
m¨k
 
C≠turög
 
usög
 
VDIG


632 
	$icvO≥nCamîa_QT
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, c⁄° 
ödex
)

634 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvOpenCamera_QT", "'capture' isá NULL-pointer");

635 
	`OPENCV_ASSERT
 (
ödex
 >=0, "icvOpenCamera_QT", "camera index isÇegative");

637 
Comp⁄ítDes¸ùti⁄
 
comp⁄ít_des¸ùti⁄
;

638 
Comp⁄ít
 
comp⁄ít
 = 0;

639 
numbî_of_öputs
 = 0;

640 
Re˘
 
myRe˘
;

641 
Comp⁄ítResu…
 
ªsu…
 = 
noEº
;

645 
comp⁄ít_des¸ùti⁄
.
comp⁄ítTy≥
 = 
videoDigôizîComp⁄ítTy≥
;

646 
comp⁄ít_des¸ùti⁄
.
comp⁄ítSubTy≥
 = 0L;

647 
comp⁄ít_des¸ùti⁄
.
comp⁄ítM™uÁ˘uªr
 = 0L;

648 
comp⁄ít_des¸ùti⁄
.
comp⁄ítFœgs
 = 0L;

649 
comp⁄ít_des¸ùti⁄
.
comp⁄ítFœgsMask
 = 0L;

653 
comp⁄ít
 = 
	`FödNextComp⁄ít
 (comp⁄ít, & 
comp⁄ít_des¸ùti⁄
);

656 i‡(
comp⁄ít
)

659 #i‚de‡
NDEBUG


660 
Comp⁄ítDes¸ùti⁄
 
desc
;

661 
H™dÀ
 
«meH™dÀ
 = 
	`NewH™dÀCÀ¨
 (200);

662 
«meBuf„r
 [255];

664 
ªsu…
 = 
	`GëComp⁄ítInfo
 (
comp⁄ít
, & 
desc
, 
«meH™dÀ
, 
nû
,Çil);

665 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt GetComponentInfo()");

666 
	`OPENCV_ASSERT
 (*
«meH™dÀ
, "icvOpenCamera_QT", "NoÇameÑeturned by GetComponentInfo()");

667 
	`¢¥ötf
 (
«meBuf„r
, (**
«meH™dÀ
) + 1, "%s", (*) (*ÇameHandle + 1));

668 
	`¥ötf
 ("- Videodevi˚: %s\n", 
«meBuf„r
);

669 
	`Di•o£H™dÀ
 (
«meH™dÀ
);

673 
ˇ±uª
->
gøbbî
 = 
	`O≥nComp⁄ít
 (
comp⁄ít
);

674 i‡(
ˇ±uª
->
gøbbî
)

676 
ªsu…
 = 
	`VDGëNumbîOfI≈uts
 (
ˇ±uª
->
gøbbî
, & c≠tuª->
ch™√l
);

677 i‡(
ªsu…
 !
noEº
)

678 
	`Ârötf
 (
°dîr
, "Could¡ GëNumbîOfI≈uts: %d\n", (Ë
ªsu…
);

681 #i‚de‡
NDEBUG


682 
	`¥ötf
 (" Numbî o‡öputs: %d\n", (Ë
ˇ±uª
->
ch™√l
 + 1);

686 
numbî_of_öputs
 +
ˇ±uª
->
ch™√l
 + 1;

690 i‡(
numbî_of_öputs
 > 
ödex
)

693 
ˇ±uª
->
ch™√l
 = 
ödex
 - 
numbî_of_öputs
 + capture->channel + 1;

694 
	`OPENCV_ASSERT
 (
ˇ±uª
->
ch™√l
 >= 0, "icvOpenCamera_QT", "negative channelÇumber");

697 #i‚de‡
NDEBUG


698 
«me
[256];

699 
Så255
 
«meBuf„r
;

701 
ªsu…
 = 
	`VDGëI≈utName
 (
ˇ±uª
->
gøbbî
, c≠tuª->
ch™√l
, 
«meBuf„r
);

702 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "ictOpenCamera_QT", "couldnt GetInputName()");

703 
	`¢¥ötf
 (
«me
, *
«meBuf„r
, "%s", (*) (nameBuffer + 1));

704 
	`¥ötf
 (" Choosög i≈uà%d - %s\n", (Ë
ˇ±uª
->
ch™√l
, 
«me
);

713 
	`Clo£Comp⁄ít
 (
ˇ±uª
->
gøbbî
);

717 
comp⁄ít
);

720 i‡(! 
comp⁄ít
)

722 
	`Ârötf
(
°dîr
, "NŸÉnough i≈ut†avaûabÀ - c™'àchoo£ i≈uà%d\n", 
ödex
);

728 
	`CÀ¨MovõsStickyEº‹
();

731 
ªsu…
 = 
	`VDSëI≈ut
 (
ˇ±uª
->
gøbbî
, c≠tuª->
ch™√l
);

732 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt select video digitizer input");

735 
ªsu…
 = 
	`VDGëA˘iveSrcRe˘
 (
ˇ±uª
->
gøbbî
, c≠tuª->
ch™√l
, & 
myRe˘
);

736 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt create VDGetActiveSrcRect from digitizer");

737 
myRe˘
.
right
 = 640; myRe˘.
bŸtom
 = 480;

738 
ˇ±uª
->
size
 = 
	`cvSize
 (
myRe˘
.
right
 - myRe˘.
À·
, myRe˘.
bŸtom
 - myRe˘.
t›
);

739 
	`¥ötf
 ("Sour˚Ñe˘ i†%d, %d -- %d, %d\n", (Ë
myRe˘
.
À·
, (ËmyRe˘.
t›
, (ËmyRe˘.
right
, (ËmyRe˘.
bŸtom
);

742 
ªsu…
 = 
	`QTNewGW‹ld
 (& 
ˇ±uª
->
myGW‹ld
, 
k32ARGBPixñF‹m©
, & 
myRe˘
, 
nû
,Çil, 0);

743 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt create QTNewGWorld() for output image");

746 
ˇ±uª
->
pixm≠
 = 
	`GëGW‹ldPixM≠
 (ˇ±uª->
myGW‹ld
);

747 
ªsu…
 = 
	`GëMovõsEº‹
 ();

748 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt getÖixmap");

751 
ªsu…
 = 
	`VDSëDigôizîRe˘
 (
ˇ±uª
->
gøbbî
, & 
myRe˘
);

752 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt create VDGetActiveSrcRect from digitizer");

755 
ªsu…
 = 
	`VDSëPœyThruDe°ö©i⁄
 (
ˇ±uª
->
gøbbî
, c≠tuª->
pixm≠
, & 
myRe˘
, 
nû
,Çil);

756 
	`¥ötf
 ("QuickTimêîr‹: %d\n", (Ë
ªsu…
);

757 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set video destination");

760 
ªsu…
 = 
	`VDGëPœyThruDe°ö©i⁄
 (
ˇ±uª
->
gøbbî
, & c≠tuª->
pixm≠
, 
nû
,Çil,Çil);

761 
	`¥ötf
 ("QuickTimêîr‹: %d\n", (Ë
ªsu…
);

762 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt get video destination");

763 
	`OPENCV_ASSERT
 (
ˇ±uª
->
pixm≠
 !
nû
, "icvOpenCamera_QT", "empty set video destination");

766 
	`GëPixBounds
 (
ˇ±uª
->
pixm≠
, & 
myRe˘
);

767 
ˇ±uª
->
size
 = 
	`cvSize
 (
myRe˘
.
right
 - myRe˘.
À·
, myRe˘.
bŸtom
 - myRe˘.
t›
);

770 
ˇ±uª
->
image_rgb
 = 
	`cvCª©eImageHódî
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 4);

771 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_rgb
, "icvOpenCamera_QT", "couldnt create image header");

774 
ˇ±uª
->
image_bgr
 = 
	`cvCª©eImage
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 3);

775 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_bgr
, "icvOpenCamera_QT", "couldnt create image");

778 
ªsu…
 = 
	`VDC≠tuªSèãCh™gög
 (
ˇ±uª
->
gøbbî
, 
vdFœgC≠tuªIsF‹Rec‹d
 | 
vdFœgC≠tuªSèπög
 | 
vdFœgC≠tuªLowL©ícy
);

779 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set capture state");

784 
	}
}

786 
	$icvClo£_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
)

788 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvClose_QT_Cam", "'capture' isá NULL-pointer");

790 
Comp⁄ítResu…
 
ªsu…
 = 
noEº
;

793 
ªsu…
 = 
	`VDC≠tuªSèãCh™gög
 (
ˇ±uª
->
gøbbî
, 
vdFœgC≠tuªSt›pög
);

794 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set capture state");

797 
	`cvRñó£Image
 (& 
ˇ±uª
->
image_bgr
);

798 
	`cvRñó£ImageHódî
 (& 
ˇ±uª
->
image_rgb
);

799 
	`Di•o£GW‹ld
 (
ˇ±uª
->
myGW‹ld
);

800 
	`Clo£Comp⁄ít
 (
ˇ±uª
->
gøbbî
);

804 
	}
}

806 
	$icvGøbFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
)

808 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvGrabFrame_QT_Cam", "'capture' isá NULL-pointer");

809 
	`OPENCV_ASSERT
 (
ˇ±uª
->
gøbbî
, "icvGrabFrame_QT_Cam", "'grabber' isá NULL-pointer");

811 
Comp⁄ítResu…
 
ªsu…
 = 
noEº
;

814 
ªsu…
 = 
	`VDGøbO√Føme
 (
ˇ±uª
->
gøbbî
);

815 i‡(
ªsu…
 !
noEº
)

817 
	`Ârötf
 (
°dîr
, "VDGrabOneFrame failed\n");

823 
	}
}

825 c⁄° * 
	$icvRërõveFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, )

827 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvRetrieveFrame_QT_Cam", "'capture' isá NULL-pointer");

829 
PixM≠H™dÀ
 
myPixM≠H™dÀ
 = 
nû
;

836 
myPixM≠H™dÀ
 = 
ˇ±uª
->
pixm≠
;

837 
	`LockPixñs
 (
myPixM≠H™dÀ
);

838 
	`cvSëD©a
 (
ˇ±uª
->
image_rgb
, 
	`GëPixBa£Addr
 (
myPixM≠H™dÀ
Ë+ 1, 
	`GëPixRowByãs
 (myPixMapHandle));

841 
	`cvCvtCﬁ‹
 (
ˇ±uª
->
image_rgb
, c≠tuª->
image_bgr
, 
CV_RGBA2BGR
);

844 
	`U∆ockPixñs
 (
myPixM≠H™dÀ
);

847  
ˇ±uª
->
image_bgr
;

848 
	}
}

851 #¥agm®
m¨k
 
C≠turög
 
usög
 
Sequí˚
 
Gøbbî


853 
OSEº
 
	$icvD©aProc_QT_Cam
 (
SGCh™√l
 
ch™√l
, 
På
 
øw_d©a
, 
Àn
, *, , 
TimeVÆue
, , 
ªfC⁄
)

855 
CvC≠tuª_QT_Cam
 * 
ˇ±uª
 = (CvC≠tuª_QT_Cam *Ë
ªfC⁄
;

856 
CodecFœgs
 
ign‹e
;

857 
Comp⁄ítResu…
 
îr
 = 
noEº
;

861 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvDataProc_QT_Cam", "'capture' isá NULL-pointer");

862 
	`OPENCV_ASSERT
 (
ˇ±uª
->
gw‹ld
, "icvDataProc_QT_Cam", "'gworld' isá NULL-pointer");

863 
	`OPENCV_ASSERT
 (
øw_d©a
, "icvDataProc_QT_Cam", "'raw_data' isá NULL-pointer");

866 i‡(
ˇ±uª
->
£quí˚
 == 0)

868 
ImageDes¸ùti⁄H™dÀ
 
des¸ùti⁄
 = (ImageDes¸ùti⁄H™dÀË
	`NewH™dÀ
(0);

871 
îr
 = 
	`SGGëCh™√lSam∂eDes¸ùti⁄
 (
ch™√l
, (
H™dÀ
Ë
des¸ùti⁄
);

872 
	`OPENCV_ASSERT
 (
îr
 =
noEº
, "icvDataProc_QT_Cam", "couldnt get channel sample description");

876 
Re˘
 
sour˚Re˘
;

877 
sour˚Re˘
.
t›
 = 0;

878 
sour˚Re˘
.
À·
 = 0;

879 
sour˚Re˘
.
right
 = (**
des¸ùti⁄
).
width
;

880 
sour˚Re˘
.
bŸtom
 = (**
des¸ùti⁄
).
height
;

882 
M©rixRec‹d
 
sˇÀM©rix
;

883 
	`Re˘M©rix
(&
sˇÀM©rix
,&
sour˚Re˘
,&
ˇ±uª
->
bounds
);

885 
îr
 = 
	`Decom¥essSequí˚Begö
 (&
ˇ±uª
->
£quí˚
, 
des¸ùti⁄
, c≠tuª->
gw‹ld
, 0,&ˇ±uª->
bounds
,&
sˇÀM©rix
, 
§cC›y
, 
NULL
, 0, 
codecN‹mÆQuÆôy
, 
be°S≥edCodec
);

888 
	`OPENCV_ASSERT
 (
îr
 =
noEº
, "icvDataProc_QT_Cam", "couldnt begin decompression sequence");

889 
	`Di•o£H™dÀ
 ((
H™dÀ
Ë
des¸ùti⁄
);

893 
îr
 = 
	`Decom¥essSequí˚FømeS
 (
ˇ±uª
->
£quí˚
, 
øw_d©a
, 
Àn
, 0, &
ign‹e
, 
nû
);

894 i‡(
îr
 !
noEº
)

896 
	`Ârötf
 (
°dîr
, "icvD©aProc_QT_Cam: couldn'àdecom¥es†‰amê- %d\n", (Ë
îr
);

897  
îr
;

907 
ˇ±uª
->
gŸ_‰ame
 = 
åue
;

908  
noEº
;

909 
	}
}

912 
	$icvO≥nCamîa_QT
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, c⁄° 
ödex
)

914 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvOpenCamera_QT", "'capture' isá NULL-pointer");

915 
	`OPENCV_ASSERT
 (
ödex
 >= 0, "icvOpenCamera_QT", "camera index isÇegative");

917 
PixM≠H™dÀ
 
pixm≠
 = 
nû
;

918 
OSEº
 
ªsu…
 = 
noEº
;

921 
ˇ±uª
->
gøbbî
 = 
	`O≥nDeÁu…Comp⁄ít
 (
SeqGøbComp⁄ítTy≥
, 0);

922 
	`OPENCV_ASSERT
 (
ˇ±uª
->
gøbbî
, "icvOpenCamera_QT", "couldnt create image");

925 
ªsu…
 = 
	`SGInôülize
 (
ˇ±uª
->
gøbbî
);

926 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt initialize sequence grabber");

927 
ªsu…
 = 
	`SGSëD©aRef
 (
ˇ±uª
->
gøbbî
, 0, 0, 
£qGøbD⁄tMakeMovõ
);

928 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set dataÑeference of sequence grabber");

931 
ªsu…
 = 
	`SGNewCh™√l
 (
ˇ±uª
->
gøbbî
, 
VideoMedüTy≥
, & (ˇ±uª->
ch™√l
));

932 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt createÇew video channel");

935 
SGDevi˚Li°
 
devi˚_li°
 = 0;

936 
ªsu…
 = 
	`SGGëCh™√lDevi˚Li°
 (
ˇ±uª
->
ch™√l
, 0, & 
devi˚_li°
);

937 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt get channel deviceÜist");

938 
i
 = 0, 
cuºít_ödex
 = 1; i < (*
devi˚_li°
)->
cou¡
; i++)

940 
SGDevi˚Name
 
devi˚
 = (*
devi˚_li°
)->
íåy
[
i
];

941 i‡(
devi˚
.
Êags
 == 0)

943 i‡(
cuºít_ödex
 =
ödex
)

945 
ªsu…
 = 
	`SGSëCh™√lDevi˚
 (
ˇ±uª
->
ch™√l
, 
devi˚
.
«me
);

946 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt setÅhe channel video device");

949 
cuºít_ödex
++;

952 
ªsu…
 = 
	`SGDi•o£Devi˚Li°
 (
ˇ±uª
->
gøbbî
, 
devi˚_li°
);

953 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt disposeÅhe channel deviceÜist");

958 
ªsu…
 = 
	`SGGëSrcVideoBounds
 (
ˇ±uª
->
ch™√l
, & (ˇ±uª->
bounds
));

959 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set video channel bounds");

962 
ªsu…
 = 
	`QTNewGW‹ld
 (& (
ˇ±uª
->
gw‹ld
), 
k32ARGBPixñF‹m©
, & (ˇ±uª->
bounds
), 0, 0, 0);

963 
ªsu…
 = 
	`SGSëGW‹ld
 (
ˇ±uª
->
gøbbî
, c≠tuª->
gw‹ld
, 0);

964 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set GWorld for sequence grabber");

965 
ªsu…
 = 
	`SGSëCh™√lBounds
 (
ˇ±uª
->
ch™√l
, & (ˇ±uª->
bounds
));

966 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set video channel bounds");

967 
ªsu…
 = 
	`SGSëCh™√lUßge
 (
ˇ±uª
->
ch™√l
, 
£qGøbRec‹d
);

968 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set channel usage");

971 
ªsu…
 = 
	`SGSèπRec‹d
 (
ˇ±uª
->
gøbbî
);

972 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt startÑecording");

975 
ImageDes¸ùti⁄H™dÀ
 
imageDesc
 = (ImageDes¸ùti⁄H™dÀ)
	`NewH™dÀ
(0);

976 
ªsu…
 = 
	`SGGëCh™√lSam∂eDes¸ùti⁄
(
ˇ±uª
->
ch™√l
, (
H™dÀ
)
imageDesc
);

977 
	`OPENCV_ASSERT
–
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldn't get image size");

978 
ˇ±uª
->
bounds
.
right
 = (**
imageDesc
).
width
;

979 
ˇ±uª
->
bounds
.
bŸtom
 = (**
imageDesc
).
height
;

980 
	`Di•o£H™dÀ
 ((
H™dÀ
Ë
imageDesc
);

983 
ªsu…
 = 
	`SGSt›
 (
ˇ±uª
->
gøbbî
);

984 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icveClose_QT_Cam", "couldnt stopÑecording");

987 
GW‹ldPå
 
tmpgw‹ld
;

988 
ªsu…
 = 
	`QTNewGW‹ld
–&
tmpgw‹ld
, 
k32ARGBPixñF‹m©
, &(
ˇ±uª
->
bounds
), 0, 0, 0);

989 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt create offscreen GWorld");

990 
ªsu…
 = 
	`SGSëGW‹ld
–
ˇ±uª
->
gøbbî
, 
tmpgw‹ld
, 0);

991 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set GWorld for sequence grabber");

992 
	`Di•o£GW‹ld
–
ˇ±uª
->
gw‹ld
 );

993 
ˇ±uª
->
gw‹ld
 = 
tmpgw‹ld
;

995 
ªsu…
 = 
	`SGSëCh™√lBounds
 (
ˇ±uª
->
ch™√l
, & (ˇ±uª->
bounds
));

996 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set video channel bounds");

999 
ˇ±uª
->
size
 = 
	`cvSize
 (ˇ±uª->
bounds
.
right
 - c≠tuª->bounds.
À·
, c≠tuª->bounds.
bŸtom
 - c≠tuª->bounds.
t›
);

1005 
ˇ±uª
->
image_rgb
 = 
	`cvCª©eImageHódî
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 4);

1006 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_rgb
, "icvOpenCamera_QT", "couldnt create image header");

1007 
pixm≠
 = 
	`GëGW‹ldPixM≠
 (
ˇ±uª
->
gw‹ld
);

1008 
	`OPENCV_ASSERT
 (
pixm≠
, "icvOpenCamera_QT", "didn't get GWorld PixMap handle");

1009 
	`LockPixñs
 (
pixm≠
);

1010 
	`cvSëD©a
 (
ˇ±uª
->
image_rgb
, 
	`GëPixBa£Addr
 (
pixm≠
Ë+ 1, 
	`GëPixRowByãs
 (pixmap));

1013 
ˇ±uª
->
image_bgr
 = 
	`cvCª©eImage
 (ˇ±uª->
size
, 
IPL_DEPTH_8U
, 3);

1014 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_bgr
, "icvOpenCamera_QT", "couldnt create image");

1018 
ªsu…
 = 
	`SGSëD©aProc
 (
ˇ±uª
->
gøbbî
, 
	`NewSGD©aUPP
 (
icvD©aProc_QT_Cam
), () capture);

1019 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt set dataÖroc");

1022 
ªsu…
 = 
	`SGSèπRec‹d
 (
ˇ±uª
->
gøbbî
);

1023 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icvOpenCamera_QT", "couldnt startÑecording");

1026 
	}
}

1029 
	$icvClo£_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
)

1031 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvClose_QT_Cam", "'capture' isá NULL-pointer");

1033 
OSEº
 
ªsu…
 = 
noEº
;

1037 
ªsu…
 = 
	`SGSt›
 (
ˇ±uª
->
gøbbî
);

1038 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icveClose_QT_Cam", "couldnt stopÑecording");

1041 
ªsu…
 = 
	`Clo£Comp⁄ít
 (
ˇ±uª
->
gøbbî
);

1042 
	`OPENCV_ASSERT
 (
ªsu…
 =
noEº
, "icveClose_QT_Cam", "couldnt close sequence grabber component");

1045 
	`CDSequí˚End
 (
ˇ±uª
->
£quí˚
);

1048 
	`cvRñó£Image
 (& 
ˇ±uª
->
image_bgr
);

1049 
	`cvRñó£ImageHódî
 (& 
ˇ±uª
->
image_rgb
);

1050 
	`Di•o£GW‹ld
 (
ˇ±uª
->
gw‹ld
);

1054 
	}
}

1056 
	$icvGøbFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
)

1058 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvGrabFrame_QT_Cam", "'capture' isá NULL-pointer");

1059 
	`OPENCV_ASSERT
 (
ˇ±uª
->
gøbbî
, "icvGrabFrame_QT_Cam", "'grabber' isá NULL-pointer");

1061 
Comp⁄ítResu…
 
ªsu…
 = 
noEº
;

1065 
ªsu…
 = 
	`SGIdÀ
 (
ˇ±uª
->
gøbbî
);

1066 i‡(
ªsu…
 !
noEº
)

1068 
	`Ârötf
 (
°dîr
, "SGIdÀ faûed i¿icvGøbFøme_QT_Cam wôhÉº‹ %d\n", (Ë
ªsu…
);

1074 
	}
}

1076 c⁄° * 
	$icvRërõveFøme_QT_Cam
 (
CvC≠tuª_QT_Cam
 * 
ˇ±uª
, )

1078 
	`OPENCV_ASSERT
 (
ˇ±uª
, "icvRetrieveFrame_QT_Cam", "'capture' isá NULL-pointer");

1079 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_rgb
, "icvRetrieveFrame_QT_Cam", "invalid source image");

1080 
	`OPENCV_ASSERT
 (
ˇ±uª
->
image_bgr
, "icvRetrieveFrame_QT_Cam", "invalid destination image");

1082 
OSEº
 
myEº
 = 
noEº
;

1086 ! 
ˇ±uª
->
gŸ_‰ame
)

1088 
myEº
 = 
	`SGIdÀ
 (
ˇ±uª
->
gøbbî
);

1089 i‡(
myEº
 !
noEº
)

1091 
	`Ârötf
 (
°dîr
, "SGIdle() didn't succeed in icvRetrieveFrame_QT_Cam().\n");

1097 
	`cvCvtCﬁ‹
 (
ˇ±uª
->
image_rgb
, c≠tuª->
image_bgr
, 
CV_RGBA2BGR
);

1100 
ˇ±uª
->
gŸ_‰ame
 = 
Ál£
;

1103  
ˇ±uª
->
image_bgr
;

1104 
	}
}

1109 
	sCvVideoWrôî_QT
 {

1111 
D©aH™dÀr
 
	md©a_h™dÀr
;

1112 
Movõ
 
	mmovõ
;

1113 
Tøck
 
	måack
;

1114 
Medü
 
	mvideo
;

1116 
ICMCom¥essi⁄Sessi⁄Ref
 
	mcom¥essi⁄_£ssi⁄_ªf
;

1118 
TimeVÆue
 
	mduøti⁄_≥r_ßm∂e
;

1119 } 
	tCvVideoWrôî_QT
;

1122 
TimeSˇÀ
 c⁄° 
	gTIME_SCALE
 = 600;

1124 
OSSètus
 
icvEncodedFømeOuçutCÆlback
(

1125 * 
wrôî
,

1126 
ICMCom¥essi⁄Sessi⁄Ref
 
com¥essi⁄_£ssi⁄_ªf
,

1127 
OSSètus
 
îr‹
,

1128 
ICMEncodedFømeRef
 
ícoded_‰ame_ªf
,

1129 * 
ª£rved


1132 
icvSour˚TøckögCÆlback
(

1133 *
sour˚_åackög_ªf_c⁄
,

1134 
ICMSour˚TøckögFœgs
 
sour˚_åackög_Êags
,

1135 *
sour˚_‰ame_ªf_c⁄
,

1136 *
ª£rved


1139 
	$icvWrôeFøme_QT
(

1140 
CvVideoWrôî_QT
 * 
video_wrôî
,

1141 c⁄° 
I∂Image
 * 
image


1143 
CVPixñBuf„rRef
 
pixñ_buf„r_ªf
 = 
NULL
;

1144 
CVRëu∫
 
ªtvÆ
 =

1145 
	`CVPixñBuf„rCª©e
(

1146 
kCFAŒoˇt‹DeÁu…
,

1147 
image
->
width
, image->
height
, 
k24RGBPixñF‹m©
,

1148 
NULL
 ,

1149 &
pixñ_buf„r_ªf


1153 
I∂Image
* 
image_rgb
 =

1154 
	`cvCª©eImageHódî
(

1155 
	`cvSize
–
image
->
width
, image->
height
 ),

1156 
IPL_DEPTH_8U
,

1160 
ªtvÆ
 = 
	`CVPixñBuf„rLockBa£Addªss
–
pixñ_buf„r_ªf
, 0 );

1162 * 
ba£_addªss
 = 
	`CVPixñBuf„rGëBa£Addªss
–
pixñ_buf„r_ªf
 );

1163 
size_t
 
byãs_≥r_row
 = 
	`CVPixñBuf„rGëByãsPîRow
–
pixñ_buf„r_ªf
 );

1164 
	`cvSëD©a
–
image_rgb
, 
ba£_addªss
, 
byãs_≥r_row
 );

1166 
	`cvC⁄vîtImage
–
image
, 
image_rgb
, 
CV_CVTIMG_SWAP_RB
 );

1168 
ªtvÆ
 = 
	`CVPixñBuf„rU∆ockBa£Addªss
–
pixñ_buf„r_ªf
, 0 );

1170 
	`cvRñó£ImageHódî
–&
image_rgb
 );

1172 
ICMSour˚TøckögCÆlbackRec‹d
 
sour˚_åackög_ˇŒback_ªc‹d
;

1173 
sour˚_åackög_ˇŒback_ªc‹d
.
sour˚TøckögCÆlback
 =

1174 
icvSour˚TøckögCÆlback
;

1175 
sour˚_åackög_ˇŒback_ªc‹d
.
sour˚TøckögRefC⁄
 = 
NULL
;

1177 
OSSètus
 
°©us
 =

1178 
	`ICMCom¥essi⁄Sessi⁄EncodeFøme
(

1179 
video_wrôî
->
com¥essi⁄_£ssi⁄_ªf
,

1180 
pixñ_buf„r_ªf
,

1182 
video_wrôî
->
duøti⁄_≥r_ßm∂e
,

1183 
kICMVÆidTime_Di•œyDuøti⁄IsVÆid
,

1184 
NULL
,

1185 &
sour˚_åackög_ˇŒback_ªc‹d
,

1186 
°©ic_ˇ°
<*>–&
pixñ_buf„r_ªf
 )

1190 
	}
}

1192 
	$icvRñó£VideoWrôî_QT
–
CvVideoWrôî_QT
 ** 
wrôî
 ) {

1193 i‡––
wrôî
 !
NULL
 ) && ( *writer != NULL ) ) {

1194 
CvVideoWrôî_QT
* 
video_wrôî
 = *
wrôî
;

1198 
	`ICMCom¥essi⁄Sessi⁄Com∂ëeFømes
(

1199 
video_wrôî
->
com¥essi⁄_£ssi⁄_ªf
, 1, 0, 0

1202 
	`EndMedüEdôs
–
video_wrôî
->
video
 );

1204 
	`ICMCom¥essi⁄Sessi⁄Rñó£
–
video_wrôî
->
com¥essi⁄_£ssi⁄_ªf
 );

1206 
	`In£πMedüI¡oTøck
(

1207 
video_wrôî
->
åack
,

1210 
	`GëMedüDuøti⁄
–
video_wrôî
->
video
 ),

1211 
	`FixR©io
( 1, 1 )

1214 
	`Upd©eMovõInSt‹age
–
video_wrôî
->
movõ
, video_wrôî->
d©a_h™dÀr
 );

1216 
	`Clo£MovõSt‹age
–
video_wrôî
->
d©a_h™dÀr
 );

1233 
	`Di•o£Movõ
–
video_wrôî
->
movõ
 );

1235 
	`cvFªe
–
wrôî
 );

1237 
	}
}

1239 
OSSètus
 
	$icvEncodedFømeOuçutCÆlback
(

1240 * 
wrôî
,

1241 
ICMCom¥essi⁄Sessi⁄Ref
 
com¥essi⁄_£ssi⁄_ªf
,

1242 
OSSètus
 
îr‹
,

1243 
ICMEncodedFømeRef
 
ícoded_‰ame_ªf
,

1244 * 
ª£rved


1246 
CvVideoWrôî_QT
* 
video_wrôî
 = 
°©ic_ˇ°
<CvVideoWrôî_QT*>–
wrôî
 );

1248 
OSSètus
 
îr
 = 
	`AddMedüSam∂eFromEncodedFøme
–
video_wrôî
->
video
,

1249 
ícoded_‰ame_ªf
, 
NULL
 );

1251  
îr
;

1252 
	}
}

1254 
	$icvSour˚TøckögCÆlback
(

1255 *
sour˚_åackög_ªf_c⁄
,

1256 
ICMSour˚TøckögFœgs
 
sour˚_åackög_Êags
,

1257 *
sour˚_‰ame_ªf_c⁄
,

1258 *
ª£rved


1260 i‡–
sour˚_åackög_Êags
 & 
kICMSour˚Tøckög_Rñó£dPixñBuf„r
 ) {

1261 
	`CVPixñBuf„rRñó£
(

1262 *
°©ic_ˇ°
<
CVPixñBuf„rRef
*>–
sour˚_‰ame_ªf_c⁄
 )

1265 
	}
}

1268 
CvVideoWrôî_QT
* 
	$icvCª©eVideoWrôî_QT
(

1269 c⁄° * 
fûíame
,

1270 
fourcc
,

1271 
Âs
,

1272 
CvSize
 
‰ame_size
,

1273 
is_cﬁ‹


1275 
	`CV_FUNCNAME
( "icvCreateVideoWriter" );

1277 
CvVideoWrôî_QT
* 
video_wrôî
 =

1278 
°©ic_ˇ°
<
CvVideoWrôî_QT
*>–
	`cvAŒoc
( ( CvVideoWriter_QT ) ) );

1279 
	`mem£t
–
video_wrôî
, 0, –
CvVideoWrôî_QT
 ) );

1281 
H™dÀ
 
d©a_ªf
 = 
NULL
;

1282 
OSTy≥
 
d©a_ªf_ty≥
;

1283 
D©aH™dÀr
 
d©a_h™dÀr
 = 
NULL
;

1284 
Movõ
 
movõ
 = 
NULL
;

1285 
ICMCom¥essi⁄Sessi⁄O±i⁄sRef
 
›ti⁄s_ªf
 = 
NULL
;

1286 
ICMCom¥essi⁄Sessi⁄Ref
 
com¥essi⁄_£ssi⁄_ªf
 = 
NULL
;

1287 
CFSåögRef
 
out_∑th
 = 
nû
;

1288 
Tøck
 
video_åack
 = 
nû
;

1289 
Medü
 
video
 = 
nû
;

1290 
OSEº
 
îr
 = 
noEº
;

1291 
CodecTy≥
 
codecTy≥
 = 
kRawCodecTy≥
;

1293 
__BEGIN__


1296 i‡–
fûíame
 =
NULL
 ) {

1297 
	`CV_ERROR
–
CV_StsBadArg
, "Video fileÇame mustÇot be NULL" );

1299 i‡–
Âs
 <= 0.0 ) {

1300 
	`CV_ERROR
–
CV_StsBadArg
, "FPS must beÜargerÅhan 0.0" );

1302 i‡––
‰ame_size
.
width
 <0 ) || ( føme_size.
height
 <= 0 ) ) {

1303 
	`CV_ERROR
–
CV_StsBadArg
,

1308 i‡–!
did_íãr_movõs
 ) {

1309 
îr
 = 
	`E¡îMovõs
();

1310 i‡–
îr
 !
noEº
 ) {

1311 
	`CV_ERROR
–
CV_StsI¡î«l
, "UnableÅo initialize QuickTime" );

1313 
did_íãr_movõs
 = 1;

1317 
out_∑th
 = 
	`CFSåögCª©eWôhCSåög
–
kCFAŒoˇt‹DeÁu…
, 
fûíame
, 
kCFSåögEncodögISOL©ö1
 );

1318 
	`CV_ASSERT
–
out_∑th
 !
nû
 );

1319 
îr
 = 
	`QTNewD©aRe„ªn˚FromFuŒP©hCFSåög
–
out_∑th
, 
kQTPOSIXP©hStyÀ
,

1320 0, &
d©a_ªf
, &
d©a_ªf_ty≥
 );

1321 
	`CFRñó£
–
out_∑th
 );

1322 i‡–
îr
 !
noEº
 ) {

1323 
	`CV_ERROR
–
CV_StsI¡î«l
,

1328 
îr
 = 
	`Cª©eMovõSt‹age
–
d©a_ªf
, 
d©a_ªf_ty≥
, 'TVOD',

1329 
smCuºítS¸ùt
, 
√wMovõA˘ive
, &
d©a_h™dÀr
, &
movõ
 );

1331 i‡–
îr
 !
noEº
 ) {

1332 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot create movie storage" );

1336 
video_åack
 = 
	`NewMovõTøck
 (
movõ
,

1337 
	`FixR©io
–
‰ame_size
.
width
, 1 ),

1338 
	`FixR©io
–
‰ame_size
.
height
, 1 ),

1339 
kNoVﬁume
);

1340 
îr
 = 
	`GëMovõsEº‹
();

1341 i‡–
îr
 !
noEº
 ) {

1342 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot create videoÅrack" );

1344 
video
 = 
	`NewTøckMedü
–
video_åack
, 
VideoMedüTy≥
, 
TIME_SCALE
, 
nû
, 0 );

1345 
îr
 = 
	`GëMovõsEº‹
();

1346 i‡–
îr
 !
noEº
 ) {

1347 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot create video media" );

1354 
îr
 = 
	`ICMCom¥essi⁄Sessi⁄O±i⁄sCª©e
–
kCFAŒoˇt‹DeÁu…
,

1355 &
›ti⁄s_ªf
 );

1356 i‡–
îr
 !
noEº
 ) {

1357 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot create compression session options" );

1359 
îr
 = 
	`ICMCom¥essi⁄Sessi⁄O±i⁄sSëAŒowTemp‹ÆCom¥essi⁄
–
›ti⁄s_ªf
,

1360 
åue
 );

1361 i‡–
îr
 !
noEº
) {

1362 
	`CV_ERROR
–
CV_StsI¡î«l
, "CannotÉnableÅemporal compression" );

1364 
îr
 = 
	`ICMCom¥essi⁄Sessi⁄O±i⁄sSëAŒowFømeRe‹dîög
–
›ti⁄s_ªf
,

1365 
åue
 );

1366 i‡–
îr
 !
noEº
) {

1367 
	`CV_ERROR
–
CV_StsI¡î«l
, "CannotÉnable frameÑeordering" );

1370 
ICMEncodedFømeOuçutRec‹d
 
ícoded_‰ame_ouçut_ªc‹d
;

1371 
ícoded_‰ame_ouçut_ªc‹d
.
ícodedFømeOuçutCÆlback
 =

1372 
icvEncodedFømeOuçutCÆlback
;

1373 
ícoded_‰ame_ouçut_ªc‹d
.
ícodedFømeOuçutRefC⁄
 =

1374 
°©ic_ˇ°
<*>–
video_wrôî
 );

1375 
ícoded_‰ame_ouçut_ªc‹d
.
‰ameD©aAŒoˇt‹
 = 
NULL
;

1377 
îr
 = 
	`ICMCom¥essi⁄Sessi⁄Cª©e
–
kCFAŒoˇt‹DeÁu…
, 
‰ame_size
.
width
,

1378 
‰ame_size
.
height
, 
codecTy≥
, 
TIME_SCALE
, 
›ti⁄s_ªf
,

1379 
NULL
 , &
ícoded_‰ame_ouçut_ªc‹d
,

1380 &
com¥essi⁄_£ssi⁄_ªf
 );

1381 
	`ICMCom¥essi⁄Sessi⁄O±i⁄sRñó£
–
›ti⁄s_ªf
 );

1382 i‡–
îr
 !
noEº
 ) {

1383 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot create compression session" );

1386 
îr
 = 
	`BegöMedüEdôs
–
video
 );

1387 i‡–
îr
 !
noEº
 ) {

1388 
	`CV_ERROR
–
CV_StsI¡î«l
, "Cannot begin mediaÉdits" );

1392 
video_wrôî
->
d©a_h™dÀr
 = data_handler;

1393 
video_wrôî
->
movõ
 = movie;

1394 
video_wrôî
->
åack
 = 
video_åack
;

1395 
video_wrôî
->
video
 = video;

1396 
video_wrôî
->
com¥essi⁄_£ssi⁄_ªf
 = compression_session_ref;

1397 
video_wrôî
->
duøti⁄_≥r_ßm∂e
 =

1398 
°©ic_ˇ°
<
TimeVÆue
>–°©ic_ˇ°<>–
TIME_SCALE
 ) / 
Âs
 );

1400 
__END__


1404 i‡–
îr
 !
noEº
 ) {

1405 i‡–
›ti⁄s_ªf
 !
NULL
 ) {

1406 
	`ICMCom¥essi⁄Sessi⁄O±i⁄sRñó£
–
›ti⁄s_ªf
 );

1408 i‡–
com¥essi⁄_£ssi⁄_ªf
 !
NULL
 ) {

1409 
	`ICMCom¥essi⁄Sessi⁄Rñó£
–
com¥essi⁄_£ssi⁄_ªf
 );

1411 i‡–
d©a_h™dÀr
 !
NULL
 ) {

1412 
	`Clo£MovõSt‹age
–
d©a_h™dÀr
 );

1414 i‡–
movõ
 !
NULL
 ) {

1415 
	`Di•o£Movõ
–
movõ
 );

1417 i‡–
d©a_ªf
 !
NULL
 ) {

1418 
	`DñëeMovõSt‹age
–
d©a_ªf
, 
d©a_ªf_ty≥
 );

1419 
	`Di•o£H™dÀ
–
d©a_ªf
 );

1421 
	`cvFªe
–
ªöãΩªt_ˇ°
<**>–&
video_wrôî
 ) );

1422 
video_wrôî
 = 
NULL
;

1425  
video_wrôî
;

1426 
	}
}

1435 ˛as†
	cCvC≠tuª_QT_Movõ_CPP
 : 
public
 
CvC≠tuª


1437 
public
:

1438 
	$CvC≠tuª_QT_Movõ_CPP
(Ë{ 
ˇ±uªQT
 = 0; }

1439 
vútuÆ
 ~
	$CvC≠tuª_QT_Movõ_CPP
(Ë{ 
	`˛o£
(); 
	}
}

1441 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
 );

1442 
vútuÆ
 
˛o£
();

1444 
vútuÆ
 
	$gëPr›îty
() const;

1445 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

1446 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

1447 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

1448 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_QT
; 
	}
}

1449 
	g¥Ÿe˘ed
:

1451 
CvC≠tuª_QT_Movõ
* 
ˇ±uªQT
;

1454 
boﬁ
 
	gCvC≠tuª_QT_Movõ_CPP
::
	$›í
–c⁄° * 
fûíame
 )

1456 
	`˛o£
();

1457 
ˇ±uªQT
 = 
	`icvC≠tuªFromFûe_QT
–
fûíame
 );

1458  
ˇ±uªQT
 != 0;

1459 
	}
}

1461 
	gCvC≠tuª_QT_Movõ_CPP
::
	$˛o£
()

1463 if–
ˇ±uªQT
 )

1465 
	`icvClo£_QT_Movõ
–
ˇ±uªQT
 );

1466 
	`cvFªe
–&
ˇ±uªQT
 );

1468 
	}
}

1470 
boﬁ
 
	gCvC≠tuª_QT_Movõ_CPP
::
	$gøbFøme
()

1472  
ˇ±uªQT
 ? 
	`icvGøbFøme_QT_Movõ
–ˇ±uªQT ) !0 : 
Ál£
;

1473 
	}
}

1475 
I∂Image
* 
	gCvC≠tuª_QT_Movõ_CPP
::
	$ªåõveFøme
()

1477  
ˇ±uªQT
 ? (
I∂Image
*)
	`icvRërõveFøme_QT_Movõ
( captureQT, 0 ) : 0;

1478 
	}
}

1480 
	gCvC≠tuª_QT_Movõ_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

1482  
ˇ±uªQT
 ? 
	`icvGëPr›îty_QT_Movõ
–ˇ±uªQT, 
¥›Id
 ) : 0;

1483 
	}
}

1485 
boﬁ
 
	gCvC≠tuª_QT_Movõ_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

1487  
ˇ±uªQT
 ? 
	`icvSëPr›îty_QT_Movõ
–ˇ±uªQT, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

1488 
	}
}

1490 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_QT
–c⁄° * 
fûíame
 )

1492 
CvC≠tuª_QT_Movõ_CPP
* 
ˇ±uª
 = 
√w
 CvCapture_QT_Movie_CPP;

1494 if–
ˇ±uª
->
	`›í
–
fûíame
 ))

1495  
ˇ±uª
;

1497 
dñëe
 
ˇ±uª
;

1499 
	}
}

1504 ˛as†
	cCvC≠tuª_QT_Cam_CPP
 : 
public
 
CvC≠tuª


1506 
public
:

1507 
	$CvC≠tuª_QT_Cam_CPP
(Ë{ 
ˇ±uªQT
 = 0; }

1508 
vútuÆ
 ~
	$CvC≠tuª_QT_Cam_CPP
(Ë{ 
	`˛o£
(); 
	}
}

1510 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

1511 
vútuÆ
 
˛o£
();

1513 
vútuÆ
 
	$gëPr›îty
() const;

1514 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

1515 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

1516 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

1517 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_QT
; 
	}
}

1518 
	g¥Ÿe˘ed
:

1520 
CvC≠tuª_QT_Cam
* 
ˇ±uªQT
;

1523 
boﬁ
 
	gCvC≠tuª_QT_Cam_CPP
::
	$›í
–
ödex
 )

1525 
	`˛o£
();

1526 
ˇ±uªQT
 = 
	`icvC≠tuªFromCam_QT
–
ödex
 );

1527  
ˇ±uªQT
 != 0;

1528 
	}
}

1530 
	gCvC≠tuª_QT_Cam_CPP
::
	$˛o£
()

1532 if–
ˇ±uªQT
 )

1534 
	`icvClo£_QT_Cam
–
ˇ±uªQT
 );

1535 
	`cvFªe
–&
ˇ±uªQT
 );

1537 
	}
}

1539 
boﬁ
 
	gCvC≠tuª_QT_Cam_CPP
::
	$gøbFøme
()

1541  
ˇ±uªQT
 ? 
	`icvGøbFøme_QT_Cam
–ˇ±uªQT ) !0 : 
Ál£
;

1542 
	}
}

1544 
I∂Image
* 
	gCvC≠tuª_QT_Cam_CPP
::
	$ªåõveFøme
()

1546  
ˇ±uªQT
 ? (
I∂Image
*)
	`icvRërõveFøme_QT_Cam
( captureQT, 0 ) : 0;

1547 
	}
}

1549 
	gCvC≠tuª_QT_Cam_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

1551  
ˇ±uªQT
 ? 
	`icvGëPr›îty_QT_Cam
–ˇ±uªQT, 
¥›Id
 ) : 0;

1552 
	}
}

1554 
boﬁ
 
	gCvC≠tuª_QT_Cam_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

1556  
ˇ±uªQT
 ? 
	`icvSëPr›îty_QT_Cam
–ˇ±uªQT, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

1557 
	}
}

1559 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_QT
–
ödex
 )

1561 
CvC≠tuª_QT_Cam_CPP
* 
ˇ±uª
 = 
√w
 CvCapture_QT_Cam_CPP;

1563 if–
ˇ±uª
->
	`›í
–
ödex
 ))

1564  
ˇ±uª
;

1566 
dñëe
 
ˇ±uª
;

1568 
	}
}

1572 ˛as†
	cCvVideoWrôî_QT_CPP
 : 
public
 
CvVideoWrôî


1574 
public
:

1575 
	$CvVideoWrôî_QT_CPP
(Ë{ 
wrôîQT
 = 0; }

1576 
vútuÆ
 ~
	$CvVideoWrôî_QT_CPP
(Ë{ 
	`˛o£
(); 
	}
}

1578 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
, 
fourcc
,

1579 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 );

1580 
vútuÆ
 
˛o£
();

1581 
vútuÆ
 
boﬁ
 
wrôeFøme
–c⁄° 
I∂Image
* );

1583 
	g¥Ÿe˘ed
:

1584 
CvVideoWrôî_QT
* 
wrôîQT
;

1587 
boﬁ
 
	gCvVideoWrôî_QT_CPP
::
	$›í
–c⁄° * 
fûíame
, 
fourcc
,

1588 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 )

1590 
	`˛o£
();

1591 
wrôîQT
 = 
	`icvCª©eVideoWrôî_QT
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
 );

1592  
wrôîQT
 != 0;

1593 
	}
}

1595 
	gCvVideoWrôî_QT_CPP
::
	$˛o£
()

1597 if–
wrôîQT
 )

1599 
	`icvRñó£VideoWrôî_QT
–&
wrôîQT
 );

1600 
wrôîQT
 = 0;

1602 
	}
}

1604 
boﬁ
 
	gCvVideoWrôî_QT_CPP
::
	$wrôeFøme
–c⁄° 
I∂Image
* 
image
 )

1606 if–!
wrôîQT
 || !
image
 )

1607  
Ál£
;

1608  
	`icvWrôeFøme_QT
–
wrôîQT
, 
image
 ) >= 0;

1609 
	}
}

1611 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_QT
–c⁄° * 
fûíame
, 
fourcc
,

1612 
Âs
, 
CvSize
 
‰ameSize
, 
isCﬁ‹
 )

1614 
CvVideoWrôî_QT_CPP
* 
wrôî
 = 
√w
 CvVideoWriter_QT_CPP;

1615 if–
wrôî
->
	`›í
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
 != 0 ))

1616  
wrôî
;

1617 
dñëe
 
wrôî
;

1619 
	}
}

	@src/cap_unicap.cpp

44 
	~"¥ecomp.hµ
"

45 
	~<uni°d.h
>

46 
	~<uniˇp.h
>

48 
	~<ucû.h
>

51 #ifde‡
NDEBUG


52 
	#CV_WARN
(
mesßge
)

	)

54 
	#CV_WARN
(
mesßge
Ë
	`Ârötf
(
°dîr
, "w¨nög: %†(%s:%d)\n", mesßge, 
__FILE__
, 
__LINE__
)

	)

57 
CvC≠tuª_Uniˇp
 : 
public
 
CvC≠tuª


59 
CvC≠tuª_Uniˇp
(Ë{ 
öô
(); }

60 
vútuÆ
 ~
CvC≠tuª_Uniˇp
(Ë{ 
˛o£
(); }

62 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

63 
vútuÆ
 
˛o£
();

65 
vútuÆ
 
gëPr›îty
() const;

66 
vútuÆ
 
boﬁ
 
£tPr›îty
(, );

67 
vútuÆ
 
boﬁ
 
gøbFøme
();

68 
vútuÆ
 
I∂Image
* 
ªåõveFøme
();

69 
vútuÆ
 
gëC≠tuªDomaö
(Ë{  
CV_CAP_UNICAP
; }

71 
boﬁ
 
shutdownDevi˚
();

72 
boﬁ
 
öôDevi˚
();

74 
öô
()

76 
devi˚_öôülized
 = 
Ál£
;

77 
desúed_f‹m©
 = 0;

78 
desúed_size
 = 
cvSize
(0,0);

79 
c⁄vît_rgb
 = 
Ál£
;

81 
h™dÀ
 = 0;

82 
mem£t
–&
devi˚
, 0, (device) );

83 
mem£t
–&
f‹m©_•ec
, 0, (format_spec) );

84 
mem£t
–&
f‹m©
, 0, (format) );

85 
mem£t
–&
øw_buf„r
, 0, (raw_buffer) );

86 
mem£t
–&
buf„r
, 0, (buffer) );

88 
øw_‰ame
 = 
‰ame
 = 0;

91 
boﬁ
 
devi˚_öôülized
;

93 
desúed_devi˚
;

94 
desúed_f‹m©
;

95 
CvSize
 
desúed_size
;

96 
boﬁ
 
c⁄vît_rgb
;

98 
uniˇp_h™dÀ_t
 
h™dÀ
;

99 
uniˇp_devi˚_t
 
devi˚
;

100 
uniˇp_f‹m©_t
 
f‹m©_•ec
;

101 
uniˇp_f‹m©_t
 
f‹m©
;

102 
uniˇp_d©a_buf„r_t
 
øw_buf„r
;

103 
uniˇp_d©a_buf„r_t
 
buf„r
;

105 
I∂Image
 *
øw_‰ame
;

106 
I∂Image
 *
‰ame
;

109 
boﬁ
 
	gCvC≠tuª_Uniˇp
::
	$shutdownDevi˚
() {

110 
boﬁ
 
ªsu…
 = 
Ál£
;

111 
	`CV_FUNCNAME
("CvCapture_Unicap::shutdownDevice");

112 
__BEGIN__
;

114 i‡(!
	`SUCCESS
(
	`uniˇp_°›_ˇ±uª
(
h™dÀ
)))

115 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo stop capture on device\n");

117 i‡(!
	`SUCCESS
(
	`uniˇp_˛o£
(
h™dÀ
)))

118 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo closeÅhe device\n");

120 
	`cvRñó£Image
(&
øw_‰ame
);

121 
	`cvRñó£Image
(&
‰ame
);

123 
devi˚_öôülized
 = 
Ál£
;

125 
ªsu…
 = 
åue
;

126 
__END__
;

127  
ªsu…
;

128 
	}
}

130 
boﬁ
 
	gCvC≠tuª_Uniˇp
::
	$öôDevi˚
() {

131 
boﬁ
 
ªsu…
 = 
Ál£
;

132 
	`CV_FUNCNAME
("CvCapture_Unicap::initDevice");

133 
__BEGIN__
;

135 i‡(
devi˚_öôülized
 && !
	`shutdownDevi˚
())

136  
Ál£
;

138 if(!
	`SUCCESS
(
	`uniˇp_íumî©e_devi˚s
(
NULL
, &
devi˚
, 
desúed_devi˚
)))

139 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo get info for device\n");

141 if(!
	`SUCCESS
(
	`uniˇp_›í
–&
h™dÀ
, &
devi˚
)))

142 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo open device\n");

144 
	`uniˇp_void_f‹m©
(&
f‹m©_•ec
);

146 i‡(!
	`SUCCESS
(
	`uniˇp_íumî©e_f‹m©s
(
h™dÀ
, &
f‹m©_•ec
, &
f‹m©
, 
desúed_f‹m©
))) {

147 
	`shutdownDevi˚
();

148 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo get video format\n");

151 
i
;

152 i‡(
f‹m©
.
sizes
)

154 
i
 = 
f‹m©
.
size_cou¡
 - 1; i > 0; i--)

155 i‡(
f‹m©
.
sizes
[
i
].
width
 =
desúed_size
.width &&

156 
f‹m©
.
sizes
[
i
].
height
 =
desúed_size
.height)

158 
f‹m©
.
size
.
width
 = f‹m©.
sizes
[
i
].width;

159 
f‹m©
.
size
.
height
 = f‹m©.
sizes
[
i
].height;

162 i‡(!
	`SUCCESS
(
	`uniˇp_£t_f‹m©
(
h™dÀ
, &
f‹m©
))) {

163 
	`shutdownDevi˚
();

164 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo set video format\n");

167 
	`mem£t
(&
øw_buf„r
, 0x0, (
uniˇp_d©a_buf„r_t
));

168 
øw_‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(
f‹m©
.
size
.
width
,

169 
f‹m©
.
size
.
height
),

170 8, 
f‹m©
.
bµ
 / 8);

171 
	`mem˝y
(&
øw_buf„r
.
f‹m©
, &format, (raw_buffer.format));

172 
øw_buf„r
.
d©a
 = (*)
øw_‰ame
->
imageD©a
;

173 
øw_buf„r
.
buf„r_size
 = 
f‹m©
.
size
.
width
 *

174 
f‹m©
.
size
.
height
 * f‹m©.
bµ
 / 8;

176 
	`mem£t
(&
buf„r
, 0x0, (
uniˇp_d©a_buf„r_t
));

177 
	`mem˝y
(&
buf„r
.
f‹m©
, &format, (buffer.format));

179 
buf„r
.
f‹m©
.
fourcc
 = 
	`UCIL_FOURCC
('B','G','R','3');

180 
buf„r
.
f‹m©
.
bµ
 = 24;

185 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(
buf„r
.
f‹m©
.
size
.
width
,

186 
buf„r
.
f‹m©
.
size
.
height
),

187 8, 
buf„r
.
f‹m©
.
bµ
 / 8);

188 
buf„r
.
d©a
 = (*)
‰ame
->
imageD©a
;

189 
buf„r
.
buf„r_size
 = buf„r.
f‹m©
.
size
.
width
 *

190 
buf„r
.
f‹m©
.
size
.
height
 * buf„r.f‹m©.
bµ
 / 8;

192 if(!
	`SUCCESS
(
	`uniˇp_°¨t_ˇ±uª
(
h™dÀ
))) {

193 
	`shutdownDevi˚
();

194 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo start capture on device\n");

197 
devi˚_öôülized
 = 
åue
;

198 
ªsu…
 = 
åue
;

199 
__END__
;

200  
ªsu…
;

201 
	}
}

203 
	gCvC≠tuª_Uniˇp
::
	$˛o£
() {

204 if(
devi˚_öôülized
)

205 
	`shutdownDevi˚
();

206 
	}
}

208 
boﬁ
 
	gCvC≠tuª_Uniˇp
::
	$gøbFøme
() {

209 
boﬁ
 
ªsu…
 = 
Ál£
;

211 
	`CV_FUNCNAME
("CvCapture_Unicap::grabFrame");

212 
__BEGIN__
;

214 
uniˇp_d©a_buf„r_t
 *
ªtu∫ed_buf„r
;

216 
ªåy_cou¡
 = 100;

218 
ªåy_cou¡
--) {

219 if(!
	`SUCCESS
(
	`uniˇp_queue_buf„r
(
h™dÀ
, &
øw_buf„r
)))

220 
	`CV_ERROR
(
CV_StsEº‹
, "unicap: failedÅo queueá buffer on device\n");

222 if(
	`SUCCESS
(
	`uniˇp_waô_buf„r
(
h™dÀ
, &
ªtu∫ed_buf„r
)))

224 
ªsu…
 = 
åue
;

225 
EXIT
;

228 
	`CV_WARN
("unicap: failedÅo wait for buffer on device\n");

229 
	`u¶ìp
(100 * 1000);

232 
__END__
;

233  
ªsu…
;

234 
	}
}

236 
I∂Image
 * 
	gCvC≠tuª_Uniˇp
::
	$ªåõveFøme
() {

237 i‡(
c⁄vît_rgb
) {

238 
	`ucû_c⁄vît_buf„r
(&
buf„r
, &
øw_buf„r
);

239  
‰ame
;

241  
øw_‰ame
;

242 
	}
}

244 
	gCvC≠tuª_Uniˇp
::
	$gëPr›îty
(
id
) const

246 
id
) {

247 
CV_CAP_PROP_POS_MSEC
: ;

248 
CV_CAP_PROP_POS_FRAMES
: ;

249 
CV_CAP_PROP_POS_AVI_RATIO
: ;

250 
CV_CAP_PROP_FRAME_WIDTH
:

251  
desúed_size
.
width
;

252 
CV_CAP_PROP_FRAME_HEIGHT
:

253  
desúed_size
.
height
;

254 
CV_CAP_PROP_FPS
: ;

255 
CV_CAP_PROP_FOURCC
: ;

256 
CV_CAP_PROP_FRAME_COUNT
: ;

257 
CV_CAP_PROP_FORMAT
:

258  
desúed_f‹m©
;

259 
CV_CAP_PROP_MODE
: ;

260 
CV_CAP_PROP_BRIGHTNESS
: ;

261 
CV_CAP_PROP_CONTRAST
: ;

262 
CV_CAP_PROP_SATURATION
: ;

263 
CV_CAP_PROP_HUE
: ;

264 
CV_CAP_PROP_GAIN
: ;

265 
CV_CAP_PROP_CONVERT_RGB
:

266  
c⁄vît_rgb
;

270 
	}
}

272 
boﬁ
 
	gCvC≠tuª_Uniˇp
::
	$£tPr›îty
(
id
, 
vÆue
) {

273 
boﬁ
 
ªöô
 = 
Ál£
;

275 
id
) {

276 
CV_CAP_PROP_POS_MSEC
: ;

277 
CV_CAP_PROP_POS_FRAMES
: ;

278 
CV_CAP_PROP_POS_AVI_RATIO
: ;

279 
CV_CAP_PROP_FRAME_WIDTH
:

280 
desúed_size
.
width
 = ()
vÆue
;

281 
ªöô
 = 
åue
;

283 
CV_CAP_PROP_FRAME_HEIGHT
:

284 
desúed_size
.
height
 = ()
vÆue
;

285 
ªöô
 = 
åue
;

287 
CV_CAP_PROP_FPS
: ;

288 
CV_CAP_PROP_FOURCC
: ;

289 
CV_CAP_PROP_FRAME_COUNT
: ;

290 
CV_CAP_PROP_FORMAT
:

291 
desúed_f‹m©
 = 
id
;

292 
ªöô
 = 
åue
;

294 
CV_CAP_PROP_MODE
: ;

295 
CV_CAP_PROP_BRIGHTNESS
: ;

296 
CV_CAP_PROP_CONTRAST
: ;

297 
CV_CAP_PROP_SATURATION
: ;

298 
CV_CAP_PROP_HUE
: ;

299 
CV_CAP_PROP_GAIN
: ;

300 
CV_CAP_PROP_CONVERT_RGB
:

301 
c⁄vît_rgb
 = 
vÆue
 != 0;

305 i‡(
ªöô
 && !
	`öôDevi˚
())

306  
Ál£
;

308  
åue
;

309 
	}
}

311 
boﬁ
 
	gCvC≠tuª_Uniˇp
::
	$›í
(
ödex
)

313 
	`˛o£
();

314 
devi˚_öôülized
 = 
Ál£
;

316 
desúed_devi˚
 = 
ödex
 < 0 ? 0 : index;

317 
desúed_f‹m©
 = 0;

318 
desúed_size
 = 
	`cvSize
(320, 240);

319 
c⁄vît_rgb
 = 
åue
;

321  
	`öôDevi˚
();

322 
	}
}

325 
CvC≠tuª
 * 
	$cvCª©eCamîaC≠tuª_Uniˇp
(c⁄° 
ödex
)

327 
CvC≠tuª_Uniˇp
 *
ˇp
 = 
√w
 CvCapture_Unicap;

328 if–
ˇp
->
	`›í
(
ödex
) )

329  
ˇp
;

330 
dñëe
 
ˇp
;

332 
	}
}

	@src/cap_v4l.cpp

210 
	~"¥ecomp.hµ
"

212 #i‡!
deföed
 
WIN32
 && (deföed 
HAVE_CAMV4L
 || deföed 
HAVE_CAMV4L2
 || deföed 
HAVE_VIDEOIO
)

214 
	#CLEAR
(
x
Ë
	`mem£t
 (&(x), 0,  (x))

	)

216 
	~<°dio.h
>

217 
	~<uni°d.h
>

218 
	~<f˙é.h
>

219 
	~<î∫o.h
>

220 
	~<sys/io˘l.h
>

221 
	~<sys/ty≥s.h
>

222 
	~<sys/mm™.h
>

224 #ifde‡
HAVE_CAMV4L


225 
	~<löux/videodev.h
>

228 
	~<°rög.h
>

229 
	~<°dlib.h
>

230 
	~<as£π.h
>

231 
	~<sys/°©.h
>

232 
	~<sys/io˘l.h
>

234 #ifde‡
HAVE_CAMV4L2


235 
	~<asm/ty≥s.h
>

236 
	~<löux/videodev2.h
>

239 #ifde‡
HAVE_VIDEOIO


240 
	~<sys/videoio.h
>

241 
	#HAVE_CAMV4L2


	)

245 
	#DEFAULT_V4L_WIDTH
 640

	)

246 
	#DEFAULT_V4L_HEIGHT
 480

	)

248 
	#CHANNEL_NUMBER
 1

	)

249 
	#MAX_CAMERAS
 8

	)

253 
	#MAX_V4L_BUFFERS
 10

	)

254 
	#DEFAULT_V4L_BUFFERS
 4

	)

257 
	#V4L_ABORT_BADJPEG


	)

259 
	#MAX_DEVICE_DRIVER_NAME
 80

	)

263 #ifde‡
HAVE_CAMV4L2


266 
	sbuf„r


268 * 
	m°¨t
;

269 
size_t
 
	mÀngth
;

272 
	gn_buf„rs
 = 0;

275 #i‚de‡
V4L2_PIX_FMT_SBGGR8


276 
	#V4L2_PIX_FMT_SBGGR8
 
	`v4l2_fourcc
('B','A','8','1'Ë

	)

278 #i‚de‡
V4L2_PIX_FMT_SN9C10X


279 
	#V4L2_PIX_FMT_SN9C10X
 
	`v4l2_fourcc
('S','9','1','0'Ë

	)

282 #i‚de‡
V4L2_PIX_FMT_SGBRG


283 
	#V4L2_PIX_FMT_SGBRG
 
	`v4l2_fourcc
('G','B','R','G'Ë

	)

288 
	ePALETTE_TYPE
 {

289 
	mPALETTE_BGR24
 = 1,

290 
	mPALETTE_YVU420
,

291 
	mPALETTE_YUV411P
,

292 
	mPALETTE_YUYV
,

293 
	mPALETTE_UYVY
,

294 
	mPALETTE_SBGGR8
,

295 
	mPALETTE_SN9C10X
,

296 
	mPALETTE_MJPEG
,

297 
	mPALETTE_SGBRG
,

298 
	mPALETTE_RGB24


301 
	sCvC≠tuªCAM_V4L


303 
	mdevi˚H™dÀ
;

304 
	mbuf„rIndex
;

305 
	mFú°C≠tuª
;

306 #ifde‡
HAVE_CAMV4L


307 
video_ˇ∑bûôy
 
	mˇ∑bûôy
;

308 
video_wödow
 
	mˇ±uªWödow
;

309 
video_pi˘uª
 
	mimagePr›îtõs
;

310 
video_mbuf
 
	mmem‹yBuf„r
;

311 
video_mm≠
 *
	mmm≠s
;

313 *
	mmem‹yM≠
;

314 
I∂Image
 
	m‰ame
;

316 #ifde‡
HAVE_CAMV4L2


317 
PALETTE_TYPE
 
	m∑Àâe
;

319 
buf„r
 
	mbuf„rs
[
MAX_V4L_BUFFERS
 + 1];

320 
v4l2_ˇ∑bûôy
 
	mˇp
;

321 
v4l2_öput
 
	möp
;

322 
v4l2_f‹m©
 
	mf‹m
;

323 
v4l2_¸›
 
	m¸›
;

324 
v4l2_¸›ˇp
 
	m¸›ˇp
;

325 
v4l2_ªque°buf„rs
 
	mªq
;

326 
v4l2_c⁄åﬁ
 
	mc⁄åﬁ
;

327 
v4l2_buf_ty≥
 
	mty≥
;

328 
v4l2_quîy˘æ
 
	mquîy˘æ
;

330 
timevÆ
 
	mtime°amp
;

333 
	mv4l2_brighäess
, 
	mv4l2_brighäess_mö
, 
	mv4l2_brighäess_max
;

334 
	mv4l2_c⁄åa°
, 
	mv4l2_c⁄åa°_mö
, 
	mv4l2_c⁄åa°_max
;

335 
	mv4l2_ßtuøti⁄
, 
	mv4l2_ßtuøti⁄_mö
, 
	mv4l2_ßtuøti⁄_max
;

336 
	mv4l2_hue
, 
	mv4l2_hue_mö
, 
	mv4l2_hue_max
;

337 
	mv4l2_gaö
, 
	mv4l2_gaö_mö
, 
	mv4l2_gaö_max
;

338 
	mv4l2_exposuª
, 
	mv4l2_exposuª_mö
, 
	mv4l2_exposuª_max
;

343 
	tCvC≠tuªCAM_V4L
;

345 #ifde‡
HAVE_CAMV4L2


347 
	gV4L2_SUPPORT
 = 0;

351 
icvClo£CAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 );

353 
icvGøbFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 );

354 
I∂Image
* 
icvRërõveFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, );

356 
icvGëPr›îtyCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
 );

357 
icvSëPr›îtyCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
¥›îty_id
, 
vÆue
 );

359 
icvSëVideoSize
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
w
, 
h
);

363 
	gnumCamîas
 = 0;

364 
	gödexLi°
 = 0;

371 
	$icvInôC≠tuª_V4L
() {

372 
devi˚H™dÀ
;

373 
CamîaNumbî
;

374 
devi˚Name
[
MAX_DEVICE_DRIVER_NAME
];

376 
CamîaNumbî
 = 0;

377 
CamîaNumbî
 < 
MAX_CAMERAS
) {

379 
	`•rötf
(
devi˚Name
, "/dev/video%1d", 
CamîaNumbî
);

381 
devi˚H™dÀ
 = 
	`›í
(
devi˚Name
, 
O_RDONLY
);

382 i‡(
devi˚H™dÀ
 != -1) {

385 
ödexLi°
|=(1 << 
CamîaNumbî
);

386 
numCamîas
++;

388 i‡(
devi˚H™dÀ
 != -1)

389 
	`˛o£
(
devi˚H™dÀ
);

391 
CamîaNumbî
++;

394 
	}
};

396 #ifde‡
HAVE_CAMV4L


399 
	$åy_∑Àâe
(
fd
,

400 
video_pi˘uª
 *
ˇm_pic
,

401 
∑l
,

402 
dïth
)

404 
ˇm_pic
->
∑Àâe
 = 
∑l
;

405 
ˇm_pic
->
dïth
 = depth;

406 i‡(
	`io˘l
(
fd
, 
VIDIOCSPICT
, 
ˇm_pic
) < 0)

408 i‡(
	`io˘l
(
fd
, 
VIDIOCGPICT
, 
ˇm_pic
) < 0)

410 i‡(
ˇm_pic
->
∑Àâe
 =
∑l
)

413 
	}
}

417 #ifde‡
HAVE_CAMV4L2


419 
	$åy_∑Àâe_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
cﬁ‹•a˚
)

421 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

423 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

424 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
pixñf‹m©
 = 
cﬁ‹•a˚
;

425 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
fõld
 = 
V4L2_FIELD_ANY
;

426 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
 = 
DEFAULT_V4L_WIDTH
;

427 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 = 
DEFAULT_V4L_HEIGHT
;

429 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_FMT
, &ˇ±uª->
f‹m
))

433 i‡(
cﬁ‹•a˚
 !
ˇ±uª
->
f‹m
.
fmt
.
pix
.
pixñf‹m©
)

437 
	}
}

441 #ifde‡
HAVE_CAMV4L


443 
	$åy_öô_v4l
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, *
devi˚Name
)

449 
dëe˘
 = 0;

456 
ˇ±uª
->
devi˚H™dÀ
 = 
	`›í
(
devi˚Name
, 
O_RDWR
);

458 i‡(
ˇ±uª
->
devi˚H™dÀ
 == 0)

460 
dëe˘
 = -1;

462 
	`icvClo£CAM_V4L
(
ˇ±uª
);

465 i‡(
dëe˘
 == 0)

468 i‡(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGCAP
, &ˇ±uª->
ˇ∑bûôy
) < 0)

470 
dëe˘
 = 0;

471 
	`icvClo£CAM_V4L
(
ˇ±uª
);

475 
dëe˘
 = 1;

479  
dëe˘
;

481 
	}
}

485 #ifde‡
HAVE_CAMV4L2


487 
	$åy_öô_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
, *
devi˚Name
)

495 
devi˚Index
;

498 
ˇ±uª
->
devi˚H™dÀ
 = 
	`›í
 (
devi˚Name
, 
O_RDWR
 | 
O_NONBLOCK
, 0);

499 i‡(-1 =
ˇ±uª
->
devi˚H™dÀ
)

501 #i‚de‡
NDEBUG


502 
	`Ârötf
(
°dîr
, "(DEBUGËåy_öô_v4l2 o≥¿\"%s\": %s\n", 
devi˚Name
, 
	`°ªº‹
(
î∫o
));

504 
	`icvClo£CAM_V4L
(
ˇ±uª
);

508 
	`CLEAR
 (
ˇ±uª
->
ˇp
);

509 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCAP
, &ˇ±uª->
ˇp
))

511 #i‚de‡
NDEBUG


512 
	`Ârötf
(
°dîr
, "(DEBUGËåy_öô_v4l2 VIDIOC_QUERYCAP \"%s\": %s\n", 
devi˚Name
, 
	`°ªº‹
(
î∫o
));

514 
	`icvClo£CAM_V4L
(
ˇ±uª
);

519 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_INPUT
, &
devi˚Index
))

521 #i‚de‡
NDEBUG


522 
	`Ârötf
(
°dîr
, "(DEBUGËåy_öô_v4l2 VIDIOC_G_INPUT \"%s\": %s\n", 
devi˚Name
, 
	`°ªº‹
(
î∫o
));

524 
	`icvClo£CAM_V4L
(
ˇ±uª
);

529 
	`CLEAR
 (
ˇ±uª
->
öp
);

530 
ˇ±uª
->
öp
.
ödex
 = 
devi˚Index
;

531 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_ENUMINPUT
, &ˇ±uª->
öp
))

533 #i‚de‡
NDEBUG


534 
	`Ârötf
(
°dîr
, "(DEBUGËåy_öô_v4l2 VIDIOC_ENUMINPUT \"%s\": %s\n", 
devi˚Name
, 
	`°ªº‹
(
î∫o
));

536 
	`icvClo£CAM_V4L
(
ˇ±uª
);

542 
	}
}

544 
	$auto£tup_ˇ±uª_mode_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
)

546 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_BGR24
) == 0)

548 
ˇ±uª
->
∑Àâe
 = 
PALETTE_BGR24
;

551 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_YVU420
) == 0)

553 
ˇ±uª
->
∑Àâe
 = 
PALETTE_YVU420
;

556 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_YUV411P
) == 0)

558 
ˇ±uª
->
∑Àâe
 = 
PALETTE_YUV411P
;

562 #ifde‡
HAVE_JPEG


563 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_MJPEG
) == 0 ||

564 
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_JPEG
) == 0)

566 
ˇ±uª
->
∑Àâe
 = 
PALETTE_MJPEG
;

571 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_YUYV
) == 0)

573 
ˇ±uª
->
∑Àâe
 = 
PALETTE_YUYV
;

575 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_UYVY
) == 0)

577 
ˇ±uª
->
∑Àâe
 = 
PALETTE_UYVY
;

580 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_SN9C10X
) == 0)

582 
ˇ±uª
->
∑Àâe
 = 
PALETTE_SN9C10X
;

584 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_SBGGR8
) == 0)

586 
ˇ±uª
->
∑Àâe
 = 
PALETTE_SBGGR8
;

588 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_SGBRG
) == 0)

590 
ˇ±uª
->
∑Àâe
 = 
PALETTE_SGBRG
;

592 i‡(
	`åy_∑Àâe_v4l2
(
ˇ±uª
, 
V4L2_PIX_FMT_RGB24
) == 0)

594 
ˇ±uª
->
∑Àâe
 = 
PALETTE_RGB24
;

598 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L2: Pixel format of incoming image is unsupported by OpenCV\n");

599 
	`icvClo£CAM_V4L
(
ˇ±uª
);

605 
	}
}

609 #ifde‡
HAVE_CAMV4L


611 
	$auto£tup_ˇ±uª_mode_v4l
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
)

614 if(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGPICT
, &ˇ±uª->
imagePr›îtõs
) < 0) {

615 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: UnableÅo determine size of incoming image\n");

616 
	`icvClo£CAM_V4L
(
ˇ±uª
);

622 i‡(
	`åy_∑Àâe
(
ˇ±uª
->
devi˚H™dÀ
, &ˇ±uª->
imagePr›îtõs
, 
VIDEO_PALETTE_RGB24
, 24)) {

625 i‡(
	`åy_∑Àâe
(
ˇ±uª
->
devi˚H™dÀ
, &ˇ±uª->
imagePr›îtõs
, 
VIDEO_PALETTE_YUV420P
, 16)) {

628 i‡(
	`åy_∑Àâe
(
ˇ±uª
->
devi˚H™dÀ
, &ˇ±uª->
imagePr›îtõs
, 
VIDEO_PALETTE_YUV420
, 16)) {

631 i‡(
	`åy_∑Àâe
(
ˇ±uª
->
devi˚H™dÀ
, &ˇ±uª->
imagePr›îtõs
, 
VIDEO_PALETTE_YUV411P
, 16)) {

635 
	`Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L: Pixel format of incoming image is unsupported by OpenCV\n");

636 
	`icvClo£CAM_V4L
(
ˇ±uª
);

642 
	}
}

646 #ifde‡
HAVE_CAMV4L2


649 
	$v4l2_sˇn_c⁄åﬁs
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
)

652 
__u32
 
˘æ_id
;

654 
˘æ_id
 = 
V4L2_CID_BASE
;

655 
˘æ_id
 < 
V4L2_CID_LASTP1
;

656 
˘æ_id
++)

660 
	`CLEAR
 (
ˇ±uª
->
quîy˘æ
);

661 
ˇ±uª
->
quîy˘æ
.
id
 = 
˘æ_id
;

663 i‡(0 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
,

664 &
ˇ±uª
->
quîy˘æ
))

667 i‡(
ˇ±uª
->
quîy˘æ
.
Êags
 & 
V4L2_CTRL_FLAG_DISABLED
)

670 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_BRIGHTNESS
)

672 
ˇ±uª
->
v4l2_brighäess
 = 1;

673 
ˇ±uª
->
v4l2_brighäess_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

674 
ˇ±uª
->
v4l2_brighäess_max
 = c≠tuª->
quîy˘æ
.
maximum
;

677 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_CONTRAST
)

679 
ˇ±uª
->
v4l2_c⁄åa°
 = 1;

680 
ˇ±uª
->
v4l2_c⁄åa°_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

681 
ˇ±uª
->
v4l2_c⁄åa°_max
 = c≠tuª->
quîy˘æ
.
maximum
;

684 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_SATURATION
)

686 
ˇ±uª
->
v4l2_ßtuøti⁄
 = 1;

687 
ˇ±uª
->
v4l2_ßtuøti⁄_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

688 
ˇ±uª
->
v4l2_ßtuøti⁄_max
 = c≠tuª->
quîy˘æ
.
maximum
;

691 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_HUE
)

693 
ˇ±uª
->
v4l2_hue
 = 1;

694 
ˇ±uª
->
v4l2_hue_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

695 
ˇ±uª
->
v4l2_hue_max
 = c≠tuª->
quîy˘æ
.
maximum
;

698 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_GAIN
)

700 
ˇ±uª
->
v4l2_gaö
 = 1;

701 
ˇ±uª
->
v4l2_gaö_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

702 
ˇ±uª
->
v4l2_gaö_max
 = c≠tuª->
quîy˘æ
.
maximum
;

705 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_EXPOSURE
)

707 
ˇ±uª
->
v4l2_exposuª
 = 1;

708 
ˇ±uª
->
v4l2_exposuª_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

709 
ˇ±uª
->
v4l2_exposuª_max
 = c≠tuª->
quîy˘æ
.
maximum
;

715 i‡(
î∫o
 =
EINVAL
)

718 
	`≥º‹
 ("VIDIOC_QUERYCTRL");

724 
˘æ_id
 = 
V4L2_CID_PRIVATE_BASE
;;ctrl_id++)

728 
	`CLEAR
 (
ˇ±uª
->
quîy˘æ
);

729 
ˇ±uª
->
quîy˘æ
.
id
 = 
˘æ_id
;

731 i‡(0 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYCTRL
,

732 &
ˇ±uª
->
quîy˘æ
))

735 i‡(
ˇ±uª
->
quîy˘æ
.
Êags
 & 
V4L2_CTRL_FLAG_DISABLED
)

738 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_BRIGHTNESS
)

740 
ˇ±uª
->
v4l2_brighäess
 = 1;

741 
ˇ±uª
->
v4l2_brighäess_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

742 
ˇ±uª
->
v4l2_brighäess_max
 = c≠tuª->
quîy˘æ
.
maximum
;

745 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_CONTRAST
)

747 
ˇ±uª
->
v4l2_c⁄åa°
 = 1;

748 
ˇ±uª
->
v4l2_c⁄åa°_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

749 
ˇ±uª
->
v4l2_c⁄åa°_max
 = c≠tuª->
quîy˘æ
.
maximum
;

752 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_SATURATION
)

754 
ˇ±uª
->
v4l2_ßtuøti⁄
 = 1;

755 
ˇ±uª
->
v4l2_ßtuøti⁄_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

756 
ˇ±uª
->
v4l2_ßtuøti⁄_max
 = c≠tuª->
quîy˘æ
.
maximum
;

759 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_HUE
)

761 
ˇ±uª
->
v4l2_hue
 = 1;

762 
ˇ±uª
->
v4l2_hue_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

763 
ˇ±uª
->
v4l2_hue_max
 = c≠tuª->
quîy˘æ
.
maximum
;

766 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_GAIN
)

768 
ˇ±uª
->
v4l2_gaö
 = 1;

769 
ˇ±uª
->
v4l2_gaö_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

770 
ˇ±uª
->
v4l2_gaö_max
 = c≠tuª->
quîy˘æ
.
maximum
;

773 i‡(
ˇ±uª
->
quîy˘æ
.
id
 =
V4L2_CID_EXPOSURE
)

775 
ˇ±uª
->
v4l2_exposuª
 = 1;

776 
ˇ±uª
->
v4l2_exposuª_mö
 = c≠tuª->
quîy˘æ
.
möimum
;

777 
ˇ±uª
->
v4l2_exposuª_max
 = c≠tuª->
quîy˘æ
.
maximum
;

782 i‡(
î∫o
 =
EINVAL
)

785 
	`≥º‹
 ("VIDIOC_QUERYCTRL");

791 
	}
}

793 
	$_ˇ±uª_V4L2
 (
CvC≠tuªCAM_V4L
 *
ˇ±uª
, *
devi˚Name
)

795 
dëe˘_v4l2
 = 0;

797 
dëe˘_v4l2
 = 
	`åy_öô_v4l2
(
ˇ±uª
, 
devi˚Name
);

799 i‡(
dëe˘_v4l2
 != 1) {

805 
V4L2_SUPPORT
 = 1;

808 
ˇ±uª
->
v4l2_brighäess
 = 0;

809 
ˇ±uª
->
v4l2_c⁄åa°
 = 0;

810 
ˇ±uª
->
v4l2_ßtuøti⁄
 = 0;

811 
ˇ±uª
->
v4l2_hue
 = 0;

812 
ˇ±uª
->
v4l2_gaö
 = 0;

813 
ˇ±uª
->
v4l2_exposuª
 = 0;

815 
ˇ±uª
->
v4l2_brighäess_mö
 = 0;

816 
ˇ±uª
->
v4l2_c⁄åa°_mö
 = 0;

817 
ˇ±uª
->
v4l2_ßtuøti⁄_mö
 = 0;

818 
ˇ±uª
->
v4l2_hue_mö
 = 0;

819 
ˇ±uª
->
v4l2_gaö_mö
 = 0;

820 
ˇ±uª
->
v4l2_exposuª_mö
 = 0;

822 
ˇ±uª
->
v4l2_brighäess_max
 = 0;

823 
ˇ±uª
->
v4l2_c⁄åa°_max
 = 0;

824 
ˇ±uª
->
v4l2_ßtuøti⁄_max
 = 0;

825 
ˇ±uª
->
v4l2_hue_max
 = 0;

826 
ˇ±uª
->
v4l2_gaö_max
 = 0;

827 
ˇ±uª
->
v4l2_exposuª_max
 = 0;

829 
ˇ±uª
->
time°amp
.
tv_£c
 = 0;

830 
ˇ±uª
->
time°amp
.
tv_u£c
 = 0;

833 
	`v4l2_sˇn_c⁄åﬁs
(
ˇ±uª
);

835 i‡((
ˇ±uª
->
ˇp
.
ˇ∑bûôõs
 & 
V4L2_CAP_VIDEO_CAPTURE
) == 0) {

837 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L2: devi˚ %†i†u«bÀÅÿˇ±uª videÿmem‹y.\n",
devi˚Name
);

838 
	`icvClo£CAM_V4L
(
ˇ±uª
);

849 if(
ˇ±uª
->
öp
.
ödex
 > 0) {

850 
	`CLEAR
 (
ˇ±uª
->
öp
);

851 
ˇ±uª
->
öp
.
ödex
 = 
CHANNEL_NUMBER
;

854 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_ENUMINPUT
, &ˇ±uª->
öp
))

856 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L2: Aren'tábleÅo set channelÇumber\n");

857 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

863 
	`CLEAR
 (
ˇ±uª
->
f‹m
);

864 
ˇ±uª
->
f‹m
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

866 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
)) {

867 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L2: CouldÇot obtain specifics of capture window.\n\n");

868 
	`icvClo£CAM_V4L
(
ˇ±uª
);

872 i‡(
V4L2_SUPPORT
 == 0)

876 i‡(
	`auto£tup_ˇ±uª_mode_v4l2
(
ˇ±uª
) == -1)

879 
	`icvSëVideoSize
(
ˇ±uª
, 
DEFAULT_V4L_WIDTH
, 
DEFAULT_V4L_HEIGHT
);

881 
mö
;

884 
mö
 = 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
 * 2;

886 i‡(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 < 
mö
)

887 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 = 
mö
;

889 
mö
 = 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
byã•îlöe
 * c≠tuª->f‹m.fmt.pix.
height
;

891 i‡(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
sizeimage
 < 
mö
)

892 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
sizeimage
 = 
mö
;

894 
	`CLEAR
 (
ˇ±uª
->
ªq
);

896 
buf„r_numbî
 = 
DEFAULT_V4L_BUFFERS
;

898 
åy_agaö
:

900 
ˇ±uª
->
ªq
.
cou¡
 = 
buf„r_numbî
;

901 
ˇ±uª
->
ªq
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

902 
ˇ±uª
->
ªq
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

904 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_REQBUFS
, &ˇ±uª->
ªq
))

906 i‡(
EINVAL
 =
î∫o
)

908 
	`Ârötf
 (
°dîr
, "%†d€†nŸ suµ‹àmem‹y m≠pög\n", 
devi˚Name
);

910 
	`≥º‹
 ("VIDIOC_REQBUFS");

913 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

917 i‡(
ˇ±uª
->
ªq
.
cou¡
 < 
buf„r_numbî
)

919 i‡(
buf„r_numbî
 == 1)

921 
	`Ârötf
 (
°dîr
, "Insufficõ¡ buf„∏mem‹y o¿%s\n", 
devi˚Name
);

924 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

927 
buf„r_numbî
--;

928 
	`Ârötf
 (
°dîr
, "Insufficõ¡ buf„∏mem‹y o¿%†-- de¸ó£ög buf„rs\n", 
devi˚Name
);

930 
åy_agaö
;

934 
n_buf„rs
 = 0;Ç_buf„r†< 
ˇ±uª
->
ªq
.
cou¡
; ++n_buffers)

936 
v4l2_buf„r
 
buf
;

938 
	`CLEAR
 (
buf
);

940 
buf
.
ty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

941 
buf
.
mem‹y
 = 
V4L2_MEMORY_MMAP
;

942 
buf
.
ödex
 = 
n_buf„rs
;

944 i‡(-1 =
	`io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QUERYBUF
, &
buf
)) {

945 
	`≥º‹
 ("VIDIOC_QUERYBUF");

948 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

952 
ˇ±uª
->
buf„rs
[
n_buf„rs
].
Àngth
 = 
buf
.length;

953 
ˇ±uª
->
buf„rs
[
n_buf„rs
].
°¨t
 =

954 
	`mm≠
 (
NULL
 ,

955 
buf
.
Àngth
,

956 
PROT_READ
 | 
PROT_WRITE
 ,

957 
MAP_SHARED
 ,

958 
ˇ±uª
->
devi˚H™dÀ
, 
buf
.
m
.
off£t
);

960 i‡(
MAP_FAILED
 =
ˇ±uª
->
buf„rs
[
n_buf„rs
].
°¨t
) {

961 
	`≥º‹
 ("mmap");

964 
	`icvClo£CAM_V4L
 (
ˇ±uª
);

968 i‡(
n_buf„rs
 == 0) {

969 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
 = 
	`mÆloc
–
buf
.
Àngth
 );

970 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
Àngth
 = 
buf
.length;

975 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

976 
	`cvSize
–
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

977 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 ),

978 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_TL
, 4 );

980 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

983 
	}
};

987 #ifde‡
HAVE_CAMV4L


989 
	$_ˇ±uª_V4L
 (
CvC≠tuªCAM_V4L
 *
ˇ±uª
, *
devi˚Name
)

991 
dëe˘_v4l
 = 0;

993 
dëe˘_v4l
 = 
	`åy_öô_v4l
(
ˇ±uª
, 
devi˚Name
);

995 i‡((
dëe˘_v4l
 == -1)

998 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L"

999 ": devi˚ %s: U«bÀÅÿ›í f‹ READ ONLY\n", 
devi˚Name
);

1004 i‡((
dëe˘_v4l
 <= 0)

1007 
	`Ârötf
 (
°dîr
, "VIDEOIO ERROR: V4L"

1008 ": devi˚ %s: U«bÀÅÿquîyÇumbî o‡ch™√ls\n", 
devi˚Name
);

1014 i‡((
ˇ±uª
->
ˇ∑bûôy
.
ty≥
 & 
VID_TYPE_CAPTURE
) == 0) {

1016 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: "

1017 "devi˚ %†i†u«bÀÅÿˇ±uª videÿmem‹y.\n",
devi˚Name
);

1018 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1034 if(
ˇ±uª
->
ˇ∑bûôy
.
ch™√ls
>0) {

1036 
video_ch™√l
 
£À˘edCh™√l
;

1037 
	`mem£t
(&
£À˘edCh™√l
, 0, (selectedChannel));

1039 
£À˘edCh™√l
.
ch™√l
=
CHANNEL_NUMBER
;

1040 i‡(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGCHAN
 , &
£À˘edCh™√l
) != -1) {

1043 i‡(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSCHAN
 , &
£À˘edCh™√l
) == -1) {

1054 if(
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGWIN
, &ˇ±uª->
ˇ±uªWödow
) == -1) {

1055 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: "

1057 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1065 i‡(
	`auto£tup_ˇ±uª_mode_v4l
(
ˇ±uª
) == -1)

1072 
	`io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGMBUF
, &ˇ±uª->
mem‹yBuf„r
);

1073 
ˇ±uª
->
mem‹yM≠
 = (*)
	`mm≠
(0,

1074 
ˇ±uª
->
mem‹yBuf„r
.
size
,

1075 
PROT_READ
 | 
PROT_WRITE
,

1076 
MAP_SHARED
,

1077 
ˇ±uª
->
devi˚H™dÀ
,

1079 i‡(
ˇ±uª
->
mem‹yM≠
 =
MAP_FAILED
) {

1080 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: M≠pög Memm‹y from videÿsour˚Éº‹: %s\n", 
	`°ªº‹
(
î∫o
));

1081 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1086 
ˇ±uª
->
mm≠s
 = (
video_mm≠
 *)

1087 (
	`mÆloc
(
ˇ±uª
->
mem‹yBuf„r
.
‰ames
 * (
video_mm≠
)));

1088 i‡(!
ˇ±uª
->
mm≠s
) {

1089 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇot memory map video frames.\n");

1090 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1097 
	`cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

1098 
	`cvSize
–
ˇ±uª
->
ˇ±uªWödow
.
width
,

1099 
ˇ±uª
->
ˇ±uªWödow
.
height
 ),

1100 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_TL
, 4 );

1102 
ˇ±uª
->
‰ame
.
imageD©a
 = (*)
	`cvAŒoc
(ˇ±uª->‰ame.
imageSize
);

1105 
	}
};

1109 
CvC≠tuªCAM_V4L
 * 
	$icvC≠tuªFromCAM_V4L
 (
ödex
)

1111 
autoödex
;

1112 
autoödex
 = 0;

1114 
devi˚Name
[
MAX_DEVICE_DRIVER_NAME
];

1116 i‡(!
numCamîas
)

1117 
	`icvInôC≠tuª_V4L
();

1118 i‡(!
numCamîas
)

1119  
NULL
;

1122 i‡–(
ödex
>-1Ë&& ! ((1 << indexË& 
ödexLi°
) )

1124 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: index %d i†nŸ c‹ª˘!\n",
ödex
);

1125  
NULL
;

1129 
CvC≠tuªCAM_V4L
 * 
ˇ±uª
 = (CvC≠tuªCAM_V4L*)
	`cvAŒoc
((CvCaptureCAM_V4L));

1130 i‡(!
ˇ±uª
) {

1131 
	`Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇotállocate memory for captureÖrocess.\n");

1132  
NULL
;

1135 i‡(
ödex
<0) {

1136 ; 
autoödex
<
MAX_CAMERAS
;autoindex++)

1137 i‡(
ödexLi°
 & (1<<
autoödex
))

1139 i‡(
autoödex
==
MAX_CAMERAS
)

1140  
NULL
;

1141 
ödex
=
autoödex
;

1142 
autoödex
++;

1145 
	`•rötf
(
devi˚Name
, "/dev/video%1d", 
ödex
);

1148 
	`mem£t
(
ˇ±uª
,0,(
CvC≠tuªCAM_V4L
));

1151 
ˇ±uª
->
Fú°C≠tuª
 = 1;

1153 #ifde‡
HAVE_CAMV4L2


1154 i‡(
	`_ˇ±uª_V4L2
 (
ˇ±uª
, 
devi˚Name
) == -1) {

1155 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1156 
V4L2_SUPPORT
 = 0;

1158 #ifde‡
HAVE_CAMV4L


1159 i‡(
	`_ˇ±uª_V4L
 (
ˇ±uª
, 
devi˚Name
) == -1) {

1160 
	`icvClo£CAM_V4L
(
ˇ±uª
);

1161  
NULL
;

1164 #ifde‡
HAVE_CAMV4L2


1165 
	}
} {

1166 
	gV4L2_SUPPORT
 = 1;

1170  
	gˇ±uª
;

1173 #ifde‡
HAVE_CAMV4L2


1175 
ªad_‰ame_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1176 
v4l2_buf„r
 
	gbuf
;

1178 
CLEAR
 (
buf
);

1180 
	gbuf
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1181 
	gbuf
.
	gmem‹y
 = 
V4L2_MEMORY_MMAP
;

1183 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_DQBUF
, &
buf
)) {

1184 
	gî∫o
) {

1185 
	gEAGAIN
:

1188 
	gEIO
:

1189 i‡(!(
buf
.
Êags
 & (
V4L2_BUF_FLAG_QUEUED
 | 
V4L2_BUF_FLAG_DONE
)))

1191 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QBUF
, &
buf
) == -1)

1200 
≥º‹
 ("VIDIOC_DQBUF");

1205 
as£π
(
buf
.
ödex
 < 
ˇ±uª
->
ªq
.
cou¡
);

1207 
mem˝y
(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
,

1208 
ˇ±uª
->
buf„rs
[
buf
.
ödex
].
°¨t
,

1209 
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
Àngth
 );

1210 
	gˇ±uª
->
	gbuf„rIndex
 = 
MAX_V4L_BUFFERS
;

1214 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QBUF
, &
buf
))

1215 
≥º‹
 ("VIDIOC_QBUF");

1218 
	gˇ±uª
->
	gtime°amp
 = 
buf
.
time°amp
;

1223 
maölo›_v4l2
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1224 
	gcou¡
;

1226 
	gcou¡
 = 1;

1228 
	gcou¡
-- > 0) {

1230 
fd_£t
 
	gfds
;

1231 
timevÆ
 
	gtv
;

1232 
	gr
;

1234 
FD_ZERO
 (&
fds
);

1235 
FD_SET
 (
ˇ±uª
->
devi˚H™dÀ
, &
fds
);

1238 
	gtv
.
	gtv_£c
 = 10;

1239 
	gtv
.
	gtv_u£c
 = 0;

1241 
	gr
 = 
£À˘
 (
ˇ±uª
->
devi˚H™dÀ
+1, &
fds
, 
NULL
, NULL, &
tv
);

1243 i‡(-1 =
r
) {

1244 i‡(
EINTR
 =
î∫o
)

1247 
≥º‹
 ("select");

1250 i‡(0 =
r
) {

1251 
Ârötf
 (
°dîr
, "selectÅimeout\n");

1257 i‡(
ªad_‰ame_v4l2
 (
ˇ±uª
))

1265 
icvGøbFømeCAM_V4L
(
CvC≠tuªCAM_V4L
* 
ˇ±uª
) {

1267 i‡(
	gˇ±uª
->
	gFú°C≠tuª
) {

1273 #ifde‡
HAVE_CAMV4L2


1275 #ifde‡
HAVE_CAMV4L


1276 i‡(
	gV4L2_SUPPORT
 == 1)

1280 
ˇ±uª
->
buf„rIndex
 = 0;

1281 
	gˇ±uª
->
	gbuf„rIndex
 < (()ˇ±uª->
	gªq
.
	gcou¡
);

1282 ++
	gˇ±uª
->
	gbuf„rIndex
)

1285 
v4l2_buf„r
 
	gbuf
;

1287 
CLEAR
 (
buf
);

1289 
	gbuf
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1290 
	gbuf
.
	gmem‹y
 = 
V4L2_MEMORY_MMAP
;

1291 
	gbuf
.
	gödex
 = ()
ˇ±uª
->
buf„rIndex
;

1293 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_QBUF
, &
buf
)) {

1294 
≥º‹
 ("VIDIOC_QBUF");

1300 
	gˇ±uª
->
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

1301 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_STREAMON
,

1302 &
ˇ±uª
->
ty≥
)) {

1304 
≥º‹
 ("VIDIOC_STREAMON");

1309 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

1312 #ifde‡
HAVE_CAMV4L


1315 
	gˇ±uª
->
	gbuf„rIndex
 = 0;

1316 
	gˇ±uª
->
	gbuf„rIndex
 < (ˇ±uª->
	gmem‹yBuf„r
.
	g‰ames
-1);

1317 ++
	gˇ±uª
->
	gbuf„rIndex
) {

1319 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	g‰ame
 = capture->bufferIndex;

1320 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gwidth
 = c≠tuª->
ˇ±uªWödow
.
width
;

1321 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gheight
 = c≠tuª->
ˇ±uªWödow
.
height
;

1322 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gf‹m©
 = c≠tuª->
imagePr›îtõs
.
∑Àâe
;

1324 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCMCAPTURE
, &ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
]) == -1) {

1325 
Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: Initial Capture Error: UnableÅoÜoad initial memory buffers.\n");

1333 #i‡
deföed
(
V4L_ABORT_BADJPEG
Ë&& deföed(
HAVE_CAMV4L2
)

1334 i‡(
	gV4L2_SUPPORT
 == 1)

1338 
maölo›_v4l2
(
ˇ±uª
);

1343 
	gˇ±uª
->
	gFú°C≠tuª
 = 0;

1346 #ifde‡
HAVE_CAMV4L2


1348 i‡(
	gV4L2_SUPPORT
 == 1)

1351 
maölo›_v4l2
(
ˇ±uª
);

1355 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

1358 #ifde‡
HAVE_CAMV4L


1361 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	g‰ame
 = capture->bufferIndex;

1362 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gwidth
 = c≠tuª->
ˇ±uªWödow
.
width
;

1363 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gheight
 = c≠tuª->
ˇ±uªWödow
.
height
;

1364 
	gˇ±uª
->
	gmm≠s
[
ˇ±uª
->
buf„rIndex
].
	gf‹m©
 = c≠tuª->
imagePr›îtõs
.
∑Àâe
;

1366 i‡(
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCMCAPTURE
,

1367 &
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
]) == -1) {

1372 ++
	gˇ±uª
->
	gbuf„rIndex
;

1373 i‡(
	gˇ±uª
->
	gbuf„rIndex
 =
ˇ±uª
->
mem‹yBuf„r
.
‰ames
) {

1374 
ˇ±uª
->
buf„rIndex
 = 0;

1410 
	#LIMIT
(
x
Ë((x)>0xffffff?0xff: ((x)<=0xffff?0:((x)>>16)))

	)

1412 
ölöe
 

1413 
move_420_block
(
yTL
, 
yTR
, 
yBL
, 
yBR
, 
u
, 
v
,

1414 
rowPixñs
, * 
rgb
)

1416 c⁄° 
	grvSˇÀ
 = 91881;

1417 c⁄° 
	gguSˇÀ
 = -22553;

1418 c⁄° 
	ggvSˇÀ
 = -46801;

1419 c⁄° 
	gbuSˇÀ
 = 116129;

1420 c⁄° 
	gySˇÀ
 = 65536;

1421 
	gr
, 
	gg
, 
	gb
;

1423 
	gg
 = 
guSˇÀ
 * 
u
 + 
gvSˇÀ
 * 
v
;

1428 
	gr
 = 
rvSˇÀ
 * 
v
;

1429 
	gb
 = 
buSˇÀ
 * 
u
;

1432 
	gyTL
 *
ySˇÀ
; 
	gyTR
 *= yScale;

1433 
	gyBL
 *
ySˇÀ
; 
	gyBR
 *= yScale;

1436 
	grgb
[0] = 
LIMIT
(
b
+
yTL
);Ñgb[1] = LIMIT(
g
+yTL);

1437 
	grgb
[2] = 
LIMIT
(
r
+
yTL
);

1439 
	grgb
[3] = 
LIMIT
(
b
+
yTR
);Ñgb[4] = LIMIT(
g
+yTR);

1440 
	grgb
[5] = 
LIMIT
(
r
+
yTR
);

1443 
	grgb
 +3 * 
rowPixñs
;

1444 
	grgb
[0] = 
LIMIT
(
b
+
yBL
);Ñgb[1] = LIMIT(
g
+yBL);

1445 
	grgb
[2] = 
LIMIT
(
r
+
yBL
);

1447 
	grgb
[3] = 
LIMIT
(
b
+
yBR
);Ñgb[4] = LIMIT(
g
+yBR);

1448 
	grgb
[5] = 
LIMIT
(
r
+
yBR
);

1451 
ölöe
 

1452 
move_411_block
(
yTL
, 
yTR
, 
yBL
, 
yBR
, 
u
, 
v
,

1453 , * 
rgb
)

1455 c⁄° 
	grvSˇÀ
 = 91881;

1456 c⁄° 
	gguSˇÀ
 = -22553;

1457 c⁄° 
	ggvSˇÀ
 = -46801;

1458 c⁄° 
	gbuSˇÀ
 = 116129;

1459 c⁄° 
	gySˇÀ
 = 65536;

1460 
	gr
, 
	gg
, 
	gb
;

1462 
	gg
 = 
guSˇÀ
 * 
u
 + 
gvSˇÀ
 * 
v
;

1467 
	gr
 = 
rvSˇÀ
 * 
v
;

1468 
	gb
 = 
buSˇÀ
 * 
u
;

1471 
	gyTL
 *
ySˇÀ
; 
	gyTR
 *= yScale;

1472 
	gyBL
 *
ySˇÀ
; 
	gyBR
 *= yScale;

1475 
	grgb
[0] = 
LIMIT
(
b
+
yTL
);Ñgb[1] = LIMIT(
g
+yTL);

1476 
	grgb
[2] = 
LIMIT
(
r
+
yTL
);

1478 
	grgb
[3] = 
LIMIT
(
b
+
yTR
);Ñgb[4] = LIMIT(
g
+yTR);

1479 
	grgb
[5] = 
LIMIT
(
r
+
yTR
);

1482 
	grgb
 += 6;

1483 
	grgb
[0] = 
LIMIT
(
b
+
yBL
);Ñgb[1] = LIMIT(
g
+yBL);

1484 
	grgb
[2] = 
LIMIT
(
r
+
yBL
);

1486 
	grgb
[3] = 
LIMIT
(
b
+
yBR
);Ñgb[4] = LIMIT(
g
+yBR);

1487 
	grgb
[5] = 
LIMIT
(
r
+
yBR
);

1503 
yuv420p_to_rgb24
(
width
, 
height
,

1504 *
pIn0
, *
pOut0
)

1506 c⁄° 
	gnumpix
 = 
width
 * 
height
;

1507 c⁄° 
	gbyãs
 = 24 >> 3;

1508 
	gi
, 
	gj
, 
	gy00
, 
	gy01
, 
	gy10
, 
	gy11
, 
	gu
, 
	gv
;

1509 *
	gpY
 = 
pIn0
;

1510 *
	gpU
 = 
pY
 + 
numpix
;

1511 *
	gpV
 = 
pU
 + 
numpix
 / 4;

1512 *
	gpOut
 = 
pOut0
;

1514 
	gj
 = 0; j <
height
 - 2; j += 2) {

1515 
i
 = 0; 
	gi
 <
width
 - 2; i += 2) {

1516 
y00
 = *
pY
;

1517 
	gy01
 = *(
pY
 + 1);

1518 
	gy10
 = *(
pY
 + 
width
);

1519 
	gy11
 = *(
pY
 + 
width
 + 1);

1520 
	gu
 = (*
pU
++) - 128;

1521 
	gv
 = (*
pV
++) - 128;

1523 
move_420_block
(
y00
, 
y01
, 
y10
, 
y11
, 
u
, 
v
,

1524 
width
, 
pOut
);

1526 
	gpY
 += 2;

1527 
	gpOut
 +2 * 
byãs
;

1530 
	gpY
 +
width
;

1531 
	gpOut
 +
width
 * 
byãs
;

1545 #ifde‡
HAVE_CAMV4L


1547 
yuv420_to_rgb24
(
width
, 
height
,

1548 *
pIn0
, *
pOut0
)

1550 c⁄° 
	gbyãs
 = 24 >> 3;

1551 
	gi
, 
	gj
, 
	gy00
, 
	gy01
, 
	gy10
, 
	gy11
, 
	gu
, 
	gv
;

1552 *
	gpY
 = 
pIn0
;

1553 *
	gpU
 = 
pY
 + 4;

1554 *
	gpV
 = 
pU
 + 
width
;

1555 *
	gpOut
 = 
pOut0
;

1557 
	gj
 = 0; j <
height
 - 2; j += 2) {

1558 
i
 = 0; 
	gi
 <
width
 - 4; i += 4) {

1559 
y00
 = *
pY
;

1560 
	gy01
 = *(
pY
 + 1);

1561 
	gy10
 = *(
pY
 + 
width
);

1562 
	gy11
 = *(
pY
 + 
width
 + 1);

1563 
	gu
 = (*
pU
++) - 128;

1564 
	gv
 = (*
pV
++) - 128;

1566 
move_420_block
(
y00
, 
y01
, 
y10
, 
y11
, 
u
, 
v
,

1567 
width
, 
pOut
);

1569 
	gpY
 += 2;

1570 
	gpOut
 +2 * 
byãs
;

1572 
	gy00
 = *
pY
;

1573 
	gy01
 = *(
pY
 + 1);

1574 
	gy10
 = *(
pY
 + 
width
);

1575 
	gy11
 = *(
pY
 + 
width
 + 1);

1576 
	gu
 = (*
pU
++) - 128;

1577 
	gv
 = (*
pV
++) - 128;

1579 
move_420_block
(
y00
, 
y01
, 
y10
, 
y11
, 
u
, 
v
,

1580 
width
, 
pOut
);

1582 
	gpY
 += 4;

1583 
	gpOut
 +2 * 
byãs
;

1586 
	gpY
 +
width
;

1587 
	gpOut
 +
width
 * 
byãs
;

1608 
yuv411p_to_rgb24
(
width
, 
height
,

1609 *
pIn0
, *
pOut0
)

1611 c⁄° 
	gnumpix
 = 
width
 * 
height
;

1612 c⁄° 
	gbyãs
 = 24 >> 3;

1613 
	gi
, 
	gj
, 
	gy00
, 
	gy01
, 
	gy10
, 
	gy11
, 
	gu
, 
	gv
;

1614 *
	gpY
 = 
pIn0
;

1615 *
	gpU
 = 
pY
 + 
numpix
;

1616 *
	gpV
 = 
pU
 + 
numpix
 / 4;

1617 *
	gpOut
 = 
pOut0
;

1619 
	gj
 = 0; j <
height
; j++) {

1620 
	gi
 = 0; i <
width
 - 4; i += 4) {

1621 
y00
 = *
pY
;

1622 
	gy01
 = *(
pY
 + 1);

1623 
	gy10
 = *(
pY
 + 2);

1624 
	gy11
 = *(
pY
 + 3);

1625 
	gu
 = (*
pU
++) - 128;

1626 
	gv
 = (*
pV
++) - 128;

1628 
move_411_block
(
y00
, 
y01
, 
y10
, 
y11
, 
u
, 
v
,

1629 
width
, 
pOut
);

1631 
	gpY
 += 4;

1632 
	gpOut
 +4 * 
byãs
;

1640 
	#SAT
(
c
) \

1641 i‡(
c
 & (~255)Ë{ i‡(¯< 0Ë¯0; ¯255; }

	)

1643 #ifde‡
HAVE_CAMV4L2


1645 
yuyv_to_rgb24
 (
width
, 
height
, *
§c
, *
d°
)

1647 *
	gs
;

1648 *
	gd
;

1649 
	gl
, 
	gc
;

1650 
	gr
, 
	gg
, 
	gb
, 
	g¸
, 
	gcg
, 
	gcb
, 
	gy1
, 
	gy2
;

1652 
	gl
 = 
height
;

1653 
	gs
 = 
§c
;

1654 
	gd
 = 
d°
;

1655 
	gl
--) {

1656 
	gc
 = 
width
 >> 1;

1657 
	gc
--) {

1658 
	gy1
 = *
s
++;

1659 
	gcb
 = ((*
s
 - 128) * 454) >> 8;

1660 
	gcg
 = (*
s
++ - 128) * 88;

1661 
	gy2
 = *
s
++;

1662 
	g¸
 = ((*
s
 - 128) * 359) >> 8;

1663 
	gcg
 = (
cg
 + (*
s
++ - 128) * 183) >> 8;

1665 
	gr
 = 
y1
 + 
¸
;

1666 
	gb
 = 
y1
 + 
cb
;

1667 
	gg
 = 
y1
 - 
cg
;

1668 
SAT
(
r
);

1669 
SAT
(
g
);

1670 
SAT
(
b
);

1672 *
	gd
++ = 
b
;

1673 *
	gd
++ = 
g
;

1674 *
	gd
++ = 
r
;

1676 
	gr
 = 
y2
 + 
¸
;

1677 
	gb
 = 
y2
 + 
cb
;

1678 
	gg
 = 
y2
 - 
cg
;

1679 
SAT
(
r
);

1680 
SAT
(
g
);

1681 
SAT
(
b
);

1683 *
	gd
++ = 
b
;

1684 *
	gd
++ = 
g
;

1685 *
	gd
++ = 
r
;

1691 
uyvy_to_rgb24
 (
width
, 
height
, *
§c
, *
d°
)

1693 *
	gs
;

1694 *
	gd
;

1695 
	gl
, 
	gc
;

1696 
	gr
, 
	gg
, 
	gb
, 
	g¸
, 
	gcg
, 
	gcb
, 
	gy1
, 
	gy2
;

1698 
	gl
 = 
height
;

1699 
	gs
 = 
§c
;

1700 
	gd
 = 
d°
;

1701 
	gl
--) {

1702 
	gc
 = 
width
 >> 1;

1703 
	gc
--) {

1704 
	gcb
 = ((*
s
 - 128) * 454) >> 8;

1705 
	gcg
 = (*
s
++ - 128) * 88;

1706 
	gy1
 = *
s
++;

1707 
	g¸
 = ((*
s
 - 128) * 359) >> 8;

1708 
	gcg
 = (
cg
 + (*
s
++ - 128) * 183) >> 8;

1709 
	gy2
 = *
s
++;

1711 
	gr
 = 
y1
 + 
¸
;

1712 
	gb
 = 
y1
 + 
cb
;

1713 
	gg
 = 
y1
 - 
cg
;

1714 
SAT
(
r
);

1715 
SAT
(
g
);

1716 
SAT
(
b
);

1718 *
	gd
++ = 
b
;

1719 *
	gd
++ = 
g
;

1720 *
	gd
++ = 
r
;

1722 
	gr
 = 
y2
 + 
¸
;

1723 
	gb
 = 
y2
 + 
cb
;

1724 
	gg
 = 
y2
 - 
cg
;

1725 
SAT
(
r
);

1726 
SAT
(
g
);

1727 
SAT
(
b
);

1729 *
	gd
++ = 
b
;

1730 *
	gd
++ = 
g
;

1731 *
	gd
++ = 
r
;

1737 #ifde‡
HAVE_JPEG


1740 
boﬁ


1741 
mj≥g_to_rgb24
 (
width
, 
height
,

1742 *
§c
, 
Àngth
,

1743 *
d°
)

1745 
	gcv
::
M©
 
ãmp
=
cv
::
imdecode
(cv::M©(
°d
::
ve˘‹
<
uch¨
>(
§c
, sr¯+ 
Àngth
)), 1);

1746 if–!
	gãmp
.
	gd©a
 ||Åemp.
	gcﬁs
 !
width
 || 
ãmp
.
rows
 !
height
 )

1747  
Ál£
;

1748 
mem˝y
(
d°
, 
ãmp
.
d©a
, 
width
*
height
*3);

1749  
	gåue
;

1762 #ifde‡
HAVE_CAMV4L2


1763 
bayî2rgb24
(
WIDTH
, 
HEIGHT
, *
§c
, *
d°
)

1765 
	gi
;

1766 *
	gøw±
, *
	gsˇ≈t
;

1767 
	gsize
;

1769 
	gøw±
 = 
§c
;

1770 
	gsˇ≈t
 = 
d°
;

1771 
	gsize
 = 
WIDTH
*
HEIGHT
;

1773  
	gi
 = 0; i < 
	gsize
; i++ ) {

1774 i‡–(
	gi
/
	gWIDTH
) % 2 == 0 ) {

1775 i‡–(
i
 % 2) == 0 ) {

1777 i‡–(
i
 > 
WIDTH
) && ((i % WIDTH) > 0) ) {

1778 *
sˇ≈t
++ = (*(
øw±
-
WIDTH
-1)+*(rawpt-WIDTH+1)+

1779 *(
øw±
+
WIDTH
-1)+*(rawpt+WIDTH+1))/4;

1780 *
	gsˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1)+

1781 *(
øw±
+
WIDTH
)+*(rawpt-WIDTH))/4;

1782 *
	gsˇ≈t
++ = *
øw±
;

1785 *
	gsˇ≈t
++ = *(
øw±
+
WIDTH
+1);

1786 *
	gsˇ≈t
++ = (*(
øw±
+1)+*‘aw±+
WIDTH
))/2;

1787 *
	gsˇ≈t
++ = *
øw±
;

1791 i‡–(
	gi
 > 
	gWIDTH
) && ((i % WIDTH) < (WIDTH-1)) ) {

1792 *
	gsˇ≈t
++ = (*(
øw±
+
WIDTH
)+*(rawpt-WIDTH))/2;

1793 *
	gsˇ≈t
++ = *
øw±
;

1794 *
	gsˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1))/2;

1797 *
	gsˇ≈t
++ = *(
øw±
+
WIDTH
);

1798 *
	gsˇ≈t
++ = *
øw±
;

1799 *
	gsˇ≈t
++ = *(
øw±
-1);

1803 i‡–(
	gi
 % 2) == 0 ) {

1805 i‡–(
i
 < (
WIDTH
*(
HEIGHT
-1))) && ((i % WIDTH) > 0) ) {

1806 *
sˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1))/2;

1807 *
	gsˇ≈t
++ = *
øw±
;

1808 *
	gsˇ≈t
++ = (*(
øw±
+
WIDTH
)+*(rawpt-WIDTH))/2;

1811 *
	gsˇ≈t
++ = *(
øw±
+1);

1812 *
	gsˇ≈t
++ = *
øw±
;

1813 *
	gsˇ≈t
++ = *(
øw±
-
WIDTH
);

1817 i‡–
	gi
 < (
	gWIDTH
*(
	gHEIGHT
-1)) && ((i % WIDTH) < (WIDTH-1)) ) {

1818 *
	gsˇ≈t
++ = *
øw±
;

1819 *
	gsˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1)+

1820 *(
øw±
-
WIDTH
)+*(rawpt+WIDTH))/4;

1821 *
	gsˇ≈t
++ = (*(
øw±
-
WIDTH
-1)+*(rawpt-WIDTH+1)+

1822 *(
øw±
+
WIDTH
-1)+*(rawpt+WIDTH+1))/4;

1825 *
	gsˇ≈t
++ = *
øw±
;

1826 *
	gsˇ≈t
++ = (*(
øw±
-1)+*‘aw±-
WIDTH
))/2;

1827 *
	gsˇ≈t
++ = *(
øw±
-
WIDTH
-1);

1831 
	gøw±
++;

1841 
sgbrg2rgb24
(
WIDTH
, 
HEIGHT
, *
§c
, *
d°
)

1843 
	gi
;

1844 *
	gøw±
, *
	gsˇ≈t
;

1845 
	gsize
;

1847 
	gøw±
 = 
§c
;

1848 
	gsˇ≈t
 = 
d°
;

1849 
	gsize
 = 
WIDTH
*
HEIGHT
;

1851  
	gi
 = 0; i < 
	gsize
; i++ )

1853 i‡–(
	gi
/
	gWIDTH
) % 2 == 0 )

1855 i‡–(
i
 % 2) == 0 )

1857 i‡–(
i
 > 
WIDTH
) && ((i % WIDTH) > 0) )

1859 *
sˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1))/2;

1860 *
	gsˇ≈t
++ = *(
øw±
);

1861 *
	gsˇ≈t
++ = (*(
øw±
-
WIDTH
) + *(rawpt+WIDTH))/2;

1866 *
	gsˇ≈t
++ = *(
øw±
+1);

1867 *
	gsˇ≈t
++ = *(
øw±
);

1868 *
	gsˇ≈t
++ = *(
øw±
+
WIDTH
);

1872 i‡–(
	gi
 > 
	gWIDTH
) && ((i % WIDTH) < (WIDTH-1)) )

1874 *
	gsˇ≈t
++ = *(
øw±
);

1875 *
	gsˇ≈t
++ = (*(
øw±
-1)+*‘aw±+1)+*‘aw±-
WIDTH
)+*(rawpt+WIDTH))/4;

1876 *
	gsˇ≈t
++ = (*(
øw±
-
WIDTH
-1) + *(rawpt-WIDTH+1) + *(rawpt+WIDTH-1) + *(rawpt+WIDTH+1))/4;

1881 *
	gsˇ≈t
++ = *(
øw±
);

1882 *
	gsˇ≈t
++ = (*(
øw±
-1)+*‘aw±+
WIDTH
))/2;

1883 *
	gsˇ≈t
++ = *(
øw±
+
WIDTH
-1);

1888 i‡–(
	gi
 % 2) == 0 )

1890 i‡–(
i
 < (
WIDTH
*(
HEIGHT
-1))) && ((i % WIDTH) > 0) )

1892 *
sˇ≈t
++ = (*(
øw±
-
WIDTH
-1)+*(rawpt-WIDTH+1)+*(rawpt+WIDTH-1)+*(rawpt+WIDTH+1))/4;

1893 *
	gsˇ≈t
++ = (*(
øw±
-1)+*‘aw±+1)+*‘aw±-
WIDTH
)+*(rawpt+WIDTH))/4;

1894 *
	gsˇ≈t
++ = *(
øw±
);

1899 *
	gsˇ≈t
++ = *(
øw±
-
WIDTH
+1);

1900 *
	gsˇ≈t
++ = (*(
øw±
+1)+*‘aw±-
WIDTH
))/2;

1901 *
	gsˇ≈t
++ = *(
øw±
);

1905 i‡–
	gi
 < (
	gWIDTH
*(
	gHEIGHT
-1)) && ((i % WIDTH) < (WIDTH-1)) )

1907 *
	gsˇ≈t
++ = (*(
øw±
-
WIDTH
)+*(rawpt+WIDTH))/2;

1908 *
	gsˇ≈t
++ = *(
øw±
);

1909 *
	gsˇ≈t
++ = (*(
øw±
-1)+*(rawpt+1))/2;

1914 *
	gsˇ≈t
++ = (*(
øw±
-
WIDTH
));

1915 *
	gsˇ≈t
++ = *(
øw±
);

1916 *
	gsˇ≈t
++ = (*(
øw±
-1));

1920 
	gøw±
++;

1925 
rgb24_to_rgb24
 (
width
, 
height
, *
§c
, *
d°
)

1927 c⁄° 
	gsize
 = 
width
 * 
height
;

1928 
	gi
 = 0; i < 
	gsize
; ++i, 
	g§c
 +3, 
	gd°
 += 3)

1930 *(
d°
 + 0Ë*(
§c
 + 2);

1931 *(
	gd°
 + 1Ë*(
§c
 + 1);

1932 *(
	gd°
 + 2Ë*(
§c
 + 0);

1936 
	#CLAMP
(
x
Ë((x)<0?0:((x)>255)?255:(x))

	)

1939 
	gis_abs
;

1940 
	gÀn
;

1941 
	gvÆ
;

1942 } 
	tcode_èbÀ_t
;

1946 
code_èbÀ_t
 
	gèbÀ
[256];

1947 
	göô_d⁄e
 = 0;

1959 
s⁄ix_decom¥ess_öô
()

1961 
	gi
;

1962 
	gis_abs
, 
	gvÆ
, 
	gÀn
;

1964 
	gi
 = 0; i < 256; i++) {

1965 
	gis_abs
 = 0;

1966 
	gvÆ
 = 0;

1967 
	gÀn
 = 0;

1968 i‡((
	gi
 & 0x80) == 0) {

1970 
vÆ
 = 0;

1971 
	gÀn
 = 1;

1973 i‡((
	gi
 & 0xE0) == 0x80) {

1975 
vÆ
 = +4;

1976 
	gÀn
 = 3;

1978 i‡((
	gi
 & 0xE0) == 0xA0) {

1980 
vÆ
 = -4;

1981 
	gÀn
 = 3;

1983 i‡((
	gi
 & 0xF0) == 0xD0) {

1985 
vÆ
 = +11;

1986 
	gÀn
 = 4;

1988 i‡((
	gi
 & 0xF0) == 0xF0) {

1990 
vÆ
 = -11;

1991 
	gÀn
 = 4;

1993 i‡((
	gi
 & 0xF8) == 0xC8) {

1995 
vÆ
 = +20;

1996 
	gÀn
 = 5;

1998 i‡((
	gi
 & 0xFC) == 0xC0) {

2000 
vÆ
 = -20;

2001 
	gÀn
 = 6;

2003 i‡((
	gi
 & 0xFC) == 0xC4) {

2005 
vÆ
 = 0;

2006 
	gÀn
 = 8;

2008 i‡((
	gi
 & 0xF0) == 0xE0) {

2010 
is_abs
 = 1;

2011 
	gvÆ
 = (
i
 & 0x0F) << 4;

2012 
	gÀn
 = 8;

2014 
	gèbÀ
[
i
].
	gis_abs
 = 
is_abs
;

2015 
	gèbÀ
[
i
].
	gvÆ
 = 
vÆ
;

2016 
	gèbÀ
[
i
].
	gÀn
 = 
Àn
;

2019 
	göô_d⁄e
 = 1;

2037 
s⁄ix_decom¥ess
(
width
, 
height
, *
öp
, *
ouç
)

2039 
	grow
, 
	gcﬁ
;

2040 
	gvÆ
;

2041 
	gbôpos
;

2042 
	gcode
;

2043 *
	gaddr
;

2045 i‡(!
	göô_d⁄e
) {

2050 
	gbôpos
 = 0;

2051 
	grow
 = 0;Ñow < 
	gheight
;Ñow++) {

2053 
	gcﬁ
 = 0;

2058 i‡(
	grow
 < 2) {

2059 
	gaddr
 = 
öp
 + (
bôpos
 >> 3);

2060 
	gcode
 = (
addr
[0] << (
bôpos
 & 7)) | (addr[1] >> (8 - (bitpos & 7)));

2061 
	gbôpos
 += 8;

2062 *
	gouç
++ = 
code
;

2064 
	gaddr
 = 
öp
 + (
bôpos
 >> 3);

2065 
	gcode
 = (
addr
[0] << (
bôpos
 & 7)) | (addr[1] >> (8 - (bitpos & 7)));

2066 
	gbôpos
 += 8;

2067 *
	gouç
++ = 
code
;

2069 
	gcﬁ
 += 2;

2072 
	gcﬁ
 < 
	gwidth
) {

2074 
	gaddr
 = 
öp
 + (
bôpos
 >> 3);

2075 
	gcode
 = (
addr
[0] << (
bôpos
 & 7)) | (addr[1] >> (8 - (bitpos & 7)));

2078 
	gbôpos
 +
èbÀ
[
code
].
Àn
;

2081 
	gvÆ
 = 
èbÀ
[
code
].
vÆ
;

2082 i‡(!
	gèbÀ
[
code
].
	gis_abs
) {

2084 i‡(
	gcﬁ
 < 2) {

2086 
	gvÆ
 +
ouç
[-2*
width
];

2088 i‡(
	grow
 < 2) {

2090 
	gvÆ
 +
ouç
[-2];

2094 
	gvÆ
 +(
ouç
[-2] + ouç[-2*
width
]) / 2;

2099 *
	gouç
++ = 
CLAMP
(
vÆ
);

2100 
	gcﬁ
++;

2108 
I∂Image
* 
icvRërõveFømeCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, ) {

2110 #ifde‡
HAVE_CAMV4L2


2111 i‡(
	gV4L2_SUPPORT
 == 0)

2113 #ifde‡
HAVE_CAMV4L


2117 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSYNC
, &ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
].
‰ame
) == -1) {

2118 
Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L: CouldÇŸ SYNCÅÿvideÿ°ªam. %s\n", 
°ªº‹
(
î∫o
));

2128 #ifde‡
HAVE_CAMV4L2


2130 i‡(
	gV4L2_SUPPORT
 == 1)

2133 if((()
ˇ±uª
->
‰ame
.
width
 !ˇ±uª->
f‹m
.
fmt
.
pix
.width)

2134 || (()
ˇ±uª
->
‰ame
.
height
 !ˇ±uª->
f‹m
.
fmt
.
pix
.height)) {

2135 
cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

2136 
cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

2137 
cvSize
–
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2138 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
 ),

2139 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_TL
, 4 );

2140 
	gˇ±uª
->
	g‰ame
.
	gimageD©a
 = (*)
cvAŒoc
(
ˇ±uª
->
‰ame
.
imageSize
);

2145 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2148 #ifde‡
HAVE_CAMV4L


2151 if((
	gˇ±uª
->
	g‰ame
.
	gwidth
 !
ˇ±uª
->
mm≠s
[ˇ±uª->
buf„rIndex
].
width
)

2152 || (
ˇ±uª
->
‰ame
.
height
 !ˇ±uª->
mm≠s
[ˇ±uª->
buf„rIndex
].height)) {

2153 
cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

2154 
cvInôImageHódî
–&
ˇ±uª
->
‰ame
,

2155 
cvSize
–
ˇ±uª
->
ˇ±uªWödow
.
width
,

2156 
ˇ±uª
->
ˇ±uªWödow
.
height
 ),

2157 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_TL
, 4 );

2158 
	gˇ±uª
->
	g‰ame
.
	gimageD©a
 = (*)
cvAŒoc
(
ˇ±uª
->
‰ame
.
imageSize
);

2164 #ifde‡
HAVE_CAMV4L2


2166 i‡(
	gV4L2_SUPPORT
 == 1)

2168 
ˇ±uª
->
∑Àâe
)

2170 
PALETTE_BGR24
:

2171 
mem˝y
((*)
ˇ±uª
->
‰ame
.
imageD©a
,

2172 (*)
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
,

2173 
ˇ±uª
->
‰ame
.
imageSize
);

2176 
	gPALETTE_YVU420
:

2177 
yuv420p_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2178 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2179 (*)(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
),

2180 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2183 
	gPALETTE_YUV411P
:

2184 
yuv411p_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2185 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2186 (*)(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
),

2187 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2189 #ifde‡
HAVE_JPEG


2190 
	gPALETTE_MJPEG
:

2191 i‡(!
mj≥g_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2192 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2193 (*)(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
]

2194 .
°¨t
),

2195 
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
Àngth
,

2196 (*)
ˇ±uª
->
‰ame
.
imageD©a
))

2201 
	gPALETTE_YUYV
:

2202 
yuyv_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2203 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2204 (*)(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
),

2205 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2207 
	gPALETTE_UYVY
:

2208 
uyvy_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2209 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2210 (*)(
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
),

2211 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2213 
	gPALETTE_SBGGR8
:

2214 
bayî2rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2215 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2216 (*)
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
,

2217 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2220 
	gPALETTE_SN9C10X
:

2221 
s⁄ix_decom¥ess_öô
();

2222 
s⁄ix_decom¥ess
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2223 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2224 (*)
ˇ±uª
->
buf„rs
[ˇ±uª->
buf„rIndex
].
°¨t
,

2225 (*)
ˇ±uª
->
buf„rs
[(ˇ±uª->
buf„rIndex
+1Ë% c≠tuª->
ªq
.
cou¡
].
°¨t
);

2227 
bayî2rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2228 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2229 (*)
ˇ±uª
->
buf„rs
[(ˇ±uª->
buf„rIndex
+1Ë% c≠tuª->
ªq
.
cou¡
].
°¨t
,

2230 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2233 
	gPALETTE_SGBRG
:

2234 
sgbrg2rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2235 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2236 (*)
ˇ±uª
->
buf„rs
[(ˇ±uª->
buf„rIndex
+1Ë% c≠tuª->
ªq
.
cou¡
].
°¨t
,

2237 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2239 
	gPALETTE_RGB24
:

2240 
rgb24_to_rgb24
(
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
,

2241 
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
,

2242 (*)
ˇ±uª
->
buf„rs
[(ˇ±uª->
buf„rIndex
+1Ë% c≠tuª->
ªq
.
cou¡
].
°¨t
,

2243 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2248 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2251 #ifde‡
HAVE_CAMV4L


2254 
	gˇ±uª
->
	gimagePr›îtõs
.
	g∑Àâe
)

2256 
	gVIDEO_PALETTE_RGB24
:

2257 
mem˝y
((*)
ˇ±uª
->
‰ame
.
imageD©a
,

2258 (*)(
ˇ±uª
->
mem‹yM≠
 + c≠tuª->
mem‹yBuf„r
.
off£ts
[ˇ±uª->
buf„rIndex
]),

2259 
ˇ±uª
->
‰ame
.
imageSize
);

2261 
	gVIDEO_PALETTE_YUV420P
:

2262 
yuv420p_to_rgb24
(
ˇ±uª
->
ˇ±uªWödow
.
width
,

2263 
ˇ±uª
->
ˇ±uªWödow
.
height
,

2264 (*)(
ˇ±uª
->
mem‹yM≠
 + c≠tuª->
mem‹yBuf„r
.
off£ts
[ˇ±uª->
buf„rIndex
]),

2265 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2267 
	gVIDEO_PALETTE_YUV420
:

2268 
yuv420_to_rgb24
(
ˇ±uª
->
ˇ±uªWödow
.
width
,

2269 
ˇ±uª
->
ˇ±uªWödow
.
height
,

2270 (*)(
ˇ±uª
->
mem‹yM≠
 + c≠tuª->
mem‹yBuf„r
.
off£ts
[ˇ±uª->
buf„rIndex
]),

2271 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2273 
	gVIDEO_PALETTE_YUV411P
:

2274 
yuv411p_to_rgb24
(
ˇ±uª
->
ˇ±uªWödow
.
width
,

2275 
ˇ±uª
->
ˇ±uªWödow
.
height
,

2276 (*)(
ˇ±uª
->
mem‹yM≠
 + c≠tuª->
mem‹yBuf„r
.
off£ts
[ˇ±uª->
buf„rIndex
]),

2277 (*)
ˇ±uª
->
‰ame
.
imageD©a
);

2280 
Ârötf
–
°dîr
,

2282 
ˇ±uª
->
imagePr›îtõs
.
∑Àâe
);

2290 (&
	gˇ±uª
->
	g‰ame
);

2293 
icvGëPr›îtyCAM_V4L
 (
CvC≠tuªCAM_V4L
* 
ˇ±uª
,

2294 
¥›îty_id
 ) {

2296 #ifde‡
HAVE_CAMV4L2


2298 #ifde‡
HAVE_CAMV4L


2299 i‡(
	gV4L2_SUPPORT
 == 1)

2304 
v4l2_mö
 = 0;

2305 
	gv4l2_max
 = 255;

2307 
CLEAR
 (
ˇ±uª
->
f‹m
);

2308 
	gˇ±uª
->
	gf‹m
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2309 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
)) {

2311 
≥º‹
 ("VIDIOC_G_FMT");

2315 
	g¥›îty_id
) {

2316 
	gCV_CAP_PROP_FRAME_WIDTH
:

2317  
ˇ±uª
->
f‹m
.
fmt
.
pix
.
width
;

2318 
	gCV_CAP_PROP_FRAME_HEIGHT
:

2319  
ˇ±uª
->
f‹m
.
fmt
.
pix
.
height
;

2324 
	g¥›îty_id
) {

2325 
	gCV_CAP_PROP_POS_MSEC
:

2326 i‡(
ˇ±uª
->
Fú°C≠tuª
) {

2329  1000 * 
	gˇ±uª
->
	gtime°amp
.
	gtv_£c
 + ((Ëˇ±uª->time°amp.
	gtv_u£c
) / 1000;

2332 
	gCV_CAP_PROP_BRIGHTNESS
:

2333 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_BRIGHTNESS
;

2335 
	gCV_CAP_PROP_CONTRAST
:

2336 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_CONTRAST
;

2338 
	gCV_CAP_PROP_SATURATION
:

2339 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_SATURATION
;

2341 
	gCV_CAP_PROP_HUE
:

2342 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_HUE
;

2344 
	gCV_CAP_PROP_GAIN
:

2345 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_GAIN
;

2347 
	gCV_CAP_PROP_EXPOSURE
:

2348 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_EXPOSURE
;

2351 
Ârötf
(
°dîr
,

2353 
¥›îty_id
);

2357 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_CTRL
,

2358 &
ˇ±uª
->
c⁄åﬁ
)) {

2360 
Ârötf
–
°dîr
, "VIDEOIO ERROR: V4L2: ");

2361 
	g¥›îty_id
) {

2362 
	gCV_CAP_PROP_BRIGHTNESS
:

2363 
Ârötf
 (
°dîr
, "Brightness");

2365 
	gCV_CAP_PROP_CONTRAST
:

2366 
Ârötf
 (
°dîr
, "Contrast");

2368 
	gCV_CAP_PROP_SATURATION
:

2369 
Ârötf
 (
°dîr
, "Saturation");

2371 
	gCV_CAP_PROP_HUE
:

2372 
Ârötf
 (
°dîr
, "Hue");

2374 
	gCV_CAP_PROP_GAIN
:

2375 
Ârötf
 (
°dîr
, "Gain");

2377 
	gCV_CAP_PROP_EXPOSURE
:

2378 
Ârötf
 (
°dîr
, "Exposure");

2381 
Ârötf
 (
°dîr
, " isÇot supported by your device\n");

2387 
	g¥›îty_id
) {

2389 
	gCV_CAP_PROP_BRIGHTNESS
:

2390 
v4l2_mö
 = 
ˇ±uª
->
v4l2_brighäess_mö
;

2391 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_brighäess_max
;

2393 
	gCV_CAP_PROP_CONTRAST
:

2394 
v4l2_mö
 = 
ˇ±uª
->
v4l2_c⁄åa°_mö
;

2395 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_c⁄åa°_max
;

2397 
	gCV_CAP_PROP_SATURATION
:

2398 
v4l2_mö
 = 
ˇ±uª
->
v4l2_ßtuøti⁄_mö
;

2399 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_ßtuøti⁄_max
;

2401 
	gCV_CAP_PROP_HUE
:

2402 
v4l2_mö
 = 
ˇ±uª
->
v4l2_hue_mö
;

2403 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_hue_max
;

2405 
	gCV_CAP_PROP_GAIN
:

2406 
v4l2_mö
 = 
ˇ±uª
->
v4l2_gaö_mö
;

2407 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_gaö_max
;

2409 
	gCV_CAP_PROP_EXPOSURE
:

2410 
v4l2_mö
 = 
ˇ±uª
->
v4l2_exposuª_mö
;

2411 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_exposuª_max
;

2416  (()
	gˇ±uª
->
	gc⁄åﬁ
.
	gvÆue
 - 
	gv4l2_mö
 + 1Ë/ (
	gv4l2_max
 - v4l2_min);

2420 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2423 #ifde‡
HAVE_CAMV4L


2426 
	gªtvÆ
 = -1;

2428 i‡(
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
,

2429 
VIDIOCGWIN
, &
ˇ±uª
->
ˇ±uªWödow
) < 0) {

2430 
Ârötf
 (
°dîr
,

2433 
icvClo£CAM_V4L
(
ˇ±uª
);

2437 
	g¥›îty_id
) {

2438 
	gCV_CAP_PROP_FRAME_WIDTH
:

2439 
ªtvÆ
 = 
ˇ±uª
->
ˇ±uªWödow
.
width
;

2441 
	gCV_CAP_PROP_FRAME_HEIGHT
:

2442 
ªtvÆ
 = 
ˇ±uª
->
ˇ±uªWödow
.
height
;

2444 
	gCV_CAP_PROP_BRIGHTNESS
:

2445 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
brighäess
;

2447 
	gCV_CAP_PROP_CONTRAST
:

2448 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
c⁄åa°
;

2450 
	gCV_CAP_PROP_SATURATION
:

2451 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
cﬁour
;

2453 
	gCV_CAP_PROP_HUE
:

2454 
ªtvÆ
 = 
ˇ±uª
->
imagePr›îtõs
.
hue
;

2456 
	gCV_CAP_PROP_GAIN
:

2457 
Ârötf
(
°dîr
,

2461 
	gCV_CAP_PROP_EXPOSURE
:

2462 
Ârötf
(
°dîr
,

2467 
Ârötf
(
°dîr
,

2469 
¥›îty_id
);

2472 i‡(
	gªtvÆ
 == -1) {

2478  (
	gªtvÆ
) / 0xFFFF;

2485 
icvSëVideoSize
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
, 
w
, 
h
) {

2487 #ifde‡
HAVE_CAMV4L2


2489 i‡(
	gV4L2_SUPPORT
 == 1)

2492 
CLEAR
 (
ˇ±uª
->
¸›ˇp
);

2493 
	gˇ±uª
->
	g¸›ˇp
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2495 i‡(
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_CROPCAP
, &ˇ±uª->
¸›ˇp
) < 0) {

2496 
Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L/V4L2: VIDIOC_CROPCAP\n");

2499 
CLEAR
 (
ˇ±uª
->
¸›
);

2500 
	gˇ±uª
->
	g¸›
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2501 
	gˇ±uª
->
	g¸›
.
	gc

ˇ±uª
->
¸›ˇp
.
de‰e˘
;

2504 i‡(
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_CROP
, &ˇ±uª->
¸›
) < 0) {

2505 
Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L/V4L2: VIDIOC_S_CROP\n");

2509 
CLEAR
 (
ˇ±uª
->
f‹m
);

2510 
	gˇ±uª
->
	gf‹m
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2513 
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
);

2516 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gpix
.
	gwidth
 = 
w
;

2517 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gpix
.
	gheight
 = 
h
;

2518 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gwö
.
	gchromakey
 = 0;

2519 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gwö
.
	gfõld
 = 
V4L2_FIELD_ANY
;

2520 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gwö
.
	g˛ùs
 = 0;

2521 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gwö
.
	g˛ùcou¡
 = 0;

2522 
	gˇ±uª
->
	gf‹m
.
	gfmt
.
	gpix
.
	gfõld
 = 
V4L2_FIELD_ANY
;

2528 
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_FMT
, &ˇ±uª->
f‹m
);

2531 
v4l2_°ªam∑rm
 
	g£tÂs
;

2532 
mem£t
 (&
£tÂs
, 0, (
v4l2_°ªam∑rm
));

2533 
	g£tÂs
.
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2534 
	g£tÂs
.
	g∑rm
.
	gˇ±uª
.
	gtimïî‰ame
.
	gnumî©‹
 = 1;

2535 
	g£tÂs
.
	g∑rm
.
	gˇ±uª
.
	gtimïî‰ame
.
	gdíomö©‹
 = 30;

2536 
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_S_PARM
, &
£tÂs
);

2540 
	gˇ±uª
->
	gFú°C≠tuª
 = 1;

2543 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_G_FMT
, &ˇ±uª->
f‹m
))

2545 
Ârötf
(
°dîr
, "VIDEOIO ERROR: V4L/V4L2: CouldÇot obtain specifics of capture window.\n\n");

2547 
icvClo£CAM_V4L
(
ˇ±uª
);

2556 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2559 #ifde‡
HAVE_CAMV4L


2562 i‡(
	gˇ±uª
==0)  0;

2563 i‡(
	gw
>
	gˇ±uª
->
	gˇ∑bûôy
.
	gmaxwidth
) {

2564 
	gw
=
ˇ±uª
->
ˇ∑bûôy
.
maxwidth
;

2566 i‡(
	gh
>
	gˇ±uª
->
	gˇ∑bûôy
.
	gmaxheight
) {

2567 
	gh
=
ˇ±uª
->
ˇ∑bûôy
.
maxheight
;

2570 
	gˇ±uª
->
	gˇ±uªWödow
.
	gwidth
=
w
;

2571 
	gˇ±uª
->
	gˇ±uªWödow
.
	gheight
=
h
;

2573 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSWIN
, &ˇ±uª->
ˇ±uªWödow
) < 0) {

2574 
icvClo£CAM_V4L
(
ˇ±uª
);

2578 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCGWIN
, &ˇ±uª->
ˇ±uªWödow
) < 0) {

2579 
icvClo£CAM_V4L
(
ˇ±uª
);

2583 
	gˇ±uª
->
	gFú°C≠tuª
 = 1;

2592 
icvSëC⁄åﬁ
 (
CvC≠tuªCAM_V4L
* 
ˇ±uª
,

2593 
¥›îty_id
, 
vÆue
) {

2596 i‡(
	gvÆue
 < 0.0) {

2597 
	gvÆue
 = 0.0;

2598 } i‡(
	gvÆue
 > 1.0) {

2599 
	gvÆue
 = 1.0;

2602 #ifde‡
HAVE_CAMV4L2


2604 i‡(
	gV4L2_SUPPORT
 == 1)

2608 
v4l2_mö
 = 0;

2609 
	gv4l2_max
 = 255;

2612 
CLEAR
 (
ˇ±uª
->
c⁄åﬁ
);

2615 
	g¥›îty_id
) {

2617 
	gCV_CAP_PROP_BRIGHTNESS
:

2618 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_BRIGHTNESS
;

2620 
	gCV_CAP_PROP_CONTRAST
:

2621 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_CONTRAST
;

2623 
	gCV_CAP_PROP_SATURATION
:

2624 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_SATURATION
;

2626 
	gCV_CAP_PROP_HUE
:

2627 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_HUE
;

2629 
	gCV_CAP_PROP_GAIN
:

2630 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_GAIN
;

2632 
	gCV_CAP_PROP_EXPOSURE
:

2633 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_EXPOSURE
;

2636 
Ârötf
(
°dîr
,

2638 
¥›îty_id
);

2643 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
,

2644 
VIDIOC_G_CTRL
, &
ˇ±uª
->
c⁄åﬁ
)) {

2650 
	g¥›îty_id
) {

2652 
	gCV_CAP_PROP_BRIGHTNESS
:

2653 
v4l2_mö
 = 
ˇ±uª
->
v4l2_brighäess_mö
;

2654 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_brighäess_max
;

2656 
	gCV_CAP_PROP_CONTRAST
:

2657 
v4l2_mö
 = 
ˇ±uª
->
v4l2_c⁄åa°_mö
;

2658 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_c⁄åa°_max
;

2660 
	gCV_CAP_PROP_SATURATION
:

2661 
v4l2_mö
 = 
ˇ±uª
->
v4l2_ßtuøti⁄_mö
;

2662 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_ßtuøti⁄_max
;

2664 
	gCV_CAP_PROP_HUE
:

2665 
v4l2_mö
 = 
ˇ±uª
->
v4l2_hue_mö
;

2666 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_hue_max
;

2668 
	gCV_CAP_PROP_GAIN
:

2669 
v4l2_mö
 = 
ˇ±uª
->
v4l2_gaö_mö
;

2670 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_gaö_max
;

2672 
	gCV_CAP_PROP_EXPOSURE
:

2673 
v4l2_mö
 = 
ˇ±uª
->
v4l2_exposuª_mö
;

2674 
	gv4l2_max
 = 
ˇ±uª
->
v4l2_exposuª_max
;

2679 
CLEAR
 (
ˇ±uª
->
c⁄åﬁ
);

2682 
	g¥›îty_id
) {

2684 
	gCV_CAP_PROP_BRIGHTNESS
:

2685 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_BRIGHTNESS
;

2687 
	gCV_CAP_PROP_CONTRAST
:

2688 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_CONTRAST
;

2690 
	gCV_CAP_PROP_SATURATION
:

2691 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_SATURATION
;

2693 
	gCV_CAP_PROP_HUE
:

2694 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_HUE
;

2696 
	gCV_CAP_PROP_GAIN
:

2697 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_GAIN
;

2699 
	gCV_CAP_PROP_EXPOSURE
:

2700 
ˇ±uª
->
c⁄åﬁ
.
id
 = 
V4L2_CID_EXPOSURE
;

2703 
Ârötf
(
°dîr
,

2705 
¥›îty_id
);

2710 
	gˇ±uª
->
	gc⁄åﬁ
.
	gvÆue
 = ()(
vÆue
 * (
v4l2_max
 - 
v4l2_mö
) + v4l2_min);

2713 i‡(-1 =
io˘l
 (
ˇ±uª
->
devi˚H™dÀ
,

2714 
VIDIOC_S_CTRL
, &
ˇ±uª
->
c⁄åﬁ
Ë&& 
	gî∫o
 !
ERANGE
) {

2715 
≥º‹
 ("VIDIOC_S_CTRL");

2720 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2723 #ifde‡
HAVE_CAMV4L


2726 
	gv4l_vÆue
;

2729 
	gv4l_vÆue
 = ()(0xFFFF * 
vÆue
);

2731 
	g¥›îty_id
) {

2732 
	gCV_CAP_PROP_BRIGHTNESS
:

2733 
ˇ±uª
->
imagePr›îtõs
.
brighäess
 = 
v4l_vÆue
;

2735 
	gCV_CAP_PROP_CONTRAST
:

2736 
ˇ±uª
->
imagePr›îtõs
.
c⁄åa°
 = 
v4l_vÆue
;

2738 
	gCV_CAP_PROP_SATURATION
:

2739 
ˇ±uª
->
imagePr›îtõs
.
cﬁour
 = 
v4l_vÆue
;

2741 
	gCV_CAP_PROP_HUE
:

2742 
ˇ±uª
->
imagePr›îtõs
.
hue
 = 
v4l_vÆue
;

2744 
	gCV_CAP_PROP_GAIN
:

2745 
Ârötf
(
°dîr
,

2748 
	gCV_CAP_PROP_EXPOSURE
:

2749 
Ârötf
(
°dîr
,

2753 
Ârötf
(
°dîr
,

2755 
¥›îty_id
);

2759 i‡(
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOCSPICT
, &ˇ±uª->
imagePr›îtõs
)

2762 
Ârötf
(
°dîr
,

2764 
icvClo£CAM_V4L
(
ˇ±uª
);

2775 
icvSëPr›îtyCAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
,

2776 
¥›îty_id
, 
vÆue
 ){

2777 
	gwidth
 = 0, 
	gheight
 = 0;

2778 
	gªtvÆ
;

2781 
	gªtvÆ
 = 0;

2787 
	g¥›îty_id
) {

2788 
	gCV_CAP_PROP_FRAME_WIDTH
:

2789 
width
 = 
cvRound
(
vÆue
);

2790 if(
	gwidth
 !=0 && 
height
 != 0) {

2791 
ªtvÆ
 = 
icvSëVideoSize
–
ˇ±uª
, 
width
, 
height
);

2792 
	gwidth
 = 
height
 = 0;

2795 
	gCV_CAP_PROP_FRAME_HEIGHT
:

2796 
height
 = 
cvRound
(
vÆue
);

2797 if(
	gwidth
 !=0 && 
height
 != 0) {

2798 
ªtvÆ
 = 
icvSëVideoSize
–
ˇ±uª
, 
width
, 
height
);

2799 
	gwidth
 = 
height
 = 0;

2802 
	gCV_CAP_PROP_BRIGHTNESS
:

2803 
CV_CAP_PROP_CONTRAST
:

2804 
CV_CAP_PROP_SATURATION
:

2805 
CV_CAP_PROP_HUE
:

2806 
CV_CAP_PROP_GAIN
:

2807 
CV_CAP_PROP_EXPOSURE
:

2808 
ªtvÆ
 = 
icvSëC⁄åﬁ
(
ˇ±uª
, 
¥›îty_id
, 
vÆue
);

2811 
Ârötf
(
°dîr
,

2813 
¥›îty_id
);

2817  
	gªtvÆ
;

2820 
icvClo£CAM_V4L
–
CvC≠tuªCAM_V4L
* 
ˇ±uª
 ){

2823 i‡(
	gˇ±uª
)

2826 #ifde‡
HAVE_CAMV4L2


2827 i‡(
	gV4L2_SUPPORT
 == 0)

2829 #ifde‡
HAVE_CAMV4L


2832 i‡(
ˇ±uª
->
mm≠s
)

2833 
‰ì
(
ˇ±uª
->
mm≠s
);

2834 i‡(
	gˇ±uª
->
	gmem‹yM≠
)

2835 
munm≠
(
ˇ±uª
->
mem‹yM≠
, c≠tuª->
mem‹yBuf„r
.
size
);

2839 #i‡
deföed
(
HAVE_CAMV4L
Ë&& deföed(
HAVE_CAMV4L2
)

2842 #ifde‡
HAVE_CAMV4L2


2844 
	gˇ±uª
->
	gty≥
 = 
V4L2_BUF_TYPE_VIDEO_CAPTURE
;

2845 i‡(-1 =
io˘l
(
ˇ±uª
->
devi˚H™dÀ
, 
VIDIOC_STREAMOFF
, &ˇ±uª->
ty≥
)) {

2846 
≥º‹
 ("UnableÅo stopÅhe stream.");

2849 
	gn_buf„rs_
 = 0;Ç_buf„rs_ < 
	gˇ±uª
->
	gªq
.
	gcou¡
; ++n_buffers_)

2851 i‡(-1 =
munm≠
 (
ˇ±uª
->
buf„rs
[
n_buf„rs_
].
°¨t
, c≠tuª->buf„rs[n_buf„rs_].
Àngth
)) {

2852 
≥º‹
 ("munmap");

2856 i‡(
	gˇ±uª
->
	gbuf„rs
[
MAX_V4L_BUFFERS
].
	g°¨t
)

2858 
‰ì
(
ˇ±uª
->
buf„rs
[
MAX_V4L_BUFFERS
].
°¨t
);

2859 
	gˇ±uª
->
	gbuf„rs
[
MAX_V4L_BUFFERS
].
	g°¨t
 = 0;

2864 i‡(
	gˇ±uª
->
	gdevi˚H™dÀ
 != -1)

2865 
˛o£
(
ˇ±uª
->
devi˚H™dÀ
);

2867 i‡(
	gˇ±uª
->
	g‰ame
.
	gimageD©a
Ë
cvFªe
(&
ˇ±uª
->
‰ame
.
imageD©a
);

2873 ˛as†
	cCvC≠tuªCAM_V4L_CPP
 : 
CvC≠tuª


2875 
public
:

2876 
CvC≠tuªCAM_V4L_CPP
(Ë{ 
ˇ±uªV4L
 = 0; }

2877 
	gvútuÆ
 ~
CvC≠tuªCAM_V4L_CPP
(Ë{ 
˛o£
(); }

2879 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

2880 
vútuÆ
 
˛o£
();

2882 
vútuÆ
 
gëPr›îty
() const;

2883 
vútuÆ
 
boﬁ
 
£tPr›îty
(, );

2884 
vútuÆ
 
boﬁ
 
gøbFøme
();

2885 
vútuÆ
 
I∂Image
* 
ªåõveFøme
();

2886 
	g¥Ÿe˘ed
:

2888 
CvC≠tuªCAM_V4L
* 
ˇ±uªV4L
;

2891 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$›í
–
ödex
 )

2893 
	`˛o£
();

2894 
ˇ±uªV4L
 = 
	`icvC≠tuªFromCAM_V4L
(
ödex
);

2895  
ˇ±uªV4L
 != 0;

2896 
	}
}

2898 
	gCvC≠tuªCAM_V4L_CPP
::
	$˛o£
()

2900 if–
ˇ±uªV4L
 )

2902 
	`icvClo£CAM_V4L
–
ˇ±uªV4L
 );

2903 
	`cvFªe
–&
ˇ±uªV4L
 );

2905 
	}
}

2907 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$gøbFøme
()

2909  
ˇ±uªV4L
 ? 
	`icvGøbFømeCAM_V4L
–ˇ±uªV4L ) !0 : 
Ál£
;

2910 
	}
}

2912 
I∂Image
* 
	gCvC≠tuªCAM_V4L_CPP
::
	$ªåõveFøme
()

2914  
ˇ±uªV4L
 ? 
	`icvRërõveFømeCAM_V4L
( captureV4L, 0 ) : 0;

2915 
	}
}

2917 
	gCvC≠tuªCAM_V4L_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

2919  
ˇ±uªV4L
 ? 
	`icvGëPr›îtyCAM_V4L
–ˇ±uªV4L, 
¥›Id
 ) : 0.0;

2920 
	}
}

2922 
boﬁ
 
	gCvC≠tuªCAM_V4L_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

2924  
ˇ±uªV4L
 ? 
	`icvSëPr›îtyCAM_V4L
–ˇ±uªV4L, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

2925 
	}
}

2927 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_V4L
–
ödex
 )

2929 
CvC≠tuªCAM_V4L_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_V4L_CPP;

2931 if–
ˇ±uª
->
	`›í
–
ödex
 ))

2932  (
CvC≠tuª
*)
ˇ±uª
;

2934 
dñëe
 
ˇ±uª
;

2936 
	}
}

	@src/cap_vfw.cpp

42 
	~"¥ecomp.hµ
"

44 
	~<vfw.h
>

46 #ifde‡
__GNUC__


47 
	#WM_CAP_FIRSTA
 (
WM_USER
)

	)

48 
	#ˇpSídMesßge
(
hwnd
,
m
,
w
,
l
Ë(
	`IsWödow
(hwnd)?
	`SídMesßge
(hwnd,m,w,l):0)

	)

51 #i‡
deföed
 
_M_X64
 && deföed 
_MSC_VER


52 #¥agm®
›timize
("",
off
)

53 #¥agm®
w¨nög
(
dißbÀ
: 4748)

58 
BITMAPINFOHEADER
 
	$icvBôm≠Hódî
–
width
, 
height
, 
bµ
, 
com¥essi⁄
 = 
BI_RGB
 )

60 
BITMAPINFOHEADER
 
bmih
;

61 
	`mem£t
–&
bmih
, 0, (bmih));

62 
bmih
.
biSize
 = (bmih);

63 
bmih
.
biWidth
 = 
width
;

64 
bmih
.
biHeight
 = 
height
;

65 
bmih
.
biBôCou¡
 = (
WORD
)
bµ
;

66 
bmih
.
biCom¥essi⁄
 = 
com¥essi⁄
;

67 
bmih
.
biPœ√s
 = 1;

69  
bmih
;

70 
	}
}

73 
	$icvInôC≠tuª_VFW
()

75 
isInôülized
 = 0;

76 if–!
isInôülized
 )

78 
	`AVIFûeInô
();

79 
isInôülized
 = 1;

81 
	}
}

84 ˛as†
	cCvC≠tuªAVI_VFW
 : 
public
 
CvC≠tuª


86 
public
:

87 
	$CvC≠tuªAVI_VFW
()

89 
	`CoInôülize
(
NULL
);

90 
	`öô
();

93 
vútuÆ
 ~
	$CvC≠tuªAVI_VFW
()

95 
	`˛o£
();

96 
	`CoUnöôülize
();

97 
	}
}

99 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
 );

100 
vútuÆ
 
˛o£
();

102 
vútuÆ
 
	$gëPr›îty
() const;

103 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

104 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

105 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

106 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_VFW
; 
	}
}

108 
	g¥Ÿe˘ed
:

109 
öô
();

111 
PAVIFILE
 
	gavifûe
;

112 
PAVISTREAM
 
	gavi°ªam
;

113 
PGETFRAME
 
	ggë‰ame
;

114 
AVISTREAMINFO
 
	gaviöfo
;

115 
BITMAPINFOHEADER
 * 
	gbmih
;

116 
CvSli˚
 
	gfûm_ønge
;

117 
	gÂs
;

118 
	gpos
;

119 
I∂Image
* 
	g‰ame
;

120 
CvSize
 
	gsize
;

124 
	gCvC≠tuªAVI_VFW
::
	$öô
()

126 
avifûe
 = 0;

127 
avi°ªam
 = 0;

128 
gë‰ame
 = 0;

129 
	`mem£t
–&
aviöfo
, 0, (aviinfo) );

130 
bmih
 = 0;

131 
fûm_ønge
 = 
	`cvSli˚
(0,0);

132 
Âs
 = 0;

133 
pos
 = 0;

134 
‰ame
 = 0;

135 
size
 = 
	`cvSize
(0,0);

136 
	}
}

139 
	gCvC≠tuªAVI_VFW
::
	$˛o£
()

141 if–
gë‰ame
 )

142 
	`AVISåómGëFømeClo£
–
gë‰ame
 );

144 if–
avi°ªam
 )

145 
	`AVISåómRñó£
–
avi°ªam
 );

147 if–
avifûe
 )

148 
	`AVIFûeRñó£
–
avifûe
 );

150 i‡(
‰ame
)

151 
	`cvRñó£Image
–&
‰ame
 );

153 
	`öô
();

154 
	}
}

157 
boﬁ
 
	gCvC≠tuªAVI_VFW
::
	$›í
–c⁄° * 
fûíame
 )

159 
	`˛o£
();

160 
	`icvInôC≠tuª_VFW
();

162 if–!
fûíame
 )

163  
Ál£
;

165 
HRESULT
 
hr
 = 
	`AVIFûeO≥n
–&
avifûe
, 
fûíame
, 
OF_READ
, 
NULL
 );

166 if–
	`SUCCEEDED
(
hr
))

168 
hr
 = 
	`AVIFûeGëSåóm
–
avifûe
, &
avi°ªam
, 
°ªamty≥VIDEO
, 0 );

169 if–
	`SUCCEEDED
(
hr
))

171 
hr
 = 
	`AVISåómInfo
–
avi°ªam
, &
aviöfo
, (aviinfo));

172 if–
	`SUCCEEDED
(
hr
))

174 
size
.
width
 = 
aviöfo
.
rcFøme
.
right
 -áviöfo.rcFøme.
À·
;

175 
size
.
height
 = 
aviöfo
.
rcFøme
.
bŸtom
 -áviöfo.rcFøme.
t›
;

176 
BITMAPINFOHEADER
 
bmihdr
 = 
	`icvBôm≠Hódî
–
size
.
width
, size.
height
, 24 );

178 
fûm_ønge
.
°¨t_ödex
 = ()
aviöfo
.
dwSèπ
;

179 
fûm_ønge
.
íd_ödex
 = fûm_ønge.
°¨t_ödex
 + ()
aviöfo
.
dwLígth
;

180 
Âs
 = ()
aviöfo
.
dwR©e
/aviöfo.
dwSˇÀ
;

181 
pos
 = 
fûm_ønge
.
°¨t_ödex
;

182 
gë‰ame
 = 
	`AVISåómGëFømeO≥n
–
avi°ªam
, &
bmihdr
 );

183 if–
gë‰ame
 != 0 )

184  
åue
;

187 
bmihdr
 = 
	`icvBôm≠Hódî
–
size
.
width
, size.
height
, 8);

188 
gë‰ame
 = 
	`AVISåómGëFømeO≥n
–
avi°ªam
, &
bmihdr
 );

189 if–
gë‰ame
 != 0 )

190  
åue
;

195 
	`˛o£
();

196  
Ál£
;

197 
	}
}

199 
boﬁ
 
	gCvC≠tuªAVI_VFW
::
	$gøbFøme
()

201 if–
avi°ªam
 )

202 
bmih
 = (
BITMAPINFOHEADER
*)
	`AVISåómGëFøme
–
gë‰ame
, 
pos
++ );

203  
bmih
 != 0;

204 
	}
}

206 
I∂Image
* 
	gCvC≠tuªAVI_VFW
::
	$ªåõveFøme
()

208 if–
avi°ªam
 && 
bmih
 )

210 
boﬁ
 
isCﬁ‹
 = 
bmih
->
biBôCou¡
 == 24;

211 
nCh™√ls
 = (
isCﬁ‹
) ? 3 : 1;

212 
I∂Image
 
§c
;

213 
	`cvInôImageHódî
–&
§c
, 
	`cvSize
–
bmih
->
biWidth
, bmih->
biHeight
 ),

214 
IPL_DEPTH_8U
, 
nCh™√ls
, 
IPL_ORIGIN_BL
, 4 );

216 * 
d©aPå
 = (*)(
bmih
 + 1);

219 i‡(!
isCﬁ‹
)

221 
RGBQUAD_SIZE_PER_BYTE
 = (
RGBQUAD
)/(
BYTE
);

222 
off£tFromCﬁ‹m≠ToD©a
 = ()
bmih
->
biCÃU£d
*
RGBQUAD_SIZE_PER_BYTE
;

223 
d©aPå
 +
off£tFromCﬁ‹m≠ToD©a
;

226 
	`cvSëD©a
–&
§c
, 
d©aPå
, src.
widthSãp
 );

228 if–!
‰ame
 || føme->
width
 !
§c
.width || føme->
height
 != src.height )

230 
	`cvRñó£Image
–&
‰ame
 );

231 
‰ame
 = 
	`cvCª©eImage
–
	`cvGëSize
(&
§c
), 8, 
nCh™√ls
 );

234 
	`cvFlù
–&
§c
, 
‰ame
, 0 );

235  
‰ame
;

239 
	}
}

241 
	gCvC≠tuªAVI_VFW
::
	$gëPr›îty
–
¥›îty_id
 ) const

243  
¥›îty_id
 )

245 
CV_CAP_PROP_POS_MSEC
:

246  
	`cvRound
(
pos
*1000./
Âs
);

247 
CV_CAP_PROP_POS_FRAMES
:

248  
pos
;

249 
CV_CAP_PROP_POS_AVI_RATIO
:

250  (
pos
 - 
fûm_ønge
.
°¨t_ödex
)/

251 (
fûm_ønge
.
íd_ödex
 - fûm_ønge.
°¨t_ödex
 + 1e-10);

252 
CV_CAP_PROP_FRAME_WIDTH
:

253  
size
.
width
;

254 
CV_CAP_PROP_FRAME_HEIGHT
:

255  
size
.
height
;

256 
CV_CAP_PROP_FPS
:

257  
Âs
;

258 
CV_CAP_PROP_FOURCC
:

259  
aviöfo
.
fccH™dÀr
;

260 
CV_CAP_PROP_FRAME_COUNT
:

261  
fûm_ønge
.
íd_ödex
 - fûm_ønge.
°¨t_ödex
;

264 
	}
}

266 
boﬁ
 
	gCvC≠tuªAVI_VFW
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

268  
¥›îty_id
 )

270 
CV_CAP_PROP_POS_MSEC
:

271 
CV_CAP_PROP_POS_FRAMES
:

272 
CV_CAP_PROP_POS_AVI_RATIO
:

274  
¥›îty_id
 )

276 
CV_CAP_PROP_POS_MSEC
:

277 
pos
 = 
	`cvRound
(
vÆue
*
Âs
*0.001);

279 
CV_CAP_PROP_POS_AVI_RATIO
:

280 
pos
 = 
	`cvRound
(
vÆue
*(
fûm_ønge
.
íd_ödex
 -

281 
fûm_ønge
.
°¨t_ödex
) +

282 
fûm_ønge
.
°¨t_ödex
);

285 
pos
 = 
	`cvRound
(
vÆue
);

287 if–
pos
 < 
fûm_ønge
.
°¨t_ödex
 )

288 
pos
 = 
fûm_ønge
.
°¨t_ödex
;

289 if–
pos
 > 
fûm_ønge
.
íd_ödex
 )

290 
pos
 = 
fûm_ønge
.
íd_ödex
;

294  
Ál£
;

297  
åue
;

298 
	}
}

300 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_VFW
 (c⁄° * 
fûíame
)

302 
CvC≠tuªAVI_VFW
* 
ˇ±uª
 = 
√w
 CvCaptureAVI_VFW;

303 if–
ˇ±uª
->
	`›í
(
fûíame
) )

304  
ˇ±uª
;

305 
dñëe
 
ˇ±uª
;

307 
	}
}

312 ˛as†
	cCvC≠tuªCAM_VFW
 : 
public
 
CvC≠tuª


314 
public
:

315 
	$CvC≠tuªCAM_VFW
(Ë{ 
	`öô
(); }

316 
vútuÆ
 ~
	$CvC≠tuªCAM_VFW
(Ë{ 
	`˛o£
(); 
	}
}

318 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

319 
vútuÆ
 
˛o£
();

320 
vútuÆ
 
	$gëPr›îty
() const;

321 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

322 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

323 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

324 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_VFW
; 
	}
}

326 
	g¥Ÿe˘ed
:

327 
öô
();

328 
˛o£HIC
();

329 
LRESULT
 
PASCAL
 
‰ameCÆlback
–
HWND
 
hWnd
, 
VIDEOHDR
* 
hdr
 );

331 
CAPDRIVERCAPS
 
	gˇps
;

332 
HWND
 
	gˇpWnd
;

333 
VIDEOHDR
* 
	ghdr
;

334 
DWORD
 
	gfourcc
;

335 
	gwidth
, 
	gheight
;

336 
	gwidthSë
, 
	gheightSë
;

337 
HIC
 
	ghic
;

338 
I∂Image
* 
	g‰ame
;

342 
	gCvC≠tuªCAM_VFW
::
	$öô
()

344 
	`mem£t
–&
ˇps
, 0, (caps) );

345 
ˇpWnd
 = 0;

346 
hdr
 = 0;

347 
fourcc
 = 0;

348 
hic
 = 0;

349 
‰ame
 = 0;

350 
width
 = 
height
 = -1;

351 
widthSë
 = 
heightSë
 = 0;

352 
	}
}

354 
	gCvC≠tuªCAM_VFW
::
	$˛o£HIC
()

356 if–
hic
 )

358 
	`ICDecom¥essEnd
–
hic
 );

359 
	`ICClo£
–
hic
 );

360 
hic
 = 0;

362 
	}
}

365 
LRESULT
 
PASCAL
 
	gCvC≠tuªCAM_VFW
::
	$‰ameCÆlback
–
HWND
 
hWnd
, 
VIDEOHDR
* 
hdr
 )

367 
CvC≠tuªCAM_VFW
* 
ˇ±uª
 = 0;

369 i‡(!
hWnd
Ë 
FALSE
;

371 
ˇ±uª
 = (
CvC≠tuªCAM_VFW
*)
	`ˇpGëU£rD©a
(
hWnd
);

372 
ˇ±uª
->
hdr
 = hdr;

374  (
LRESULT
)
TRUE
;

375 
	}
}

379 
boﬁ
 
	gCvC≠tuªCAM_VFW
::
	$›í
–
wIndex
 )

381 
szDevi˚Name
[80];

382 
szDevi˚Vîsi⁄
[80];

383 
HWND
 
hWndC
 = 0;

385 
	`˛o£
();

387 if–()
wIndex
 >= 10 )

388 
wIndex
 = 0;

390  ; 
wIndex
 < 10; wIndex++ )

392 if–
	`ˇpGëDrivîDes¸ùti⁄
–
wIndex
, 
szDevi˚Name
,

393  (
szDevi˚Name
), 
szDevi˚Vîsi⁄
,

394  (
szDevi˚Vîsi⁄
)))

396 
hWndC
 = 
	`ˇpCª©eC≠tuªWödow
 ( "My Own Capture Window",

397 
WS_POPUP
 | 
WS_CHILD
, 0, 0, 320, 240, 0, 0);

398 if–
	`ˇpDrivîC⁄√˘
 (
hWndC
, 
wIndex
))

400 
	`De°royWödow
–
hWndC
 );

401 
hWndC
 = 0;

405 if–
hWndC
 )

407 
ˇpWnd
 = 
hWndC
;

408 
hdr
 = 0;

409 
hic
 = 0;

410 
fourcc
 = (
DWORD
)-1;

412 
	`mem£t
–&
ˇps
, 0, (caps));

413 
	`ˇpDrivîGëC≠s
–
hWndC
, &
ˇps
, (caps));

414 
CAPSTATUS
 
°©us
 = {};

415 
	`ˇpGëSètus
(
hWndC
, &
°©us
, (status));

416 ::
	`SëWödowPos
(
hWndC
, 
NULL
, 0, 0, 
°©us
.
uiImageWidth
, sètus.
uiImageHeight
, 
SWP_NOZORDER
|
SWP_NOMOVE
);

417 
	`ˇpSëU£rD©a
–
hWndC
, (
size_t
)
this
 );

418 
	`ˇpSëCÆlbackOnFøme
–
hWndC
, 
‰ameCÆlback
 );

419 
CAPTUREPARMS
 
p
;

420 
	`ˇpC≠tuªGëSëup
(
hWndC
,&
p
,(
CAPTUREPARMS
));

421 
p
.
dwReque°Mi¸oSecPîFøme
 = 66667/2;

422 
	`ˇpC≠tuªSëSëup
(
hWndC
,&
p
,(
CAPTUREPARMS
));

424 
	`ˇpPªvõwSˇÀ
(
hWndC
,
FALSE
);

425 
	`ˇpPªvõwR©e
(
hWndC
,1);

428 c⁄° 
DWORD
 
size
 = 
	`ˇpGëVideoF‹m©Size
(
ˇpWnd
);

429 if–
size
 > 0 )

431 *
pbi
 = 
√w
 [
size
];

432 if–
pbi
 )

434 if–
	`ˇpGëVideoF‹m©
(
ˇpWnd
, 
pbi
, 
size
) == size )

436 
BITMAPINFOHEADER
& 
vfmt
 = ((
BITMAPINFO
*)
pbi
)->
bmiHódî
;

437 
widthSë
 = 
vfmt
.
biWidth
;

438 
heightSë
 = 
vfmt
.
biHeight
;

439 
fourcc
 = 
vfmt
.
biCom¥essi⁄
;

441 
dñëe
 []
pbi
;

445 if–
widthSë
 =0 || 
heightSë
 == 0 )

447 
widthSë
 = 
°©us
.
uiImageWidth
;

448 
heightSë
 = 
°©us
.
uiImageHeight
;

452  
ˇpWnd
 != 0;

453 
	}
}

456 
	gCvC≠tuªCAM_VFW
::
	$˛o£
()

458 if–
ˇpWnd
 )

460 
	`ˇpSëCÆlbackOnFøme
–
ˇpWnd
, 
NULL
 );

461 
	`ˇpDrivîDisc⁄√˘
–
ˇpWnd
 );

462 
	`De°royWödow
–
ˇpWnd
 );

463 
	`˛o£HIC
();

465 
	`cvRñó£Image
–&
‰ame
 );

466 
	`öô
();

467 
	}
}

470 
boﬁ
 
	gCvC≠tuªCAM_VFW
::
	$gøbFøme
()

472 if–
ˇpWnd
 )

473  
	`ˇpGøbFømeNoSt›
(
ˇpWnd
Ë=
TRUE
;

475  
Ál£
;

476 
	}
}

479 
I∂Image
* 
	gCvC≠tuªCAM_VFW
::
	$ªåõveFøme
()

481 
BITMAPINFO
 
vfmt
;

482 
	`mem£t
–&
vfmt
, 0, (vfmt));

483 
BITMAPINFOHEADER
& 
vfmt0
 = 
vfmt
.
bmiHódî
;

485 if–!
ˇpWnd
 )

488 c⁄° 
DWORD
 
sz
 = 
	`ˇpGëVideoF‹m©
–
ˇpWnd
, &
vfmt
, (vfmt));

489 c⁄° 
¥evWidth
 = 
‰ame
 ? føme->
width
 : 0;

490 c⁄° 
¥evHeight
 = 
‰ame
 ? føme->
height
 : 0;

492 if–!
hdr
 || hdr->
ÕD©a
 =0 || 
sz
 == 0 )

495 if–!
‰ame
 || føme->
width
 !
vfmt0
.
biWidth
 || føme->
height
 !vfmt0.
biHeight
 )

497 
	`cvRñó£Image
–&
‰ame
 );

498 
‰ame
 = 
	`cvCª©eImage
–
	`cvSize
–
vfmt0
.
biWidth
, vfmt0.
biHeight
 ), 8, 3 );

501 if–
vfmt0
.
biCom¥essi⁄
 !
BI_RGB
 ||

502 
vfmt0
.
biBôCou¡
 != 24 )

504 
BITMAPINFOHEADER
 
vfmt1
 = 
	`icvBôm≠Hódî
–
vfmt0
.
biWidth
, vfmt0.
biHeight
, 24 );

506 if–
hic
 =0 || 
fourcc
 !
vfmt0
.
biCom¥essi⁄
 ||

507 
¥evWidth
 !
vfmt0
.
biWidth
 || 
¥evHeight
 !vfmt0.
biHeight
 )

509 
	`˛o£HIC
();

510 
hic
 = 
	`ICO≥n
–
	`MAKEFOURCC
('V','I','D','C'),

511 
vfmt0
.
biCom¥essi⁄
, 
ICMODE_DECOMPRESS
 );

512 if–
hic
 )

514 if–
	`ICDecom¥essBegö
–
hic
, &
vfmt0
, &
vfmt1
 ) !
ICERR_OK
 )

516 
	`˛o£HIC
();

522 if–!
hic
 || 
	`ICDecom¥ess
–hic, 0, &
vfmt0
, 
hdr
->
ÕD©a
,

523 &
vfmt1
, 
‰ame
->
imageD©a
 ) !
ICERR_OK
 )

525 
	`˛o£HIC
();

529 
	`cvFlù
–
‰ame
, frame, 0 );

533 
I∂Image
 
§c
;

534 
	`cvInôImageHódî
–&
§c
, 
	`cvSize
(
vfmt0
.
biWidth
, vfmt0.
biHeight
),

535 
IPL_DEPTH_8U
, 3, 
IPL_ORIGIN_BL
, 4 );

536 
	`cvSëD©a
–&
§c
, 
hdr
->
ÕD©a
, src.
widthSãp
 );

537 
	`cvFlù
–&
§c
, 
‰ame
, 0 );

540  
‰ame
;

541 
	}
}

544 
	gCvC≠tuªCAM_VFW
::
	$gëPr›îty
–
¥›îty_id
 ) const

546  
¥›îty_id
 )

548 
CV_CAP_PROP_FRAME_WIDTH
:

549  
widthSë
;

550 
CV_CAP_PROP_FRAME_HEIGHT
:

551  
heightSë
;

552 
CV_CAP_PROP_FOURCC
:

553  
fourcc
;

554 
CV_CAP_PROP_FPS
:

556 
CAPTUREPARMS
 
∑øms
 = {};

557 if–
	`ˇpC≠tuªGëSëup
(
ˇpWnd
, &
∑øms
, (params)) )

558  1e6 / 
∑øms
.
dwReque°Mi¸oSecPîFøme
;

565 
	}
}

567 
boﬁ
 
	gCvC≠tuªCAM_VFW
::
	$£tPr›îty
(
¥›îty_id
, 
vÆue
)

569 
boﬁ
 
h™dÀdSize
 = 
Ál£
;

571  
¥›îty_id
 )

573 
CV_CAP_PROP_FRAME_WIDTH
:

574 
width
 = 
	`cvRound
(
vÆue
);

575 
h™dÀdSize
 = 
åue
;

577 
CV_CAP_PROP_FRAME_HEIGHT
:

578 
height
 = 
	`cvRound
(
vÆue
);

579 
h™dÀdSize
 = 
åue
;

581 
CV_CAP_PROP_FOURCC
:

583 
CV_CAP_PROP_FPS
:

584 if–
vÆue
 > 0 )

586 
CAPTUREPARMS
 
∑øms
;

587 if–
	`ˇpC≠tuªGëSëup
(
ˇpWnd
, &
∑øms
, (params)) )

589 
∑øms
.
dwReque°Mi¸oSecPîFøme
 = 
	`cvRound
(1e6/
vÆue
);

590  
	`ˇpC≠tuªSëSëup
(
ˇpWnd
, &
∑øms
, ’¨ams)Ë=
TRUE
;

598 i‡–
h™dÀdSize
 )

601 if–
width
 > 0 && 
height
 > 0 )

603 c⁄° 
DWORD
 
size
 = 
	`ˇpGëVideoF‹m©Size
(
ˇpWnd
);

604 if–
size
 == 0 )

605  
Ál£
;

607 *
pbi
 = 
√w
 [
size
];

608 if–!
pbi
 )

609  
Ál£
;

611 if–
	`ˇpGëVideoF‹m©
(
ˇpWnd
, 
pbi
, 
size
) != size )

613 
dñëe
 []
pbi
;

614  
Ál£
;

617 
BITMAPINFOHEADER
& 
vfmt
 = ((
BITMAPINFO
*)
pbi
)->
bmiHódî
;

618 
boﬁ
 
suc˚ss
 = 
åue
;

619 if–
width
 !
vfmt
.
biWidth
 || 
height
 !vfmt.
biHeight
 )

622 
vfmt
.
biWidth
 = 
width
;

623 
vfmt
.
biHeight
 = 
height
;

624 
vfmt
.
biSizeImage
 = 
height
 * ((
width
 * vfmt.
biBôCou¡
 + 31) / 32) * 4;

625 
vfmt
.
biCom¥essi⁄
 = 
BI_RGB
;

626 
suc˚ss
 = 
	`ˇpSëVideoF‹m©
(
ˇpWnd
, 
pbi
, 
size
Ë=
TRUE
;

628 if–
suc˚ss
 )

631 
CAPSTATUS
 
°©us
 = {};

632 
	`ˇpGëSètus
(
ˇpWnd
, &
°©us
, (status));

633 ::
	`SëWödowPos
(
ˇpWnd
, 
NULL
, 0, 0, 
°©us
.
uiImageWidth
, sètus.
uiImageHeight
, 
SWP_NOZORDER
|
SWP_NOMOVE
);

635 
widthSë
 = 
width
;

636 
heightSë
 = 
height
;

638 
dñëe
 []
pbi
;

639 
width
 = 
height
 = -1;

641  
suc˚ss
;

644  
åue
;

647  
Ál£
;

648 
	}
}

650 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_VFW
–
ödex
 )

652 
CvC≠tuªCAM_VFW
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_VFW;

654 if–
ˇ±uª
->
	`›í
–
ödex
 ))

655  
ˇ±uª
;

657 
dñëe
 
ˇ±uª
;

659 
	}
}

664 ˛as†
	cCvVideoWrôî_VFW
 : 
public
 
CvVideoWrôî


666 
public
:

667 
	$CvVideoWrôî_VFW
(Ë{ 
	`öô
(); }

668 
vútuÆ
 ~
	$CvVideoWrôî_VFW
(Ë{ 
	`˛o£
(); 
	}
}

670 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
, 
fourcc
,

671 
Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 );

672 
vútuÆ
 
˛o£
();

673 
vútuÆ
 
boﬁ
 
wrôeFøme
–c⁄° 
I∂Image
* );

675 
	g¥Ÿe˘ed
:

676 
öô
();

677 
boﬁ
 
¸óãSåóms
–
CvSize
 
‰ameSize
, boﬁ 
isCﬁ‹
 );

679 
PAVIFILE
 
	gavifûe
;

680 
PAVISTREAM
 
	gcom¥es£d
;

681 
PAVISTREAM
 
	guncom¥es£d
;

682 
	gÂs
;

683 
I∂Image
* 
	gãmpFøme
;

684 
	gpos
;

685 
	gfourcc
;

689 
	gCvVideoWrôî_VFW
::
	$öô
()

691 
avifûe
 = 0;

692 
com¥es£d
 = 
uncom¥es£d
 = 0;

693 
Âs
 = 0;

694 
ãmpFøme
 = 0;

695 
pos
 = 0;

696 
fourcc
 = 0;

697 
	}
}

699 
	gCvVideoWrôî_VFW
::
	$˛o£
()

701 if–
uncom¥es£d
 )

702 
	`AVISåómRñó£
–
uncom¥es£d
 );

703 if–
com¥es£d
 )

704 
	`AVISåómRñó£
–
com¥es£d
 );

705 if–
avifûe
 )

706 
	`AVIFûeRñó£
–
avifûe
 );

707 
	`cvRñó£Image
–&
ãmpFøme
 );

708 
	`öô
();

709 
	}
}

713 
	sBITMAPINFO_8Bô


715 
BITMAPINFOHEADER
 
	mbmiHódî
;

716 
RGBQUAD
 
	mbmiCﬁ‹s
[256];

720 
boﬁ
 
	gCvVideoWrôî_VFW
::
	$›í
–c⁄° * 
fûíame
, 
_fourcc
, 
_Âs
, 
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 )

722 
	`˛o£
();

724 
	`icvInôC≠tuª_VFW
();

725 if–
	`AVIFûeO≥n
–&
avifûe
, 
fûíame
, 
OF_CREATE
 | 
OF_WRITE
, 0 ) =
AVIERR_OK
 )

727 
fourcc
 = 
_fourcc
;

728 
Âs
 = 
_Âs
;

729 if–
‰ameSize
.
width
 > 0 && fømeSize.
height
 > 0 &&

730 !
	`¸óãSåóms
–
‰ameSize
, 
isCﬁ‹
 ) )

732 
	`˛o£
();

733  
Ál£
;

735  
åue
;

738  
Ál£
;

739 
	}
}

742 
boﬁ
 
	gCvVideoWrôî_VFW
::
	$¸óãSåóms
–
CvSize
 
‰ameSize
, 
boﬁ
 
isCﬁ‹
 )

744 if–!
avifûe
 )

745  
Ál£
;

746 
AVISTREAMINFO
 
aviöfo
;

748 
BITMAPINFO_8Bô
 
bmih
;

749 
bmih
.
bmiHódî
 = 
	`icvBôm≠Hódî
–
‰ameSize
.
width
, fømeSize.
height
, 
isCﬁ‹
 ? 24 : 8 );

750  
i
 = 0; i < 256; i++ )

752 
bmih
.
bmiCﬁ‹s
[
i
].
rgbBlue
 = (
BYTE
)i;

753 
bmih
.
bmiCﬁ‹s
[
i
].
rgbGªí
 = (
BYTE
)i;

754 
bmih
.
bmiCﬁ‹s
[
i
].
rgbRed
 = (
BYTE
)i;

755 
bmih
.
bmiCﬁ‹s
[
i
].
rgbRe£rved
 = 0;

758 
	`mem£t
–&
aviöfo
, 0, (aviinfo));

759 
aviöfo
.
fccTy≥
 = 
°ªamty≥VIDEO
;

760 
aviöfo
.
fccH™dÀr
 = 0;

762 
aviöfo
.
dwSˇÀ
 = (
DWORD
)(()0x7FFFFFFF / 
Âs
);

763 
aviöfo
.
dwR©e
 = 
	`cvRound
(
Âs
 *áviöfo.
dwSˇÀ
);

764 
aviöfo
.
rcFøme
.
t›
 =áviöfo.rcFøme.
À·
 = 0;

765 
aviöfo
.
rcFøme
.
right
 = 
‰ameSize
.
width
;

766 
aviöfo
.
rcFøme
.
bŸtom
 = 
‰ameSize
.
height
;

768 if–
	`AVIFûeCª©eSåóm
–
avifûe
, &
uncom¥es£d
, &
aviöfo
 ) =
AVIERR_OK
 )

770 
AVICOMPRESSOPTIONS
 
c›ts
, *
pc›ts
 = &copts;

771 
c›ts
.
fccTy≥
 = 
°ªamty≥VIDEO
;

772 
c›ts
.
fccH™dÀr
 = 
fourcc
 != -1 ? fourcc : 0;

773 
c›ts
.
dwKeyFømeEvîy
 = 1;

774 
c›ts
.
dwQuÆôy
 = 10000;

775 
c›ts
.
dwByãsPîSec⁄d
 = 0;

776 
c›ts
.
dwFœgs
 = 
AVICOMPRESSF_VALID
;

777 
c›ts
.
ÕF‹m©
 = &
bmih
;

778 
c›ts
.
cbF‹m©
 = (
isCﬁ‹
 ? (
BITMAPINFOHEADER
Ë: (
bmih
));

779 
c›ts
.
ÕP¨ms
 = 0;

780 
c›ts
.
cbP¨ms
 = 0;

781 
c›ts
.
dwI¡îÀaveEvîy
 = 0;

783 if–
fourcc
 !-1 || 
	`AVISaveO±i⁄s
–0, 0, 1, &
uncom¥es£d
, &
pc›ts
 ) =
TRUE
 )

785 if–
	`AVIMakeCom¥es£dSåóm
–&
com¥es£d
, 
uncom¥es£d
, 
pc›ts
, 0 ) =
AVIERR_OK
 &&

786 
	`AVISåómSëF‹m©
–
com¥es£d
, 0, &
bmih
, (bmih)Ë=
AVIERR_OK
 )

788 
Âs
 = fps;

789 
fourcc
 = ()
c›ts
.
fccH™dÀr
;

790 
‰ameSize
 = frameSize;

791 
ãmpFøme
 = 
	`cvCª©eImage
–
‰ameSize
, 8, (
isCﬁ‹
 ? 3 : 1) );

792  
åue
;

796  
Ál£
;

797 
	}
}

800 
boﬁ
 
	gCvVideoWrôî_VFW
::
	$wrôeFøme
–c⁄° 
I∂Image
* 
image
 )

802 
boﬁ
 
ªsu…
 = 
Ál£
;

803 
	`CV_FUNCNAME
( "CvVideoWriter_VFW::writeFrame" );

805 
__BEGIN__
;

807 if–!
image
 )

808 
EXIT
;

810 if–!
com¥es£d
 && !
	`¸óãSåóms
–
	`cvGëSize
(
image
), image->
nCh™√ls
 > 1 ))

811 
EXIT
;

813 if–
image
->
width
 !
ãmpFøme
->width || image->
height
 !=ÅempFrame->height )

814 
	`CV_ERROR
–
CV_StsUnm©chedSizes
,

817 if–
image
->
nCh™√ls
 !
ãmpFøme
->nChannels ||

818 
image
->
dïth
 !
ãmpFøme
->depth ||

819 
image
->
‹igö
 == 0 ||

820 
image
->
widthSãp
 !
	`cvAlign
(image->
width
*image->
nCh™√ls
*((image->
dïth
 & 255)/8), 4))

822 
	`cvC⁄vîtImage
–
image
, 
ãmpFøme
, image->
‹igö
 =0 ? 
CV_CVTIMG_FLIP
 : 0 );

823 
image
 = (c⁄° 
I∂Image
*)
ãmpFøme
;

826 
ªsu…
 = 
	`AVISåómWrôe
–
com¥es£d
, 
pos
++, 1, 
image
->
imageD©a
,

827 
image
->
imageSize
, 
AVIIF_KEYFRAME
, 0, 0 ) =
AVIERR_OK
;

829 
__END__
;

831  
ªsu…
;

832 
	}
}

834 
CvVideoWrôî
* 
	$cvCª©eVideoWrôî_VFW
–c⁄° * 
fûíame
, 
fourcc
,

835 
Âs
, 
CvSize
 
‰ameSize
, 
isCﬁ‹
 )

837 
CvVideoWrôî_VFW
* 
wrôî
 = 
√w
 CvVideoWriter_VFW;

838 if–
wrôî
->
	`›í
–
fûíame
, 
fourcc
, 
Âs
, 
‰ameSize
, 
isCﬁ‹
 != 0 ))

839  
wrôî
;

840 
dñëe
 
wrôî
;

842 
	}
}

	@src/cap_winrt/CaptureFrameGrabber.cpp

23 
	~"MedüSåómSök.hµ
"

24 
	~"MedüSök.hµ
"

25 
	~"C≠tuªFømeGøbbî.hµ
"

27 
usög
 
«me•a˚
 
	gMedü
;

28 
usög
 
«me•a˚
 
	gPœtf‹m
;

29 
usög
 
«me•a˚
 
	gWödows
::
Found©i⁄
;

30 
usög
 
«me•a˚
 
	gWödows
::
Medü
;

31 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
C≠tuª
;

32 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
MedüPr›îtõs
;

33 
usög
 
«me•a˚
 
	gc⁄cuºícy
;

34 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
::
Dëaûs
;

35 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
;

37 
	gèsk
<
	gMedü
::
C≠tuªFømeGøbbî
^> 
Medü
::C≠tuªFømeGøbbî::
Cª©eAsync
(
_In_
 
MedüC≠tuª
^ 
ˇ±uª
, _In_ 
VideoEncodögPr›îtõs
^ 
¥›s
, 
C≠tuªSåómTy≥
 
°ªamTy≥
)

39 autÿ
	gªadî
 = 
ªf
 
√w
 
Medü
::
C≠tuªFømeGøbbî
(
ˇ±uª
, 
¥›s
, 
°ªamTy≥
);

41 autÿ
	g¥ofûe
 = 
ªf
 
√w
 
MedüEncodögProfûe
();

42 
	g¥ofûe
->
	gVideo
 = 
¥›s
;

44 
	gèsk
<>Åask;

45 i‡(
	gªadî
->
	g_°ªamTy≥
 =
C≠tuªSåómTy≥
::
Pªvõw
)

47 
èsk
 = 
¸óã_èsk
(
ˇ±uª
->
SèπPªvõwToCu°omSökAsync
(
¥ofûe
, 
ªadî
->
_medüExãnsi⁄
));

51 
	gèsk
 = 
¸óã_èsk
(
ˇ±uª
->
SèπRec‹dToCu°omSökAsync
(
¥ofûe
, 
ªadî
->
_medüExãnsi⁄
));

54  
	gèsk
.
thí
([
ªadî
]()

56 
ªadî
->
_°©e
 = 
Sèã
::
Sèπed
;

57  
ªadî
;

61 
	gMedü
::
C≠tuªFømeGøbbî
::C≠tuªFømeGøbbî(
_In_
 
MedüC≠tuª
^ 
ˇ±uª
, _In_ 
VideoEncodögPr›îtõs
^ 
¥›s
, 
C≠tuªSåómTy≥
 
°ªamTy≥
)

62 : 
_°©e
(
Sèã
::
Cª©ed
)

63 , 
_°ªamTy≥
(
°ªamTy≥
)

64 , 
	$_ˇ±uª
(
ˇ±uª
)

66 autÿ
videoSam∂eH™dÀr
 = 
ªf
 
√w
 
	`MedüSam∂eH™dÀr
(
this
, &
Medü
::
C≠tuªFømeGøbbî
::
Pro˚ssSam∂e
);

68 
_medüSök
 = 
Make
<
MedüSök
>(
nuŒ±r
, 
¥›s
,ÇuŒ±r, 
videoSam∂eH™dÀr
);

69 
_medüExãnsi⁄
 = 
ªöãΩªt_ˇ°
<
IMedüExãnsi⁄
^>(
°©ic_ˇ°
<
AWM
::IMedüExãnsi⁄*>(
_medüSök
.
	`Gë
()));

70 
	}
}

72 
	gMedü
::
C≠tuªFømeGøbbî
::~
	$C≠tuªFømeGøbbî
()

74 i‡(
_°©e
 =
Sèã
::
Sèπed
)

76 i‡(
_°ªamTy≥
 =
C≠tuªSåómTy≥
::
Pªvõw
)

78 ()
_ˇ±uª
->
	`St›PªvõwAsync
();

82 ()
_ˇ±uª
->
	`St›Rec‹dAsync
();

86 i‡(
_medüSök
 !
nuŒ±r
)

88 ()
_medüSök
->
	`Shutdown
();

89 
_medüSök
 = 
nuŒ±r
;

91 
_medüExãnsi⁄
 = 
nuŒ±r
;

92 
_ˇ±uª
 = 
nuŒ±r
;

93 
	}
}

95 
	gMedü
::
C≠tuªFømeGøbbî
::
	$ShowCamîaSëtögs
()

97 #i‡
WINAPI_FAMILY
!=
WINAPI_FAMILY_PHONE_APP


98 i‡(
_°©e
 =
Sèã
::
Sèπed
)

100 
CamîaO±i⁄sUI
::
	`Show
(
_ˇ±uª
.
	`Gë
());

103 
	}
}

105 
	gèsk
<> 
	gMedü
::
C≠tuªFømeGøbbî
::
	$FöishAsync
()

107 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

109 i‡(
_°©e
 !
Sèã
::
Sèπed
)

111 
throw
 
ªf
 
√w
 
	`COMEx˚±i⁄
(
E_UNEXPECTED
, 
L
"State");

113 
_°©e
 = 
Sèã
::
Closög
;

115 i‡(
_medüSök
 !
nuŒ±r
)

117 ()
_medüSök
->
	`Shutdown
();

118 
_medüSök
 = 
nuŒ±r
;

120 
_medüExãnsi⁄
 = 
nuŒ±r
;

122 
èsk
<>Åask;

123 i‡(
_°ªamTy≥
 =
C≠tuªSåómTy≥
::
Pªvõw
)

125 
èsk
 = 
	`¸óã_èsk
(
_ˇ±uª
->
	`St›PªvõwAsync
());

129 
èsk
 = 
	`¸óã_èsk
(
_ˇ±uª
->
	`St›Rec‹dAsync
());

132  
èsk
.
	`thí
([
this
]()

134 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

135 
_°©e
 = 
Sèã
::
Clo£d
;

136 
_ˇ±uª
 = 
nuŒ±r
;

138 
	}
}

140 
	gèsk
<
	gComPå
<
	gIMF2DBuf„r2
>> 
	gMedü
::
C≠tuªFømeGøbbî
::
	$GëFømeAsync
()

142 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

144 i‡(
_°©e
 !
Sèã
::
Sèπed
)

146 
throw
 
ªf
 
√w
 
	`COMEx˚±i⁄
(
E_UNEXPECTED
, 
L
"State");

149 
_medüSök
->
	`Reque°VideoSam∂e
();

151 
èsk_com∂ëi⁄_evít
<
ComPå
<
IMF2DBuf„r2
>> 
èskEvít
;

152 
_videoSam∂eReque°Queue
.
	`push
(
èskEvít
);

154  
	`¸óã_èsk
(
èskEvít
);

155 
	}
}

157 
	gMedü
::
C≠tuªFømeGøbbî
::
Pro˚ssSam∂e
(
_In_
 
MedüSam∂e
^ 
ßm∂e
)

159 
èsk_com∂ëi⁄_evít
<
ComPå
<
IMF2DBuf„r2
>> 
t
;

162 autÿ
	glock
 = 
_lock
.
LockEx˛usive
();

164 
	gt
 = 
_videoSam∂eReque°Queue
.
‰⁄t
();

165 
	g_videoSam∂eReque°Queue
.
p›
();

168 
	gComPå
<
	gIMFMedüBuf„r
> 
	gbuf„r
;

169 
CHK
(
ßm∂e
->
Sam∂e
->
C⁄vîtToC⁄tiguousBuf„r
(&
buf„r
));

172 
	gt
.
£t
(
As
<
IMF2DBuf„r2
>(
buf„r
));

	@src/cap_winrt/MediaStreamSink.cpp

23 
	~"MedüSåómSök.hµ
"

24 
	~"MFIn˛udes.hµ
"

26 
usög
 
«me•a˚
 
	gMedü
;

27 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
;

28 
usög
 
«me•a˚
 
	gPœtf‹m
;

29 
usög
 
«me•a˚
 
	gWödows
::
Found©i⁄
;

31 
	gMedüSåómSök
::
MedüSåómSök
(

32 
__ö
 c⁄° 
MW
::
ComPå
<
IMFMedüSök
>& 
sök
,

33 
__ö
 
DWORD
 
id
,

34 
__ö
 c⁄° 
MW
::
ComPå
<
IMFMedüTy≥
>& 
mt
,

35 
__ö
 
MedüSam∂eH™dÀr
^ 
ßm∂eH™dÀr


37 : 
_shutdown
(
Ál£
)

38 , 
_id
(-1)

39 , 
_width
(0)

40 , 
	$_height
(0)

42 
	`CHK
(
	`MFCª©eEvítQueue
(&
_evítQueue
));

43 
	`CHK
(
	`MFCª©eMedüTy≥
(&
_curMT
));

45 
	`_Upd©eMedüTy≥
(
mt
);

47 
_sök
 = 
sök
;

48 
_id
 = 
id
;

49 
_ßm∂eH™dÀr
 = 
ßm∂eH™dÀr
;

50 
	}
}

52 
HRESULT
 
	gMedüSåómSök
::
	$GëMedüSök
(
__dîef_out
 
IMFMedüSök
 **
sök
)

54  
	`Ex˚±i⁄Bound¨y
([
this
, 
sök
]()

56 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

58 
	`CHKNULL
(
sök
);

59 *
sök
 = 
nuŒ±r
;

61 
	`_VîifyNŸShutdown
();

63 
	`CHK
(
_sök
.
	`C›yTo
(
sök
));

65 
	}
}

67 
HRESULT
 
	gMedüSåómSök
::
	$GëIdítifõr
(
__out
 
DWORD
 *
idítifõr
)

69  
	`Ex˚±i⁄Bound¨y
([
this
, 
idítifõr
]()

71 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

73 
	`CHKNULL
(
idítifõr
);

75 
	`_VîifyNŸShutdown
();

77 *
idítifõr
 = 
_id
;

79 
	}
}

81 
HRESULT
 
	gMedüSåómSök
::
	$GëMedüTy≥H™dÀr
(
__dîef_out
 
IMFMedüTy≥H™dÀr
 **
h™dÀr
)

83  
	`Ex˚±i⁄Bound¨y
([
this
, 
h™dÀr
]()

85 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

87 
	`CHKNULL
(
h™dÀr
);

88 *
h™dÀr
 = 
nuŒ±r
;

90 
	`_VîifyNŸShutdown
();

92 *
h™dÀr
 = 
this
;

93 
this
->
	`AddRef
();

96 
	}
}

98 
	gMedüSåómSök
::
	$Reque°Sam∂e
()

100 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

102 
	`_VîifyNŸShutdown
();

104 
	`CHK
(
_evítQueue
->
	`QueueEvítP¨amV¨
(
MESåómSökReque°Sam∂e
, 
GUID_NULL
, 
S_OK
, 
nuŒ±r
));

105 
	}
}

107 
HRESULT
 
	gMedüSåómSök
::
	$Pro˚ssSam∂e
(
__ö_›t
 
IMFSam∂e
 *
ßm∂e
)

109  
	`Ex˚±i⁄Bound¨y
([
this
, 
ßm∂e
]()

111 
MedüSam∂eH™dÀr
^ 
ßm∂eH™dÀr
;

112 autÿ
medüSam∂e
 = 
ªf
 
√w
 
	`MedüSam∂e
();

115 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

117 
	`_VîifyNŸShutdown
();

119 i‡(
ßm∂e
 =
nuŒ±r
)

124 
medüSam∂e
->
Sam∂e
 = 
ßm∂e
;

125 
ßm∂eH™dÀr
 = 
_ßm∂eH™dÀr
;

129 
	`ßm∂eH™dÀr
(
medüSam∂e
);

131 
	}
}

133 
HRESULT
 
	gMedüSåómSök
::
	$Pœ˚M¨kî
(
__ö
 
MFSTREAMSINK_MARKER_TYPE
 , __ö c⁄° 
PROPVARIANT
 * , __ö c⁄° PROPVARIANT * 
c⁄ãxtVÆue
)

135  
	`Ex˚±i⁄Bound¨y
([
this
, 
c⁄ãxtVÆue
]()

137 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

138 
	`CHKNULL
(
c⁄ãxtVÆue
);

140 
	`_VîifyNŸShutdown
();

142 
	`CHK
(
_evítQueue
->
	`QueueEvítP¨amV¨
(
MESåómSökM¨kî
, 
GUID_NULL
, 
S_OK
, 
c⁄ãxtVÆue
));

144 
	}
}

146 
HRESULT
 
	gMedüSåómSök
::
	$Flush
()

148  
	`Ex˚±i⁄Bound¨y
([
this
]()

150 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

152 
	`_VîifyNŸShutdown
();

154 
	}
}

156 
HRESULT
 
	gMedüSåómSök
::
	$GëEvít
(
__ö
 
DWORD
 
Êags
, 
__dîef_out
 
IMFMedüEvít
 **
evít
)

158  
	`Ex˚±i⁄Bound¨y
([
this
, 
Êags
, 
evít
]()

160 
	`CHKNULL
(
evít
);

161 *
evít
 = 
nuŒ±r
;

163 
ComPå
<
IMFMedüEvítQueue
> 
evítQueue
;

166 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

168 
	`_VîifyNŸShutdown
();

170 
evítQueue
 = 
_evítQueue
;

174 
	`CHK
(
evítQueue
->
	`GëEvít
(
Êags
, 
evít
));

176 
	}
}

178 
HRESULT
 
	gMedüSåómSök
::
	$BegöGëEvít
(
__ö
 
IMFAsyncCÆlback
 *
ˇŒback
, 
__ö_›t
 
IUnknown
 *
°©e
)

180  
	`Ex˚±i⁄Bound¨y
([
this
, 
ˇŒback
, 
°©e
]()

182 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

184 
	`_VîifyNŸShutdown
();

186 
	`CHK
(
_evítQueue
->
	`BegöGëEvít
(
ˇŒback
, 
°©e
));

188 
	}
}

191 
HRESULT
 
	gMedüSåómSök
::
	$EndGëEvít
(
__ö
 
IMFAsyncResu…
 *
ªsu…
, 
__dîef_out
 
IMFMedüEvít
 **
evít
)

193  
	`Ex˚±i⁄Bound¨y
([
this
, 
ªsu…
, 
evít
]()

195 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

197 
	`CHKNULL
(
evít
);

198 *
evít
 = 
nuŒ±r
;

200 
	`_VîifyNŸShutdown
();

202 
	`CHK
(
_evítQueue
->
	`EndGëEvít
(
ªsu…
, 
evít
));

204 
	}
}

206 
HRESULT
 
	gMedüSåómSök
::
	$QueueEvít
(

207 
__ö
 
MedüEvítTy≥
 
më
,

208 
__ö
 
REFGUID
 
exãndedTy≥
,

209 
__ö
 
HRESULT
 
°©us
,

210 
__ö_›t
 c⁄° 
PROPVARIANT
 *
vÆue


213  
	`Ex˚±i⁄Bound¨y
([
this
, 
më
, 
exãndedTy≥
, 
°©us
, 
vÆue
]()

215 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

217 
	`_VîifyNŸShutdown
();

219 
	`CHK
(
_evítQueue
->
	`QueueEvítP¨amV¨
(
më
, 
exãndedTy≥
, 
°©us
, 
vÆue
));

221 
	}
}

223 
HRESULT
 
	gMedüSåómSök
::
	$IsMedüTy≥Suµ‹ãd
(
__ö
 
IMFMedüTy≥
 *
medüTy≥
, 
__dîef_out_›t
 IMFMedüTy≥ **
˛o£°MedüTy≥
)

225 
boﬁ
 
suµ‹ãd
 = 
Ál£
;

227 
HRESULT
 
hr
 = 
	`Ex˚±i⁄Bound¨y
([
this
, 
medüTy≥
, 
˛o£°MedüTy≥
, &
suµ‹ãd
]()

229 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

231 i‡(
˛o£°MedüTy≥
 !
nuŒ±r
)

233 *
˛o£°MedüTy≥
 = 
nuŒ±r
;

236 
	`CHKNULL
(
medüTy≥
);

238 
	`_VîifyNŸShutdown
();

240 
suµ‹ãd
 = 
	`_IsMedüTy≥Suµ‹ãd
(
medüTy≥
);

244  
	`FAILED
(
hr
Ë? h∏: 
suµ‹ãd
 ? 
S_OK
 : 
MF_E_INVALIDMEDIATYPE
;

245 
	}
}

247 
HRESULT
 
	gMedüSåómSök
::
	$GëMedüTy≥Cou¡
(
__out
 
DWORD
 *
ty≥Cou¡
)

249  
	`Ex˚±i⁄Bound¨y
([
this
, 
ty≥Cou¡
]()

251 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

253 
	`CHKNULL
(
ty≥Cou¡
);

255 
	`_VîifyNŸShutdown
();

258 *
ty≥Cou¡
 = 0;

260 
	}
}

262 
HRESULT
 
	gMedüSåómSök
::
	$GëMedüTy≥ByIndex
(
__ö
 
DWORD
 , 
__dîef_out
 
IMFMedüTy≥
 **
medüTy≥
)

264 
HRESULT
 
hr
 = 
	`Ex˚±i⁄Bound¨y
([
this
, 
medüTy≥
]()

266 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

268 
	`CHKNULL
(
medüTy≥
);

269 *
medüTy≥
 = 
nuŒ±r
;

271 
	`_VîifyNŸShutdown
();

275  
	`FAILED
(
hr
Ë? h∏: 
MF_E_NO_MORE_TYPES
;

276 
	}
}

278 
HRESULT
 
	gMedüSåómSök
::
	$SëCuºítMedüTy≥
(
__ö
 
IMFMedüTy≥
 *
medüTy≥
)

280  
	`Ex˚±i⁄Bound¨y
([
this
, 
medüTy≥
]()

282 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

284 
	`CHKNULL
(
medüTy≥
);

286 
	`_VîifyNŸShutdown
();

288 i‡(!
	`_IsMedüTy≥Suµ‹ãd
(
medüTy≥
))

290 
	`CHK
(
MF_E_INVALIDMEDIATYPE
);

293 
	`_Upd©eMedüTy≥
(
medüTy≥
);

295 
	}
}

297 
HRESULT
 
	gMedüSåómSök
::
	$GëCuºítMedüTy≥
(
__dîef_out_›t
 
IMFMedüTy≥
 **
medüTy≥
)

299  
	`Ex˚±i⁄Bound¨y
([
this
, 
medüTy≥
]()

301 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

303 
	`CHKNULL
(
medüTy≥
);

304 *
medüTy≥
 = 
nuŒ±r
;

306 
	`_VîifyNŸShutdown
();

308 
ComPå
<
IMFMedüTy≥
> 
mt
;

309 
	`CHK
(
	`MFCª©eMedüTy≥
(&
mt
));

310 
	`CHK
(
_curMT
->
	`C›yAŒIãms
(
mt
.
	`Gë
()));

311 *
medüTy≥
 = 
mt
.
	`Dëach
();

313 
	}
}

315 
HRESULT
 
	gMedüSåómSök
::
	$GëMaj‹Ty≥
(
__out
 
GUID
 *
maj‹Ty≥
)

317  
	`Ex˚±i⁄Bound¨y
([
this
, 
maj‹Ty≥
]()

319 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

321 
	`CHKNULL
(
maj‹Ty≥
);

323 
	`_VîifyNŸShutdown
();

325 *
maj‹Ty≥
 = 
_maj‹Ty≥
;

327 
	}
}

329 
	gMedüSåómSök
::
I¡î«lSëCuºítMedüTy≥
(
__ö
 c⁄° 
ComPå
<
IMFMedüTy≥
>& 
medüTy≥
)

331 autÿ
lock
 = 
_lock
.
LockEx˛usive
();

333 
CHKNULL
(
medüTy≥
);

335 
_VîifyNŸShutdown
();

337 
_Upd©eMedüTy≥
(
medüTy≥
);

340 
	gMedüSåómSök
::
	$Shutdown
()

342 autÿ
lock
 = 
_lock
.
	`LockEx˛usive
();

344 i‡(
_shutdown
)

348 
_shutdown
 = 
åue
;

350 ()
_evítQueue
->
	`Shutdown
();

351 
_evítQueue
 = 
nuŒ±r
;

353 
_curMT
 = 
nuŒ±r
;

354 
_sök
 = 
nuŒ±r
;

355 
_ßm∂eH™dÀr
 = 
nuŒ±r
;

356 
	}
}

358 
boﬁ
 
	gMedüSåómSök
::
_IsMedüTy≥Suµ‹ãd
(
__ö
 c⁄° 
ComPå
<
IMFMedüTy≥
>& 
mt
) const

360 
GUID
 
maj‹Ty≥
;

361 
GUID
 
	gsubTy≥
;

362 i‡(
SUCCEEDED
(
mt
->
GëGUID
(
MF_MT_MAJOR_TYPE
, &
maj‹Ty≥
)) &&

363 
SUCCEEDED
(
mt
->
GëGUID
(
MF_MT_SUBTYPE
, &
subTy≥
)) &&

364 (
	gmaj‹Ty≥
 =
_maj‹Ty≥
) &&

365 (
subTy≥
 =
_subTy≥
))

367  
åue
;

370  
	gÁl£
;

373 
	gMedüSåómSök
::
_Upd©eMedüTy≥
(
__ö
 c⁄° 
ComPå
<
IMFMedüTy≥
>& 
mt
)

375 
CHK
(
mt
->
GëGUID
(
MF_MT_MAJOR_TYPE
, &
_maj‹Ty≥
));

376 
CHK
(
mt
->
GëGUID
(
MF_MT_SUBTYPE
, &
_subTy≥
));

378 i‡(
	g_maj‹Ty≥
 =
MFMedüTy≥_Video
)

380 
CHK
(
MFGëAâribuãSize
(
mt
.
Gë
(), 
MF_MT_FRAME_SIZE
, &
_width
, &
_height
));

383 
CHK
(
mt
->
C›yAŒIãms
(
_curMT
.
Gë
()));

	@src/cap_winrt_bridge.cpp

27 
	~"›ícv2\videoio\ˇp_wöπ.hµ
"

28 
	~"ˇp_wöπ_ˇ±uª.hµ
"

29 
	~"ˇp_wöπ_bridge.hµ
"

30 
	~"ˇp_wöπ_video.hµ
"

32 
usög
 
«me•a˚
 
	gWödows
::
Found©i⁄
;

33 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
C≠tuª
;

34 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
MedüPr›îtõs
;

35 
usög
 
«me•a˚
 
	gWödows
::
Devi˚s
::
Enumî©i⁄
;

37 
usög
 
«me•a˚
 
	gWödows
::
UI
::
Xaml
::
Medü
::
Imagög
;

38 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
;

40 
usög
 
«me•a˚
 
	gPœtf‹m
;

41 
usög
 
	g«me•a˚
 ::
C⁄cuºícy
;

43 
usög
 
	g«me•a˚
 ::
°d
;

48 
	gVideoioBridge
::
	$ªque°F‹UIthªadAsync
(
a˘i⁄
)

50 
ªp‹ãr
.
	`ªp‹t
(
a˘i⁄
);

51 
	}
}

53 
	gVideoioBridge
& VideoioBridge::
	$gëIn°™˚
()

55 
VideoioBridge
 
ö°™˚
;

56  
ö°™˚
;

57 
	}
}

59 
	gVideoioBridge
::
	$sw≠I≈utBuf„rs
()

63 
	`sw≠
(
backI≈utPå
, 
‰⁄tI≈utPå
);

69 
	}
}

71 
	gVideoioBridge
::
	$sw≠OuçutBuf„rs
()

73 
lock_gu¨d
<
muãx
> 
	`lock
(
ouçutBuf„rMuãx
);

74 
	`sw≠
(
‰⁄tOuçutBuf„r
, 
backOuçutBuf„r
);

75 
	}
}

77 
	gVideoioBridge
::
	$ÆloˇãOuçutBuf„rs
()

79 
‰⁄tOuçutBuf„r
 = 
ªf
 
√w
 
	`WrôóbÀBôm≠
(
width
, 
height
);

80 
backOuçutBuf„r
 = 
ªf
 
√w
 
	`WrôóbÀBôm≠
(
width
, 
height
);

81 
	}
}

84 
	gVideoioBridge
::
	$ÆloˇãBuf„rs
(
width
, 
height
)

87 
‰⁄tI≈utM©
.
	`¸óã
(
height
, 
width
, 
CV_8UC3
);

88 
backI≈utM©
.
	`¸óã
(
height
, 
width
, 
CV_8UC3
);

90 
‰⁄tI≈utPå
 = 
‰⁄tI≈utM©
.
	`±r
(0);

91 
backI≈utPå
 = 
backI≈utM©
.
	`±r
(0);

93 
	`ÆloˇãOuçutBuf„rs
();

94 
	}
}

97 
boﬁ
 
	gVideoioBridge
::
	$›íCamîa
()

100 
	`ÆloˇãBuf„rs
(
width
, 
height
);

103 i‡(!
Video
::
	`gëIn°™˚
().
	`isSèπed
())

105 
Video
::
	`gëIn°™˚
().
	`öôGøbbî
(
devi˚Index
, 
width
, 
height
);

106  
åue
;

109  
Ál£
;

110 
	}
}

113 
	gVideoioBridge
::
	$upd©eFømeC⁄èöî
()

116 
Video
::
	`gëIn°™˚
().
	`C›yOuçut
();

119 
cvImage
->
Sour˚
 = 
backOuçutBuf„r
;

120 
	}
}

122 
	gVideoioBridge
::
	$imshow
()

124 
	`sw≠OuçutBuf„rs
();

125 
	`ªque°F‹UIthªadAsync
(
cv
::
UPDATE_IMAGE_ELEMENT
);

126 
	}
}

128 
	gVideoioBridge
::
	$gëDevi˚Index
()

130  
devi˚Index
;

131 
	}
}

133 
	gVideoioBridge
::
	$£tDevi˚Index
(
ödex
)

135 
devi˚Index
 = 
ödex
;

136 
	}
}

138 
	gVideoioBridge
::
	$gëWidth
()

140  
width
;

141 
	}
}

143 
	gVideoioBridge
::
	$gëHeight
()

145  
height
;

146 
	}
}

148 
	gVideoioBridge
::
	$£tWidth
(
_width
)

150 
width
 = 
_width
;

151 
	}
}

153 
	gVideoioBridge
::
	$£tHeight
(
_height
)

155 
height
 = 
_height
;

156 
	}
}

	@src/cap_winrt_capture.cpp

28 
	~"¥ecomp.hµ
"

29 
	~"ˇp_wöπ_ˇ±uª.hµ
"

30 
	~"ˇp_wöπ_bridge.hµ
"

31 
	~"ˇp_wöπ_video.hµ
"

32 
	~<›ícv2\videoio\ˇp_wöπ.hµ
>

34 
usög
 
«me•a˚
 
	gWödows
::
Found©i⁄
;

35 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
C≠tuª
;

36 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
MedüPr›îtõs
;

37 
usög
 
«me•a˚
 
	gWödows
::
Devi˚s
::
Enumî©i⁄
;

39 
usög
 
«me•a˚
 
	gPœtf‹m
;

41 
usög
 
«me•a˚
 
	gWödows
::
UI
::
Xaml
::
Medü
::
Imagög
;

42 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
;

44 
usög
 
	g«me•a˚
 ::
°d
;

46 
«me•a˚
 
	gcv
 {

50 
	gãm∂©e
 <
	gty≥«me
 ...
	gArgs
>

51 
wöπ_°¨tMesßgeLo›
(
°d
::
fun˘i⁄
<(
Args
...)>&& 
ˇŒback
, Args... 
¨gs
)

53 autÿ
	gasyncTask
 = ::
c⁄cuºícy
::
¸óã_async
([=](::c⁄cuºícy::
¥ogªss_ªp‹ãr
<> 
ªp‹ãr
)

55 
VideoioBridge
::
gëIn°™˚
().
£tRï‹ãr
(
ªp‹ãr
);

58 
ˇŒback
(
¨gs
...);

61 
	gasyncTask
->
	gProgªss
 = 
ªf
 
√w
 
AsyncA˘i⁄ProgªssH™dÀr
<>([=](
IAsyncA˘i⁄WôhProgªss
<>^ 
a˘
, 
	g¥ogªss
)

63 
	ga˘i⁄
 = 
¥ogªss
;

66 
	ga˘i⁄
)

68 
	gOPEN_CAMERA
:

69 
VideoioBridge
::
gëIn°™˚
().
›íCamîa
();

71 
	gCLOSE_CAMERA
:

72 
Video
::
gëIn°™˚
().
˛o£Gøbbî
();

74 
	gUPDATE_IMAGE_ELEMENT
:

75 
VideoioBridge
::
gëIn°™˚
().
upd©eFømeC⁄èöî
();

81 
	gãm∂©e
 <
	gty≥«me
 ...
	gArgs
>

82 
wöπ_°¨tMesßgeLo›
(
ˇŒback
(
Args
...), Args... 
¨gs
)

84 
wöπ_°¨tMesßgeLo›
(
°d
::
fun˘i⁄
<(
Args
...)>(
ˇŒback
), 
¨gs
...);

87 
wöπ_⁄VisibûôyCh™ged
(
boﬁ
 
visibÀ
)

89 i‡(
	gvisibÀ
)

91 
	gVideoioBridge
& 
	gbridge
 = 
VideoioBridge
::
gëIn°™˚
();

94 i‡(
	gbridge
.
	gbackI≈utPå
 !
nuŒ±r
)

96 i‡(
Video
::
gëIn°™˚
().
isSèπed
()) ;

98 
	gdevi˚
 = 
bridge
.
gëDevi˚Index
();

99 
	gwidth
 = 
bridge
.
gëWidth
();

100 
	gheight
 = 
bridge
.
gëHeight
();

102 
	gVideo
::
gëIn°™˚
().
öôGøbbî
(
devi˚
, 
width
, 
height
);

107 
	gVideo
::
gëIn°™˚
().
˛o£Gøbbî
();

111 
wöπ_imshow
()

113 
	gVideoioBridge
::
gëIn°™˚
().
imshow
();

116 
wöπ_£tFømeC⁄èöî
(::
Wödows
::
UI
::
Xaml
::
C⁄åﬁs
::
Image
^ 
image
)

118 
VideoioBridge
::
gëIn°™˚
().
cvImage
 = 
image
;

123 
	gVideoC≠tuª_WöRT
::
VideoC≠tuª_WöRT
(
devi˚
Ë: 
°¨ãd
(
Ál£
)

125 
VideoioBridge
::
gëIn°™˚
().
£tDevi˚Index
(
devi˚
);

128 
boﬁ
 
	gVideoC≠tuª_WöRT
::
isO≥√d
() const

130  
åue
;

136 
boﬁ
 
	gVideoC≠tuª_WöRT
::
gøbFøme
()

140 i‡(!
°¨ãd
Ë 
åue
;

142 i‡(
	gVideoioBridge
::
gëIn°™˚
().
bIsFømeNew
)

144  
åue
;

150  
	gÁl£
;

155 
boﬁ
 
	gVideoC≠tuª_WöRT
::
ªåõveFøme
(
ch™√l
, 
cv
::
OuçutAºay
 
outAºay
)

157 i‡(!
°¨ãd
) {

159 
width
, 
	gheight
;

160 
	gwidth
 = 
outAºay
.
size
().
width
;

161 
	gheight
 = 
outAºay
.
size
().
height
;

162 i‡(
	gwidth
 =0Ë
width
 = 640;

163 i‡(
	gheight
 =0Ë
height
 = 480;

165 
	gVideoioBridge
::
gëIn°™˚
().
£tWidth
(
width
);

166 
	gVideoioBridge
::
gëIn°™˚
().
£tHeight
(
height
);

171 
	gVideoioBridge
::
gëIn°™˚
().
ªque°F‹UIthªadAsync
(
OPEN_CAMERA
);

173 
	g°¨ãd
 = 
åue
;

174  
	gÁl£
;

177 i‡(!
	g°¨ãd
Ë 
	gÁl£
;

179  
	gVideoioBridge
::
gëIn°™˚
().
bIsFømeNew
;

183 
boﬁ
 
	gVideoC≠tuª_WöRT
::
£tPr›îty
(
¥›îty_id
, 
vÆue
)

185 
	g¥›îty_id
)

187 
	gCAP_PROP_FRAME_WIDTH
:

188 
size
.
width
 = ()
vÆue
;

190 
	gCAP_PROP_FRAME_HEIGHT
:

191 
size
.
height
 = ()
vÆue
;

194  
Ál£
;

196  
	gåue
;

	@src/cap_winrt_video.cpp

27 
	~"ˇp_wöπ_video.hµ
"

29 
	~<µl.h
>

30 
	~<µ…asks.h
>

31 
	~<c⁄¸t.h
>

32 
	~<agûe.h
>

34 
	~<©omic
>

35 
	~<futuª
>

36 
	~<ve˘‹
>

39 
usög
 
	g«me•a˚
 ::
c⁄cuºícy
;

40 
usög
 
	g«me•a˚
 ::
Wödows
::
Found©i⁄
;

41 
usög
 
	g«me•a˚
 ::
°d
;

43 
usög
 
«me•a˚
 
	gMi¸oso·
::
WRL
;

44 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
Devi˚s
;

45 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
MedüPr›îtõs
;

46 
usög
 
«me•a˚
 
	gWödows
::
Medü
::
C≠tuª
;

47 
usög
 
«me•a˚
 
	gWödows
::
UI
::
Xaml
::
Medü
::
Imagög
;

48 
usög
 
«me•a˚
 
	gWödows
::
Devi˚s
::
Enumî©i⁄
;

50 
	~"ˇp_wöπ/C≠tuªFømeGøbbî.hµ
"

53 #¥agm®
commít
(
lib
, "mfplat")

54 #¥agm®
commít
(
lib
, "mf")

55 #¥agm®
commít
(
lib
, "mfuuid")

57 #i‡(
WINAPI_FAMILY
!=
WINAPI_FAMILY_PHONE_APP
Ë&& !
deföed
(
_M_ARM
)

58 #¥agm®
commít
(
lib
, "Shlwapi")

61 
	~"ˇp_wöπ_bridge.hµ
"

63 
	gVideo
::
	$Video
(Ë{
	}
}

65 
Video
 &Video::
	$gëIn°™˚
() {

66 
Video
 
v
;

67  
v
;

68 
	}
}

70 
boﬁ
 
	gVideo
::
	$isSèπed
() {

71  
bGøbbîInôed
.
	`lﬂd
();

72 
	}
}

74 
	gVideo
::
	$˛o£Gøbbî
() {

76 
m_‰ameGøbbî
 = 
nuŒ±r
;

77 
bGøbbîInôed
 = 
Ál£
;

78 
bGøbbîInôInProgªss
 = 
Ál£
;

79 
	}
}

82 
boﬁ
 
	gVideo
::
	$öôGøbbî
(
devi˚
, 
w
, 
h
) {

84 i‡(
bGøbbîInôed
 || 
bGøbbîInôInProgªss
Ë 
Ál£
;

86 
width
 = 
w
;

87 
height
 = 
h
;

89 
bGøbbîInôed
 = 
Ál£
;

90 
bGøbbîInôInProgªss
 = 
åue
;

92 
m_devi˚ID
 = 
devi˚
;

94 
	`¸óã_èsk
(
Devi˚Inf‹m©i⁄
::
	`FödAŒAsync
(
Devi˚Cœss
::
VideoC≠tuª
))

95 .
	`thí
([
this
](
èsk
<
Devi˚Inf‹m©i⁄CﬁÀ˘i⁄
^> 
födTask
)

97 
m_devi˚s
 = 
födTask
.
	`gë
();

100 i‡(()
m_devi˚ID
 >
m_devi˚s
.
	`Gë
()->
Size
)

102 
	`OuçutDebugSåögA
("Video::initGrabber -Ço video device found\n");

103  
Ál£
;

106 autÿ
devInfo
 = 
m_devi˚s
.
	`Gë
()->
	`GëAt
(
m_devi˚ID
);

108 autÿ
£âögs
 = 
ªf
 
√w
 
	`MedüC≠tuªInôüliz©i⁄Sëtögs
();

109 
£âögs
->
SåómögC≠tuªMode
 = SåómögC≠tuªMode::
Video
;

110 
£âögs
->
VideoDevi˚Id
 = 
devInfo
->
Id
;

112 autÿ
loˇti⁄
 = 
devInfo
->
En˛osuªLoˇti⁄
;

113 
bFlùImageX
 = 
åue
;

114 i‡(
loˇti⁄
 !
nuŒ±r
 &&Üoˇti⁄->
P™ñ
 =
Wödows
::
Devi˚s
::
Enumî©i⁄
::P™ñ::
Back
)

116 
bFlùImageX
 = 
Ál£
;

119 
m_ˇ±uª
 = 
ªf
 
√w
 
	`MedüC≠tuª
();

120 
	`¸óã_èsk
(
m_ˇ±uª
->
	`InôülizeAsync
(
£âögs
)).
	`thí
([
this
](){

122 autÿ
¥›s
 = 
ß„_ˇ°
<
VideoEncodögPr›îtõs
^>(
m_ˇ±uª
->
VideoDevi˚C⁄åﬁÀr
->
	`GëMedüSåómPr›îtõs
(
MedüSåómTy≥
::
VideoPªvõw
));

125 
¥›s
->
Subty≥
 = 
MedüEncodögSubty≥s
::
Rgb24
; 
byãsPîPixñ
 = 3;

130 
¥›s
->
Width
 = 
width
;

131 
¥›s
->
Height
 = 
height
;

133  ::
Medü
::
C≠tuªFømeGøbbî
::
	`Cª©eAsync
(
m_ˇ±uª
.
	`Gë
(), 
¥›s
);

135 }).
	`thí
([
this
](::
Medü
::
C≠tuªFømeGøbbî
^ 
‰ameGøbbî
)

137 
m_‰ameGøbbî
 = 
‰ameGøbbî
;

138 
bGøbbîInôed
 = 
åue
;

139 
bGøbbîInôInProgªss
 = 
Ál£
;

141 
	`_GøbFømeAsync
(
‰ameGøbbî
);

144  
åue
;

149  
åue
;

150 
	}
}

153 
	gVideo
::
_GøbFømeAsync
(::
Medü
::
C≠tuªFømeGøbbî
^ 
‰ameGøbbî
) {

155 
¸óã_èsk
(
‰ameGøbbî
->
GëFømeAsync
()).
thí
([
this
, fømeGøbbî](c⁄° 
ComPå
<
IMF2DBuf„r2
>& 
buf„r
)

158 
BYTE
 *
pbSˇ∆öe
;

159 
LONG
 
∂Pôch
;

160 
cﬁByãs
 = 
width
 * 
byãsPîPixñ
;

161 
CHK
(
buf„r
->
Lock2D
(&
pbSˇ∆öe
, &
∂Pôch
));

164 i‡(
bFlùImageX
)

166 
°d
::
lock_gu¨d
<°d::
muãx
> 
lock
(
VideoioBridge
::
gëIn°™˚
().
öputBuf„rMuãx
);

169 autÿ
buf
 = 
VideoioBridge
::
gëIn°™˚
().
backI≈utPå
;

171 
row
 = 0;Ñow < 
height
;Ñow++)

173 
i
 = 0;

174 
j
 = 
cﬁByãs
 - 1;

176 
i
 < 
cﬁByãs
)

180 
buf
[
j
--] = 
pbSˇ∆öe
[
i
++];

181 
buf
[
j
--] = 
pbSˇ∆öe
[
i
++];

182 
buf
[
j
--] = 
pbSˇ∆öe
[
i
++];

184 
pbSˇ∆öe
 +
∂Pôch
;

185 
buf
 +
cﬁByãs
;

187 
VideoioBridge
::
gëIn°™˚
().
bIsFømeNew
 = 
åue
;

190 
°d
::
lock_gu¨d
<°d::
muãx
> 
lock
(
VideoioBridge
::
gëIn°™˚
().
öputBuf„rMuãx
);

193 autÿ
buf
 = 
VideoioBridge
::
gëIn°™˚
().
backI≈utPå
;

195 
row
 = 0;Ñow < 
height
;Ñow++)

202 
i
 = 0; i < 
cﬁByãs
; i +
byãsPîPixñ
)

205 
buf
[
i
] = 
pbSˇ∆öe
[i + 2];

206 
buf
[
i
 + 1] = 
pbSˇ∆öe
[i + 1];

207 
buf
[
i
 + 2] = 
pbSˇ∆öe
[i];

215 
pbSˇ∆öe
 +
∂Pôch
;

216 
buf
 +
cﬁByãs
;

218 
VideoioBridge
::
gëIn°™˚
().
bIsFømeNew
 = 
åue
;

220 
CHK
(
buf„r
->
U∆ock2D
());

222 
VideoioBridge
::
gëIn°™˚
().
‰ameCou¡î
++;

224 i‡(
bGøbbîInôed
)

226 
_GøbFømeAsync
(
‰ameGøbbî
);

228 }, 
èsk_c⁄töu©i⁄_c⁄ãxt
::
u£_cuºít
());

234 
	gVideo
::
	$C›yOuçut
() {

236 
°d
::
lock_gu¨d
<°d::
muãx
> 
	`lock
(
VideoioBridge
::
	`gëIn°™˚
().
ouçutBuf„rMuãx
);

238 autÿ
öAr
 = 
VideoioBridge
::
	`gëIn°™˚
().
‰⁄tI≈utPå
;

239 autÿ
outAr
 = 
	`GëD©a
(
VideoioBridge
::
	`gëIn°™˚
().
‰⁄tOuçutBuf„r
->
PixñBuf„r
);

241 c⁄° 
byãsPîPixñ
 = 3;

242 autÿ
pbSˇ∆öe
 = 
öAr
;

243 autÿ
∂Pôch
 = 
width
 * 
byãsPîPixñ
;

245 autÿ
buf
 = 
outAr
;

246 
cﬁByãs
 = 
width
 * 4;

249 
row
 = 0;Ñow < 
height
;Ñow++)

257 
i
 = 0, 
j
 = 0; i < 
∂Pôch
; i +
byãsPîPixñ
, j += 4)

260 
buf
[
j
] = 
pbSˇ∆öe
[
i
 + 2];

261 
buf
[
j
 + 1] = 
pbSˇ∆öe
[
i
 + 1];

262 
buf
[
j
 + 2] = 
pbSˇ∆öe
[
i
];

263 
buf
[
j
 + 3] = 0xff;

272 
pbSˇ∆öe
 +
∂Pôch
;

273 
buf
 +
cﬁByãs
;

275 
VideoioBridge
::
	`gëIn°™˚
().
‰⁄tOuçutBuf„r
->
PixñBuf„r
->
Lígth
 = 
width
 * 
height
 * 4;

277 
	}
}

280 
boﬁ
 
	gVideo
::
	$li°Devi˚sTask
() {

281 
°d
::
©omic
<
boﬁ
> 
	`ªady
(
Ál£
);

283 autÿ
£âögs
 = 
ªf
 
√w
 
	`MedüC≠tuªInôüliz©i⁄Sëtögs
();

285 
	`¸óã_èsk
(
Devi˚Inf‹m©i⁄
::
	`FödAŒAsync
(
Devi˚Cœss
::
VideoC≠tuª
))

286 .
	`thí
([
this
, &
ªady
](
èsk
<
Devi˚Inf‹m©i⁄CﬁÀ˘i⁄
^> 
födTask
)

288 
m_devi˚s
 = 
födTask
.
	`gë
();

300 
ªady
 = 
åue
;

304 
cou¡
 = 0;

305 !
ªady
)

307 
cou¡
++;

310  
åue
;

311 
	}
}

314 
boﬁ
 
	gVideo
::
	$li°Devi˚s
() {

316 
°d
::
futuª
<
boﬁ
> 
ªsu…
 = std::
	`async
(°d::
œunch
::
async
, &
Video
::
li°Devi˚sTask
, 
this
);

317  
ªsu…
.
	`gë
();

318 
	}
}

	@src/cap_ximea.cpp

1 
	~"¥ecomp.hµ
"

3 #ifde‡
WIN32


4 
	~"xiApi.h
"

6 
	~<m3≠i/xiApi.h
>

11 ˛as†
	cCvC≠tuªCAM_XIMEA
 : 
public
 
CvC≠tuª


13 
public
:

14 
	$CvC≠tuªCAM_XIMEA
(Ë{ 
	`öô
(); }

15 
vútuÆ
 ~
	$CvC≠tuªCAM_XIMEA
(Ë{ 
	`˛o£
(); 
	}
}

17 
vútuÆ
 
boﬁ
 
›í
–
ödex
 );

18 
vútuÆ
 
˛o£
();

19 
vútuÆ
 
	$gëPr›îty
() const;

20 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

21 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

22 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

23 
vútuÆ
 
	$gëC≠tuªDomaö
(Ë{  
CV_CAP_XIAPI
; 
	}
}

25 
	g¥iv©e
:

26 
öô
();

27 
îrMsg
(c⁄° * 
msg
, 
îrNum
);

28 
ª£tCvImage
();

29 
gëBµ
();

30 
I∂Image
* 
	g‰ame
;

32 
HANDLE
 
	ghmv
;

33 
DWORD
 
	gnumDevi˚s
;

34 
	gtimeout
;

35 
XI_IMG
 
	gimage
;

40 
CvC≠tuª
* 
	$cvCª©eCamîaC≠tuª_XIMEA
–
ödex
 )

42 
CvC≠tuªCAM_XIMEA
* 
ˇ±uª
 = 
√w
 CvCaptureCAM_XIMEA;

44 if–
ˇ±uª
->
	`›í
–
ödex
 ))

45  
ˇ±uª
;

47 
dñëe
 
ˇ±uª
;

49 
	}
}

53 
	gCvC≠tuªCAM_XIMEA
::
	$öô
()

55 #i‡
deföed
 
WIN32
 || deföed 
_WIN32


56 
	`xiGëNumbîDevi˚s
–&
numDevi˚s
);

59 i‡(
	`xiGëNumbîDevi˚s
–&
numDevi˚s
Ë!
XI_OK
)

61 
	`xiGëNumbîDevi˚s
–&
numDevi˚s
);

64 
hmv
 = 
NULL
;

65 
‰ame
 = 
NULL
;

66 
timeout
 = 0;

67 
	`mem£t
(&
image
, 0, (
XI_IMG
));

68 
	}
}

73 
boﬁ
 
	gCvC≠tuªCAM_XIMEA
::
	$›í
–
wIndex
 )

75 
	#H™dÀXiResu…
(
ªs
Ëi‡‘es!=
XI_OK
Ë
îr‹
;

	)

77 
mvªt
 = 
XI_OK
;

79 if(
numDevi˚s
 == 0)

80  
Ál£
;

82 if((
mvªt
 = 
	`xiO≥nDevi˚
–
wIndex
, &
hmv
)Ë!
XI_OK
)

84 #i‡
deföed
 
WIN32
 || deföed 
_WIN32


85 
	`îrMsg
("O≥¿XI_DEVICE faûed", 
mvªt
);

86  
Ál£
;

89 if((
mvªt
 = 
	`xiO≥nDevi˚
–
wIndex
, &
hmv
)Ë!
XI_OK
)

91 
	`îrMsg
("O≥¿XI_DEVICE faûed", 
mvªt
);

92  
Ál£
;

97 
width
 = 0;

98 
height
 = 0;

99 
isCﬁ‹
 = 0;

102 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AEAG
, 1);

103 
	`H™dÀXiResu…
(
mvªt
);

105 
mvªt
 = 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_WIDTH
, &
width
);

106 
	`H™dÀXiResu…
(
mvªt
);

108 
mvªt
 = 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_HEIGHT
, &
height
);

109 
	`H™dÀXiResu…
(
mvªt
);

111 
mvªt
 = 
	`xiGëP¨amI¡
(
hmv
, 
XI_PRM_IMAGE_IS_COLOR
, &
isCﬁ‹
);

112 
	`H™dÀXiResu…
(
mvªt
);

114 if(
isCﬁ‹
)

117 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_IMAGE_DATA_FORMAT
, 
XI_RGB24
);

118 
	`H™dÀXiResu…
(
mvªt
);

121 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AUTO_WB
, 1);

122 
	`H™dÀXiResu…
(
mvªt
);

125 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(
width
, 
height
), 
IPL_DEPTH_8U
, 3);

130 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_IMAGE_DATA_FORMAT
, 
XI_MONO8
);

131 
	`H™dÀXiResu…
(
mvªt
);

134 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
(
width
, 
height
), 
IPL_DEPTH_8U
, 1);

138 
timeout
 = 10000;

140 
mvªt
 = 
	`xiSèπAcquisôi⁄
(
hmv
);

141 if(
mvªt
 !
XI_OK
)

143 
	`îrMsg
("SèπAcquisôi⁄ XI_DEVICE faûed", 
mvªt
);

144 
îr‹
;

146  
åue
;

148 
îr‹
:

149 
	`îrMsg
("O≥¿XI_DEVICE faûed", 
mvªt
);

150 
	`xiClo£Devi˚
(
hmv
);

151 
hmv
 = 
NULL
;

152  
Ál£
;

153 
	}
}

157 
	gCvC≠tuªCAM_XIMEA
::
	$˛o£
()

159 if(
‰ame
)

160 
	`cvRñó£Image
(&
‰ame
);

162 if(
hmv
)

164 
	`xiSt›Acquisôi⁄
(
hmv
);

165 
	`xiClo£Devi˚
(
hmv
);

167 
hmv
 = 
NULL
;

168 
	}
}

172 
boﬁ
 
	gCvC≠tuªCAM_XIMEA
::
	$gøbFøme
()

174 
	`mem£t
(&
image
, 0, (
XI_IMG
));

175 
image
.
size
 = (
XI_IMG
);

176 
mvªt
 = 
	`xiGëImage
–
hmv
, 
timeout
, &
image
);

178 if(
mvªt
 =
XI_ACQUISITION_STOPED
)

180 
	`xiSèπAcquisôi⁄
(
hmv
);

181 
mvªt
 = 
	`xiGëImage
(
hmv
, 
timeout
, &
image
);

184 if(
mvªt
 !
XI_OK
)

186 
	`îrMsg
("Eº‹ durög GëImage", 
mvªt
);

187  
Ál£
;

190  
åue
;

191 
	}
}

195 
I∂Image
* 
	gCvC≠tuªCAM_XIMEA
::
	$ªåõveFøme
()

198 
	`ª£tCvImage
();

201  
image
.
‰m
)

203 
XI_MONO8
 :

204 
XI_RAW8
 : 
	`mem˝y
–
‰ame
->
imageD©a
, 
image
.
bp
, image.
width
*image.
height
); ;

205 
XI_MONO16
 :

206 
XI_RAW16
 : 
	`mem˝y
–
‰ame
->
imageD©a
, 
image
.
bp
, image.
width
*image.
height
*(
WORD
)); ;

207 
XI_RGB24
 :

208 
XI_RGB_PLANAR
 : 
	`mem˝y
–
‰ame
->
imageD©a
, 
image
.
bp
, image.
width
*image.
height
*3); ;

209 
XI_RGB32
 : 
	`mem˝y
–
‰ame
->
imageD©a
, 
image
.
bp
, image.
width
*image.
height
*4); ;

212  
‰ame
;

213 
	}
}

217 
	gCvC≠tuªCAM_XIMEA
::
	$ª£tCvImage
()

219 
width
 = 0, 
height
 = 0, 
f‹m©
 = 0;

220 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_WIDTH
, &
width
);

221 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_HEIGHT
, &
height
);

222 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_IMAGE_DATA_FORMAT
, &
f‹m©
);

224 if–()
image
.
width
 !
‰ame
->width || ()image.
height
 !‰ame->heighà|| image.
‰m
 !(
XI_IMG_FORMAT
)
f‹m©
)

226 if(
‰ame
Ë
	`cvRñó£Image
(&frame);

227 
‰ame
 = 
NULL
;

229  
image
.
‰m
)

231 
XI_MONO8
 :

232 
XI_RAW8
 : 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
–
image
.
width
, image.
height
), 
IPL_DEPTH_8U
, 1); ;

233 
XI_MONO16
 :

234 
XI_RAW16
 : 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
–
image
.
width
, image.
height
), 
IPL_DEPTH_16U
, 1); ;

235 
XI_RGB24
 :

236 
XI_RGB_PLANAR
 : 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
–
image
.
width
, image.
height
), 
IPL_DEPTH_8U
, 3); ;

237 
XI_RGB32
 : 
‰ame
 = 
	`cvCª©eImage
(
	`cvSize
–
image
.
width
, image.
height
), 
IPL_DEPTH_8U
, 4); ;

242 
	`cvZîo
(
‰ame
);

243 
	}
}

246 
	gCvC≠tuªCAM_XIMEA
::
	$gëPr›îty
–
¥›îty_id
 ) const

248 if(
hmv
 =
NULL
)

251 
ivÆ
 = 0;

252 
fvÆ
 = 0;

254  
¥›îty_id
 )

257 
CV_CAP_PROP_POS_FRAMES
 :  (Ë
image
.
n‰ame
;

258 
CV_CAP_PROP_FRAME_WIDTH
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_WIDTH
, &
ivÆ
);  ival;

259 
CV_CAP_PROP_FRAME_HEIGHT
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_HEIGHT
, &
ivÆ
);  ival;

260 
CV_CAP_PROP_FPS
 : 
	`xiGëP¨amFlﬂt
–
hmv
, 
XI_PRM_FRAMERATE
, &
fvÆ
);  fval;

261 
CV_CAP_PROP_GAIN
 : 
	`xiGëP¨amFlﬂt
–
hmv
, 
XI_PRM_GAIN
, &
fvÆ
);  fval;

262 
CV_CAP_PROP_EXPOSURE
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_EXPOSURE
, &
ivÆ
);  ival;

265 
CV_CAP_PROP_XI_DOWNSAMPLING
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_DOWNSAMPLING
, &
ivÆ
);  ival;

266 
CV_CAP_PROP_XI_DATA_FORMAT
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_IMAGE_DATA_FORMAT
, &
ivÆ
);  ival;

267 
CV_CAP_PROP_XI_OFFSET_X
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_OFFSET_X
, &
ivÆ
);  ival;

268 
CV_CAP_PROP_XI_OFFSET_Y
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_OFFSET_Y
, &
ivÆ
);  ival;

269 
CV_CAP_PROP_XI_TRG_SOURCE
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_TRG_SOURCE
, &
ivÆ
);  ival;

270 
CV_CAP_PROP_XI_GPI_SELECTOR
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_GPI_SELECTOR
, &
ivÆ
);  ival;

271 
CV_CAP_PROP_XI_GPI_MODE
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_GPI_MODE
, &
ivÆ
);  ival;

272 
CV_CAP_PROP_XI_GPI_LEVEL
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_GPI_LEVEL
, &
ivÆ
);  ival;

273 
CV_CAP_PROP_XI_GPO_SELECTOR
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_GPO_SELECTOR
, &
ivÆ
);  ival;

274 
CV_CAP_PROP_XI_GPO_MODE
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_GPO_MODE
, &
ivÆ
);  ival;

275 
CV_CAP_PROP_XI_LED_SELECTOR
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_LED_SELECTOR
, &
ivÆ
);  ival;

276 
CV_CAP_PROP_XI_LED_MODE
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_LED_MODE
, &
ivÆ
);  ival;

277 
CV_CAP_PROP_XI_AUTO_WB
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_AUTO_WB
, &
ivÆ
);  ival;

278 
CV_CAP_PROP_XI_AEAG
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_AEAG
, &
ivÆ
);  ival;

279 
CV_CAP_PROP_XI_EXP_PRIORITY
 : 
	`xiGëP¨amFlﬂt
–
hmv
, 
XI_PRM_EXP_PRIORITY
, &
fvÆ
);  fval;

280 
CV_CAP_PROP_XI_AE_MAX_LIMIT
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_AE_MAX_LIMIT
, &
ivÆ
);  ival;

281 
CV_CAP_PROP_XI_AG_MAX_LIMIT
 : 
	`xiGëP¨amFlﬂt
–
hmv
, 
XI_PRM_AG_MAX_LIMIT
, &
fvÆ
);  fval;

282 
CV_CAP_PROP_XI_AEAG_LEVEL
 : 
	`xiGëP¨amI¡
–
hmv
, 
XI_PRM_AEAG_LEVEL
, &
ivÆ
);  ival;

283 
CV_CAP_PROP_XI_TIMEOUT
 :  
timeout
;

287 
	}
}

291 
boﬁ
 
	gCvC≠tuªCAM_XIMEA
::
	$£tPr›îty
–
¥›îty_id
, 
vÆue
 )

293 
ivÆ
 = (Ë
vÆue
;

294 
fvÆ
 = (Ë
vÆue
;

296 
mvªt
 = 
XI_OK
;

298 
¥›îty_id
)

301 
CV_CAP_PROP_FRAME_WIDTH
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_WIDTH
, 
ivÆ
); ;

302 
CV_CAP_PROP_FRAME_HEIGHT
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_HEIGHT
, 
ivÆ
); ;

303 
CV_CAP_PROP_FPS
 : 
mvªt
 = 
	`xiSëP¨amFlﬂt
–
hmv
, 
XI_PRM_FRAMERATE
, 
fvÆ
); ;

304 
CV_CAP_PROP_GAIN
 : 
mvªt
 = 
	`xiSëP¨amFlﬂt
–
hmv
, 
XI_PRM_GAIN
, 
fvÆ
); ;

305 
CV_CAP_PROP_EXPOSURE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_EXPOSURE
, 
ivÆ
); ;

307 
CV_CAP_PROP_XI_DOWNSAMPLING
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_DOWNSAMPLING
, 
ivÆ
); ;

308 
CV_CAP_PROP_XI_DATA_FORMAT
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_IMAGE_DATA_FORMAT
, 
ivÆ
); ;

309 
CV_CAP_PROP_XI_OFFSET_X
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_OFFSET_X
, 
ivÆ
); ;

310 
CV_CAP_PROP_XI_OFFSET_Y
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_OFFSET_Y
, 
ivÆ
); ;

311 
CV_CAP_PROP_XI_TRG_SOURCE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_TRG_SOURCE
, 
ivÆ
); ;

312 
CV_CAP_PROP_XI_GPI_SELECTOR
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_GPI_SELECTOR
, 
ivÆ
); ;

313 
CV_CAP_PROP_XI_TRG_SOFTWARE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_TRG_SOFTWARE
, 1); ;

314 
CV_CAP_PROP_XI_GPI_MODE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_GPI_MODE
, 
ivÆ
); ;

315 
CV_CAP_PROP_XI_GPI_LEVEL
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_GPI_LEVEL
, 
ivÆ
); ;

316 
CV_CAP_PROP_XI_GPO_SELECTOR
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_GPO_SELECTOR
, 
ivÆ
); ;

317 
CV_CAP_PROP_XI_GPO_MODE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_GPO_MODE
, 
ivÆ
); ;

318 
CV_CAP_PROP_XI_LED_SELECTOR
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_LED_SELECTOR
, 
ivÆ
); ;

319 
CV_CAP_PROP_XI_LED_MODE
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_LED_MODE
, 
ivÆ
); ;

320 
CV_CAP_PROP_XI_AUTO_WB
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AUTO_WB
, 
ivÆ
); ;

321 
CV_CAP_PROP_XI_MANUAL_WB
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_MANUAL_WB
, 
ivÆ
); ;

322 
CV_CAP_PROP_XI_AEAG
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AEAG
, 
ivÆ
); ;

323 
CV_CAP_PROP_XI_EXP_PRIORITY
 : 
mvªt
 = 
	`xiSëP¨amFlﬂt
–
hmv
, 
XI_PRM_EXP_PRIORITY
, 
fvÆ
); ;

324 
CV_CAP_PROP_XI_AE_MAX_LIMIT
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AE_MAX_LIMIT
, 
ivÆ
); ;

325 
CV_CAP_PROP_XI_AG_MAX_LIMIT
 : 
mvªt
 = 
	`xiSëP¨amFlﬂt
–
hmv
, 
XI_PRM_AG_MAX_LIMIT
, 
fvÆ
); ;

326 
CV_CAP_PROP_XI_AEAG_LEVEL
 : 
mvªt
 = 
	`xiSëP¨amI¡
–
hmv
, 
XI_PRM_AEAG_LEVEL
, 
ivÆ
); ;

327 
CV_CAP_PROP_XI_TIMEOUT
 : 
timeout
 = 
ivÆ
; ;

330 if(
mvªt
 !
XI_OK
)

332 
	`îrMsg
("SëÖ¨amëîÉº‹", 
mvªt
);

333  
Ál£
;

336  
åue
;

338 
	}
}

342 
	gCvC≠tuªCAM_XIMEA
::
	$îrMsg
(c⁄° * 
msg
, 
îrNum
)

344 #i‡
deföed
 
WIN32
 || deföed 
_WIN32


345 
buf
[512]="";

346 
	`•rötf
–
buf
, "%†: %d\n", 
msg
, 
îrNum
);

347 
	`OuçutDebugSåög
(
buf
);

349 
	`Ârötf
(
°dîr
, "%†: %d\n", 
msg
, 
îrNum
);

351 
	}
}

355 
	gCvC≠tuªCAM_XIMEA
::
	$gëBµ
()

357  
image
.
‰m
)

359 
XI_MONO8
 :

360 
XI_RAW8
 :  1;

361 
XI_MONO16
 :

362 
XI_RAW16
 :  2;

363 
XI_RGB24
 :

364 
XI_RGB_PLANAR
 :  3;

365 
XI_RGB32
 :  4;

369 
	}
}

	@src/cap_xine.cpp

49 
	~"¥ecomp.hµ
"

52 
	#XINE_ENABLE_EXPERIMENTAL_FEATURES


	)

54 
	~<ˇs£π
>

58 
	~<xöe.h
>

62 c⁄° *
xöe_gë_homedú
( );

65 
	sCvC≠tuªAVI_XINE


68 
xöe_t
 * 
xöe
;

69 
xöe_°ªam_t
 * 
°ªam
;

70 
xöe_video_p‹t_t
 * 
vo_p‹t
;

73 
xöe_video_‰ame_t
 
xöe_‰ame
;

75 
I∂Image
 * 
yuv_‰ame
;

76 
I∂Image
 * 
bgr_‰ame
;

79 
CvSize
 
size
;

83 
‰ame_numbî
;

86 
‰ame_øã
;

89 
‰ame_duøti⁄
;

92 
boﬁ
 
£ekabÀ
;

95 
	tCvC≠tuªAVI_XINE
;

99 
	$icvYUY2toBGR
–
CvC≠tuªAVI_XINE
 * 
ˇ±uª
 )

101 
uöt8_t
 * 
v
 = 
ˇ±uª
->
xöe_‰ame
.
d©a
;

102 
off£t
;

103  
y
 = 0; y < 
ˇ±uª
->
yuv_‰ame
->
height
; y++ )

105 
off£t
 = 
y
 * 
ˇ±uª
->
yuv_‰ame
->
widthSãp
;

107  
x
 = 0; x < 
ˇ±uª
->
yuv_‰ame
->
width
; x++, 
off£t
 += 3 )

109 
ˇ±uª
->
yuv_‰ame
->
imageD©a
[ 
off£t
 + 1 ] = 
v
[ 3 ];

110 
ˇ±uª
->
yuv_‰ame
->
imageD©a
[ 
off£t
 + 2 ] = 
v
[ 1 ];

111 i‡–
x
 & 1 )

113 
ˇ±uª
->
yuv_‰ame
->
imageD©a
[ 
off£t
 ] = 
v
[ 2 ];

114 
v
 += 4;

118 
ˇ±uª
->
yuv_‰ame
->
imageD©a
[ 
off£t
 ] = 
v
[ 0 ];

124 
	`cvCvtCﬁ‹
–
ˇ±uª
->
yuv_‰ame
, c≠tuª->
bgr_‰ame
, 
CV_YCrCb2BGR
 );

125 
	}
}

129 
	$icvYV12toBGR
–
CvC≠tuªAVI_XINE
 * 
ˇ±uª
 )

131 
I∂Image
 * 
yuv
 = 
ˇ±uª
->
yuv_‰ame
;

132 
w_Y
 = 
ˇ±uª
->
size
.
width
;

133 
h_Y
 = 
ˇ±uª
->
size
.
height
;

135 
w_UV
 = 
w_Y
 >> 1;

137 
size_Y
 = 
w_Y
 * 
h_Y
;

138 
size_UV
 = 
size_Y
 / 4;

140 
löe
 = 
yuv
->
widthSãp
;

142 
uöt8_t
 * 
addr_Y
 = 
ˇ±uª
->
xöe_‰ame
.
d©a
;

143 
uöt8_t
 * 
addr_U
 = 
addr_Y
 + 
size_Y
;

144 
uöt8_t
 * 
addr_V
 = 
addr_U
 + 
size_UV
;

147  
y
 = 0; y < 
h_Y
; y++ )

149 
off£t
 = 
y
 * 
löe
;

150  
x
 = 0; x < 
w_Y
; x++, 
off£t
 += 3 )

158 
⁄e_zîo
 = 
x
 & 1;

159 
addr_U
 +
⁄e_zîo
;

160 
addr_V
 +
⁄e_zîo
;

162 
yuv
->
imageD©a
[ 
off£t
 ] = *–
addr_Y
++ );

163 
yuv
->
imageD©a
[ 
off£t
 + 1 ] = *
addr_U
;

164 
yuv
->
imageD©a
[ 
off£t
 + 2 ] = *
addr_V
;

167 i‡–
y
 & 1 )

169 
addr_U
 -
w_UV
;

170 
addr_V
 -
w_UV
;

175 
	`cvCvtCﬁ‹
–
ˇ±uª
->
yuv_‰ame
, c≠tuª->
bgr_‰ame
, 
CV_YCrCb2BGR
 );

176 
	}
}

178 
	$icvClo£AVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
 )

180 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

182 i‡–
ˇ±uª
->
yuv_‰ame
 ) 
	`cvRñó£Image
( &capture->yuv_frame );

183 i‡–
ˇ±uª
->
bgr_‰ame
 ) 
	`cvRñó£Image
( &capture->bgr_frame );

185 
	`xöe_˛o£
–
ˇ±uª
->
°ªam
 );

188 i‡–
ˇ±uª
->
vo_p‹t
 ) 
	`xöe_˛o£_video_drivî
–ˇ±uª->
xöe
, capture->vo_port );

190 
	`xöe_exô
–
ˇ±uª
->
xöe
 );

191 
	}
}

197 
	$icvCheckSìkAVI_XINE
–
CvC≠tuªAVI_XINE
 * 
ˇ±uª
 )

199 
	`OPENCV_ASSERT
 ( 
ˇ±uª
, "icvCheckSeekAVI_XINE( CvCaptureAVI_XINE* )", "illegal capture");

200 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

202 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

205 #i‚de‡
NDEBUG


206 
	`Ârötf
–
°dîr
, "(DEBUG) icvCheckSeekAVI_XINE ... start\n" );

210 
xöe_video_‰ame_t
 
tmp
;

212 
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 300 );

214 
	`xöe_gë_√xt_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &
tmp
 );

216 
ˇ±uª
->
£ekabÀ
 = ( 
tmp
.
‰ame_numbî
 != 0 );

218 
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 0 );

220 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &
tmp
 );

222 #i‚de‡
NDEBUG


223 i‡–
ˇ±uª
->
£ekabÀ
 )

224 
	`Ârötf
–
°dîr
, "(DEBUG) icvCheckSeekAVI_XINE: Input is seekable, using XINE seek implementation.\n" );

226 
	`Ârötf
–
°dîr
, "(DEBUG) icvCheckSeekAVI_XINE: Input is NOT seekable, using fallback function.\n" );

228 
	`Ârötf
–
°dîr
, "(DEBUG) icvCheckSeekAVI_XINE ...Énd\n" );

230 
	}
}

233 
	$icvO≥nAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, c⁄° * 
fûíame
 )

235 #i‚de‡
NDEBUG


236 
	`Ârötf
–
°dîr
, "(DEBUG) icvOpenAVI_XINE ... start\n" );

239 
c⁄figfûe
[ 2048 ];

241 
ˇ±uª
->
xöe
 = 
	`xöe_√w
();

242 
	`•rötf
–
c⁄figfûe
, "%s%s", 
	`xöe_gë_homedú
(), "/.xine/config" );

244 
	`xöe_c⁄fig_lﬂd
–
ˇ±uª
->
xöe
, 
c⁄figfûe
 );

245 
	`xöe_öô
–
ˇ±uª
->
xöe
 );

247 
	`xöe_ígöe_£t_∑øm
–
ˇ±uª
->
xöe
, 0, 0 );

248 
ˇ±uª
->
vo_p‹t
 = 
	`xöe_√w_‰amegøb_video_p‹t
–ˇ±uª->
xöe
 );

249 i‡–
ˇ±uª
->
vo_p‹t
 =
NULL
 )

251 
	`¥ötf
( "(ERROR)icvOpenAVI_XINE(): UnableÅo initialize video driver.\n" );

255 
ˇ±uª
->
°ªam
 = 
	`xöe_°ªam_√w
–ˇ±uª->
xöe
, 
NULL
, c≠tuª->
vo_p‹t
 );

257 i‡–!
	`xöe_›í
–
ˇ±uª
->
°ªam
, 
fûíame
 ) )

259 
	`¥ötf
–"(ERROR)icvO≥nAVI_XINE(): U«bÀÅÿ›í sour˚ '%s'\n", 
fûíame
 );

263 
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 0 );

267 
ˇ±uª
->
‰ame_numbî
 = 0;

269 i‡–!
	`xöe_gë_√xt_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 ) )

271 #i‚de‡
NDEBUG


272 
	`Ârötf
–
°dîr
, "(DEBUG) icvOpenAVI_XINE ... failed!\n" );

277 
ˇ±uª
->
size
 = 
	`cvSize
–ˇ±uª->
xöe_‰ame
.
width
, c≠tuª->xöe_‰ame.
height
 );

278 
ˇ±uª
->
yuv_‰ame
 = 
	`cvCª©eImage
–ˇ±uª->
size
, 
IPL_DEPTH_8U
, 3 );

279 
ˇ±uª
->
bgr_‰ame
 = 
	`cvCª©eImage
–ˇ±uª->
size
, 
IPL_DEPTH_8U
, 3 );

281 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

282 
ˇ±uª
->
xöe_‰ame
.
d©a
[ 0 ] = 0;

284 
	`icvCheckSìkAVI_XINE
–
ˇ±uª
 );

286 
ˇ±uª
->
‰ame_duøti⁄
 = 
	`xöe_gë_°ªam_öfo
–ˇ±uª->
°ªam
, 
XINE_STREAM_INFO_FRAME_DURATION
 ) / 90.;

287 
ˇ±uª
->
‰ame_øã
 = 1000 / c≠tuª->
‰ame_duøti⁄
;

289 #i‚de‡
NDEBUG


290 
	`Ârötf
–
°dîr
, "(DEBUGË‰ame_duøti⁄ = %f, fømî©ê%f\n", 
ˇ±uª
->
‰ame_duøti⁄
, c≠tuª->
‰ame_øã
 );

293 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
yuv_‰ame
,

296 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
bgr_‰ame
,

299 #i‚de‡
NDEBUG


300 
	`Ârötf
–
°dîr
, "(DEBUG) icvOpenAVI_XINE ...Énd\n" );

303 
	}
}

306 
	$icvGøbFømeAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
 )

308 #i‚de‡
NDEBUG


309 
	`Ârötf
–
°dîr
, "(DEBUG) icvGrabFrameAVI_XINE ... start\n" );

312 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

314 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

317 
ªs
 = 
	`xöe_gë_√xt_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

320 i‡–
ªs
 ) 
ˇ±uª
->
‰ame_numbî
++;

322 #i‚de‡
NDEBUG


323 
	`Ârötf
–
°dîr
, "(DEBUG) icvGrabFrameAVI_XINE ...Énd\n" );

325  
ªs
;

326 
	}
}

329 c⁄° 
I∂Image
* 
	$icvRërõveFømeAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, )

331 #i‚de‡
NDEBUG


332 
	`Ârötf
–
°dîr
, "(DEBUG) icvRetrieveFrameAVI_XINE ... start\n" );

335 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

337 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

339 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

343 
ªs
 = 0;

344 i‡–
ˇ±uª
->
xöe_‰ame
.
d©a
 == 0 )

346 
ªs
 = 
	`icvGøbFømeAVI_XINE
–
ˇ±uª
 );

350 
ªs
 = 1;

353 i‡–
ªs
 )

355  
ˇ±uª
->
xöe_‰ame
.
cﬁ‹•a˚
 )

357 
XINE_IMGFMT_YV12
: 
	`icvYV12toBGR
–
ˇ±uª
 );

358 #i‚de‡
NDEBUG


359 
	`¥ötf
( "(DEBUG)icvRetrieveFrameAVI_XINE: converted YV12Åo BGR.\n" );

363 
XINE_IMGFMT_YUY2
: 
	`icvYUY2toBGR
–
ˇ±uª
 );

364 #i‚de‡
NDEBUG


365 
	`¥ötf
( "(DEBUG)icvRetrieveFrameAVI_XINE: converted YUY2Åo BGR.\n" );

368 
XINE_IMGFMT_XVMC
: 
	`¥ötf
( "(ERROR)icvRetrieveFrameAVI_XINE: XVMC formatÇot supported!\n" );

371 
XINE_IMGFMT_XXMC
: 
	`¥ötf
( "(ERROR)icvRetrieveFrameAVI_XINE: XXMC formatÇot supported!\n" );

374 : 
	`¥ötf
( "(ERROR)icvRetrieveFrameAVI_XINE: unknown color/pixel format!\n" );

378 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

379 
ˇ±uª
->
xöe_‰ame
.
d©a
 = 0;

381 #i‚de‡
NDEBUG


382 
	`Ârötf
–
°dîr
, "(DEBUG) icvRetrieveFrameAVI_XINE ...Énd\n" );

384  
ˇ±uª
->
bgr_‰ame
;

387 #i‚de‡
NDEBUG


388 
	`Ârötf
–
°dîr
, "(DEBUG) icvRetrieveFrameAVI_XINE ... failed!\n" );

391 
	}
}

399 
	$icvOldSìkFømeAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, 
f
 )

401 #i‚de‡
NDEBUG


402 
	`Ârötf
–
°dîr
, "(DEBUG) icvOldSeekFrameAVI_XINE ... start\n" );

405 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

407 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

409 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

417 i‡–
f
 =
ˇ±uª
->
‰ame_numbî
 )

419 #i‚de‡
NDEBUG


420 
	`Ârötf
–
°dîr
, "(DEBUG) icvOldSeekFrameAVI_XINE ...Énd\n" );

426 i‡–
f
 > 
ˇ±uª
->
‰ame_numbî
 )

428  ;
ˇ±uª
->
‰ame_numbî
 < 
f
;capture->frame_number++ )

430 i‡–!
	`xöe_gë_√xt_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 ) )

432 
ˇ±uª
->
‰ame_numbî
--;

437 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

445 
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 0 );

447  
ˇ±uª
->
‰ame_numbî
 = 0; c≠tuª->‰ame_numbî < 
f
; capture->frame_number++ )

449 i‡–!
	`xöe_gë_√xt_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 ) )

451 
ˇ±uª
->
‰ame_numbî
--;

456 
	`xöe_‰ì_video_‰ame
–
ˇ±uª
->
vo_p‹t
, &ˇ±uª->
xöe_‰ame
 );

461 #i‚de‡
NDEBUG


462 
	`Ârötf
–
°dîr
, "(DEBUG) icvOldSeekFrameAVI_XINE ...Énd\n" );

464  ( 
f
 =
ˇ±uª
->
‰ame_numbî
 ) ? 1 : 0;

465 
	}
}

468 
	$icvSìkFømeAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, 
f
 )

470 #i‚de‡
NDEBUG


471 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ... start\n" );

474 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

476 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

478 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

485 i‡–
ˇ±uª
->
£ekabÀ
 )

489 
√w_time
 = ( Ë––
f
 + 1 ) * ( Ë
ˇ±uª
->
‰ame_duøti⁄
 );

491 #i‚de‡
NDEBUG


492 
	`Ârötf
–
°dîr
, "(DEBUG) calling xine_play()" );

494 i‡–
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 
√w_time
 ) )

496 #i‚de‡
NDEBUG


497 
	`Ârötf
–
°dîr
, "ok\n" );

498 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ...Énd\n" );

500 
ˇ±uª
->
‰ame_numbî
 = 
f
;

505 #i‚de‡
NDEBUG


506 
	`Ârötf
–
°dîr
, "failed\n" );

507 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ... failed\n" );

514 #i‚de‡
NDEBUG


515 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ...Énd\n" );

517  
	`icvOldSìkFømeAVI_XINE
–
ˇ±uª
, 
f
 );

519 
	}
}

522 
	$icvSìkTimeAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, 
t
 )

524 #i‚de‡
NDEBUG


525 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekTimeAVI_XINE ... start\n" );

528 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

530 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

532 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

535 #i‚de‡
NDEBUG


536 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekTimeAVI_XINE ... start\n" );

543 i‡–
ˇ±uª
->
£ekabÀ
 )

546 i‡–
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, 0, 
t
 ) )

548 
ˇ±uª
->
‰ame_numbî
 = ( Ë––Ë
t
 * c≠tuª->
‰ame_øã
 / 1000 );

549 #i‚de‡
NDEBUG


550 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ...Énd\n" );

556 #i‚de‡
NDEBUG


557 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ... failed!\n" );

564 
√w_‰ame
 = ( Ë––Ë
t
 * 
ˇ±uª
->
‰ame_øã
 / 1000 );

565 #i‚de‡
NDEBUG


566 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekFrameAVI_XINE ....end\n" );

568  
	`icvOldSìkFømeAVI_XINE
–
ˇ±uª
, 
√w_‰ame
 );

570 
	}
}

573 
	$icvSìkR©ioAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, 
øtio
 )

575 #i‚de‡
NDEBUG


576 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekRatioAVI_XINE ... start\n" );

579 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

581 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

583 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

591 i‡–
øtio
 > 1 ||Ñatio < 0 )  0;

593 i‡–
ˇ±uª
->
£ekabÀ
 )

596 
pos_t
, 
pos_l
, 
Àngth
;

597 
	`xöe_gë_pos_Àngth
–
ˇ±uª
->
°ªam
, &
pos_l
, &
pos_t
, &
Àngth
 );

598 
	`Ârötf
–
°dîr
, "øtiÿ⁄ GëPr›îty(): %d\n", 
pos_l
 );

601 i‡–
	`xöe_∂ay
–
ˇ±uª
->
°ªam
, ()(
øtio
*()
Àngth
), 0 ) )

603 
ˇ±uª
->
‰ame_numbî
 = ( Ë–
øtio
*
Àngth
 / c≠tuª->
‰ame_duøti⁄
 );

607 #i‚de‡
NDEBUG


608 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekRatioAVI_XINE ... failed!\n" );

616 
	`Ârötf
–
°dîr
, "icvSeekRatioAVI_XINE(): SeekÇot supported by stream !\n" );

617 
	`Ârötf
–
°dîr
, "icvSeekRatioAVI_XINE(): (seek in stream with NO seek support NOT implemented...yet!)\n" );

618 #i‚de‡
NDEBUG


619 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekRatioAVI_XINE ... failed!\n" );

624 #i‚de‡
NDEBUG


625 
	`Ârötf
–
°dîr
, "(DEBUG) icvSeekRatioAVI_XINE ...Énd!\n" );

628 
	}
}

631 
	$icvGëPr›îtyAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
, 
¥›îty_id
 )

633 #i‚de‡
NDEBUG


634 
	`Ârötf
–
°dîr
, "(DEBUG) icvGetPropertyAVI_XINE ... start\n" );

637 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

639 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

641 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

643 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
xöe
,

645 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
bgr_‰ame
,

652 
pos_t
, 
pos_l
, 
Àngth
;

653 
	`xöe_gë_pos_Àngth
–
ˇ±uª
->
°ªam
, &
pos_l
, &
pos_t
, &
Àngth
 );

654 
	`Ârötf
–
°dîr
, "øtiÿ⁄ GëPr›îty(): %i\n", 
pos_l
 );

656  
¥›îty_id
 )

659 
CV_CAP_PROP_POS_MSEC
:

660 i‡–!
ˇ±uª
->
£ekabÀ
 )

662 
	`Ârötf
–
°dîr
, "(ERROR) GetPropertyAVI_XINE(CV_CAP_PROP_POS_MSEC:\n" );

663 
	`Ârötf
–
°dîr
, " Stream is NOT seekable, soÖosition info may NOT be valid !!\n" );

665  
pos_t
;

668 
CV_CAP_PROP_POS_FRAMES
:

670  
ˇ±uª
->
‰ame_numbî
;

674 
CV_CAP_PROP_POS_AVI_RATIO
:

675 i‡–!
ˇ±uª
->
£ekabÀ
 )

677 
	`Ârötf
–
°dîr
, "(ERROR) GetPropertyAVI_XINE(CV_CAP_PROP_POS_AVI_RATIO:\n" );

678 
	`Ârötf
–
°dîr
, " Stream is NOT seekable, soÑatio info may NOT be valid !!\n" );

680 i‡–
Àngth
 == 0 ) ;

681  
pos_l
 / 65535;

685 
CV_CAP_PROP_FRAME_WIDTH
:

686  
ˇ±uª
->
size
.
width
;

689 
CV_CAP_PROP_FRAME_HEIGHT
:

690  
ˇ±uª
->
size
.
height
;

693 
CV_CAP_PROP_FPS
:

694 i‡–!
ˇ±uª
->
£ekabÀ
 )

696 
	`Ârötf
–
°dîr
, "(ERROR) GetPropertyAVI_XINE(CV_CAP_PROP_FPS:\n" );

697 
	`Ârötf
–
°dîr
, " Stream is NOT seekable, so FPS info may NOT be valid !!\n" );

699  
ˇ±uª
->
‰ame_øã
;

702 
CV_CAP_PROP_FOURCC
:

703  ( Ë
	`xöe_gë_°ªam_öfo
–
ˇ±uª
->
°ªam
, 
XINE_STREAM_INFO_VIDEO_FOURCC
 );

706 #i‚de‡
NDEBUG


707 
	`Ârötf
–
°dîr
, "(DEBUG) icvGetPropertyAVI_XINE ... failed!\n" );

711 
	}
}

714 
	$icvSëPr›îtyAVI_XINE
–
CvC≠tuªAVI_XINE
* 
ˇ±uª
,

715 
¥›îty_id
, 
vÆue
 )

717 #i‚de‡
NDEBUG


718 
	`Ârötf
–
°dîr
, "(DEBUG) icvSetPropertyAVI_XINE ... start\n" );

721 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

723 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
°ªam
,

725 
	`OPENCV_ASSERT
 ( 
ˇ±uª
->
vo_p‹t
,

732 #i‚de‡
NDEBUG


733 
	`Ârötf
–
°dîr
, "(DEBUGËicvSëPr›îtyAVI_XINE: sìkögÅÿvÆuê%‡... ", 
vÆue
 );

736  
¥›îty_id
 )

739 
CV_CAP_PROP_POS_MSEC
:

740  
	`icvSìkTimeAVI_XINE
–
ˇ±uª
, ( Ë
vÆue
 );

743 
CV_CAP_PROP_POS_FRAMES
:

744  
	`icvSìkFømeAVI_XINE
–
ˇ±uª
, ( Ë
vÆue
 );

748 
CV_CAP_PROP_POS_AVI_RATIO
:

749  
	`icvSìkR©ioAVI_XINE
–
ˇ±uª
, 
vÆue
 );

752 #i‚de‡
NDEBUG


753 
	`Ârötf
–
°dîr
, "(DEBUG) icvSetPropertyAVI_XINE ... failed!\n" );

758 
	}
}

761 
CvC≠tuªAVI_XINE
* 
	$icvC≠tuªFromFûe_XINE
–c⁄° * 
fûíame
 )

764 
CvC≠tuªAVI_XINE
 * 
ˇ±uª
 = ( CvC≠tuªAVI_XINE* ) 
	`cvAŒoc
 (  ( CvCaptureAVI_XINE ) );

765 
	`mem£t
–
ˇ±uª
, 0,  ( 
CvC≠tuªAVI_XINE
 ) );

768 i‡–!
	`icvO≥nAVI_XINE
–
ˇ±uª
, 
fûíame
 ) )

771 
	`OPENCV_ASSERT
 ( 
ˇ±uª
,

774  
ˇ±uª
;

776 
	}
}

780 ˛as†
	cCvC≠tuªAVI_XINE_CPP
 : 
public
 
CvC≠tuª


782 
public
:

783 
	$CvC≠tuªAVI_XINE_CPP
(Ë{ 
ˇ±uªXINE
 = 0; }

784 
vútuÆ
 ~
	$CvC≠tuªAVI_XINE_CPP
(Ë{ 
	`˛o£
(); 
	}
}

786 
vútuÆ
 
boﬁ
 
›í
–c⁄° * 
fûíame
 );

787 
vútuÆ
 
˛o£
();

789 
vútuÆ
 
	$gëPr›îty
() const;

790 
vútuÆ
 
boﬁ
 
	`£tPr›îty
(, );

791 
vútuÆ
 
boﬁ
 
	`gøbFøme
();

792 
vútuÆ
 
I∂Image
* 
	`ªåõveFøme
();

793 
¥Ÿe˘ed
:

795 
CvC≠tuªAVI_XINE
* 
ˇ±uªXINE
;

796 
	}
};

798 
boﬁ
 
	gCvC≠tuªAVI_XINE_CPP
::
	$›í
–c⁄° * 
fûíame
 )

800 
	`˛o£
();

801 
ˇ±uªXINE
 = 
	`icvC≠tuªFromFûe_XINE
(
fûíame
);

802  
ˇ±uªXINE
 != 0;

803 
	}
}

805 
	gCvC≠tuªAVI_XINE_CPP
::
	$˛o£
()

807 if–
ˇ±uªXINE
 )

809 
	`icvClo£AVI_XINE
–
ˇ±uªXINE
 );

810 
	`cvFªe
–&
ˇ±uªXINE
 );

812 
	}
}

814 
boﬁ
 
	gCvC≠tuªAVI_XINE_CPP
::
	$gøbFøme
()

816  
ˇ±uªXINE
 ? 
	`icvGøbFømeAVI_XINE
–ˇ±uªXINE ) !0 : 
Ál£
;

817 
	}
}

819 
I∂Image
* 
	gCvC≠tuªAVI_XINE_CPP
::
	$ªåõveFøme
()

821  
ˇ±uªXINE
 ? (
I∂Image
*)
	`icvRërõveFømeAVI_XINE
( captureXINE, 0 ) : 0;

822 
	}
}

824 
	gCvC≠tuªAVI_XINE_CPP
::
	$gëPr›îty
–
¥›Id
 ) const

826  
ˇ±uªXINE
 ? 
	`icvGëPr›îtyAVI_XINE
–ˇ±uªXINE, 
¥›Id
 ) : 0;

827 
	}
}

829 
boﬁ
 
	gCvC≠tuªAVI_XINE_CPP
::
	$£tPr›îty
–
¥›Id
, 
vÆue
 )

831  
ˇ±uªXINE
 ? 
	`icvSëPr›îtyAVI_XINE
–ˇ±uªXINE, 
¥›Id
, 
vÆue
 ) !0 : 
Ál£
;

832 
	}
}

834 
CvC≠tuª
* 
	$cvCª©eFûeC≠tuª_XINE
(c⁄° * 
fûíame
)

836 
CvC≠tuªAVI_XINE_CPP
* 
ˇ±uª
 = 
√w
 CvCaptureAVI_XINE_CPP;

838 if–
ˇ±uª
->
	`›í
(
fûíame
))

839  
ˇ±uª
;

841 
dñëe
 
ˇ±uª
;

843 
	}
}

846 #unde‡
NDEBUG


	@test/test_basic_props.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio.hµ
"

45 
	~"›ícv2/ts.hµ
"

46 
	~<°dio.h
>

48 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT


50 
usög
 
«me•a˚
 
	gcv
;

51 
usög
 
«me•a˚
 
	g°d
;

52 
usög
 
«me•a˚
 
	gcvã°
;

54 #ifde‡
HAVE_GSTREAMER


55 c⁄° 
°rög
 
	gext
[] = {"avi"};

57 c⁄° 
°rög
 
	gext
[] = {"avi", "mov", "mp4"};

60 
	$TEST
(
Videoio_Video
, 
¥›_ªsﬁuti⁄
)

62 c⁄° 
size_t
 
n
 = (
ext
)/(ext[0]);

63 c⁄° 
°rög
 
§c_dú
 = 
TS
::
	`±r
()->
	`gë_d©a_∑th
();

65 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

67 
size_t
 
i
 = 0; i < 
n
; ++i)

69 
°rög
 
fûe_∑th
 = 
§c_dú
+"video/big_buck_bu¬y."+
ext
[
i
];

70 
VideoC≠tuª
 
	`ˇp
(
fûe_∑th
);

71 i‡(!
ˇp
.
	`isO≥√d
())

73 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

74 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "Error: cannotÑead source video file.\n");

75 
TS
::
	`±r
()->
	`£t_Áûed_ã°_öfo
(
cvã°
::TS::
FAIL_INVALID_TEST_DATA
);

79 
	`ASSERT_EQ
(672, 
ˇp
.
	`gë
(
CAP_PROP_FRAME_WIDTH
));

80 
	`ASSERT_EQ
(384, 
ˇp
.
	`gë
(
CAP_PROP_FRAME_HEIGHT
));

82 
	}
}

84 
	$TEST
(
Videoio_Video
, 
a˘uÆ_ªsﬁuti⁄
)

86 c⁄° 
size_t
 
n
 = (
ext
)/(ext[0]);

87 c⁄° 
°rög
 
§c_dú
 = 
TS
::
	`±r
()->
	`gë_d©a_∑th
();

89 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

91 
size_t
 
i
 = 0; i < 
n
; ++i)

93 
°rög
 
fûe_∑th
 = 
§c_dú
+"video/big_buck_bu¬y."+
ext
[
i
];

94 
VideoC≠tuª
 
	`ˇp
(
fûe_∑th
);

95 i‡(!
ˇp
.
	`isO≥√d
())

97 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

98 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "Error: cannotÑead source video file.\n");

99 
TS
::
	`±r
()->
	`£t_Áûed_ã°_öfo
(
cvã°
::TS::
FAIL_INVALID_TEST_DATA
);

103 
M©
 
‰ame
;

104 
ˇp
 >> 
‰ame
;

106 
	`ASSERT_EQ
(672, 
‰ame
.
cﬁs
);

107 
	`ASSERT_EQ
(384, 
‰ame
.
rows
);

109 
	}
}

111 
	$TEST
(
Videoio_Video
, 
DISABLED_¥›_Âs
)

113 c⁄° 
size_t
 
n
 = (
ext
)/(ext[0]);

114 c⁄° 
°rög
 
§c_dú
 = 
TS
::
	`±r
()->
	`gë_d©a_∑th
();

116 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

118 
size_t
 
i
 = 0; i < 
n
; ++i)

120 
°rög
 
fûe_∑th
 = 
§c_dú
+"video/big_buck_bu¬y."+
ext
[
i
];

121 
VideoC≠tuª
 
	`ˇp
(
fûe_∑th
);

122 i‡(!
ˇp
.
	`isO≥√d
())

124 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

125 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "Error: cannotÑead source video file.\n");

126 
TS
::
	`±r
()->
	`£t_Áûed_ã°_öfo
(
cvã°
::TS::
FAIL_INVALID_TEST_DATA
);

130 
	`ASSERT_EQ
(24, 
ˇp
.
	`gë
(
CAP_PROP_FPS
));

132 
	}
}

134 
	$TEST
(
Videoio_Video
, 
¥›_‰amecou¡
)

136 c⁄° 
size_t
 
n
 = (
ext
)/(ext[0]);

137 c⁄° 
°rög
 
§c_dú
 = 
TS
::
	`±r
()->
	`gë_d©a_∑th
();

139 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

141 
size_t
 
i
 = 0; i < 
n
; ++i)

143 
°rög
 
fûe_∑th
 = 
§c_dú
+"video/big_buck_bu¬y."+
ext
[
i
];

144 
VideoC≠tuª
 
	`ˇp
(
fûe_∑th
);

145 i‡(!
ˇp
.
	`isO≥√d
())

147 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

148 
TS
::
	`±r
()->
	`¥ötf
(
cvã°
::TS::
LOG
, "Error: cannotÑead source video file.\n");

149 
TS
::
	`±r
()->
	`£t_Áûed_ã°_öfo
(
cvã°
::TS::
FAIL_INVALID_TEST_DATA
);

153 
	`ASSERT_EQ
(125, 
ˇp
.
	`gë
(
CAP_PROP_FRAME_COUNT
));

155 
	}
}

	@test/test_ffmpeg.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio.hµ
"

46 
usög
 
«me•a˚
 
	gcv
;

48 #ifde‡
HAVE_FFMPEG


50 
usög
 
«me•a˚
 
	g°d
;

52 c⁄° * 
	gAVI_EXT
 = ".avi";

53 c⁄° * 
	gMP4_EXT
 = ".mp4";

55 ˛as†
	cCV_FFm≥gWrôeBigVideoTe°
 : 
public
 
cvã°
::
Ba£Te°


57 
	sTe°F‹m©E¡ry
 {

58 
èg
;

59 c⁄° * 
	mext
;

60 
boﬁ
 
	mªquúed
;

63 
	$gëFûeSize
(
°rög
 
fûíame
)

65 
FILE
 *
p_fûe
 = 
NULL
;

66 
p_fûe
 = 
	`f›í
(
fûíame
.
	`c_°r
(), "rb");

67 i‡(
p_fûe
 =
NULL
)

69 
	`f£ek
(
p_fûe
, 0, 
SEEK_END
);

70 
size
 = 
	`·ñl
(
p_fûe
);

71 
	`f˛o£
(
p_fûe
);

72  
size
;

73 
	}
}

74 
	gpublic
:

75 
	$run
()

77 c⁄° 
img_r
 = 4096;

78 c⁄° 
img_c
 = 4096;

79 c⁄° 
Âs0
 = 15;

80 c⁄° 
time_£c
 = 1;

82 c⁄° 
Te°F‹m©E¡ry
 
íåõs
[] = {

83 {0, 
AVI_EXT
, 
åue
},

86 {
VideoWrôî
::
	`fourcc
('D', 'X', '5', '0'), 
AVI_EXT
, 
åue
},

87 {
VideoWrôî
::
	`fourcc
('F', 'L', 'V', '1'), 
AVI_EXT
, 
åue
},

88 {
VideoWrôî
::
	`fourcc
('H', '2', '6', '1'), 
AVI_EXT
, 
åue
},

89 {
VideoWrôî
::
	`fourcc
('H', '2', '6', '3'), 
AVI_EXT
, 
åue
},

90 {
VideoWrôî
::
	`fourcc
('I', '4', '2', '0'), 
AVI_EXT
, 
åue
},

92 {
VideoWrôî
::
	`fourcc
('M', 'J', 'P', 'G'), 
AVI_EXT
, 
åue
},

93 {
VideoWrôî
::
	`fourcc
('m', 'p', '4', 'v'), 
AVI_EXT
, 
åue
},

94 {
VideoWrôî
::
	`fourcc
('M', 'P', 'E', 'G'), 
AVI_EXT
, 
åue
},

97 {
VideoWrôî
::
	`fourcc
('X', 'V', 'I', 'D'), 
AVI_EXT
, 
åue
},

99 {
VideoWrôî
::
	`fourcc
('H', '2', '6', '4'), 
MP4_EXT
, 
Ál£
}

102 c⁄° 
size_t
 
n
 = (
íåõs
)/(entries[0]);

104 
size_t
 
j
 = 0; j < 
n
; ++j)

106 
èg
 = 
íåõs
[
j
].tag;

107 c⁄° * 
ext
 = 
íåõs
[
j
].ext;

108 
°rög
 
s
 = 
cv
::
	`f‹m©
("%08x%s", 
èg
, 
ext
);

110 c⁄° 
°rög
 
fûíame
 = 
	`ãmpfûe
(
s
.
	`c_°r
());

112 
åy


114 
Âs
 = 
Âs0
;

115 
Size
 
‰ame_s
 = 
	`Size
(
img_c
, 
img_r
);

117 if–
èg
 =
VideoWrôî
::
	`fourcc
('H', '2', '6', '1') )

118 
‰ame_s
 = 
	`Size
(352, 288);

119 if–
èg
 =
VideoWrôî
::
	`fourcc
('H', '2', '6', '3') )

120 
‰ame_s
 = 
	`Size
(704, 576);

125 if–
èg
 =
VideoWrôî
::
	`fourcc
('M', 'P', 'E', 'G') )

127 
‰ame_s
 = 
	`Size
(720, 576);

128 
Âs
 = 25;

131 
VideoWrôî
 
	`wrôî
(
fûíame
, 
èg
, 
Âs
, 
‰ame_s
);

133 i‡(
wrôî
.
	`isO≥√d
(Ë=
Ál£
)

135 
	`Ârötf
(
°dîr
, "\n\nFûê«me: %s\n", 
fûíame
.
	`c_°r
());

136 
	`Ârötf
(
°dîr
, "Code¯id: %d Code¯èg: %c%c%c%c\n", ()
j
,

137 
èg
 & 255, (tag >> 8) & 255, (tag >> 16) & 255, (tag >> 24) & 255);

138 
	`Ârötf
(
°dîr
, "Error: cannot create video file.");

139 i‡(
íåõs
[
j
].
ªquúed
)

140 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

144 
M©
 
	`img
(
‰ame_s
, 
CV_8UC3
, 
Sˇœr
::
	`Æl
(0));

145 c⁄° 
c€ff
 = 
	`cvRound
(
	`mö
(
‰ame_s
.
width
, føme_s.
height
)/(
Âs0
 * 
time_£c
));

147 
i
 = 0 ; i < 
°©ic_ˇ°
<>(
Âs
 * 
time_£c
); i++ )

150 
	`ª˘™gÀ
(
img
, 
	`Poöt2i
(
c€ff
 * 
i
, coeff * i), Point2i(coeff * (i + 1), coeff * (i + 1)),

151 
Sˇœr
::
	`Æl
(255 * (1.0 - 
°©ic_ˇ°
<>(
i
Ë/ (
Âs
 * 
time_£c
 * 2) )), -1);

152 
wrôî
 << 
img
;

155 
wrôî
.
	`ªÀa£
();

156 
sz
 = 
	`gëFûeSize
(
fûíame
);

157 i‡(
sz
 < 0)

159 
	`Ârötf
(
°dîr
, "ERROR: Fûê«me: %†wa†nŸ cª©ed\n", 
fûíame
.
	`c_°r
());

160 i‡(
íåõs
[
j
].
ªquúed
)

161 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

165 i‡(
sz
 < 8192)

167 
	`Ârötf
(
°dîr
, "ERROR: Fûê«me: %†i†vîy smÆ»(d©®wrôê¥obÀms?)\n", 
fûíame
.
	`c_°r
());

168 i‡(
íåõs
[
j
].
ªquúed
)

169 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

171 
	`ªmove
(
fûíame
.
	`c_°r
());

175 
	`ˇtch
(...)

177 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

179 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
OK
);

181 
	}
}

184 
	$TEST
(
Videoio_Video
, 
ffm≥g_wrôebig
Ë{ 
CV_FFm≥gWrôeBigVideoTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

186 ˛as†
	cCV_FFm≥gRódImageTe°
 : 
public
 
cvã°
::
Ba£Te°


188 
public
:

189 
	$run
()

191 
åy


193 
°rög
 
fûíame
 = 
ts
->
	`gë_d©a_∑th
() + "readwrite/ordinary.bmp";

194 
VideoC≠tuª
 
	`ˇp
(
fûíame
);

195 
M©
 
img0
 = 
	`imªad
(
fûíame
, 1);

196 
M©
 
img
, 
img_√xt
;

197 
ˇp
 >> 
img
;

198 
ˇp
 >> 
img_√xt
;

200 
	`CV_As£π
–!
img0
.
	`em±y
(Ë&& !
img
.em±y(Ë&& 
img_√xt
.empty() );

202 
diff
 = 
cvã°
::
	`n‹m
(
img0
, 
img
, 
CV_C
);

203 
	`CV_As£π
–
diff
 == 0 );

205 
	`ˇtch
(...)

207 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

209 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
OK
);

211 
	}
};

213 
	$TEST
(
Videoio_Video
, 
ffm≥g_image
Ë{ 
CV_FFm≥gRódImageTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

217 #i‡
deföed
(
HAVE_FFMPEG
)

221 ˛as†
	cCª©eVideoWrôîInvokî
 :

222 
public
 
P¨ÆÀlLo›Body


224 
public
:

225 c⁄° 
Size
 
FømeSize
;

226 
	m°d
::
°rög
 
TmpDúe˘‹y
;

228 
Cª©eVideoWrôîInvokî
(
°d
::
ve˘‹
<
VideoWrôî
*>& 
_wrôîs
, std::ve˘‹<°d::
°rög
>& 
_fûes
) :

229 
P¨ÆÀlLo›Body
(), 
wrôîs
(&
_wrôîs
), 
	$fûes
(&
_fûes
)

233 
vútuÆ
 
	$›î©‹
(Ë(c⁄° 
R™ge
& 
ønge
) const

235 
i
 = 
ønge
.
°¨t
; i !ønge.
íd
; ++i)

237 
°d
::
o°rög°ªam
 
°ªam
;

238 
°ªam
 << 
i
 << ".avi";

239 
°d
::
°rög
 
fûeName
 = 
	`ãmpfûe
(
°ªam
.
	`°r
().
	`c_°r
());

241 
fûes
->
›î©‹
[](
i
Ë
fûeName
;

242 
wrôîs
->
›î©‹
[](
i
Ë
√w
 
	`VideoWrôî
(
fûeName
, 
VideoWrôî
::
	`fourcc
('X','V','I','D'), 25.0f, 
FømeSize
);

244 
	`CV_As£π
(
wrôîs
->
›î©‹
[](
i
)->
	`isO≥√d
());

246 
	}
}

248 
	g¥iv©e
:

249 
°d
::
ve˘‹
<
VideoWrôî
*>* 
wrôîs
;

250 
	g°d
::
ve˘‹
<
°d
::
°rög
>* 
fûes
;

253 
	g°d
::
°rög
 
Cª©eVideoWrôîInvokî
::
TmpDúe˘‹y
;

254 c⁄° 
Size
 
	gCª©eVideoWrôîInvokî
::
FømeSize
(1020, 900);

256 ˛as†
	cWrôeVideo_Invokî
 :

257 
public
 
P¨ÆÀlLo›Body


259 
public
:

260 íum { 
FømeCou¡
 = 300 };

262 c⁄° 
Sˇœr
 
	gObje˘Cﬁ‹
;

263 c⁄° 
Poöt
 
	gCíãr
;

265 
WrôeVideo_Invokî
(c⁄° 
°d
::
ve˘‹
<
VideoWrôî
*>& 
_wrôîs
) :

266 
P¨ÆÀlLo›Body
(), 
	$wrôîs
(&
_wrôîs
)

268 
	}
}

270 
	$Gíî©eFøme
(
M©
& 
‰ame
, 
i
)

272 
‰ame
 = 
Sˇœr
::
	`Æl
(
i
 % 255);

274 
°d
::
°rög
 
ãxt
 = 
	`to_°rög
(
i
);

275 
	`putText
(
‰ame
, 
ãxt
, 
	`Poöt
(50, 
Cíãr
.
y
), 
FONT_HERSHEY_SIMPLEX
, 5.0, 
Obje˘Cﬁ‹
, 5, 
CV_AA
);

276 
	`cú˛e
(
‰ame
, 
Cíãr
, 
i
 + 2, 
Obje˘Cﬁ‹
, 2, 
CV_AA
);

277 
	}
}

279 
vútuÆ
 
	$›î©‹
(Ë(c⁄° 
R™ge
& 
ønge
) const

281 
j
 = 
ønge
.
°¨t
; j <Ñ™ge.
íd
; ++j)

283 
VideoWrôî
* 
wrôî
 = 
wrôîs
->
›î©‹
[](
j
);

284 
	`CV_As£π
(
wrôî
 !
NULL
);

285 
	`CV_As£π
(
wrôî
->
	`isO≥√d
());

287 
M©
 
	`‰ame
(
Cª©eVideoWrôîInvokî
::
FømeSize
, 
CV_8UC3
);

288 
i
 = 0; i < 
FømeCou¡
; ++i)

290 
	`Gíî©eFøme
(
‰ame
, 
i
);

291 
wrôî
->
›î©‹
<< (
‰ame
);

294 
	}
}

296 
	g¥Ÿe˘ed
:

297 
°d
::
°rög
 
	$to_°rög
(
i
)

299 
°d
::
°rög°ªam
 
	`°ªam
(°d::
ios
::
out
);

300 
°ªam
 << "‰amê#" << 
i
;

301  
°ªam
.
	`°r
();

302 
	}
}

304 
	g¥iv©e
:

305 c⁄° 
°d
::
ve˘‹
<
VideoWrôî
*>* 
wrôîs
;

308 c⁄° 
Sˇœr
 
	gWrôeVideo_Invokî
::
Obje˘Cﬁ‹
(Sˇœr::
Æl
(0));

309 c⁄° 
Poöt
 
	gWrôeVideo_Invokî
::
Cíãr
(
Cª©eVideoWrôîInvokî
::
FømeSize
.
height
 / 2,

310 
Cª©eVideoWrôîInvokî
::
FømeSize
.
width
 / 2);

312 ˛as†
	cCª©eVideoC≠tuªInvokî
 :

313 
public
 
P¨ÆÀlLo›Body


315 
public
:

316 
Cª©eVideoC≠tuªInvokî
(
°d
::
ve˘‹
<
VideoC≠tuª
*>& 
_ªadîs
, c⁄° std::ve˘‹<°d::
°rög
>& 
_fûes
) :

317 
P¨ÆÀlLo›Body
(), 
ªadîs
(&
_ªadîs
), 
	$fûes
(&
_fûes
)

321 
vútuÆ
 
	$›î©‹
(Ë(c⁄° 
R™ge
& 
ønge
) const

323 
i
 = 
ønge
.
°¨t
; i !ønge.
íd
; ++i)

325 
ªadîs
->
›î©‹
[](
i
Ë
√w
 
	`VideoC≠tuª
(
fûes
->operator[](i));

326 
	`CV_As£π
(
ªadîs
->
›î©‹
[](
i
)->
	`isO≥√d
());

328 
	}
}

329 
	g¥iv©e
:

330 
°d
::
ve˘‹
<
VideoC≠tuª
*>* 
ªadîs
;

331 c⁄° 
	g°d
::
ve˘‹
<
°d
::
°rög
>* 
fûes
;

334 ˛as†
	cRódImageAndTe°
 :

335 
public
 
P¨ÆÀlLo›Body


337 
public
:

338 
RódImageAndTe°
(c⁄° 
°d
::
ve˘‹
<
VideoC≠tuª
*>& 
_ªadîs
, 
cvã°
::
TS
* 
_ts
) :

339 
P¨ÆÀlLo›Body
(), 
ªadîs
(&
_ªadîs
), 
	$ts
(
_ts
)

343 
vútuÆ
 
	$›î©‹
(Ë(c⁄° 
R™ge
& 
ønge
) const

345 
j
 = 
ønge
.
°¨t
; j <Ñ™ge.
íd
; ++j)

347 
VideoC≠tuª
* 
ˇ±uª
 = 
ªadîs
->
›î©‹
[](
j
);

348 
	`CV_As£π
(
ˇ±uª
 !
NULL
);

349 
	`CV_As£π
(
ˇ±uª
->
	`isO≥√d
());

351 c⁄° 
ïs
 = 23.0;

352 
‰ameCou¡
 = 
°©ic_ˇ°
<>(
ˇ±uª
->
	`gë
(
CAP_PROP_FRAME_COUNT
));

353 
	`CV_As£π
(
‰ameCou¡
 =
WrôeVideo_Invokî
::
FømeCou¡
);

354 
M©
 
	`ª„ªn˚
(
Cª©eVideoWrôîInvokî
::
FømeSize
, 
CV_8UC3
);

356 
i
 = 0; i < 
‰ameCou¡
 && 
√xt
; ++i)

358 
M©
 
a˘uÆ
;

359 (*
ˇ±uª
Ë>> 
a˘uÆ
;

361 
WrôeVideo_Invokî
::
	`Gíî©eFøme
(
ª„ªn˚
, 
i
);

363 
	`EXPECT_EQ
(
ª„ªn˚
.
cﬁs
, 
a˘uÆ
.cols);

364 
	`EXPECT_EQ
(
ª„ªn˚
.
rows
, 
a˘uÆ
.rows);

365 
	`EXPECT_EQ
(
ª„ªn˚
.
	`dïth
(), 
a˘uÆ
.depth());

366 
	`EXPECT_EQ
(
ª„ªn˚
.
	`ch™√ls
(), 
a˘uÆ
.channels());

368 
p¢r
 = 
cvã°
::
	`PSNR
(
a˘uÆ
, 
ª„ªn˚
);

369 i‡(
p¢r
 < 
ïs
)

371 
	#SUM
 
cvã°
::
TS
::
SUMMARY


	)

372 
ts
->
	`¥ötf
(
SUM
, "\nPSNR: %lf\n", 
p¢r
);

373 
ts
->
	`¥ötf
(
SUM
, "Videÿ#: %d\n", 
ønge
.
°¨t
);

374 
ts
->
	`¥ötf
(
SUM
, "Fømê#: %d\n", 
i
);

375 #unde‡
SUM


376 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
FAIL_BAD_ACCURACY
);

377 
ts
->
	`£t_gã°_°©us
();

379 
M©
 
diff
;

380 
	`absdiff
(
a˘uÆ
, 
ª„ªn˚
, 
diff
);

382 
	`EXPECT_EQ
(
	`cou¡N⁄Zîo
(
diff
.
	`ªsh≠e
(1) > 1), 0);

384 
√xt
 = 
Ál£
;

388 
	}
}

390 
boﬁ
 
	g√xt
;

392 
	g¥iv©e
:

393 c⁄° 
°d
::
ve˘‹
<
VideoC≠tuª
*>* 
ªadîs
;

394 
	gcvã°
::
TS
* 
ts
;

397 
boﬁ
 
	gRódImageAndTe°
::
√xt
;

399 
	$TEST
(
Videoio_Video_∑øŒñ_wrôîs_™d_ªadîs
, 
accuøcy
)

401 c⁄° 
thªadsCou¡
 = 4;

402 
cvã°
::
TS
* 
ts
 = cvã°::TS::
	`±r
();

405 
°d
::
ve˘‹
<
VideoWrôî
*> 
	`wrôîs
(
thªadsCou¡
);

406 
R™ge
 
	`ønge
(0, 
thªadsCou¡
);

407 
°d
::
ve˘‹
<°d::
°rög
> 
	`fûes
(
thªadsCou¡
);

408 
Cª©eVideoWrôîInvokî
 
	`övokî1
(
wrôîs
, 
fûes
);

409 
	`∑øŒñ_f‹_
(
ønge
, 
övokî1
);

412 
	`∑øŒñ_f‹_
(
ønge
, 
	`WrôeVideo_Invokî
(
wrôîs
));

415 
°d
::
ve˘‹
<
VideoWrôî
*>::
ôî©‹
 
i
 = 
wrôîs
.
	`begö
(), 
íd
 = wrôîs.
	`íd
(); i !=Énd; ++i)

416 
dñëe
 *
i
;

417 
wrôîs
.
	`˛ór
();

419 
°d
::
ve˘‹
<
VideoC≠tuª
*> 
	`ªadîs
(
thªadsCou¡
);

420 
Cª©eVideoC≠tuªInvokî
 
	`övokî2
(
ªadîs
, 
fûes
);

421 
	`∑øŒñ_f‹_
(
ønge
, 
övokî2
);

423 
RódImageAndTe°
::
√xt
 = 
åue
;

425 
	`∑øŒñ_f‹_
(
ønge
, 
	`RódImageAndTe°
(
ªadîs
, 
ts
));

428 
°d
::
ve˘‹
<°d::
°rög
>::
c⁄°_ôî©‹
 
i
 = 
fûes
.
	`begö
(), 
íd
 = fûes.
	`íd
(); i !=Énd; ++i)

430 
code
 = 
	`ªmove
(
i
->
	`c_°r
());

431 i‡(
code
 == 1)

432 
°d
::
˚º
 << "Couldn'àdñëê" << *
i
 << std::
ídl
;

434 
	}
}

	@test/test_fourcc.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio.hµ
"

46 #unde‡
DEFINE_GUID


47 
	#DEFINE_GUID
(
n
, 
fourcc
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
a9
, 
a10
Ëfourcc,

	)

49 
	gÆlfourcc
[] = {

51 
DEFINE_GUID
(
MEDIASUBTYPE_GREY
, 0x59455247, 0x0000, 0x0010, 0x80, 0x00,

53 
DEFINE_GUID
(
MEDIASUBTYPE_Y8
, 0x20203859, 0x0000, 0x0010, 0x80, 0x00,

55 
DEFINE_GUID
(
MEDIASUBTYPE_Y800
, 0x30303859, 0x0000, 0x0010, 0x80, 0x00,

58 
DEFINE_GUID
(
CLSID_C≠tuªGøphBuûdî2
,0xbf87b6e1,0x8c27,0x11d0,0xb3,0xf0,0x00,0xaa,0x00,0x37,0x61,0xc5)

59 
DEFINE_GUID
(
CLSID_FûãrGøph
,0xe436ebb3,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70)

60 
DEFINE_GUID
(
CLSID_NuŒRídîî
,0xc1f400a4,0x3f08,0x11d3,0x9f,0x0b,0x00,0x60,0x08,0x03,0x9e,0x37)

61 
DEFINE_GUID
(
CLSID_Sam∂eGøbbî
,0xc1f400a0,0x3f08,0x11d3,0x9f,0x0b,0x00,0x60,0x08,0x03,0x9e,0x37)

62 
DEFINE_GUID
(
CLSID_Sy°emDevi˚Enum
,0x62be5d10,0x60eb,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86)

63 
DEFINE_GUID
(
CLSID_VideoI≈utDevi˚C©eg‹y
,0x860bb310,0x5d01,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86)

64 
DEFINE_GUID
(
FORMAT_VideoInfo
,0x05589f80,0xc356,0x11ce,0xbf,0x01,0x00,0xaa,0x00,0x55,0x59,0x5a)

65 
DEFINE_GUID
(
IID_IAMA«logVideoDecodî
,0xc6e13350,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56)

66 
DEFINE_GUID
(
IID_IAMCamîaC⁄åﬁ
,0xc6e13370,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56)

67 
DEFINE_GUID
(
IID_IAMCrossb¨
,0xc6e13380,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56)

68 
DEFINE_GUID
(
IID_IAMSåómC⁄fig
,0xc6e13340,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56)

69 
DEFINE_GUID
(
IID_IAMVideoProcAmp
,0xc6e13360,0x30ac,0x11d0,0xa1,0x8c,0x00,0xa0,0xc9,0x11,0x89,0x56)

70 
DEFINE_GUID
(
IID_IBa£Fûãr
,0x56a86895,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70)

71 
DEFINE_GUID
(
IID_IC≠tuªGøphBuûdî2
,0x93e5a4e0,0x2d50,0x11d2,0xab,0xfa,0x00,0xa0,0xc9,0xc6,0xe3,0x8d)

72 
DEFINE_GUID
(
IID_ICª©eDevEnum
,0x29840822,0x5b84,0x11d0,0xbd,0x3b,0x00,0xa0,0xc9,0x11,0xce,0x86)

73 
DEFINE_GUID
(
IID_IGøphBuûdî
,0x56a868a9,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70)

74 
DEFINE_GUID
(
IID_IMPEG2PIDM≠
,0xafb6c2a1,0x2c41,0x11d3,0x8a,0x60,0x00,0x00,0xf8,0x1e,0x0e,0x4a)

75 
DEFINE_GUID
(
IID_IMedüC⁄åﬁ
,0x56a868b1,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70)

76 
DEFINE_GUID
(
IID_IMedüFûãr
,0x56a86899,0x0ad4,0x11ce,0xb0,0x3a,0x00,0x20,0xaf,0x0b,0xa7,0x70)

77 
DEFINE_GUID
(
IID_ISam∂eGøbbî
,0x6b652fff,0x11fe,0x4fce,0x92,0xad,0x02,0x66,0xb5,0xd7,0xc7,0x8f)

78 
DEFINE_GUID
(
LOOK_UPSTREAM_ONLY
,0xac798be0,0x98e3,0x11d1,0xb3,0xf1,0x00,0xaa,0x00,0x37,0x61,0xc5)

79 
DEFINE_GUID
(
MEDIASUBTYPE_AYUV
,0x56555941,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

80 
DEFINE_GUID
(
MEDIASUBTYPE_IYUV
,0x56555949,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

81 
DEFINE_GUID
(
MEDIASUBTYPE_RGB24
,0xe436eb7d,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70)

82 
DEFINE_GUID
(
MEDIASUBTYPE_RGB32
,0xe436eb7e,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70)

83 
DEFINE_GUID
(
MEDIASUBTYPE_RGB555
,0xe436eb7c,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70)

84 
DEFINE_GUID
(
MEDIASUBTYPE_RGB565
,0xe436eb7b,0x524f,0x11ce,0x9f,0x53,0x00,0x20,0xaf,0x0b,0xa7,0x70)

85 
DEFINE_GUID
(
MEDIASUBTYPE_I420
,0x49343230,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

86 
DEFINE_GUID
(
MEDIASUBTYPE_UYVY
,0x59565955,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

87 
DEFINE_GUID
(
MEDIASUBTYPE_Y211
,0x31313259,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

88 
DEFINE_GUID
(
MEDIASUBTYPE_Y411
,0x31313459,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

89 
DEFINE_GUID
(
MEDIASUBTYPE_Y41P
,0x50313459,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

90 
DEFINE_GUID
(
MEDIASUBTYPE_YUY2
,0x32595559,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

91 
DEFINE_GUID
(
MEDIASUBTYPE_YUYV
,0x56595559,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

92 
DEFINE_GUID
(
MEDIASUBTYPE_YV12
,0x32315659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

93 
DEFINE_GUID
(
MEDIASUBTYPE_YVU9
,0x39555659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

94 
DEFINE_GUID
(
MEDIASUBTYPE_YVYU
,0x55595659,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

95 
DEFINE_GUID
(
MEDIASUBTYPE_MJPG
,0x47504A4D, 0x0000, 0x0010, 0x80, 0x00, 0x00, 0xaa, 0x00, 0x38, 0x9b, 0x71)

96 
DEFINE_GUID
(
MEDIATYPE_I¡îÀaved
,0x73766169,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

97 
DEFINE_GUID
(
MEDIATYPE_Video
,0x73646976,0x0000,0x0010,0x80,0x00,0x00,0xaa,0x00,0x38,0x9b,0x71)

98 
DEFINE_GUID
(
PIN_CATEGORY_CAPTURE
,0xfb6c4281,0x0353,0x11d1,0x90,0x5f,0x00,0x00,0xc0,0xcc,0x16,0xba)

99 
DEFINE_GUID
(
PIN_CATEGORY_PREVIEW
,0xfb6c4282,0x0353,0x11d1,0x90,0x5f,0x00,0x00,0xc0,0xcc,0x16,0xba)

104 
	$TEST
(
Videoio_dshow
, 
fourcc_c⁄vîsi⁄
)

106 
i
 = 0; 
Ælfourcc
[i]; ++i)

108 
fourcc
 = 
Ælfourcc
[
i
];

110 
∑ømVÆue
 = 
fourcc
;

111 
fourccFromP¨am
 = ()()(
∑ømVÆue
);

113 
	`EXPECT_EQ
(
fourcc
, ()()
fourccFromP¨am
);

115 
	}
}

	@test/test_framecount.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio/videoio_c.h
"

45 
	~<°dio.h
>

47 
usög
 
«me•a˚
 
	gcv
;

48 
usög
 
«me•a˚
 
	g°d
;

50 ˛as†
	cCV_Fømecou¡Te°
: 
public
 
cvã°
::
Ba£Te°


52 
public
:

53 
run
();

56 
	gCV_Fømecou¡Te°
::
	$run
()

58 c⁄° 
time_£c
 = 5, 
Âs
 = 25;

60 c⁄° 
°rög
 
ext
[] = {"avi", "mov", "mp4"};

62 c⁄° 
size_t
 
n
 = (
ext
)/(ext[0]);

64 c⁄° 
°rög
 
§c_dú
 = 
ts
->
	`gë_d©a_∑th
();

66 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

68 
På
<
CvC≠tuª
> 
ˇp
;

70 
size_t
 
i
 = 0; i < 
n
; ++i)

72 
°rög
 
fûe_∑th
 = 
§c_dú
+"video/big_buck_bu¬y."+
ext
[
i
];

74 
ˇp
.
	`ª£t
(
	`cvCª©eFûeC≠tuª
(
fûe_∑th
.
	`c_°r
()));

75 i‡(!
ˇp
)

77 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

78 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "Error: cannotÑead source video file.\n");

79 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
FAIL_INVALID_TEST_DATA
);

84 
I∂Image
* 
‰ame
; 
FømeCou¡
 = 0;

88 
‰ame
 = 
	`cvQuîyFøme
(
ˇp
);

89 if–!
‰ame
 )

91 
FømeCou¡
++;

94 
‰amecou¡
 = ()
	`cvGëC≠tuªPr›îty
(
ˇp
, 
CAP_PROP_FRAME_COUNT
);

96 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nFile information (video %d): \n"\

100 
i
+1, 
ext
[i].
	`c_°r
(), 
time_£c
*
Âs
, 
FømeCou¡
, 
‰amecou¡
);

102 if–(
FømeCou¡
 !
	`cvRound
(
time_£c
*
Âs
) ||

103 
FømeCou¡
 !
‰amecou¡
Ë&& 
ext
[
i
] != "mpg" )

105 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "FAILED\n");

106 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nError:áctual frame countándÑeturned frame countáreÇot matched.\n");

107 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
FAIL_INVALID_OUTPUT
);

111 
	}
}

112 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT
 && 
deföed
 
HAVE_FFMPEG


113 
	$TEST
(
Videoio_Video
, 
‰amecou¡
Ë{
CV_Fømecou¡Te°
 
ã°
;Åe°.
	`ß„_run
();
	}
}

	@test/test_main.cpp

1 
	~"ã°_¥ecomp.hµ
"

3 
CV_TEST_MAIN
("highgui")

	@test/test_positioning.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio/videoio_c.h
"

45 
	~<°dio.h
>

47 
usög
 
«me•a˚
 
	gcv
;

48 
usög
 
«me•a˚
 
	g°d
;

50 ˛as†
	cCV_VideoPosôi⁄ögTe°
: 
public
 
cvã°
::
Ba£Te°


52 
public
:

53 íum {
PROGRESSIVE
, 
	mRANDOM
};

55 
CV_VideoPosôi⁄ögTe°
();

56 ~
CV_VideoPosôi⁄ögTe°
();

57 
vútuÆ
 
run
() = 0;

59 
	g¥Ÿe˘ed
:

60 
ve˘‹
 <> 
idx
;

61 
run_ã°
(
mëhod
);

63 
	g¥iv©e
:

64 
gíî©e_idx_£q
(
CvC≠tuª
 *
ˇp
, 
mëhod
);

67 ˛as†
	cCV_VideoProgªssivePosôi⁄ögTe°
: 
public
 
CV_VideoPosôi⁄ögTe°


69 
public
:

70 
	$CV_VideoProgªssivePosôi⁄ögTe°
(Ë: 
	$CV_VideoPosôi⁄ögTe°
() { }

71 ~
	`CV_VideoProgªssivePosôi⁄ögTe°
();

72 
	`run
();

73 
	}
};

75 ˛as†
	cCV_VideoR™domPosôi⁄ögTe°
: 
public
 
CV_VideoPosôi⁄ögTe°


77 
public
:

78 
	$CV_VideoR™domPosôi⁄ögTe°
(): 
	$CV_VideoPosôi⁄ögTe°
() { }

79 ~
	`CV_VideoR™domPosôi⁄ögTe°
();

80 
	`run
();

81 
	}
};

83 
	gCV_VideoPosôi⁄ögTe°
::
	$CV_VideoPosôi⁄ögTe°
(Ë{
	}
}

84 
CV_VideoPosôi⁄ögTe°
::~
	$CV_VideoPosôi⁄ögTe°
(Ë{
	}
}

85 
CV_VideoProgªssivePosôi⁄ögTe°
::~
	$CV_VideoProgªssivePosôi⁄ögTe°
(Ë{
	}
}

86 
CV_VideoR™domPosôi⁄ögTe°
::~
	$CV_VideoR™domPosôi⁄ögTe°
(Ë{
	}
}

88 
CV_VideoPosôi⁄ögTe°
::
	$gíî©e_idx_£q
(
CvC≠tuª
* 
ˇp
, 
mëhod
)

90 
idx
.
	`˛ór
();

91 
N
 = ()
	`cvGëC≠tuªPr›îty
(
ˇp
, 
CAP_PROP_FRAME_COUNT
);

92 
mëhod
)

94 
PROGRESSIVE
:

96 
pos
 = 1, 
°ï
 = 20;

99 
idx
.
	`push_back
(
pos
);

100 
pos
 +
°ï
;

102 
pos
 <
N
);

105 
RANDOM
:

107 
RNG
 
	`∫g
(
N
);

108 
idx
.
	`˛ór
();

109  
i
 = 0; i < 
N
-1; i++ )

110 
idx
.
	`push_back
(
∫g
.
	`unif‹m
(0, 
N
));

111 
idx
.
	`push_back
(
N
-1);

112 
°d
::
	`sw≠
(
idx
.
	`©
(
∫g
.
	`unif‹m
(0, 
N
-1)), idx.at(N-1));

117 
	}
}

119 
	gCV_VideoPosôi⁄ögTe°
::
	$run_ã°
(
mëhod
)

121 c⁄° 
°rög
& 
§c_dú
 = 
ts
->
	`gë_d©a_∑th
();

123 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\n\nSour˚ fûe†dúe˘‹y: %s\n", (
§c_dú
+"video/").
	`c_°r
());

125 c⁄° 
°rög
 
ext
[] = {"avi", "mov", "mp4", "mpg"};

127 
n
 = ()((
ext
)/(ext[0]));

129 
Áûed_videos
 = 0;

131 
i
 = 0; i < 
n
; ++i)

134 if–
mëhod
 =
RANDOM
 && 
ext
[
i
] == "mpg" )

136 
°rög
 
fûe_∑th
 = 
§c_dú
 + "video/big_buck_bu¬y." + 
ext
[
i
];

138 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nRódög videÿfûêö %s...\n", 
fûe_∑th
.
	`c_°r
());

140 
CvC≠tuª
* 
ˇp
 = 
	`cvCª©eFûeC≠tuª
(
fûe_∑th
.
	`c_°r
());

142 i‡(!
ˇp
)

144 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\nFAILED\n\n", 
i
+1, 
ext
[i].
	`c_°r
());

145 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "Error: cannotÑead source video file.\n");

146 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
FAIL_INVALID_TEST_DATA
);

147 
Áûed_videos
++; ;

150 
	`cvSëC≠tuªPr›îty
(
ˇp
, 
CAP_PROP_POS_FRAMES
, 0);

152 
	`gíî©e_idx_£q
(
ˇp
, 
mëhod
);

154 
N
 = ()
idx
.
	`size
(), 
Áûed_‰ames
 = 0, 
Áûed_posôi⁄s
 = 0, 
Áûed_ôî©i⁄s
 = 0;

156 
j
 = 0; j < 
N
; ++j)

158 
boﬁ
 
Êag
 = 
Ál£
;

160 
	`cvSëC≠tuªPr›îty
(
ˇp
, 
CAP_PROP_POS_FRAMES
, 
idx
.
	`©
(
j
));

176 
vÆ
 = ()
	`cvGëC≠tuªPr›îty
(
ˇp
, 
CAP_PROP_POS_FRAMES
);

178 i‡(
idx
.
	`©
(
j
Ë!
vÆ
)

180 i‡(!(
Áûed_‰ames
||
Áûed_posôi⁄s
))

182 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nFûêöf‹m©i⁄ (videÿ%d): \n\nName: big_buck_bu¬y.%s\n", 
i
+1, 
ext
[i].
	`c_°r
());

184 
Áûed_posôi⁄s
++;

185 i‡(!
Áûed_‰ames
)

187 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nIãøti⁄: %d\n", 
j
);

189 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "RequúedÖos: %d\nRëu∫edÖos: %d\n", 
idx
.
	`©
(
j
), 
vÆ
);

190 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "Error:ÑequiredándÑeturnedÖositionsáreÇot matched.\n");

191 
ts
->
	`£t_Áûed_ã°_öfo
(
cvã°
::
TS
::
FAIL_INVALID_OUTPUT
);

192 
Êag
 = 
åue
;

195 i‡(
Êag
)

197 
Áûed_ôî©i⁄s
++;

198 
Áûed_videos
++;

203 
	`cvRñó£C≠tuª
(&
ˇp
);

206 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "\nSuc˚ssfuŒÉx≥rimíts: %d (%d%%)\n", 
n
-
Áûed_videos
, 100*(n-failed_videos)/n);

207 
ts
->
	`¥ötf
(
cvã°
::
TS
::
LOG
, "FaûedÉx≥rimíts: %d (%d%%)\n", 
Áûed_videos
, 100*Áûed_videos/
n
);

208 
	}
}

210 
	gCV_VideoProgªssivePosôi⁄ögTe°
::
	$run
()

212 
	`run_ã°
(
PROGRESSIVE
);

213 
	}
}

215 
	gCV_VideoR™domPosôi⁄ögTe°
::
	$run
()

217 
	`run_ã°
(
RANDOM
);

218 
	}
}

220 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT
 && 
deföed
 
HAVE_FFMPEG


221 
	$TEST
 (
Videoio_Video
, 
£ek_¥ogªssive
Ë{ 
CV_VideoProgªssivePosôi⁄ögTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

222 
	$TEST
 (
Videoio_Video
, 
£ek_øndom
Ë{ 
CV_VideoR™domPosôi⁄ögTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

	@test/test_video_io.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio/videoio_c.h
"

46 
usög
 
«me•a˚
 
	gcv
;

47 
usög
 
«me•a˚
 
	g°d
;

49 
«me•a˚
 
	gcvã°


52 
°rög
 
fourccToSåög
(
fourcc
)

54  
f‹m©
("%c%c%c%c", 
fourcc
 & 255, (fourcc >> 8) & 255, (fourcc >> 16) & 255, (fourcc >> 24) & 255);

57 #ifde‡
HAVE_MSMF


58 c⁄° 
VideoF‹m©
 
	gg_•ecific_fmt_li°
[] =

76 #i‡!
deföed
(
_M_ARM
)

77 
VideoF‹m©
("wmv", 
CV_FOURCC_MACRO
('W', 'M', 'V', '1')),

78 
VideoF‹m©
("wmv", 
CV_FOURCC_MACRO
('W', 'M', 'V', '2')),

80 
VideoF‹m©
("wmv", 
CV_FOURCC_MACRO
('W', 'M', 'V', '3')),

81 
VideoF‹m©
("avi", 
CV_FOURCC_MACRO
('H', '2', '6', '4')),

83 
VideoF‹m©
()

86 c⁄° 
VideoF‹m©
 
	gg_•ecific_fmt_li°
[] =

88 
VideoF‹m©
("avi", 
VideoWrôî
::
fourcc
('X', 'V', 'I', 'D')),

89 
VideoF‹m©
("avi", 
VideoWrôî
::
fourcc
('M', 'P', 'E', 'G')),

90 
VideoF‹m©
("avi", 
VideoWrôî
::
fourcc
('M', 'J', 'P', 'G')),

92 
VideoF‹m©
("mkv", 
VideoWrôî
::
fourcc
('X', 'V', 'I', 'D')),

93 
VideoF‹m©
("mkv", 
VideoWrôî
::
fourcc
('M', 'P', 'E', 'G')),

94 
VideoF‹m©
("mkv", 
VideoWrôî
::
fourcc
('M', 'J', 'P', 'G')),

95 #i‚de‡
HAVE_GSTREAMER


96 
VideoF‹m©
("mov", 
VideoWrôî
::
fourcc
('m', 'p', '4', 'v')),

98 
VideoF‹m©
()

104 ˛as†
	cCV_VideoIOTe°
 : 
public
 
cvã°
::
Ba£Te°


106 
¥Ÿe˘ed
:

107 
ImageTe°
 (c⁄° 
°rög
& 
dú
);

108 
VideoTe°
 (c⁄° 
°rög
& 
dú
, c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
);

109 
S≥cificImageTe°
 (c⁄° 
°rög
& 
dú
);

110 
S≥cificVideoTe°
 (c⁄° 
°rög
& 
dú
, c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
);

112 
	$CV_VideoIOTe°
() {}

113 ~
	$CV_VideoIOTe°
(Ë{
	}
}

114 
vútuÆ
 
run
() = 0;

117 ˛as†
	cCV_ImageTe°
 : 
public
 
CV_VideoIOTe°


119 
public
:

120 
	$CV_ImageTe°
() {}

121 ~
	$CV_ImageTe°
(Ë{
	}
}

122 
run
();

125 ˛as†
	cCV_S≥cificImageTe°
 : 
public
 
CV_VideoIOTe°


127 
public
:

128 
	$CV_S≥cificImageTe°
() {}

129 ~
	$CV_S≥cificImageTe°
(Ë{
	}
}

130 
run
();

133 ˛as†
	cCV_VideoTe°
 : 
public
 
CV_VideoIOTe°


135 
public
:

136 
	$CV_VideoTe°
() {}

137 ~
	$CV_VideoTe°
(Ë{
	}
}

138 
run
();

141 ˛as†
	cCV_S≥cificVideoTe°
 : 
public
 
CV_VideoIOTe°


143 
public
:

144 
	$CV_S≥cificVideoTe°
() {}

145 ~
	$CV_S≥cificVideoTe°
(Ë{
	}
}

146 
run
();

150 
	gCV_VideoIOTe°
::
	$ImageTe°
(c⁄° 
°rög
& 
dú
)

152 
°rög
 
_«me
 = 
dú
 + 
	`°rög
("../cv/shared/baboon.png");

153 
ts
->
	`¥ötf
—s->
LOG
, "ªadög imagê: %s\n", 
_«me
.
	`c_°r
());

155 
M©
 
image
 = 
	`imªad
(
_«me
);

156 
image
.
	`c⁄vîtTo
(image, 
CV_8UC3
);

158 i‡(
image
.
	`em±y
())

160 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISSING_TEST_DATA
);

164 c⁄° 
°rög
 
exts
[] = {

165 #ifde‡
HAVE_PNG


168 #ifde‡
HAVE_TIFF


171 #ifde‡
HAVE_JPEG


174 #ifde‡
HAVE_JASPER


184 c⁄° 
size_t
 
ext_num
 = (
exts
)/(exts[0]);

186 
size_t
 
i
 = 0; i < 
ext_num
; ++i)

188 
°rög
 
ext
 = 
exts
[
i
];

189 
°rög
 
fuŒ_«me
 = 
cv
::
	`ãmpfûe
(
ext
.
	`c_°r
());

190 
ts
->
	`¥ötf
—s->
LOG
, " fuŒ_«mê: %s\n", 
fuŒ_«me
.
	`c_°r
());

192 
	`imwrôe
(
fuŒ_«me
, 
image
);

194 
M©
 
lﬂded
 = 
	`imªad
(
fuŒ_«me
);

195 i‡(
lﬂded
.
	`em±y
())

197 
ts
->
	`¥ötf
—s->
LOG
, "Ródög faûedáàfmt=%s\n", 
ext
.
	`c_°r
());

198 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

202 c⁄° 
thªsDbñl
 = 20;

203 
p¢r
 = 
cvã°
::
	`PSNR
(
lﬂded
, 
image
);

204 i‡(
p¢r
 < 
thªsDbñl
)

206 
ts
->
	`¥ötf
—s->
LOG
, "Ródög imagê‰om fûe:Åoÿbig dif„ªn˚ (=%gËwôh fmt=%s\n", 
p¢r
, 
ext
.
	`c_°r
());

207 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_BAD_ACCURACY
);

211 
ve˘‹
<
uch¨
> 
‰om_fûe
;

213 
FILE
 *
f
 = 
	`f›í
(
fuŒ_«me
.
	`c_°r
(), "rb");

214 
	`f£ek
(
f
, 0, 
SEEK_END
);

215 
Àn
 = 
	`·ñl
(
f
);

216 
‰om_fûe
.
	`ªsize
((
size_t
)
Àn
);

217 
	`f£ek
(
f
, 0, 
SEEK_SET
);

218 
‰om_fûe
.
	`ªsize
(
	`‰ód
(&‰om_fûe[0], 1, from_fûe.
	`size
(), 
f
));

219 
	`f˛o£
(
f
);

221 
ve˘‹
<
uch¨
> 
buf
;

222 
	`imícode
("." + 
exts
[
i
], 
image
, 
buf
);

224 i‡(
buf
 !
‰om_fûe
)

226 
ts
->
	`¥ötf
—s->
LOG
, "Encodög faûed wôh fmt=%s\n", 
ext
.
	`c_°r
());

227 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

231 
M©
 
buf_lﬂded
 = 
	`imdecode
(
	`M©
(
buf
), 1);

233 i‡(
buf_lﬂded
.
	`em±y
())

235 
ts
->
	`¥ötf
—s->
LOG
, "Decodög faûed wôh fmt=%s\n", 
ext
.
	`c_°r
());

236 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

240 
p¢r
 = 
cvã°
::
	`PSNR
(
buf_lﬂded
, 
image
);

242 i‡(
p¢r
 < 
thªsDbñl
)

244 
ts
->
	`¥ötf
—s->
LOG
, "Decodög imagê‰om mem‹y:ÅoÿsmÆ»PSNR (=%gdbËwôh fmt=%s\n", 
p¢r
, 
ext
.
	`c_°r
());

245 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

251 
ts
->
	`¥ötf
—s->
LOG
, "endÅest function : ImagesTest \n");

252 
ts
->
	`£t_Áûed_ã°_öfo
—s->
OK
);

253 
	}
}

256 
	gCV_VideoIOTe°
::
VideoTe°
(c⁄° 
°rög
& 
dú
, c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
)

258 
°rög
 
§c_fûe
 = 
dú
 + "../cv/shared/video_for_test.avi";

259 
°rög
 
	gtmp_«me
 = 
cv
::
ãmpfûe
((
cvã°
::
fourccToSåög
(
fmt
.
fourcc
Ë+ "." + fmt.
ext
).
c_°r
());

261 
	gts
->
¥ötf
(
ts
->
LOG
, "ªadög videÿ: %†™d c⁄vîtög iàtÿ%s\n", 
§c_fûe
.
c_°r
(), 
tmp_«me
.c_str());

263 
CvC≠tuª
* 
	gˇp
 = 
cvC≠tuªFromFûe
(
§c_fûe
.
c_°r
());

265 i‡(!
	gˇp
)

267 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISMATCH
);

271 
CvVideoWrôî
* 
	gwrôî
 = 0;

272 
	gve˘‹
<
	gM©
> 
	g‰ames
;

276 
I∂Image
* 
	gimg
 = 
cvQuîyFøme
–
ˇp
 );

278 i‡(!
	gimg
)

281 
	g‰ames
.
push_back
(
cv
::
cv¨rToM©
(
img
, 
åue
));

283 i‡(
	gwrôî
 =
NULL
)

285 
wrôî
 = 
cvCª©eVideoWrôî
(
tmp_«me
.
c_°r
(), 
fmt
.
fourcc
, 24, 
cvGëSize
(
img
));

286 i‡(
	gwrôî
 =
NULL
)

288 
ts
->
¥ötf
—s->
LOG
, "can't create writer (with fourcc : %s)\n",

289 
cvã°
::
fourccToSåög
(
fmt
.
fourcc
).
c_°r
());

290 
cvRñó£C≠tuª
–&
ˇp
 );

291 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISMATCH
);

296 
cvWrôeFøme
(
wrôî
, 
img
);

299 
cvRñó£VideoWrôî
–&
wrôî
 );

300 
cvRñó£C≠tuª
–&
ˇp
 );

302 
CvC≠tuª
 *
	gßved
 = 
cvC≠tuªFromFûe
(
tmp_«me
.
c_°r
());

303 i‡(!
	gßved
)

305 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISMATCH
);

309 c⁄° 
	gthªsDbñl
 = 20;

311 
	gi
 = 0;; i++)

313 
I∂Image
* 
	gùl1
 = 
cvQuîyFøme
–
ßved
 );

315 i‡(!
	gùl1
)

318 
M©
 
	gimg
 = 
‰ames
[
i
];

319 
M©
 
	gimg1
 = 
cv
::
cv¨rToM©
(
ùl1
);

321 
	gp¢r
 = 
cvã°
::
PSNR
(
img1
, 
img
);

322 i‡(
	gp¢r
 < 
	gthªsDbñl
)

324 
	gts
->
¥ötf
(
ts
->
LOG
, "Toÿlow fømê%dÖ¢∏%gdb\n", 
i
, 
p¢r
);

325 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISMATCH
);

337 
cvRñó£C≠tuª
–&
ßved
 );

339 
	gts
->
¥ötf
(
ts
->
LOG
, "endÅest function : ImagesVideo \n");

342 
	gCV_VideoIOTe°
::
	$S≥cificImageTe°
(c⁄° 
°rög
& 
dú
)

344 c⁄° 
size_t
 
IMAGE_COUNT
 = 10;

346 
size_t
 
i
 = 0; i < 
IMAGE_COUNT
; ++i)

348 
°rög°ªam
 
s
; s << 
i
;

349 
°rög
 
fûe_∑th
 = 
dú
+"../pyth⁄/images/QCIF_0"+
s
.
	`°r
()+".bmp";

350 
M©
 
image
 = 
	`imªad
(
fûe_∑th
);

352 i‡(
image
.
	`em±y
())

354 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISSING_TEST_DATA
);

358 
	`ªsize
(
image
, image, 
	`Size
(968, 757), 0.0, 0.0, 
INTER_CUBIC
);

360 
°rög°ªam
 
s_digô
; s_digô << 
i
;

362 
°rög
 
fuŒ_«me
 = 
cv
::
	`ãmpfûe
((
s_digô
.
	`°r
(Ë+ ".bmp").
	`c_°r
());

363 
ts
->
	`¥ötf
—s->
LOG
, " fuŒ_«mê: %s\n", 
fuŒ_«me
.
	`c_°r
());

365 
	`imwrôe
(
fuŒ_«me
, 
image
);

367 
M©
 
lﬂded
 = 
	`imªad
(
fuŒ_«me
);

368 i‡(
lﬂded
.
	`em±y
())

370 
ts
->
	`¥ötf
—s->
LOG
, "Reading failedát fmt=bmp\n");

371 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

375 c⁄° 
thªsDbñl
 = 20;

376 
p¢r
 = 
cvã°
::
	`PSNR
(
lﬂded
, 
image
);

377 i‡(
p¢r
 < 
thªsDbñl
)

379 
ts
->
	`¥ötf
—s->
LOG
, "Ródög imagê‰om fûe:Åoÿbig dif„ªn˚ (=%gËwôh fmt=bmp\n", 
p¢r
);

380 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_BAD_ACCURACY
);

384 
ve˘‹
<
uch¨
> 
‰om_fûe
;

386 
FILE
 *
f
 = 
	`f›í
(
fuŒ_«me
.
	`c_°r
(), "rb");

387 
	`f£ek
(
f
, 0, 
SEEK_END
);

388 
Àn
 = 
	`·ñl
(
f
);

389 
‰om_fûe
.
	`ªsize
((
size_t
)
Àn
);

390 
	`f£ek
(
f
, 0, 
SEEK_SET
);

391 
‰om_fûe
.
	`ªsize
(
	`‰ód
(&‰om_fûe[0], 1, from_fûe.
	`size
(), 
f
));

392 
	`f˛o£
(
f
);

394 
ve˘‹
<
uch¨
> 
buf
;

395 
	`imícode
(".bmp", 
image
, 
buf
);

397 i‡(
buf
 !
‰om_fûe
)

399 
ts
->
	`¥ötf
—s->
LOG
, "Encoding failed with fmt=bmp\n");

400 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

404 
M©
 
buf_lﬂded
 = 
	`imdecode
(
	`M©
(
buf
), 1);

406 i‡(
buf_lﬂded
.
	`em±y
())

408 
ts
->
	`¥ötf
—s->
LOG
, "Decoding failed with fmt=bmp\n");

409 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

413 
p¢r
 = 
cvã°
::
	`PSNR
(
buf_lﬂded
, 
image
);

415 i‡(
p¢r
 < 
thªsDbñl
)

417 
ts
->
	`¥ötf
—s->
LOG
, "Decodög imagê‰om mem‹y:ÅoÿsmÆ»PSNR (=%gdbËwôh fmt=bmp\n", 
p¢r
);

418 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_MISMATCH
);

423 
ts
->
	`¥ötf
—s->
LOG
, "endÅest function : SpecificImageTest \n");

424 
ts
->
	`£t_Áûed_ã°_öfo
—s->
OK
);

425 
	}
}

428 
	gCV_VideoIOTe°
::
S≥cificVideoTe°
(c⁄° 
°rög
& 
dú
, c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
)

430 
°rög
 
ext
 = 
fmt
.ext;

431 
	gfourcc
 = 
fmt
.
fourcc
;

433 
°rög
 
	gfourcc_°r
 = 
cvã°
::
fourccToSåög
(
fourcc
);

434 c⁄° 
°rög
 
	gvideo_fûe
 = 
cv
::
ãmpfûe
((
fourcc_°r
 + "." + 
ext
).
c_°r
());

436 
Size
 
‰ame_size
(968 & -2, 757 & -2);

437 
VideoWrôî
 
wrôî
(
video_fûe
, 
fourcc
, 25, 
‰ame_size
, 
åue
);

439 i‡(!
	gwrôî
.
isO≥√d
())

442 
VideoWrôî
 
wrôî2
(
video_fûe
, 
fourcc
, 25, 
‰ame_size
, 
åue
);

443 
	gts
->
¥ötf
(
ts
->
LOG
, "Cª©ögá videÿö %s...\n", 
video_fûe
.
c_°r
());

444 
	gts
->
¥ötf
(
ts
->
LOG
, "C™nŸ cª©êVideoWrôî obje˘ wôh code¯%s.\n", 
fourcc_°r
.
c_°r
());

445 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISMATCH
);

449 c⁄° 
size_t
 
	gIMAGE_COUNT
 = 30;

450 
	gve˘‹
<
	gM©
> 
	gimages
;

452  
size_t
 
	gi
 = 0; i < 
	gIMAGE_COUNT
; ++i )

454 
°rög
 
	gfûe_∑th
 = 
f‹m©
("%s../pyth⁄/images/QCIF_%02d.bmp", 
dú
.
c_°r
(), 
i
);

455 
M©
 
	gimg
 = 
imªad
(
fûe_∑th
, 
IMREAD_COLOR
);

457 i‡(
	gimg
.
em±y
())

459 
	gts
->
¥ötf
(
ts
->
LOG
, "Cª©ögá videÿö %s...\n", 
video_fûe
.
c_°r
());

460 
	gts
->
¥ötf
(
ts
->
LOG
, "Eº‹: c™nŸÑód fømê‰om %s.\n", 
fûe_∑th
.
c_°r
());

461 
	gts
->
¥ötf
(
ts
->
LOG
, "Continue creatingÅhe video file...\n");

462 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_INVALID_TEST_DATA
);

466 
	gk
 = 0; k < 
	gimg
.
	grows
; ++k)

467 
	gl
 = 0;Ü < 
	gimg
.
	gcﬁs
; ++l)

468 i‡(
	gimg
.
	g©
<
	gVec3b
>(
	gk
, 
	gl
Ë=
Vec3b
::
Æl
(0))

469 
img
.
©
<
Vec3b
>(
k
, 
	gl
) = Vec3b(0, 255, 0);

470 
	gimg
.
	g©
<
	gVec3b
>(
	gk
, 
	gl
Ë
Vec3b
(0, 0, 255);

472 
ªsize
(
img
, img, 
‰ame_size
, 0.0, 0.0, 
INTER_CUBIC
);

474 
	gimages
.
push_back
(
img
);

475 
	gwrôî
 << 
	gimg
;

478 
	gwrôî
.
ªÀa£
();

479 
VideoC≠tuª
 
ˇp
(
video_fûe
);

481 
size_t
 
	gFRAME_COUNT
 = (size_t)
ˇp
.
gë
(
CAP_PROP_FRAME_COUNT
);

483 
size_t
 
	gÆlowed_exåa_‰ames
 = 0;

492 i‡(
	gfourcc
 =
VideoWrôî
::
fourcc
('M', 'P', 'E', 'G'Ë&& 
	gext
 == "mkv")

493 
Ælowed_exåa_‰ames
 = 1;

496 
	gÆlowed_‰ame_‰›
 = 0;

497 #ifde‡
HAVE_GSTREAMER


498 
	gÆlowed_‰ame_‰›
 = 1;

501 i‡(
	gFRAME_COUNT
 < 
	gIMAGE_COUNT
 - 
	gÆlowed_‰ame_‰›
 || FRAME_COUNT > IMAGE_COUNT + 
	gÆlowed_exåa_‰ames
)

503 
	gts
->
¥ötf
(
ts
->
LOG
, "\nFømêcou¡ checkög f‹ video_%s.%s...\n", 
fourcc_°r
.
c_°r
(), 
ext
.c_str());

504 
	gts
->
¥ötf
(
ts
->
LOG
, "Videÿcodec: %s\n", 
fourcc_°r
.
c_°r
());

505 i‡(
	gÆlowed_exåa_‰ames
 != 0)

506 
ts
->
¥ötf
—s->
LOG
, "Required frame count: %d-%d; Returned frame count: %d\n",

507 
IMAGE_COUNT
, IMAGE_COUNT + 
Ælowed_exåa_‰ames
, 
FRAME_COUNT
);

509 
	gts
->
¥ötf
(
ts
->
LOG
, "Requúed fømêcou¡: %d; Rëu∫ed fømêcou¡: %d\n", 
IMAGE_COUNT
, 
FRAME_COUNT
);

510 
	gts
->
¥ötf
(
ts
->
LOG
, "Error: Incorrect frame count inÅhe video.\n");

511 
	gts
->
¥ötf
(
ts
->
LOG
, "Continue checking...\n");

512 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_BAD_ACCURACY
);

516 
	gi
 = 0; (
	gsize_t
)ò< 
	gIMAGE_COUNT
-
	gÆlowed_‰ame_‰›
; i++)

518 
M©
 
	g‰ame
; 
	gˇp
 >> frame;

519 i‡(
	g‰ame
.
em±y
())

521 
	gts
->
¥ötf
(
ts
->
LOG
, "\nVideo file directory: %s\n", ".");

522 
	gts
->
¥ötf
(
ts
->
LOG
, "Fûê«me: video_%s.%s\n", 
fourcc_°r
.
c_°r
(), 
ext
.c_str());

523 
	gts
->
¥ötf
(
ts
->
LOG
, "Videÿcodec: %s\n", 
fourcc_°r
.
c_°r
());

524 
	gts
->
¥ötf
(
ts
->
LOG
, "Eº‹: c™nŸÑódÅhê√xà‰amêwôh index %d.\n", 
i
+1);

525 
	gts
->
£t_Áûed_ã°_öfo
(
ts
->
FAIL_MISSING_TEST_DATA
);

529 
M©
 
	gimg
 = 
images
[
i
];

531 c⁄° 
	gthªsDbñl
 = 40;

532 
	gp¢r
 = 
cvã°
::
PSNR
(
img
, 
‰ame
);

534 i‡(
	gp¢r
 > 
	gthªsDbñl
)

536 
	gts
->
¥ötf
(
ts
->
LOG
, "\nRódög fømê‰omÅhêfûêvideo_%s.%s...\n", 
fourcc_°r
.
c_°r
(), 
ext
.c_str());

537 
	gts
->
¥ötf
(
ts
->
LOG
, "Fømêödex: %d\n", 
i
+1);

538 
	gts
->
¥ötf
(
ts
->
LOG
, "Dif„ªn˚ bëwì¿ßvedánd origöÆ images: %g\n", 
p¢r
);

539 
	gts
->
¥ötf
(
ts
->
LOG
, "MaximumáŒowed dif„ªn˚: %g\n", 
thªsDbñl
);

540 
	gts
->
¥ötf
(
ts
->
LOG
, "Error:Åoo big difference between savedánd original images.\n");

546 
	gCV_ImageTe°
::
	$run
()

548 
	`ImageTe°
(
ts
->
	`gë_d©a_∑th
());

549 
	}
}

551 
	gCV_S≥cificImageTe°
::
	$run
()

553 
	`S≥cificImageTe°
(
ts
->
	`gë_d©a_∑th
());

554 
	}
}

556 
	gCV_VideoTe°
::
	$run
()

558 
i
 = 0; ; ++i)

560 c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
 = cvã°::
g_•ecific_fmt_li°
[
i
];

561 if–
fmt
.
	`em±y
() )

563 
	`VideoTe°
(
ts
->
	`gë_d©a_∑th
(), 
fmt
);

565 
	}
}

567 
	gCV_S≥cificVideoTe°
::
	$run
()

569 
i
 = 0; ; ++i)

571 c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
 = cvã°::
g_•ecific_fmt_li°
[
i
];

572 if–
fmt
.
	`em±y
() )

574 
	`S≥cificVideoTe°
(
ts
->
	`gë_d©a_∑th
(), 
fmt
);

576 
	}
}

578 #ifde‡
HAVE_JPEG


579 
	$TEST
(
Videoio_Image
, 
ªgªssi⁄
Ë{ 
CV_ImageTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

582 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT
 && 
BUILD_WITH_VIDEO_OUTPUT_SUPPORT
 && !
deföed
(
__APPLE__
)

583 
	$TEST
(
Videoio_Video
, 
ªgªssi⁄
Ë{ 
CV_VideoTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

584 
	$TEST
(
Videoio_Video
, 
wrôe_ªad
Ë{ 
CV_S≥cificVideoTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

587 
	$TEST
(
Videoio_Image
, 
wrôe_ªad
Ë{ 
CV_S≥cificImageTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

	@test/test_video_pos.cpp

43 
	~"ã°_¥ecomp.hµ
"

44 
	~"›ícv2/videoio.hµ
"

46 
usög
 
«me•a˚
 
	gcv
;

47 
usög
 
«me•a˚
 
	g°d
;

49 ˛as†
	cCV_Posôi⁄ögTe°
 : 
public
 
cvã°
::
Ba£Te°


51 
public
:

52 
	$CV_Posôi⁄ögTe°
()

54 
‰amesize
 = 
	`Size
(640, 480);

57 
M©
 
	$døwFøme
(
i
)

59 
M©
 
m©
 = M©::
	`zîos
(
‰amesize
, 
CV_8UC3
);

61 
m©
 = 
	`Sˇœr
(
	`Ábs
(
	`cos
(
i
*0.08)*255), fabs(
	`sö
(i*0.05)*255), i);

62 
	`putText
(
m©
, 
	`f‹m©
("%03d", 
i
), 
	`Poöt
(10, 350), 0, 10, 
	`Sˇœr
(128, 255, 255), 15);

63  
m©
;

64 
	}
}

66 
°rög
 
gëFûíame
(c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
)

68  
cv
::
ãmpfûe
((
cvã°
::
fourccToSåög
(
fmt
.
fourcc
Ë+ "." + fmt.
ext
).
c_°r
());

71 
boﬁ
 
Cª©eTe°Video
(c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
, 
‰amecou¡
, 
°rög
 
fûíame
)

73 
VideoWrôî
 
wrôî
(
fûíame
, 
fmt
.
fourcc
, 25, 
‰amesize
, 
åue
);

74 if–!
	gwrôî
.
isO≥√d
() )

75  
	gÁl£
;

77 
	gi
 = 0; i < 
	g‰amecou¡
; ++i)

79 
M©
 
	gimg
 = 
døwFøme
(
i
);

80 
	gwrôî
 << 
	gimg
;

82  
	gåue
;

85 
	$run
()

87 
n_‰ames
 = 100;

89  
ã°ˇ£
 = 0; ;Åestcase++ )

91 c⁄° 
cvã°
::
VideoF‹m©
& 
fmt
 = cvã°::
g_•ecific_fmt_li°
[
ã°ˇ£
];

92 if–
fmt
.
	`em±y
() )

94 
°rög
 
fûíame
 = 
	`gëFûíame
(
fmt
);

95 
ts
->
	`¥ötf
—s->
LOG
, "\nFûe: %s\n", 
fûíame
.
	`c_°r
());

97 if–!
	`Cª©eTe°Video
(
fmt
, 
n_‰ames
, 
fûíame
) )

99 
ts
->
	`¥ötf
—s->
LOG
, "\nError: cannot create video file");

100 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

104 
VideoC≠tuª
 
	`ˇp
(
fûíame
);

106 i‡(!
ˇp
.
	`isO≥√d
())

108 
ts
->
	`¥ötf
—s->
LOG
, "\nError: cannotÑead video file.");

109 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_TEST_DATA
);

113 
N0
 = ()
ˇp
.
	`gë
(
CAP_PROP_FRAME_COUNT
);

114 
ˇp
.
	`£t
(
CAP_PROP_POS_FRAMES
, 0);

115 
N
 = ()
ˇp
.
	`gë
(
CAP_PROP_FRAME_COUNT
);

118 
Ælowed_exåa_‰ames
 = 0;

119 i‡(
fmt
.
fourcc
 =
VideoWrôî
::
	`fourcc
('M', 'P', 'E', 'G'Ë&& fmt.
ext
 == "mkv")

120 
Ælowed_exåa_‰ames
 = 1;

122 i‡(
N
 < 
n_‰ames
 || N >Ç_‰ame†+ 
Ælowed_exåa_‰ames
 || N !
N0
)

124 
ts
->
	`¥ötf
—s->
LOG
, "\nEº‹:Ñëu∫ed fømêcou¡ (N0=%d, N=%dËi†dif„ª¡ fromÅhêª„ªn˚Çumbî %d\n", 
N0
, 
N
, 
n_‰ames
);

125 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

129 
k
 = 0; k < 
n_‰ames
; ++k)

131 
idx
 = 
	`theRNG
().
	`unif‹m
(0, 
n_‰ames
);

133 if–!
ˇp
.
	`£t
(
CAP_PROP_POS_FRAMES
, 
idx
) )

135 
ts
->
	`¥ötf
—s->
LOG
, "\nEº‹: c™nŸ sìkÅÿ‰amê%d.\n", 
idx
);

136 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

140 
idx1
 = ()
ˇp
.
	`gë
(
CAP_PROP_POS_FRAMES
);

142 
M©
 
img
; 
ˇp
 >> img;

143 
M©
 
img0
 = 
	`døwFøme
(
idx
);

145 if–
idx
 !
idx1
 )

147 
ts
->
	`¥ötf
—s->
LOG
, "\nError:Åhe currentÖosition (%d)áfter seek is different from specified (%d)\n",

148 
idx1
, 
idx
);

149 
ts
->
	`¥ötf
—s->
LOG
, "Saving both frames ...\n");

150 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

154 i‡(
img
.
	`em±y
())

156 
ts
->
	`¥ötf
—s->
LOG
, "\nEº‹: c™nŸÑódá fømê©Öosôi⁄ %d.\n", 
idx
);

157 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

161 
îr
 = 
cvã°
::
	`PSNR
(
img
, 
img0
);

163 if–
îr
 < 20 )

165 
ts
->
	`¥ötf
—s->
LOG
, "Thê‰amêªadá·îÖosôi⁄ögÅÿ%d i†öc‹ª˘ (PSNR=%g)\n", 
idx
, 
îr
);

166 
ts
->
	`¥ötf
—s->
LOG
, "Saving both frames ...\n");

167 
ts
->
	`£t_Áûed_ã°_öfo
—s->
FAIL_INVALID_OUTPUT
);

172 
	}
}

174 
Size
 
	g‰amesize
;

177 #i‡
BUILD_WITH_VIDEO_INPUT_SUPPORT
 && 
BUILD_WITH_VIDEO_OUTPUT_SUPPORT
 && 
deföed
 
HAVE_FFMPEG


178 
	$TEST
(
Videoio_Video
, 
£ek_øndom_sy¡hëic
Ë{ 
CV_Posôi⁄ögTe°
 
ã°
;Åe°.
	`ß„_run
(); 
	}
}

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #i‚de‡
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

70 
__löe
, c⁄° *
__fun˘i⁄
)

71 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

74 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

75 
__löe
, c⁄° *
__fun˘i⁄
)

76 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

81 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

82 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

85 
__END_DECLS


88 
	#as£π
(
ex¥
) \

89 ((
ex¥
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£π_≥º‹
(
î∫um
) \

95 (!(
î∫um
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

118 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


120 #unde‡
°©ic_as£π


121 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/dc1394/dc1394.h

34 #i‚de‡
__DC1394_H__


35 
	#__DC1394_H__


	)

45 
	~<dc1394/ty≥s.h
>

46 
	~<dc1394/ˇmîa.h
>

47 
	~<dc1394/c⁄åﬁ.h
>

48 
	~<dc1394/ˇ±uª.h
>

49 
	~<dc1394/c⁄vîsi⁄s.h
>

50 
	~<dc1394/f‹m©7.h
>

51 
	~<dc1394/iso.h
>

52 
	~<dc1394/log.h
>

53 
	~<dc1394/ªgi°î.h
>

54 
	~<dc1394/video.h
>

55 
	~<dc1394/utûs.h
>

	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


26 #i‚def 
__√ed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


35 
	~<bôs/î∫o.h
>

36 #unde‡
__√ed_Em©h


38 #ifdef 
_ERRNO_H


45 #i‚def 
î∫o


46 
î∫o
;

49 #ifde‡
__USE_GNU


54 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

58 
	g__END_DECLS


66 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


67 #i‚de‡
__îr‹_t_deföed


68 
	tîr‹_t
;

69 
	#__îr‹_t_deföed
 1

	)

71 #unde‡
__√ed_îr‹_t


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

40 #i‚de‡
__mode_t_deföed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_deföed


	)

45 #i‚de‡
__off_t_deföed


46 #i‚de‡
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_deföed


	)

59 #i‚de‡
__pid_t_deföed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_deföed


	)

65 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


66 
	#__√ed_time•ec


	)

67 
	~<time.h
>

68 
	~<bôs/°©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifde‡
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifde‡
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #i‚de‡
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
f˙é
 (
__fd
, 
__cmd
, ...);

145 #i‚de‡
__USE_FILE_OFFSET64


146 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

148 #ifde‡
__REDIRECT


149 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

150 
	`__n⁄nuŒ
 ((1));

152 
	#›í
 
›í64


	)

155 #ifde‡
__USE_LARGEFILE64


156 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

159 #ifde‡
__USE_ATFILE


169 #i‚de‡
__USE_FILE_OFFSET64


170 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

171 
	`__n⁄nuŒ
 ((2));

173 #ifde‡
__REDIRECT


174 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

175 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

177 
	#›í©
 
›í©64


	)

180 #ifde‡
__USE_LARGEFILE64


181 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

182 
	`__n⁄nuŒ
 ((2));

191 #i‚de‡
__USE_FILE_OFFSET64


192 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

194 #ifde‡
__REDIRECT


195 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

196 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

198 
	#¸ót
 
¸ót64


	)

201 #ifde‡
__USE_LARGEFILE64


202 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

205 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

206 && !
deföed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #i‚de‡
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

223 #ifde‡
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifde‡
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

234 #ifde‡
__USE_XOPEN2K


237 #i‚de‡
__USE_FILE_OFFSET64


238 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

239 
__advi£
Ë
__THROW
;

241 #ifde‡
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Àn
, 
__advi£
),

244 
posix_Ádvi£64
);

246 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

249 #ifde‡
__USE_LARGEFILE64


250 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

251 
__advi£
Ë
__THROW
;

259 #i‚de‡
__USE_FILE_OFFSET64


260 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

262 #ifde‡
__REDIRECT


263 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Àn
),

265 
posix_ÁŒoˇã64
);

267 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

270 #ifde‡
__USE_LARGEFILE64


271 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

277 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

278 && 
deföed
 
__va_¨g_∑ck_Àn


279 
	~<bôs/f˙é2.h
>

282 
__END_DECLS


	@/usr/include/libraw1394/raw1394.h

13 #i‚de‡
_LIBRAW1394_RAW1394_H


14 
	#_LIBRAW1394_RAW1394_H


	)

16 
	~<sys/ty≥s.h
>

18 
	#RAW1394_ARM_READ
 1

	)

19 
	#RAW1394_ARM_WRITE
 2

	)

20 
	#RAW1394_ARM_LOCK
 4

	)

22 
	#RAW1394_LONG_RESET
 0

	)

23 
	#RAW1394_SHORT_RESET
 1

	)

26 
	#RAW1394_NOTIFY_OFF
 0

	)

27 
	#RAW1394_NOTIFY_ON
 1

	)

30 
	#RAW1394_EXTCODE_MASK_SWAP
 0x1

	)

31 
	#RAW1394_EXTCODE_COMPARE_SWAP
 0x2

	)

32 
	#RAW1394_EXTCODE_FETCH_ADD
 0x3

	)

33 
	#RAW1394_EXTCODE_LITTLE_ADD
 0x4

	)

34 
	#RAW1394_EXTCODE_BOUNDED_ADD
 0x5

	)

35 
	#RAW1394_EXTCODE_WRAP_ADD
 0x6

	)

38 
	#RAW1394_RCODE_COMPLETE
 0x0

	)

39 
	#RAW1394_RCODE_CONFLICT_ERROR
 0x4

	)

40 
	#RAW1394_RCODE_DATA_ERROR
 0x5

	)

41 
	#RAW1394_RCODE_TYPE_ERROR
 0x6

	)

42 
	#RAW1394_RCODE_ADDRESS_ERROR
 0x7

	)

44 
u_öt8_t
 
	tbyã_t
;

45 
u_öt32_t
 
	tquadÀt_t
;

46 
u_öt64_t
 
	to˘Àt_t
;

47 
u_öt64_t
 
	tnodóddr_t
;

48 
u_öt16_t
 
	tnodeid_t
;

49 
u_öt8_t
 
	tphyid_t
;

50 
u_öt8_t
 
	t¨m_›ti⁄s_t
;

51 
u_öt16_t
 
	t¨m_Àngth_t
;

53 
øw1394_h™dÀ
 *
	tøw1394h™dÀ_t
;

55 
	søw1394_¨m_ªque°
 {

56 
nodeid_t
 
	mde°ö©i⁄_nodeid
;

57 
nodeid_t
 
	msour˚_nodeid
;

58 
nodóddr_t
 
	mde°ö©i⁄_off£t
;

59 
u_öt8_t
 
	méabñ
;

60 
u_öt8_t
 
	mtcode
;

61 
u_öt8_t
 
	mexãnded_å™ß˘i⁄_code
;

62 
u_öt32_t
 
	mgíî©i⁄
;

63 
¨m_Àngth_t
 
	mbuf„r_Àngth
;

64 
byã_t
 *
	mbuf„r
;

65 } *
	tøw1394_¨m_ªque°_t
;

67 
	søw1394_¨m_ª•⁄£
 {

68 
	mª•⁄£_code
;

69 
¨m_Àngth_t
 
	mbuf„r_Àngth
;

70 
byã_t
 *
	mbuf„r
;

71 } *
	tøw1394_¨m_ª•⁄£_t
;

73 
	søw1394_¨m_ªque°_ª•⁄£
 {

74 
øw1394_¨m_ªque°
 *
	mªque°
;

75 
øw1394_¨m_ª•⁄£
 *
	mª•⁄£
;

76 } *
	tøw1394_¨m_ªque°_ª•⁄£_t
;

80 
	eøw1394_iso_•ìd
 {

81 
	mRAW1394_ISO_SPEED_100
 = 0,

82 
	mRAW1394_ISO_SPEED_200
 = 1,

83 
	mRAW1394_ISO_SPEED_400
 = 2,

87 
	eøw1394_iso_dma_ªcv_mode
 {

88 
	mRAW1394_DMA_DEFAULT
 = -1,

89 
	mRAW1394_DMA_BUFFERFILL
 = 1,

90 
	mRAW1394_DMA_PACKET_PER_BUFFER
 = 2

95 
	eøw1394_iso_di•osôi⁄
 {

97 
	mRAW1394_ISO_OK
 = 0,

100 
	mRAW1394_ISO_DEFER
 = 1,

103 
	mRAW1394_ISO_ERROR
 = 2,

106 
	mRAW1394_ISO_STOP
 = 3,

109 
	mRAW1394_ISO_STOP_NOSYNC
 = 4,

114 
	mRAW1394_ISO_AGAIN
 = 5,

117 
	eøw1394_modify_mode
 {

118 
	mRAW1394_MODIFY_ALLOC
,

119 
	mRAW1394_MODIFY_FREE


122 #ifde‡
__˝lu•lus


128 
øw1394_iso_di•osôi⁄
 (*
	tøw1394_iso_xmô_h™dÀr_t
)(

129 
	tøw1394h™dÀ_t
 
	th™dÀ
,

130 *
	td©a
,

131 *
	tÀn
,

132 *
	tèg
,

133 *
	tsy
,

134 
	tcy˛e
,

135 
	tdr›≥d
);

137 
øw1394_iso_di•osôi⁄
 (*
	tøw1394_iso_ªcv_h™dÀr_t
)(

138 
	tøw1394h™dÀ_t
 
	th™dÀ
,

139 *
	td©a
,

140 
	tÀn
,

141 
	tch™√l
,

142 
	tèg
,

143 
	tsy
,

144 
	tcy˛e
,

145 
	tdr›≥d
);

163 
øw1394_iso_xmô_öô
(
øw1394h™dÀ_t
 
h™dÀ
,

164 
øw1394_iso_xmô_h™dÀr_t
 
h™dÀr
,

165 
buf_∑ckës
,

166 
max_∑ckë_size
,

167 
ch™√l
,

168 
øw1394_iso_•ìd
 
•ìd
,

169 
úq_öãrvÆ
);

187 
øw1394_iso_ªcv_öô
(
øw1394h™dÀ_t
 
h™dÀ
,

188 
øw1394_iso_ªcv_h™dÀr_t
 
h™dÀr
,

189 
buf_∑ckës
,

190 
max_∑ckë_size
,

191 
ch™√l
,

192 
øw1394_iso_dma_ªcv_mode
 
mode
,

193 
úq_öãrvÆ
);

209 
øw1394_iso_mu…ich™√l_ªcv_öô
(
øw1394h™dÀ_t
 
h™dÀ
,

210 
øw1394_iso_ªcv_h™dÀr_t
 
h™dÀr
,

211 
buf_∑ckës
,

212 
max_∑ckë_size
,

213 
úq_öãrvÆ
);

224 
øw1394_iso_ªcv_li°í_ch™√l
(
øw1394h™dÀ_t
 
h™dÀ
,

225 
ch™√l
);

234 
øw1394_iso_ªcv_u∆i°í_ch™√l
(
øw1394h™dÀ_t
 
h™dÀ
,

235 
ch™√l
);

247 
øw1394_iso_ªcv_£t_ch™√l_mask
(
øw1394h™dÀ_t
 
h™dÀ
, 
u_öt64_t
 
mask
);

259 
øw1394_iso_xmô_°¨t
(
øw1394h™dÀ_t
 
h™dÀ
, 
°¨t_⁄_cy˛e
,

260 
¥ebuf„r_∑ckës
);

272 
øw1394_iso_ªcv_°¨t
(
øw1394h™dÀ_t
 
h™dÀ
, 
°¨t_⁄_cy˛e
,

273 
èg_mask
, 
sync
);

290 
øw1394_iso_xmô_wrôe
(
øw1394h™dÀ_t
 
h™dÀ
, *
d©a
,

291 
Àn
, 
èg
,

292 
sy
);

300 
øw1394_iso_xmô_sync
(
øw1394h™dÀ_t
 
h™dÀ
);

317 
øw1394_iso_ªcv_Êush
(
øw1394h™dÀ_t
 
h™dÀ
);

323 
øw1394_iso_°›
(
øw1394h™dÀ_t
 
h™dÀ
);

329 
øw1394_iso_shutdown
(
øw1394h™dÀ_t
 
h™dÀ
);

347 
øw1394_ªad_cy˛e_timî
(
øw1394h™dÀ_t
 
h™dÀ
,

348 
u_öt32_t
 *
cy˛e_timî
, 
u_öt64_t
 *
loˇl_time
);

350 
	tøw1394_îrcode_t
;

351 
	#øw1394_make_îrcode
(
ack
, 
rcode
Ë((◊ckË<< 16Ë|Ñcode)

	)

352 
	#øw1394_öã∫Æ_îr
(
îrcode
Ë(”ºcodeË< 0)

	)

353 
	#øw1394_gë_ack
(
îrcode
Ë(”ºcodeË>> 16)

	)

354 
	#øw1394_gë_rcode
(
îrcode
Ë(”ºcodeË& 0xf)

	)

355 
	#øw1394_gë_öã∫Æ
(
îrcode
Ë”ºcode)

	)

371 
øw1394_îrcode_t
 
øw1394_gë_îrcode
(
øw1394h™dÀ_t
 
h™dÀ
);

392 
øw1394_îrcode_to_î∫o
(
øw1394_îrcode_t
 
îrcode
);

411 
øw1394h™dÀ_t
 
øw1394_√w_h™dÀ
();

421 
øw1394_de°roy_h™dÀ
(
øw1394h™dÀ_t
 
h™dÀ
);

440 
øw1394h™dÀ_t
 
øw1394_√w_h™dÀ_⁄_p‹t
(
p‹t
);

449 
øw1394_bu§e£t_nŸify
 (
øw1394h™dÀ_t
 
h™dÀ
, 
off_⁄_swôch
);

464 
øw1394_gë_fd
(
øw1394h™dÀ_t
 
h™dÀ
);

476 
øw1394_£t_u£rd©a
(
øw1394h™dÀ_t
 
h™dÀ
, *
d©a
);

485 *
øw1394_gë_u£rd©a
(
øw1394h™dÀ_t
 
h™dÀ
);

494 
nodeid_t
 
øw1394_gë_loˇl_id
(
øw1394h™dÀ_t
 
h™dÀ
);

503 
nodeid_t
 
øw1394_gë_úm_id
(
øw1394h™dÀ_t
 
h™dÀ
);

516 
øw1394_gë_nodecou¡
(
øw1394h™dÀ_t
 
h™dÀ
);

518 
	søw1394_p‹töfo
 {

519 
nodes
;

520 
«me
[32];

541 
øw1394_gë_p‹t_öfo
(
øw1394h™dÀ_t
 
h™dÀ
, 
øw1394_p‹töfo
 *
pöf
,

542 
maxp‹ts
);

560 
øw1394_£t_p‹t
(
øw1394h™dÀ_t
 
h™dÀ
, 
p‹t
);

572 
øw1394_ª£t_bus
(
øw1394h™dÀ_t
 
h™dÀ
);

581 
øw1394_ª£t_bus_√w
(
øw1394h™dÀ_t
 
h™dÀ
, 
ty≥
);

595 
øw1394_lo›_ôî©e
(
øw1394h™dÀ_t
 
h™dÀ
);

597 (*
bus_ª£t_h™dÀr_t
)(
	tøw1394h™dÀ_t
, 
	tgíî©i⁄
);

609 
bus_ª£t_h™dÀr_t
 
øw1394_£t_bus_ª£t_h™dÀr
(
øw1394h™dÀ_t
 
h™dÀ
,

610 
bus_ª£t_h™dÀr_t
 
√w_h
);

625 
øw1394_gë_gíî©i⁄
(
øw1394h™dÀ_t
 
h™dÀ
);

640 
øw1394_upd©e_gíî©i⁄
(
øw1394h™dÀ_t
 
h™dÀ
, 
gíî©i⁄
);

642 (*
èg_h™dÀr_t
)(
	tøw1394h™dÀ_t
, 
	tèg
,

643 
	tøw1394_îrcode_t
 
	tîr
);

661 
èg_h™dÀr_t
 
øw1394_£t_èg_h™dÀr
(
øw1394h™dÀ_t
 
h™dÀ
,

662 
èg_h™dÀr_t
 
√w_h
);

664 (*
¨m_èg_h™dÀr_t
)(
	tøw1394h™dÀ_t
 
	th™dÀ
, 
	t¨m_èg
,

665 
	tbyã_t
 
	tªque°_ty≥
, 
	tªque°ed_Àngth
,

666 *
	td©a
);

679 
¨m_èg_h™dÀr_t
 
øw1394_£t_¨m_èg_h™dÀr
(
øw1394h™dÀ_t
 
h™dÀ
,

680 
¨m_èg_h™dÀr_t
 
√w_h
);

682 (*
f˝_h™dÀr_t
)(
	tøw1394h™dÀ_t
, 
	tnodeid_t
 
	tnodeid
, 
	tª•⁄£
,

683 
	tsize_t
 
	tÀngth
, *
	td©a
);

699 
f˝_h™dÀr_t
 
øw1394_£t_f˝_h™dÀr
(
øw1394h™dÀ_t
 
h™dÀ
, f˝_h™dÀr_à
√w_h
);

708 (*
ªq_ˇŒback_t
)(
	tøw1394h™dÀ_t
, *
	td©a
,

709 
	tøw1394_îrcode_t
 
	tîr
);

711 
	søw1394_ªqh™dÀ
 {

712 
ªq_ˇŒback_t
 
ˇŒback
;

713 *
d©a
;

722 (*
¨m_ªq_ˇŒback_t
Ë(
	tøw1394h™dÀ_t
,

723 
	tøw1394_¨m_ªque°_ª•⁄£
 *
	t¨m_ªq_ª•
,

724 
	tªque°ed_Àngth
,

725 *
	tpc⁄ãxt
, 
	tbyã_t
 
	tªque°_ty≥
);

727 
	søw1394_¨m_ªqh™dÀ
 {

728 
¨m_ªq_ˇŒback_t
 
¨m_ˇŒback
;

729 *
pc⁄ãxt
;

760 
øw1394_¨m_ªgi°î
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodóddr_t
 
°¨t
,

761 
size_t
 
Àngth
, 
byã_t
 *
öôül_vÆue
,

762 
o˘Àt_t
 
¨m_èg
, 
¨m_›ti⁄s_t
 
ac˚ss_rights
,

763 
¨m_›ti⁄s_t
 
nŸifiˇti⁄_›ti⁄s
,

764 
¨m_›ti⁄s_t
 
˛õ¡_å™ß˘i⁄s
);

774 
øw1394_¨m_uƒegi°î
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodóddr_t
 
°¨t
);

789 
øw1394_¨m_£t_buf
 (
øw1394h™dÀ_t
 
h™dÀ
, 
nodóddr_t
 
°¨t
,

790 
size_t
 
Àngth
, *
buf
);

805 
øw1394_¨m_gë_buf
 (
øw1394h™dÀ_t
 
h™dÀ
, 
nodóddr_t
 
°¨t
,

806 
size_t
 
Àngth
, *
buf
);

819 
øw1394_echo_ªque°
(
øw1394h™dÀ_t
 
h™dÀ
, 
quadÀt_t
 
d©a
);

830 
øw1394_wake_up
(
øw1394h™dÀ_t
 
h™dÀ
);

842 
øw1394_phy_∑ckë_wrôe
 (
øw1394h™dÀ_t
 
h™dÀ
, 
quadÀt_t
 
d©a
);

854 
øw1394_°¨t_phy_∑ckë_wrôe
(
øw1394h™dÀ_t
 
h™dÀ
,

855 
quadÀt_t
 
d©a
, 
èg
);

878 
øw1394_°¨t_ªad
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

879 
size_t
 
Àngth
, 
quadÀt_t
 *
buf„r
, 
èg
);

902 
øw1394_°¨t_wrôe
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

903 
size_t
 
Àngth
, 
quadÀt_t
 *
d©a
, 
èg
);

926 
øw1394_°¨t_lock
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

927 
extcode
, 
quadÀt_t
 
d©a
, quadÀt_à
¨g
,

928 
quadÀt_t
 *
ªsu…
, 
èg
);

951 
øw1394_°¨t_lock64
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

952 
extcode
, 
o˘Àt_t
 
d©a
, o˘Àt_à
¨g
,

953 
o˘Àt_t
 *
ªsu…
, 
èg
);

971 
øw1394_°¨t_async_°ªam
(
øw1394h™dÀ_t
 
h™dÀ
, 
ch™√l
,

972 
èg
, 
sy
,

973 
•ìd
, 
size_t
 
Àngth
, 
quadÀt_t
 *
d©a
,

974 
øwèg
);

1000 
øw1394_°¨t_async_£nd
(
øw1394h™dÀ_t
 
h™dÀ
,

1001 
size_t
 
Àngth
, size_à
hódî_Àngth
,

1002 
ex≥˘_ª•⁄£
,

1003 
quadÀt_t
 *
d©a
, 
øwèg
);

1021 
øw1394_ªad
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

1022 
size_t
 
Àngth
, 
quadÀt_t
 *
buf„r
);

1040 
øw1394_wrôe
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

1041 
size_t
 
Àngth
, 
quadÀt_t
 *
d©a
);

1059 
øw1394_lock
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

1060 
extcode
, 
quadÀt_t
 
d©a
, quadÀt_à
¨g
,

1061 
quadÀt_t
 *
ªsu…
);

1079 
øw1394_lock64
(
øw1394h™dÀ_t
 
h™dÀ
, 
nodeid_t
 
node
, 
nodóddr_t
 
addr
,

1080 
extcode
, 
o˘Àt_t
 
d©a
, o˘Àt_à
¨g
,

1081 
o˘Àt_t
 *
ªsu…
);

1095 
øw1394_async_°ªam
(
øw1394h™dÀ_t
 
h™dÀ
, 
ch™√l
,

1096 
èg
, 
sy
, 
•ìd
,

1097 
size_t
 
Àngth
, 
quadÀt_t
 *
d©a
);

1109 
øw1394_async_£nd
(
øw1394h™dÀ_t
 
h™dÀ
,

1110 
size_t
 
Àngth
, size_à
hódî_Àngth
,

1111 
ex≥˘_ª•⁄£
,

1112 
quadÀt_t
 *
d©a
);

1125 
øw1394_°¨t_f˝_li°í
(
øw1394h™dÀ_t
 
h™dÀ
);

1136 
øw1394_°›_f˝_li°í
(
øw1394h™dÀ_t
 
h™dÀ
);

1147 c⁄° *
øw1394_gë_libvîsi⁄
();

1165 
øw1394_upd©e_c⁄fig_rom
(
øw1394h™dÀ_t
 
h™dÀ
, c⁄° 
quadÀt_t


1166 *
√w_rom
, 
size_t
 
size
, 
rom_vîsi⁄
);

1183 
øw1394_gë_c⁄fig_rom
(
øw1394h™dÀ_t
 
h™dÀ
, 
quadÀt_t
 *
buf„r
,

1184 
size_t
 
buf„rsize
, size_à*
rom_size
, *
rom_vîsi⁄
);

1198 
øw1394_b™dwidth_modify
 (
øw1394h™dÀ_t
 
h™dÀ
, 
b™dwidth
,

1199 
øw1394_modify_mode
 
mode
);

1213 
øw1394_ch™√l_modify
 (
øw1394h™dÀ_t
 
h™dÀ
, 
ch™√l
,

1214 
øw1394_modify_mode
 
mode
);

1217 #ifde‡
__˝lu•lus


	@/usr/include/libv4l1.h

19 #i‚de‡
__LIBV4L1_H


20 
	#__LIBV4L1_H


	)

22 #ifde‡
__˝lu•lus


26 
	~<°dio.h
>

27 
	~<°döt.h
>

28 
	~<uni°d.h
>

29 
	~<libv4l1-videodev.h
>

31 #i‡
HAVE_VISIBILITY


32 
	#LIBV4L_PUBLIC
 
	`__©åibuã__
 ((
	`visibûôy
("deÁu…")))

	)

34 
	#LIBV4L_PUBLIC


	)

39 
LIBV4L_PUBLIC
 
FILE
 *
v4l1_log_fûe
;

62 
LIBV4L_PUBLIC
 
v4l1_›í
(c⁄° *
fûe
, 
oÊag
, ...);

63 
LIBV4L_PUBLIC
 
v4l1_˛o£
(
fd
);

64 
LIBV4L_PUBLIC
 
v4l1_dup
(
fd
);

65 
LIBV4L_PUBLIC
 
v4l1_io˘l
(
fd
, 
ªque°
, ...);

66 
LIBV4L_PUBLIC
 
ssize_t
 
v4l1_ªad
(
fd
, *
buf„r
, 
size_t
 
n
);

67 
LIBV4L_PUBLIC
 *
v4l1_mm≠
(*
°¨t
, 
size_t
 
Àngth
, 
¥Ÿ
, 
Êags
,

68 
fd
, 
öt64_t
 
off£t
);

69 
LIBV4L_PUBLIC
 
v4l1_munm≠
(*
_°¨t
, 
size_t
 
Àngth
);

71 #ifde‡
__˝lu•lus


	@/usr/include/libv4l2.h

19 #i‚de‡
__LIBV4L2_H


20 
	#__LIBV4L2_H


	)

22 
	~<°dio.h
>

23 
	~<uni°d.h
>

24 
	~<°döt.h
>

26 #ifde‡
__˝lu•lus


30 #i‡
HAVE_VISIBILITY


31 
	#LIBV4L_PUBLIC
 
	`__©åibuã__
 ((
	`visibûôy
("deÁu…")))

	)

33 
	#LIBV4L_PUBLIC


	)

38 
LIBV4L_PUBLIC
 
FILE
 *
v4l2_log_fûe
;

63 
LIBV4L_PUBLIC
 
v4l2_›í
(c⁄° *
fûe
, 
oÊag
, ...);

64 
LIBV4L_PUBLIC
 
v4l2_˛o£
(
fd
);

65 
LIBV4L_PUBLIC
 
v4l2_dup
(
fd
);

66 
LIBV4L_PUBLIC
 
v4l2_io˘l
(
fd
, 
ªque°
, ...);

67 
LIBV4L_PUBLIC
 
ssize_t
 
v4l2_ªad
(
fd
, *
buf„r
, 
size_t
 
n
);

68 
LIBV4L_PUBLIC
 
ssize_t
 
v4l2_wrôe
(
fd
, c⁄° *
buf„r
, 
size_t
 
n
);

69 
LIBV4L_PUBLIC
 *
v4l2_mm≠
(*
°¨t
, 
size_t
 
Àngth
, 
¥Ÿ
, 
Êags
,

70 
fd
, 
öt64_t
 
off£t
);

71 
LIBV4L_PUBLIC
 
v4l2_munm≠
(*
_°¨t
, 
size_t
 
Àngth
);

82 
LIBV4L_PUBLIC
 
v4l2_£t_c⁄åﬁ
(
fd
, 
cid
, 
vÆue
);

87 
LIBV4L_PUBLIC
 
v4l2_gë_c⁄åﬁ
(
fd
, 
cid
);

99 
	#V4L2_DISABLE_CONVERSION
 0x01

	)

102 
	#V4L2_ENABLE_ENUM_FMT_EMULATION
 0x02

	)

110 
LIBV4L_PUBLIC
 
v4l2_fd_›í
(
fd
, 
v4l2_Êags
);

112 #ifde‡
__˝lu•lus


	@/usr/include/linux/videodev2.h

56 #i‚de‡
__LINUX_VIDEODEV2_H


57 
	#__LINUX_VIDEODEV2_H


	)

59 
	~<sys/time.h
>

61 
	~<löux/io˘l.h
>

62 
	~<löux/ty≥s.h
>

68 
	#VIDEO_MAX_FRAME
 32

	)

69 
	#VIDEO_MAX_PLANES
 8

	)

75 
	#VID_TYPE_CAPTURE
 1

	)

76 
	#VID_TYPE_TUNER
 2

	)

77 
	#VID_TYPE_TELETEXT
 4

	)

78 
	#VID_TYPE_OVERLAY
 8

	)

79 
	#VID_TYPE_CHROMAKEY
 16

	)

80 
	#VID_TYPE_CLIPPING
 32

	)

81 
	#VID_TYPE_FRAMERAM
 64

	)

82 
	#VID_TYPE_SCALES
 128

	)

83 
	#VID_TYPE_MONOCHROME
 256

	)

84 
	#VID_TYPE_SUBCAPTURE
 512

	)

85 
	#VID_TYPE_MPEG_DECODER
 1024

	)

86 
	#VID_TYPE_MPEG_ENCODER
 2048

	)

87 
	#VID_TYPE_MJPEG_DECODER
 4096

	)

88 
	#VID_TYPE_MJPEG_ENCODER
 8192

	)

95 
	#v4l2_fourcc
(
a
, 
b
, 
c
, 
d
)\

96 ((
__u32
)(
a
Ë| ((__u32)(
b
Ë<< 8Ë| ((__u32)(
c
Ë<< 16Ë| ((__u32)(
d
Ë<< 24))

	)

101 
	ev4l2_fõld
 {

102 
	mV4L2_FIELD_ANY
 = 0,

106 
	mV4L2_FIELD_NONE
 = 1,

107 
	mV4L2_FIELD_TOP
 = 2,

108 
	mV4L2_FIELD_BOTTOM
 = 3,

109 
	mV4L2_FIELD_INTERLACED
 = 4,

110 
	mV4L2_FIELD_SEQ_TB
 = 5,

112 
	mV4L2_FIELD_SEQ_BT
 = 6,

113 
	mV4L2_FIELD_ALTERNATE
 = 7,

115 
	mV4L2_FIELD_INTERLACED_TB
 = 8,

118 
	mV4L2_FIELD_INTERLACED_BT
 = 9,

122 
	#V4L2_FIELD_HAS_TOP
(
fõld
) \

123 ((
fõld
Ë=
V4L2_FIELD_TOP
 ||\

124 (
fõld
Ë=
V4L2_FIELD_INTERLACED
 ||\

125 (
fõld
Ë=
V4L2_FIELD_INTERLACED_TB
 ||\

126 (
fõld
Ë=
V4L2_FIELD_INTERLACED_BT
 ||\

127 (
fõld
Ë=
V4L2_FIELD_SEQ_TB
 ||\

128 (
fõld
Ë=
V4L2_FIELD_SEQ_BT
)

	)

129 
	#V4L2_FIELD_HAS_BOTTOM
(
fõld
) \

130 ((
fõld
Ë=
V4L2_FIELD_BOTTOM
 ||\

131 (
fõld
Ë=
V4L2_FIELD_INTERLACED
 ||\

132 (
fõld
Ë=
V4L2_FIELD_INTERLACED_TB
 ||\

133 (
fõld
Ë=
V4L2_FIELD_INTERLACED_BT
 ||\

134 (
fõld
Ë=
V4L2_FIELD_SEQ_TB
 ||\

135 (
fõld
Ë=
V4L2_FIELD_SEQ_BT
)

	)

136 
	#V4L2_FIELD_HAS_BOTH
(
fõld
) \

137 ((
fõld
Ë=
V4L2_FIELD_INTERLACED
 ||\

138 (
fõld
Ë=
V4L2_FIELD_INTERLACED_TB
 ||\

139 (
fõld
Ë=
V4L2_FIELD_INTERLACED_BT
 ||\

140 (
fõld
Ë=
V4L2_FIELD_SEQ_TB
 ||\

141 (
fõld
Ë=
V4L2_FIELD_SEQ_BT
)

	)

143 
	ev4l2_buf_ty≥
 {

144 
	mV4L2_BUF_TYPE_VIDEO_CAPTURE
 = 1,

145 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT
 = 2,

146 
	mV4L2_BUF_TYPE_VIDEO_OVERLAY
 = 3,

147 
	mV4L2_BUF_TYPE_VBI_CAPTURE
 = 4,

148 
	mV4L2_BUF_TYPE_VBI_OUTPUT
 = 5,

149 
	mV4L2_BUF_TYPE_SLICED_VBI_CAPTURE
 = 6,

150 
	mV4L2_BUF_TYPE_SLICED_VBI_OUTPUT
 = 7,

153 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT_OVERLAY
 = 8,

155 
	mV4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE
 = 9,

156 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
 = 10,

157 
	mV4L2_BUF_TYPE_PRIVATE
 = 0x80,

160 
	#V4L2_TYPE_IS_MULTIPLANAR
(
ty≥
) \

161 ((
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE
 \

162 || (
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
)

	)

164 
	#V4L2_TYPE_IS_OUTPUT
(
ty≥
) \

165 ((
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_OUTPUT
 \

166 || (
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
 \

167 || (
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_OVERLAY
 \

168 || (
ty≥
Ë=
V4L2_BUF_TYPE_VIDEO_OUTPUT_OVERLAY
 \

169 || (
ty≥
Ë=
V4L2_BUF_TYPE_VBI_OUTPUT
 \

170 || (
ty≥
Ë=
V4L2_BUF_TYPE_SLICED_VBI_OUTPUT
)

	)

172 
	ev4l2_tu√r_ty≥
 {

173 
	mV4L2_TUNER_RADIO
 = 1,

174 
	mV4L2_TUNER_ANALOG_TV
 = 2,

175 
	mV4L2_TUNER_DIGITAL_TV
 = 3,

178 
	ev4l2_mem‹y
 {

179 
	mV4L2_MEMORY_MMAP
 = 1,

180 
	mV4L2_MEMORY_USERPTR
 = 2,

181 
	mV4L2_MEMORY_OVERLAY
 = 3,

185 
	ev4l2_cﬁ‹•a˚
 {

187 
	mV4L2_COLORSPACE_SMPTE170M
 = 1,

190 
	mV4L2_COLORSPACE_SMPTE240M
 = 2,

193 
	mV4L2_COLORSPACE_REC709
 = 3,

196 
	mV4L2_COLORSPACE_BT878
 = 4,

199 
	mV4L2_COLORSPACE_470_SYSTEM_M
 = 5,

200 
	mV4L2_COLORSPACE_470_SYSTEM_BG
 = 6,

206 
	mV4L2_COLORSPACE_JPEG
 = 7,

209 
	mV4L2_COLORSPACE_SRGB
 = 8,

212 
	ev4l2_¥i‹ôy
 {

213 
	mV4L2_PRIORITY_UNSET
 = 0,

214 
	mV4L2_PRIORITY_BACKGROUND
 = 1,

215 
	mV4L2_PRIORITY_INTERACTIVE
 = 2,

216 
	mV4L2_PRIORITY_RECORD
 = 3,

217 
	mV4L2_PRIORITY_DEFAULT
 = 
V4L2_PRIORITY_INTERACTIVE
,

220 
	sv4l2_ª˘
 {

221 
__s32
 
	mÀ·
;

222 
__s32
 
	mt›
;

223 
__s32
 
	mwidth
;

224 
__s32
 
	mheight
;

227 
	sv4l2_‰a˘
 {

228 
__u32
 
	mnumî©‹
;

229 
__u32
 
	mdíomö©‹
;

235 
	sv4l2_ˇ∑bûôy
 {

236 
__u8
 
	mdrivî
[16];

237 
__u8
 
	mˇrd
[32];

238 
__u8
 
	mbus_öfo
[32];

239 
__u32
 
	mvîsi⁄
;

240 
__u32
 
	mˇ∑bûôõs
;

241 
__u32
 
	mª£rved
[4];

245 
	#V4L2_CAP_VIDEO_CAPTURE
 0x00000001

	)

246 
	#V4L2_CAP_VIDEO_OUTPUT
 0x00000002

	)

247 
	#V4L2_CAP_VIDEO_OVERLAY
 0x00000004

	)

248 
	#V4L2_CAP_VBI_CAPTURE
 0x00000010

	)

249 
	#V4L2_CAP_VBI_OUTPUT
 0x00000020

	)

250 
	#V4L2_CAP_SLICED_VBI_CAPTURE
 0x00000040

	)

251 
	#V4L2_CAP_SLICED_VBI_OUTPUT
 0x00000080

	)

252 
	#V4L2_CAP_RDS_CAPTURE
 0x00000100

	)

253 
	#V4L2_CAP_VIDEO_OUTPUT_OVERLAY
 0x00000200

	)

254 
	#V4L2_CAP_HW_FREQ_SEEK
 0x00000400

	)

255 
	#V4L2_CAP_RDS_OUTPUT
 0x00000800

	)

258 
	#V4L2_CAP_VIDEO_CAPTURE_MPLANE
 0x00001000

	)

260 
	#V4L2_CAP_VIDEO_OUTPUT_MPLANE
 0x00002000

	)

262 
	#V4L2_CAP_TUNER
 0x00010000

	)

263 
	#V4L2_CAP_AUDIO
 0x00020000

	)

264 
	#V4L2_CAP_RADIO
 0x00040000

	)

265 
	#V4L2_CAP_MODULATOR
 0x00080000

	)

267 
	#V4L2_CAP_READWRITE
 0x01000000

	)

268 
	#V4L2_CAP_ASYNCIO
 0x02000000

	)

269 
	#V4L2_CAP_STREAMING
 0x04000000

	)

274 
	sv4l2_pix_f‹m©
 {

275 
__u32
 
	mwidth
;

276 
__u32
 
	mheight
;

277 
__u32
 
	mpixñf‹m©
;

278 
v4l2_fõld
 
	mfõld
;

279 
__u32
 
	mbyã•îlöe
;

280 
__u32
 
	msizeimage
;

281 
v4l2_cﬁ‹•a˚
 
	mcﬁ‹•a˚
;

282 
__u32
 
	m¥iv
;

288 
	#V4L2_PIX_FMT_RGB332
 
	`v4l2_fourcc
('R', 'G', 'B', '1'Ë

	)

289 
	#V4L2_PIX_FMT_RGB444
 
	`v4l2_fourcc
('R', '4', '4', '4'Ë

	)

290 
	#V4L2_PIX_FMT_RGB555
 
	`v4l2_fourcc
('R', 'G', 'B', 'O'Ë

	)

291 
	#V4L2_PIX_FMT_RGB565
 
	`v4l2_fourcc
('R', 'G', 'B', 'P'Ë

	)

292 
	#V4L2_PIX_FMT_RGB555X
 
	`v4l2_fourcc
('R', 'G', 'B', 'Q'Ë

	)

293 
	#V4L2_PIX_FMT_RGB565X
 
	`v4l2_fourcc
('R', 'G', 'B', 'R'Ë

	)

294 
	#V4L2_PIX_FMT_BGR666
 
	`v4l2_fourcc
('B', 'G', 'R', 'H'Ë

	)

295 
	#V4L2_PIX_FMT_BGR24
 
	`v4l2_fourcc
('B', 'G', 'R', '3'Ë

	)

296 
	#V4L2_PIX_FMT_RGB24
 
	`v4l2_fourcc
('R', 'G', 'B', '3'Ë

	)

297 
	#V4L2_PIX_FMT_BGR32
 
	`v4l2_fourcc
('B', 'G', 'R', '4'Ë

	)

298 
	#V4L2_PIX_FMT_RGB32
 
	`v4l2_fourcc
('R', 'G', 'B', '4'Ë

	)

301 
	#V4L2_PIX_FMT_GREY
 
	`v4l2_fourcc
('G', 'R', 'E', 'Y'Ë

	)

302 
	#V4L2_PIX_FMT_Y4
 
	`v4l2_fourcc
('Y', '0', '4', ' 'Ë

	)

303 
	#V4L2_PIX_FMT_Y6
 
	`v4l2_fourcc
('Y', '0', '6', ' 'Ë

	)

304 
	#V4L2_PIX_FMT_Y10
 
	`v4l2_fourcc
('Y', '1', '0', ' 'Ë

	)

305 
	#V4L2_PIX_FMT_Y12
 
	`v4l2_fourcc
('Y', '1', '2', ' 'Ë

	)

306 
	#V4L2_PIX_FMT_Y16
 
	`v4l2_fourcc
('Y', '1', '6', ' 'Ë

	)

309 
	#V4L2_PIX_FMT_Y10BPACK
 
	`v4l2_fourcc
('Y', '1', '0', 'B'Ë

	)

312 
	#V4L2_PIX_FMT_PAL8
 
	`v4l2_fourcc
('P', 'A', 'L', '8'Ë

	)

315 
	#V4L2_PIX_FMT_YVU410
 
	`v4l2_fourcc
('Y', 'V', 'U', '9'Ë

	)

316 
	#V4L2_PIX_FMT_YVU420
 
	`v4l2_fourcc
('Y', 'V', '1', '2'Ë

	)

317 
	#V4L2_PIX_FMT_YUYV
 
	`v4l2_fourcc
('Y', 'U', 'Y', 'V'Ë

	)

318 
	#V4L2_PIX_FMT_YYUV
 
	`v4l2_fourcc
('Y', 'Y', 'U', 'V'Ë

	)

319 
	#V4L2_PIX_FMT_YVYU
 
	`v4l2_fourcc
('Y', 'V', 'Y', 'U'Ë

	)

320 
	#V4L2_PIX_FMT_UYVY
 
	`v4l2_fourcc
('U', 'Y', 'V', 'Y'Ë

	)

321 
	#V4L2_PIX_FMT_VYUY
 
	`v4l2_fourcc
('V', 'Y', 'U', 'Y'Ë

	)

322 
	#V4L2_PIX_FMT_YUV422P
 
	`v4l2_fourcc
('4', '2', '2', 'P'Ë

	)

323 
	#V4L2_PIX_FMT_YUV411P
 
	`v4l2_fourcc
('4', '1', '1', 'P'Ë

	)

324 
	#V4L2_PIX_FMT_Y41P
 
	`v4l2_fourcc
('Y', '4', '1', 'P'Ë

	)

325 
	#V4L2_PIX_FMT_YUV444
 
	`v4l2_fourcc
('Y', '4', '4', '4'Ë

	)

326 
	#V4L2_PIX_FMT_YUV555
 
	`v4l2_fourcc
('Y', 'U', 'V', 'O'Ë

	)

327 
	#V4L2_PIX_FMT_YUV565
 
	`v4l2_fourcc
('Y', 'U', 'V', 'P'Ë

	)

328 
	#V4L2_PIX_FMT_YUV32
 
	`v4l2_fourcc
('Y', 'U', 'V', '4'Ë

	)

329 
	#V4L2_PIX_FMT_YUV410
 
	`v4l2_fourcc
('Y', 'U', 'V', '9'Ë

	)

330 
	#V4L2_PIX_FMT_YUV420
 
	`v4l2_fourcc
('Y', 'U', '1', '2'Ë

	)

331 
	#V4L2_PIX_FMT_HI240
 
	`v4l2_fourcc
('H', 'I', '2', '4'Ë

	)

332 
	#V4L2_PIX_FMT_HM12
 
	`v4l2_fourcc
('H', 'M', '1', '2'Ë

	)

333 
	#V4L2_PIX_FMT_M420
 
	`v4l2_fourcc
('M', '4', '2', '0'Ë

	)

336 
	#V4L2_PIX_FMT_NV12
 
	`v4l2_fourcc
('N', 'V', '1', '2'Ë

	)

337 
	#V4L2_PIX_FMT_NV21
 
	`v4l2_fourcc
('N', 'V', '2', '1'Ë

	)

338 
	#V4L2_PIX_FMT_NV16
 
	`v4l2_fourcc
('N', 'V', '1', '6'Ë

	)

339 
	#V4L2_PIX_FMT_NV61
 
	`v4l2_fourcc
('N', 'V', '6', '1'Ë

	)

342 
	#V4L2_PIX_FMT_NV12M
 
	`v4l2_fourcc
('N', 'M', '1', '2'Ë

	)

343 
	#V4L2_PIX_FMT_NV12MT
 
	`v4l2_fourcc
('T', 'M', '1', '2'Ë

	)

346 
	#V4L2_PIX_FMT_YUV420M
 
	`v4l2_fourcc
('Y', 'M', '1', '2'Ë

	)

349 
	#V4L2_PIX_FMT_SBGGR8
 
	`v4l2_fourcc
('B', 'A', '8', '1'Ë

	)

350 
	#V4L2_PIX_FMT_SGBRG8
 
	`v4l2_fourcc
('G', 'B', 'R', 'G'Ë

	)

351 
	#V4L2_PIX_FMT_SGRBG8
 
	`v4l2_fourcc
('G', 'R', 'B', 'G'Ë

	)

352 
	#V4L2_PIX_FMT_SRGGB8
 
	`v4l2_fourcc
('R', 'G', 'G', 'B'Ë

	)

353 
	#V4L2_PIX_FMT_SBGGR10
 
	`v4l2_fourcc
('B', 'G', '1', '0'Ë

	)

354 
	#V4L2_PIX_FMT_SGBRG10
 
	`v4l2_fourcc
('G', 'B', '1', '0'Ë

	)

355 
	#V4L2_PIX_FMT_SGRBG10
 
	`v4l2_fourcc
('B', 'A', '1', '0'Ë

	)

356 
	#V4L2_PIX_FMT_SRGGB10
 
	`v4l2_fourcc
('R', 'G', '1', '0'Ë

	)

357 
	#V4L2_PIX_FMT_SBGGR12
 
	`v4l2_fourcc
('B', 'G', '1', '2'Ë

	)

358 
	#V4L2_PIX_FMT_SGBRG12
 
	`v4l2_fourcc
('G', 'B', '1', '2'Ë

	)

359 
	#V4L2_PIX_FMT_SGRBG12
 
	`v4l2_fourcc
('B', 'A', '1', '2'Ë

	)

360 
	#V4L2_PIX_FMT_SRGGB12
 
	`v4l2_fourcc
('R', 'G', '1', '2'Ë

	)

362 
	#V4L2_PIX_FMT_SGRBG10DPCM8
 
	`v4l2_fourcc
('B', 'D', '1', '0')

	)

367 
	#V4L2_PIX_FMT_SBGGR16
 
	`v4l2_fourcc
('B', 'Y', 'R', '2'Ë

	)

370 
	#V4L2_PIX_FMT_MJPEG
 
	`v4l2_fourcc
('M', 'J', 'P', 'G'Ë

	)

371 
	#V4L2_PIX_FMT_JPEG
 
	`v4l2_fourcc
('J', 'P', 'E', 'G'Ë

	)

372 
	#V4L2_PIX_FMT_DV
 
	`v4l2_fourcc
('d', 'v', 's', 'd'Ë

	)

373 
	#V4L2_PIX_FMT_MPEG
 
	`v4l2_fourcc
('M', 'P', 'E', 'G'Ë

	)

374 
	#V4L2_PIX_FMT_H264
 
	`v4l2_fourcc
('H', '2', '6', '4'Ë

	)

375 
	#V4L2_PIX_FMT_H264_NO_SC
 
	`v4l2_fourcc
('A', 'V', 'C', '1'Ë

	)

376 
	#V4L2_PIX_FMT_H263
 
	`v4l2_fourcc
('H', '2', '6', '3'Ë

	)

377 
	#V4L2_PIX_FMT_MPEG1
 
	`v4l2_fourcc
('M', 'P', 'G', '1'Ë

	)

378 
	#V4L2_PIX_FMT_MPEG2
 
	`v4l2_fourcc
('M', 'P', 'G', '2'Ë

	)

379 
	#V4L2_PIX_FMT_MPEG4
 
	`v4l2_fourcc
('M', 'P', 'G', '4'Ë

	)

380 
	#V4L2_PIX_FMT_XVID
 
	`v4l2_fourcc
('X', 'V', 'I', 'D'Ë

	)

381 
	#V4L2_PIX_FMT_VC1_ANNEX_G
 
	`v4l2_fourcc
('V', 'C', '1', 'G'Ë

	)

382 
	#V4L2_PIX_FMT_VC1_ANNEX_L
 
	`v4l2_fourcc
('V', 'C', '1', 'L'Ë

	)

385 
	#V4L2_PIX_FMT_CPIA1
 
	`v4l2_fourcc
('C', 'P', 'I', 'A'Ë

	)

386 
	#V4L2_PIX_FMT_WNVA
 
	`v4l2_fourcc
('W', 'N', 'V', 'A'Ë

	)

387 
	#V4L2_PIX_FMT_SN9C10X
 
	`v4l2_fourcc
('S', '9', '1', '0'Ë

	)

388 
	#V4L2_PIX_FMT_SN9C20X_I420
 
	`v4l2_fourcc
('S', '9', '2', '0'Ë

	)

389 
	#V4L2_PIX_FMT_PWC1
 
	`v4l2_fourcc
('P', 'W', 'C', '1'Ë

	)

390 
	#V4L2_PIX_FMT_PWC2
 
	`v4l2_fourcc
('P', 'W', 'C', '2'Ë

	)

391 
	#V4L2_PIX_FMT_ET61X251
 
	`v4l2_fourcc
('E', '6', '2', '5'Ë

	)

392 
	#V4L2_PIX_FMT_SPCA501
 
	`v4l2_fourcc
('S', '5', '0', '1'Ë

	)

393 
	#V4L2_PIX_FMT_SPCA505
 
	`v4l2_fourcc
('S', '5', '0', '5'Ë

	)

394 
	#V4L2_PIX_FMT_SPCA508
 
	`v4l2_fourcc
('S', '5', '0', '8'Ë

	)

395 
	#V4L2_PIX_FMT_SPCA561
 
	`v4l2_fourcc
('S', '5', '6', '1'Ë

	)

396 
	#V4L2_PIX_FMT_PAC207
 
	`v4l2_fourcc
('P', '2', '0', '7'Ë

	)

397 
	#V4L2_PIX_FMT_MR97310A
 
	`v4l2_fourcc
('M', '3', '1', '0'Ë

	)

398 
	#V4L2_PIX_FMT_SN9C2028
 
	`v4l2_fourcc
('S', 'O', 'N', 'X'Ë

	)

399 
	#V4L2_PIX_FMT_SQ905C
 
	`v4l2_fourcc
('9', '0', '5', 'C'Ë

	)

400 
	#V4L2_PIX_FMT_PJPG
 
	`v4l2_fourcc
('P', 'J', 'P', 'G'Ë

	)

401 
	#V4L2_PIX_FMT_OV511
 
	`v4l2_fourcc
('O', '5', '1', '1'Ë

	)

402 
	#V4L2_PIX_FMT_OV518
 
	`v4l2_fourcc
('O', '5', '1', '8'Ë

	)

403 
	#V4L2_PIX_FMT_STV0680
 
	`v4l2_fourcc
('S', '6', '8', '0'Ë

	)

404 
	#V4L2_PIX_FMT_TM6000
 
	`v4l2_fourcc
('T', 'M', '6', '0'Ë

	)

405 
	#V4L2_PIX_FMT_CIT_YYVYUY
 
	`v4l2_fourcc
('C', 'I', 'T', 'V'Ë

	)

406 
	#V4L2_PIX_FMT_KONICA420
 
	`v4l2_fourcc
('K', 'O', 'N', 'I'Ë

	)

407 
	#V4L2_PIX_FMT_JPGL
 
	`v4l2_fourcc
('J', 'P', 'G', 'L'Ë

	)

408 
	#V4L2_PIX_FMT_SE401
 
	`v4l2_fourcc
('S', '4', '0', '1'Ë

	)

413 
	sv4l2_fmtdesc
 {

414 
__u32
 
	mödex
;

415 
v4l2_buf_ty≥
 
	mty≥
;

416 
__u32
 
	mÊags
;

417 
__u8
 
	mdes¸ùti⁄
[32];

418 
__u32
 
	mpixñf‹m©
;

419 
__u32
 
	mª£rved
[4];

422 
	#V4L2_FMT_FLAG_COMPRESSED
 0x0001

	)

423 
	#V4L2_FMT_FLAG_EMULATED
 0x0002

	)

430 
	ev4l2_‰msizëy≥s
 {

431 
	mV4L2_FRMSIZE_TYPE_DISCRETE
 = 1,

432 
	mV4L2_FRMSIZE_TYPE_CONTINUOUS
 = 2,

433 
	mV4L2_FRMSIZE_TYPE_STEPWISE
 = 3,

436 
	sv4l2_‰msize_dis¸ëe
 {

437 
__u32
 
	mwidth
;

438 
__u32
 
	mheight
;

441 
	sv4l2_‰msize_°ïwi£
 {

442 
__u32
 
	mmö_width
;

443 
__u32
 
	mmax_width
;

444 
__u32
 
	m°ï_width
;

445 
__u32
 
	mmö_height
;

446 
__u32
 
	mmax_height
;

447 
__u32
 
	m°ï_height
;

450 
	sv4l2_‰msizìnum
 {

451 
__u32
 
	mödex
;

452 
__u32
 
	mpixñ_f‹m©
;

453 
__u32
 
	mty≥
;

456 
v4l2_‰msize_dis¸ëe
 
	mdis¸ëe
;

457 
v4l2_‰msize_°ïwi£
 
	m°ïwi£
;

460 
__u32
 
	mª£rved
[2];

466 
	ev4l2_‰mivÆty≥s
 {

467 
	mV4L2_FRMIVAL_TYPE_DISCRETE
 = 1,

468 
	mV4L2_FRMIVAL_TYPE_CONTINUOUS
 = 2,

469 
	mV4L2_FRMIVAL_TYPE_STEPWISE
 = 3,

472 
	sv4l2_‰mivÆ_°ïwi£
 {

473 
v4l2_‰a˘
 
	mmö
;

474 
v4l2_‰a˘
 
	mmax
;

475 
v4l2_‰a˘
 
	m°ï
;

478 
	sv4l2_‰mivÆíum
 {

479 
__u32
 
	mödex
;

480 
__u32
 
	mpixñ_f‹m©
;

481 
__u32
 
	mwidth
;

482 
__u32
 
	mheight
;

483 
__u32
 
	mty≥
;

486 
v4l2_‰a˘
 
	mdis¸ëe
;

487 
v4l2_‰mivÆ_°ïwi£
 
	m°ïwi£
;

490 
__u32
 
	mª£rved
[2];

497 
	sv4l2_timecode
 {

498 
__u32
 
	mty≥
;

499 
__u32
 
	mÊags
;

500 
__u8
 
	m‰ames
;

501 
__u8
 
	m£c⁄ds
;

502 
__u8
 
	mmöuãs
;

503 
__u8
 
	mhours
;

504 
__u8
 
	mu£rbôs
[4];

508 
	#V4L2_TC_TYPE_24FPS
 1

	)

509 
	#V4L2_TC_TYPE_25FPS
 2

	)

510 
	#V4L2_TC_TYPE_30FPS
 3

	)

511 
	#V4L2_TC_TYPE_50FPS
 4

	)

512 
	#V4L2_TC_TYPE_60FPS
 5

	)

515 
	#V4L2_TC_FLAG_DROPFRAME
 0x0001

	)

516 
	#V4L2_TC_FLAG_COLORFRAME
 0x0002

	)

517 
	#V4L2_TC_USERBITS_fõld
 0x000C

	)

518 
	#V4L2_TC_USERBITS_USERDEFINED
 0x0000

	)

519 
	#V4L2_TC_USERBITS_8BITCHARS
 0x0008

	)

522 
	sv4l2_j≥gcom¥essi⁄
 {

523 
	mquÆôy
;

525 
	mAPPn
;

527 
	mAPP_Àn
;

528 
	mAPP_d©a
[60];

530 
	mCOM_Àn
;

531 
	mCOM_d©a
[60];

533 
__u32
 
	mj≥g_m¨kîs
;

543 
	#V4L2_JPEG_MARKER_DHT
 (1<<3Ë

	)

544 
	#V4L2_JPEG_MARKER_DQT
 (1<<4Ë

	)

545 
	#V4L2_JPEG_MARKER_DRI
 (1<<5Ë

	)

546 
	#V4L2_JPEG_MARKER_COM
 (1<<6Ë

	)

547 
	#V4L2_JPEG_MARKER_APP
 (1<<7Ë

	)

554 
	sv4l2_ªque°buf„rs
 {

555 
__u32
 
	mcou¡
;

556 
v4l2_buf_ty≥
 
	mty≥
;

557 
v4l2_mem‹y
 
	mmem‹y
;

558 
__u32
 
	mª£rved
[2];

579 
	sv4l2_∂™e
 {

580 
__u32
 
	mbyãsu£d
;

581 
__u32
 
	mÀngth
;

583 
__u32
 
	mmem_off£t
;

584 
	mu£Ωå
;

585 } 
	mm
;

586 
__u32
 
	md©a_off£t
;

587 
__u32
 
	mª£rved
[11];

617 
	sv4l2_buf„r
 {

618 
__u32
 
	mödex
;

619 
v4l2_buf_ty≥
 
	mty≥
;

620 
__u32
 
	mbyãsu£d
;

621 
__u32
 
	mÊags
;

622 
v4l2_fõld
 
	mfõld
;

623 
timevÆ
 
	mtime°amp
;

624 
v4l2_timecode
 
	mtimecode
;

625 
__u32
 
	m£quí˚
;

628 
v4l2_mem‹y
 
	mmem‹y
;

630 
__u32
 
	moff£t
;

631 
	mu£Ωå
;

632 
v4l2_∂™e
 *
	m∂™es
;

633 } 
	mm
;

634 
__u32
 
	mÀngth
;

635 
__u32
 
	möput
;

636 
__u32
 
	mª£rved
;

640 
	#V4L2_BUF_FLAG_MAPPED
 0x0001

	)

641 
	#V4L2_BUF_FLAG_QUEUED
 0x0002

	)

642 
	#V4L2_BUF_FLAG_DONE
 0x0004

	)

643 
	#V4L2_BUF_FLAG_KEYFRAME
 0x0008

	)

644 
	#V4L2_BUF_FLAG_PFRAME
 0x0010

	)

645 
	#V4L2_BUF_FLAG_BFRAME
 0x0020

	)

647 
	#V4L2_BUF_FLAG_ERROR
 0x0040

	)

648 
	#V4L2_BUF_FLAG_TIMECODE
 0x0100

	)

649 
	#V4L2_BUF_FLAG_INPUT
 0x0200

	)

650 
	#V4L2_BUF_FLAG_PREPARED
 0x0400

	)

652 
	#V4L2_BUF_FLAG_NO_CACHE_INVALIDATE
 0x0800

	)

653 
	#V4L2_BUF_FLAG_NO_CACHE_CLEAN
 0x1000

	)

658 
	sv4l2_‰amebuf„r
 {

659 
__u32
 
	mˇ∑bûôy
;

660 
__u32
 
	mÊags
;

663 *
	mba£
;

664 
v4l2_pix_f‹m©
 
	mfmt
;

667 
	#V4L2_FBUF_CAP_EXTERNOVERLAY
 0x0001

	)

668 
	#V4L2_FBUF_CAP_CHROMAKEY
 0x0002

	)

669 
	#V4L2_FBUF_CAP_LIST_CLIPPING
 0x0004

	)

670 
	#V4L2_FBUF_CAP_BITMAP_CLIPPING
 0x0008

	)

671 
	#V4L2_FBUF_CAP_LOCAL_ALPHA
 0x0010

	)

672 
	#V4L2_FBUF_CAP_GLOBAL_ALPHA
 0x0020

	)

673 
	#V4L2_FBUF_CAP_LOCAL_INV_ALPHA
 0x0040

	)

674 
	#V4L2_FBUF_CAP_SRC_CHROMAKEY
 0x0080

	)

676 
	#V4L2_FBUF_FLAG_PRIMARY
 0x0001

	)

677 
	#V4L2_FBUF_FLAG_OVERLAY
 0x0002

	)

678 
	#V4L2_FBUF_FLAG_CHROMAKEY
 0x0004

	)

679 
	#V4L2_FBUF_FLAG_LOCAL_ALPHA
 0x0008

	)

680 
	#V4L2_FBUF_FLAG_GLOBAL_ALPHA
 0x0010

	)

681 
	#V4L2_FBUF_FLAG_LOCAL_INV_ALPHA
 0x0020

	)

682 
	#V4L2_FBUF_FLAG_SRC_CHROMAKEY
 0x0040

	)

684 
	sv4l2_˛ù
 {

685 
v4l2_ª˘
 
	mc
;

686 
v4l2_˛ù
 *
	m√xt
;

689 
	sv4l2_wödow
 {

690 
v4l2_ª˘
 
	mw
;

691 
v4l2_fõld
 
	mfõld
;

692 
__u32
 
	mchromakey
;

693 
v4l2_˛ù
 *
	m˛ùs
;

694 
__u32
 
	m˛ùcou¡
;

695 *
	mbôm≠
;

696 
__u8
 
	mglobÆ_Æpha
;

702 
	sv4l2_ˇ±uª∑rm
 {

703 
__u32
 
	mˇ∑bûôy
;

704 
__u32
 
	mˇ±uªmode
;

705 
v4l2_‰a˘
 
	mtimïî‰ame
;

706 
__u32
 
	mexãndedmode
;

707 
__u32
 
	mªadbuf„rs
;

708 
__u32
 
	mª£rved
[4];

712 
	#V4L2_MODE_HIGHQUALITY
 0x0001

	)

713 
	#V4L2_CAP_TIMEPERFRAME
 0x1000

	)

715 
	sv4l2_ouçuç¨m
 {

716 
__u32
 
	mˇ∑bûôy
;

717 
__u32
 
	mouçutmode
;

718 
v4l2_‰a˘
 
	mtimïî‰ame
;

719 
__u32
 
	mexãndedmode
;

720 
__u32
 
	mwrôebuf„rs
;

721 
__u32
 
	mª£rved
[4];

727 
	sv4l2_¸›ˇp
 {

728 
v4l2_buf_ty≥
 
	mty≥
;

729 
v4l2_ª˘
 
	mbounds
;

730 
v4l2_ª˘
 
	mde‰e˘
;

731 
v4l2_‰a˘
 
	mpixña•e˘
;

734 
	sv4l2_¸›
 {

735 
v4l2_buf_ty≥
 
	mty≥
;

736 
v4l2_ª˘
 
	mc
;

743 
__u64
 
	tv4l2_°d_id
;

746 
	#V4L2_STD_PAL_B
 ((
v4l2_°d_id
)0x00000001)

	)

747 
	#V4L2_STD_PAL_B1
 ((
v4l2_°d_id
)0x00000002)

	)

748 
	#V4L2_STD_PAL_G
 ((
v4l2_°d_id
)0x00000004)

	)

749 
	#V4L2_STD_PAL_H
 ((
v4l2_°d_id
)0x00000008)

	)

750 
	#V4L2_STD_PAL_I
 ((
v4l2_°d_id
)0x00000010)

	)

751 
	#V4L2_STD_PAL_D
 ((
v4l2_°d_id
)0x00000020)

	)

752 
	#V4L2_STD_PAL_D1
 ((
v4l2_°d_id
)0x00000040)

	)

753 
	#V4L2_STD_PAL_K
 ((
v4l2_°d_id
)0x00000080)

	)

755 
	#V4L2_STD_PAL_M
 ((
v4l2_°d_id
)0x00000100)

	)

756 
	#V4L2_STD_PAL_N
 ((
v4l2_°d_id
)0x00000200)

	)

757 
	#V4L2_STD_PAL_Nc
 ((
v4l2_°d_id
)0x00000400)

	)

758 
	#V4L2_STD_PAL_60
 ((
v4l2_°d_id
)0x00000800)

	)

760 
	#V4L2_STD_NTSC_M
 ((
v4l2_°d_id
)0x00001000Ë

	)

761 
	#V4L2_STD_NTSC_M_JP
 ((
v4l2_°d_id
)0x00002000Ë

	)

762 
	#V4L2_STD_NTSC_443
 ((
v4l2_°d_id
)0x00004000)

	)

763 
	#V4L2_STD_NTSC_M_KR
 ((
v4l2_°d_id
)0x00008000Ë

	)

765 
	#V4L2_STD_SECAM_B
 ((
v4l2_°d_id
)0x00010000)

	)

766 
	#V4L2_STD_SECAM_D
 ((
v4l2_°d_id
)0x00020000)

	)

767 
	#V4L2_STD_SECAM_G
 ((
v4l2_°d_id
)0x00040000)

	)

768 
	#V4L2_STD_SECAM_H
 ((
v4l2_°d_id
)0x00080000)

	)

769 
	#V4L2_STD_SECAM_K
 ((
v4l2_°d_id
)0x00100000)

	)

770 
	#V4L2_STD_SECAM_K1
 ((
v4l2_°d_id
)0x00200000)

	)

771 
	#V4L2_STD_SECAM_L
 ((
v4l2_°d_id
)0x00400000)

	)

772 
	#V4L2_STD_SECAM_LC
 ((
v4l2_°d_id
)0x00800000)

	)

775 
	#V4L2_STD_ATSC_8_VSB
 ((
v4l2_°d_id
)0x01000000)

	)

776 
	#V4L2_STD_ATSC_16_VSB
 ((
v4l2_°d_id
)0x02000000)

	)

796 
	#V4L2_STD_NTSC
 (
V4L2_STD_NTSC_M
 |\

797 
V4L2_STD_NTSC_M_JP
 |\

798 
V4L2_STD_NTSC_M_KR
)

	)

800 
	#V4L2_STD_SECAM_DK
 (
V4L2_STD_SECAM_D
 |\

801 
V4L2_STD_SECAM_K
 |\

802 
V4L2_STD_SECAM_K1
)

	)

804 
	#V4L2_STD_SECAM
 (
V4L2_STD_SECAM_B
 |\

805 
V4L2_STD_SECAM_G
 |\

806 
V4L2_STD_SECAM_H
 |\

807 
V4L2_STD_SECAM_DK
 |\

808 
V4L2_STD_SECAM_L
 |\

809 
V4L2_STD_SECAM_LC
)

	)

811 
	#V4L2_STD_PAL_BG
 (
V4L2_STD_PAL_B
 |\

812 
V4L2_STD_PAL_B1
 |\

813 
V4L2_STD_PAL_G
)

	)

814 
	#V4L2_STD_PAL_DK
 (
V4L2_STD_PAL_D
 |\

815 
V4L2_STD_PAL_D1
 |\

816 
V4L2_STD_PAL_K
)

	)

822 
	#V4L2_STD_PAL
 (
V4L2_STD_PAL_BG
 |\

823 
V4L2_STD_PAL_DK
 |\

824 
V4L2_STD_PAL_H
 |\

825 
V4L2_STD_PAL_I
)

	)

827 
	#V4L2_STD_B
 (
V4L2_STD_PAL_B
 |\

828 
V4L2_STD_PAL_B1
 |\

829 
V4L2_STD_SECAM_B
)

	)

830 
	#V4L2_STD_G
 (
V4L2_STD_PAL_G
 |\

831 
V4L2_STD_SECAM_G
)

	)

832 
	#V4L2_STD_H
 (
V4L2_STD_PAL_H
 |\

833 
V4L2_STD_SECAM_H
)

	)

834 
	#V4L2_STD_L
 (
V4L2_STD_SECAM_L
 |\

835 
V4L2_STD_SECAM_LC
)

	)

836 
	#V4L2_STD_GH
 (
V4L2_STD_G
 |\

837 
V4L2_STD_H
)

	)

838 
	#V4L2_STD_DK
 (
V4L2_STD_PAL_DK
 |\

839 
V4L2_STD_SECAM_DK
)

	)

840 
	#V4L2_STD_BG
 (
V4L2_STD_B
 |\

841 
V4L2_STD_G
)

	)

842 
	#V4L2_STD_MN
 (
V4L2_STD_PAL_M
 |\

843 
V4L2_STD_PAL_N
 |\

844 
V4L2_STD_PAL_Nc
 |\

845 
V4L2_STD_NTSC
)

	)

848 
	#V4L2_STD_MTS
 (
V4L2_STD_NTSC_M
 |\

849 
V4L2_STD_PAL_M
 |\

850 
V4L2_STD_PAL_N
 |\

851 
V4L2_STD_PAL_Nc
)

	)

854 
	#V4L2_STD_525_60
 (
V4L2_STD_PAL_M
 |\

855 
V4L2_STD_PAL_60
 |\

856 
V4L2_STD_NTSC
 |\

857 
V4L2_STD_NTSC_443
)

	)

859 
	#V4L2_STD_625_50
 (
V4L2_STD_PAL
 |\

860 
V4L2_STD_PAL_N
 |\

861 
V4L2_STD_PAL_Nc
 |\

862 
V4L2_STD_SECAM
)

	)

864 
	#V4L2_STD_ATSC
 (
V4L2_STD_ATSC_8_VSB
 |\

865 
V4L2_STD_ATSC_16_VSB
)

	)

867 
	#V4L2_STD_UNKNOWN
 0

	)

868 
	#V4L2_STD_ALL
 (
V4L2_STD_525_60
 |\

869 
V4L2_STD_625_50
)

	)

871 
	sv4l2_°™d¨d
 {

872 
__u32
 
	mödex
;

873 
v4l2_°d_id
 
	mid
;

874 
__u8
 
	m«me
[24];

875 
v4l2_‰a˘
 
	m‰amïîiod
;

876 
__u32
 
	m‰amñöes
;

877 
__u32
 
	mª£rved
[4];

883 
	sv4l2_dv_¥e£t
 {

884 
__u32
 
	m¥e£t
;

885 
__u32
 
	mª£rved
[4];

891 
	sv4l2_dv_íum_¥e£t
 {

892 
__u32
 
	mödex
;

893 
__u32
 
	m¥e£t
;

894 
__u8
 
	m«me
[32];

895 
__u32
 
	mwidth
;

896 
__u32
 
	mheight
;

897 
__u32
 
	mª£rved
[4];

903 
	#V4L2_DV_INVALID
 0

	)

904 
	#V4L2_DV_480P59_94
 1

	)

905 
	#V4L2_DV_576P50
 2

	)

906 
	#V4L2_DV_720P24
 3

	)

907 
	#V4L2_DV_720P25
 4

	)

908 
	#V4L2_DV_720P30
 5

	)

909 
	#V4L2_DV_720P50
 6

	)

910 
	#V4L2_DV_720P59_94
 7

	)

911 
	#V4L2_DV_720P60
 8

	)

912 
	#V4L2_DV_1080I29_97
 9

	)

913 
	#V4L2_DV_1080I30
 10

	)

914 
	#V4L2_DV_1080I25
 11

	)

915 
	#V4L2_DV_1080I50
 12

	)

916 
	#V4L2_DV_1080I60
 13

	)

917 
	#V4L2_DV_1080P24
 14

	)

918 
	#V4L2_DV_1080P25
 15

	)

919 
	#V4L2_DV_1080P30
 16

	)

920 
	#V4L2_DV_1080P50
 17

	)

921 
	#V4L2_DV_1080P60
 18

	)

928 
	sv4l2_bt_timögs
 {

929 
__u32
 
	mwidth
;

930 
__u32
 
	mheight
;

931 
__u32
 
	möãæa˚d
;

932 
__u32
 
	mpﬁ¨ôõs
;

933 
__u64
 
	mpixñ˛ock
;

934 
__u32
 
	mh‰⁄ç‹ch
;

935 
__u32
 
	mhsync
;

936 
__u32
 
	mhbackp‹ch
;

937 
__u32
 
	mv‰⁄ç‹ch
;

938 
__u32
 
	mvsync
;

939 
__u32
 
	mvbackp‹ch
;

940 
__u32
 
	mû_v‰⁄ç‹ch
;

943 
__u32
 
	mû_vsync
;

946 
__u32
 
	mû_vbackp‹ch
;

949 
__u32
 
	mª£rved
[16];

950 } 
__©åibuã__
 ((
∑cked
));

953 
	#V4L2_DV_PROGRESSIVE
 0

	)

954 
	#V4L2_DV_INTERLACED
 1

	)

957 
	#V4L2_DV_VSYNC_POS_POL
 0x00000001

	)

958 
	#V4L2_DV_HSYNC_POS_POL
 0x00000002

	)

962 
	sv4l2_dv_timögs
 {

963 
__u32
 
	mty≥
;

965 
v4l2_bt_timögs
 
	mbt
;

966 
__u32
 
	mª£rved
[32];

968 } 
__©åibuã__
 ((
∑cked
));

971 
	#V4L2_DV_BT_656_1120
 0

	)

976 
	sv4l2_öput
 {

977 
__u32
 
	mödex
;

978 
__u8
 
	m«me
[32];

979 
__u32
 
	mty≥
;

980 
__u32
 
	maudio£t
;

981 
__u32
 
	mtu√r
;

982 
v4l2_°d_id
 
	m°d
;

983 
__u32
 
	m°©us
;

984 
__u32
 
	mˇ∑bûôõs
;

985 
__u32
 
	mª£rved
[3];

989 
	#V4L2_INPUT_TYPE_TUNER
 1

	)

990 
	#V4L2_INPUT_TYPE_CAMERA
 2

	)

993 
	#V4L2_IN_ST_NO_POWER
 0x00000001

	)

994 
	#V4L2_IN_ST_NO_SIGNAL
 0x00000002

	)

995 
	#V4L2_IN_ST_NO_COLOR
 0x00000004

	)

999 
	#V4L2_IN_ST_HFLIP
 0x00000010

	)

1000 
	#V4L2_IN_ST_VFLIP
 0x00000020

	)

1003 
	#V4L2_IN_ST_NO_H_LOCK
 0x00000100

	)

1004 
	#V4L2_IN_ST_COLOR_KILL
 0x00000200

	)

1007 
	#V4L2_IN_ST_NO_SYNC
 0x00010000

	)

1008 
	#V4L2_IN_ST_NO_EQU
 0x00020000

	)

1009 
	#V4L2_IN_ST_NO_CARRIER
 0x00040000

	)

1012 
	#V4L2_IN_ST_MACROVISION
 0x01000000

	)

1013 
	#V4L2_IN_ST_NO_ACCESS
 0x02000000

	)

1014 
	#V4L2_IN_ST_VTR
 0x04000000

	)

1017 
	#V4L2_IN_CAP_PRESETS
 0x00000001

	)

1018 
	#V4L2_IN_CAP_CUSTOM_TIMINGS
 0x00000002

	)

1019 
	#V4L2_IN_CAP_STD
 0x00000004

	)

1024 
	sv4l2_ouçut
 {

1025 
__u32
 
	mödex
;

1026 
__u8
 
	m«me
[32];

1027 
__u32
 
	mty≥
;

1028 
__u32
 
	maudio£t
;

1029 
__u32
 
	mmoduœt‹
;

1030 
v4l2_°d_id
 
	m°d
;

1031 
__u32
 
	mˇ∑bûôõs
;

1032 
__u32
 
	mª£rved
[3];

1035 
	#V4L2_OUTPUT_TYPE_MODULATOR
 1

	)

1036 
	#V4L2_OUTPUT_TYPE_ANALOG
 2

	)

1037 
	#V4L2_OUTPUT_TYPE_ANALOGVGAOVERLAY
 3

	)

1040 
	#V4L2_OUT_CAP_PRESETS
 0x00000001

	)

1041 
	#V4L2_OUT_CAP_CUSTOM_TIMINGS
 0x00000002

	)

1042 
	#V4L2_OUT_CAP_STD
 0x00000004

	)

1047 
	sv4l2_c⁄åﬁ
 {

1048 
__u32
 
	mid
;

1049 
__s32
 
	mvÆue
;

1052 
	sv4l2_ext_c⁄åﬁ
 {

1053 
__u32
 
	mid
;

1054 
__u32
 
	msize
;

1055 
__u32
 
	mª£rved2
[1];

1057 
__s32
 
	mvÆue
;

1058 
__s64
 
	mvÆue64
;

1059 *
	m°rög
;

1061 } 
__©åibuã__
 ((
∑cked
));

1063 
	sv4l2_ext_c⁄åﬁs
 {

1064 
__u32
 
	m˘æ_˛ass
;

1065 
__u32
 
	mcou¡
;

1066 
__u32
 
	mîr‹_idx
;

1067 
__u32
 
	mª£rved
[2];

1068 
v4l2_ext_c⁄åﬁ
 *
	mc⁄åﬁs
;

1072 
	#V4L2_CTRL_CLASS_USER
 0x00980000

	)

1073 
	#V4L2_CTRL_CLASS_MPEG
 0x00990000

	)

1074 
	#V4L2_CTRL_CLASS_CAMERA
 0x009a0000

	)

1075 
	#V4L2_CTRL_CLASS_FM_TX
 0x009b0000

	)

1076 
	#V4L2_CTRL_CLASS_FLASH
 0x009c0000

	)

1078 
	#V4L2_CTRL_ID_MASK
 (0x0fffffff)

	)

1079 
	#V4L2_CTRL_ID2CLASS
(
id
Ë((idË& 0x0fff0000UL)

	)

1080 
	#V4L2_CTRL_DRIVER_PRIV
(
id
Ë(((idË& 0xffffË>0x1000)

	)

1082 
	ev4l2_˘æ_ty≥
 {

1083 
	mV4L2_CTRL_TYPE_INTEGER
 = 1,

1084 
	mV4L2_CTRL_TYPE_BOOLEAN
 = 2,

1085 
	mV4L2_CTRL_TYPE_MENU
 = 3,

1086 
	mV4L2_CTRL_TYPE_BUTTON
 = 4,

1087 
	mV4L2_CTRL_TYPE_INTEGER64
 = 5,

1088 
	mV4L2_CTRL_TYPE_CTRL_CLASS
 = 6,

1089 
	mV4L2_CTRL_TYPE_STRING
 = 7,

1090 
	mV4L2_CTRL_TYPE_BITMASK
 = 8,

1094 
	sv4l2_quîy˘æ
 {

1095 
__u32
 
	mid
;

1096 
v4l2_˘æ_ty≥
 
	mty≥
;

1097 
__u8
 
	m«me
[32];

1098 
__s32
 
	mmöimum
;

1099 
__s32
 
	mmaximum
;

1100 
__s32
 
	m°ï
;

1101 
__s32
 
	mdeÁu…_vÆue
;

1102 
__u32
 
	mÊags
;

1103 
__u32
 
	mª£rved
[2];

1107 
	sv4l2_quîymíu
 {

1108 
__u32
 
	mid
;

1109 
__u32
 
	mödex
;

1110 
__u8
 
	m«me
[32];

1111 
__u32
 
	mª£rved
;

1115 
	#V4L2_CTRL_FLAG_DISABLED
 0x0001

	)

1116 
	#V4L2_CTRL_FLAG_GRABBED
 0x0002

	)

1117 
	#V4L2_CTRL_FLAG_READ_ONLY
 0x0004

	)

1118 
	#V4L2_CTRL_FLAG_UPDATE
 0x0008

	)

1119 
	#V4L2_CTRL_FLAG_INACTIVE
 0x0010

	)

1120 
	#V4L2_CTRL_FLAG_SLIDER
 0x0020

	)

1121 
	#V4L2_CTRL_FLAG_WRITE_ONLY
 0x0040

	)

1122 
	#V4L2_CTRL_FLAG_VOLATILE
 0x0080

	)

1125 
	#V4L2_CTRL_FLAG_NEXT_CTRL
 0x80000000

	)

1128 
	#V4L2_CID_MAX_CTRLS
 1024

	)

1129 
	#V4L2_CID_BASE
 (
V4L2_CTRL_CLASS_USER
 | 0x900)

	)

1130 
	#V4L2_CID_USER_BASE
 
V4L2_CID_BASE


	)

1132 
	#V4L2_CID_PRIVATE_BASE
 0x08000000

	)

1134 
	#V4L2_CID_USER_CLASS
 (
V4L2_CTRL_CLASS_USER
 | 1)

	)

1135 
	#V4L2_CID_BRIGHTNESS
 (
V4L2_CID_BASE
+0)

	)

1136 
	#V4L2_CID_CONTRAST
 (
V4L2_CID_BASE
+1)

	)

1137 
	#V4L2_CID_SATURATION
 (
V4L2_CID_BASE
+2)

	)

1138 
	#V4L2_CID_HUE
 (
V4L2_CID_BASE
+3)

	)

1139 
	#V4L2_CID_AUDIO_VOLUME
 (
V4L2_CID_BASE
+5)

	)

1140 
	#V4L2_CID_AUDIO_BALANCE
 (
V4L2_CID_BASE
+6)

	)

1141 
	#V4L2_CID_AUDIO_BASS
 (
V4L2_CID_BASE
+7)

	)

1142 
	#V4L2_CID_AUDIO_TREBLE
 (
V4L2_CID_BASE
+8)

	)

1143 
	#V4L2_CID_AUDIO_MUTE
 (
V4L2_CID_BASE
+9)

	)

1144 
	#V4L2_CID_AUDIO_LOUDNESS
 (
V4L2_CID_BASE
+10)

	)

1145 
	#V4L2_CID_BLACK_LEVEL
 (
V4L2_CID_BASE
+11Ë

	)

1146 
	#V4L2_CID_AUTO_WHITE_BALANCE
 (
V4L2_CID_BASE
+12)

	)

1147 
	#V4L2_CID_DO_WHITE_BALANCE
 (
V4L2_CID_BASE
+13)

	)

1148 
	#V4L2_CID_RED_BALANCE
 (
V4L2_CID_BASE
+14)

	)

1149 
	#V4L2_CID_BLUE_BALANCE
 (
V4L2_CID_BASE
+15)

	)

1150 
	#V4L2_CID_GAMMA
 (
V4L2_CID_BASE
+16)

	)

1151 
	#V4L2_CID_WHITENESS
 (
V4L2_CID_GAMMA
Ë

	)

1152 
	#V4L2_CID_EXPOSURE
 (
V4L2_CID_BASE
+17)

	)

1153 
	#V4L2_CID_AUTOGAIN
 (
V4L2_CID_BASE
+18)

	)

1154 
	#V4L2_CID_GAIN
 (
V4L2_CID_BASE
+19)

	)

1155 
	#V4L2_CID_HFLIP
 (
V4L2_CID_BASE
+20)

	)

1156 
	#V4L2_CID_VFLIP
 (
V4L2_CID_BASE
+21)

	)

1159 
	#V4L2_CID_HCENTER
 (
V4L2_CID_BASE
+22)

	)

1160 
	#V4L2_CID_VCENTER
 (
V4L2_CID_BASE
+23)

	)

1162 
	#V4L2_CID_POWER_LINE_FREQUENCY
 (
V4L2_CID_BASE
+24)

	)

1163 
	ev4l2_powî_löe_‰equícy
 {

1164 
	mV4L2_CID_POWER_LINE_FREQUENCY_DISABLED
 = 0,

1165 
	mV4L2_CID_POWER_LINE_FREQUENCY_50HZ
 = 1,

1166 
	mV4L2_CID_POWER_LINE_FREQUENCY_60HZ
 = 2,

1167 
	mV4L2_CID_POWER_LINE_FREQUENCY_AUTO
 = 3,

1169 
	#V4L2_CID_HUE_AUTO
 (
V4L2_CID_BASE
+25)

	)

1170 
	#V4L2_CID_WHITE_BALANCE_TEMPERATURE
 (
V4L2_CID_BASE
+26)

	)

1171 
	#V4L2_CID_SHARPNESS
 (
V4L2_CID_BASE
+27)

	)

1172 
	#V4L2_CID_BACKLIGHT_COMPENSATION
 (
V4L2_CID_BASE
+28)

	)

1173 
	#V4L2_CID_CHROMA_AGC
 (
V4L2_CID_BASE
+29)

	)

1174 
	#V4L2_CID_COLOR_KILLER
 (
V4L2_CID_BASE
+30)

	)

1175 
	#V4L2_CID_COLORFX
 (
V4L2_CID_BASE
+31)

	)

1176 
	ev4l2_cﬁ‹fx
 {

1177 
	mV4L2_COLORFX_NONE
 = 0,

1178 
	mV4L2_COLORFX_BW
 = 1,

1179 
	mV4L2_COLORFX_SEPIA
 = 2,

1180 
	mV4L2_COLORFX_NEGATIVE
 = 3,

1181 
	mV4L2_COLORFX_EMBOSS
 = 4,

1182 
	mV4L2_COLORFX_SKETCH
 = 5,

1183 
	mV4L2_COLORFX_SKY_BLUE
 = 6,

1184 
	mV4L2_COLORFX_GRASS_GREEN
 = 7,

1185 
	mV4L2_COLORFX_SKIN_WHITEN
 = 8,

1186 
	mV4L2_COLORFX_VIVID
 = 9,

1188 
	#V4L2_CID_AUTOBRIGHTNESS
 (
V4L2_CID_BASE
+32)

	)

1189 
	#V4L2_CID_BAND_STOP_FILTER
 (
V4L2_CID_BASE
+33)

	)

1191 
	#V4L2_CID_ROTATE
 (
V4L2_CID_BASE
+34)

	)

1192 
	#V4L2_CID_BG_COLOR
 (
V4L2_CID_BASE
+35)

	)

1194 
	#V4L2_CID_CHROMA_GAIN
 (
V4L2_CID_BASE
+36)

	)

1196 
	#V4L2_CID_ILLUMINATORS_1
 (
V4L2_CID_BASE
+37)

	)

1197 
	#V4L2_CID_ILLUMINATORS_2
 (
V4L2_CID_BASE
+38)

	)

1199 
	#V4L2_CID_MIN_BUFFERS_FOR_CAPTURE
 (
V4L2_CID_BASE
+39)

	)

1200 
	#V4L2_CID_MIN_BUFFERS_FOR_OUTPUT
 (
V4L2_CID_BASE
+40)

	)

1203 
	#V4L2_CID_LASTP1
 (
V4L2_CID_BASE
+41)

	)

1208 
	#V4L2_CID_MPEG_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x900)

	)

1209 
	#V4L2_CID_MPEG_CLASS
 (
V4L2_CTRL_CLASS_MPEG
 | 1)

	)

1212 
	#V4L2_CID_MPEG_STREAM_TYPE
 (
V4L2_CID_MPEG_BASE
+0)

	)

1213 
	ev4l2_m≥g_°ªam_ty≥
 {

1214 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_PS
 = 0,

1215 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_TS
 = 1,

1216 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_SS
 = 2,

1217 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_DVD
 = 3,

1218 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_VCD
 = 4,

1219 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_SVCD
 = 5,

1221 
	#V4L2_CID_MPEG_STREAM_PID_PMT
 (
V4L2_CID_MPEG_BASE
+1)

	)

1222 
	#V4L2_CID_MPEG_STREAM_PID_AUDIO
 (
V4L2_CID_MPEG_BASE
+2)

	)

1223 
	#V4L2_CID_MPEG_STREAM_PID_VIDEO
 (
V4L2_CID_MPEG_BASE
+3)

	)

1224 
	#V4L2_CID_MPEG_STREAM_PID_PCR
 (
V4L2_CID_MPEG_BASE
+4)

	)

1225 
	#V4L2_CID_MPEG_STREAM_PES_ID_AUDIO
 (
V4L2_CID_MPEG_BASE
+5)

	)

1226 
	#V4L2_CID_MPEG_STREAM_PES_ID_VIDEO
 (
V4L2_CID_MPEG_BASE
+6)

	)

1227 
	#V4L2_CID_MPEG_STREAM_VBI_FMT
 (
V4L2_CID_MPEG_BASE
+7)

	)

1228 
	ev4l2_m≥g_°ªam_vbi_fmt
 {

1229 
	mV4L2_MPEG_STREAM_VBI_FMT_NONE
 = 0,

1230 
	mV4L2_MPEG_STREAM_VBI_FMT_IVTV
 = 1,

1234 
	#V4L2_CID_MPEG_AUDIO_SAMPLING_FREQ
 (
V4L2_CID_MPEG_BASE
+100)

	)

1235 
	ev4l2_m≥g_audio_ßm∂ög_‰eq
 {

1236 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_44100
 = 0,

1237 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_48000
 = 1,

1238 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_32000
 = 2,

1240 
	#V4L2_CID_MPEG_AUDIO_ENCODING
 (
V4L2_CID_MPEG_BASE
+101)

	)

1241 
	ev4l2_m≥g_audio_ícodög
 {

1242 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_1
 = 0,

1243 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_2
 = 1,

1244 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_3
 = 2,

1245 
	mV4L2_MPEG_AUDIO_ENCODING_AAC
 = 3,

1246 
	mV4L2_MPEG_AUDIO_ENCODING_AC3
 = 4,

1248 
	#V4L2_CID_MPEG_AUDIO_L1_BITRATE
 (
V4L2_CID_MPEG_BASE
+102)

	)

1249 
	ev4l2_m≥g_audio_l1_bôøã
 {

1250 
	mV4L2_MPEG_AUDIO_L1_BITRATE_32K
 = 0,

1251 
	mV4L2_MPEG_AUDIO_L1_BITRATE_64K
 = 1,

1252 
	mV4L2_MPEG_AUDIO_L1_BITRATE_96K
 = 2,

1253 
	mV4L2_MPEG_AUDIO_L1_BITRATE_128K
 = 3,

1254 
	mV4L2_MPEG_AUDIO_L1_BITRATE_160K
 = 4,

1255 
	mV4L2_MPEG_AUDIO_L1_BITRATE_192K
 = 5,

1256 
	mV4L2_MPEG_AUDIO_L1_BITRATE_224K
 = 6,

1257 
	mV4L2_MPEG_AUDIO_L1_BITRATE_256K
 = 7,

1258 
	mV4L2_MPEG_AUDIO_L1_BITRATE_288K
 = 8,

1259 
	mV4L2_MPEG_AUDIO_L1_BITRATE_320K
 = 9,

1260 
	mV4L2_MPEG_AUDIO_L1_BITRATE_352K
 = 10,

1261 
	mV4L2_MPEG_AUDIO_L1_BITRATE_384K
 = 11,

1262 
	mV4L2_MPEG_AUDIO_L1_BITRATE_416K
 = 12,

1263 
	mV4L2_MPEG_AUDIO_L1_BITRATE_448K
 = 13,

1265 
	#V4L2_CID_MPEG_AUDIO_L2_BITRATE
 (
V4L2_CID_MPEG_BASE
+103)

	)

1266 
	ev4l2_m≥g_audio_l2_bôøã
 {

1267 
	mV4L2_MPEG_AUDIO_L2_BITRATE_32K
 = 0,

1268 
	mV4L2_MPEG_AUDIO_L2_BITRATE_48K
 = 1,

1269 
	mV4L2_MPEG_AUDIO_L2_BITRATE_56K
 = 2,

1270 
	mV4L2_MPEG_AUDIO_L2_BITRATE_64K
 = 3,

1271 
	mV4L2_MPEG_AUDIO_L2_BITRATE_80K
 = 4,

1272 
	mV4L2_MPEG_AUDIO_L2_BITRATE_96K
 = 5,

1273 
	mV4L2_MPEG_AUDIO_L2_BITRATE_112K
 = 6,

1274 
	mV4L2_MPEG_AUDIO_L2_BITRATE_128K
 = 7,

1275 
	mV4L2_MPEG_AUDIO_L2_BITRATE_160K
 = 8,

1276 
	mV4L2_MPEG_AUDIO_L2_BITRATE_192K
 = 9,

1277 
	mV4L2_MPEG_AUDIO_L2_BITRATE_224K
 = 10,

1278 
	mV4L2_MPEG_AUDIO_L2_BITRATE_256K
 = 11,

1279 
	mV4L2_MPEG_AUDIO_L2_BITRATE_320K
 = 12,

1280 
	mV4L2_MPEG_AUDIO_L2_BITRATE_384K
 = 13,

1282 
	#V4L2_CID_MPEG_AUDIO_L3_BITRATE
 (
V4L2_CID_MPEG_BASE
+104)

	)

1283 
	ev4l2_m≥g_audio_l3_bôøã
 {

1284 
	mV4L2_MPEG_AUDIO_L3_BITRATE_32K
 = 0,

1285 
	mV4L2_MPEG_AUDIO_L3_BITRATE_40K
 = 1,

1286 
	mV4L2_MPEG_AUDIO_L3_BITRATE_48K
 = 2,

1287 
	mV4L2_MPEG_AUDIO_L3_BITRATE_56K
 = 3,

1288 
	mV4L2_MPEG_AUDIO_L3_BITRATE_64K
 = 4,

1289 
	mV4L2_MPEG_AUDIO_L3_BITRATE_80K
 = 5,

1290 
	mV4L2_MPEG_AUDIO_L3_BITRATE_96K
 = 6,

1291 
	mV4L2_MPEG_AUDIO_L3_BITRATE_112K
 = 7,

1292 
	mV4L2_MPEG_AUDIO_L3_BITRATE_128K
 = 8,

1293 
	mV4L2_MPEG_AUDIO_L3_BITRATE_160K
 = 9,

1294 
	mV4L2_MPEG_AUDIO_L3_BITRATE_192K
 = 10,

1295 
	mV4L2_MPEG_AUDIO_L3_BITRATE_224K
 = 11,

1296 
	mV4L2_MPEG_AUDIO_L3_BITRATE_256K
 = 12,

1297 
	mV4L2_MPEG_AUDIO_L3_BITRATE_320K
 = 13,

1299 
	#V4L2_CID_MPEG_AUDIO_MODE
 (
V4L2_CID_MPEG_BASE
+105)

	)

1300 
	ev4l2_m≥g_audio_mode
 {

1301 
	mV4L2_MPEG_AUDIO_MODE_STEREO
 = 0,

1302 
	mV4L2_MPEG_AUDIO_MODE_JOINT_STEREO
 = 1,

1303 
	mV4L2_MPEG_AUDIO_MODE_DUAL
 = 2,

1304 
	mV4L2_MPEG_AUDIO_MODE_MONO
 = 3,

1306 
	#V4L2_CID_MPEG_AUDIO_MODE_EXTENSION
 (
V4L2_CID_MPEG_BASE
+106)

	)

1307 
	ev4l2_m≥g_audio_mode_exãnsi⁄
 {

1308 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_4
 = 0,

1309 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_8
 = 1,

1310 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_12
 = 2,

1311 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_16
 = 3,

1313 
	#V4L2_CID_MPEG_AUDIO_EMPHASIS
 (
V4L2_CID_MPEG_BASE
+107)

	)

1314 
	ev4l2_m≥g_audio_emphasis
 {

1315 
	mV4L2_MPEG_AUDIO_EMPHASIS_NONE
 = 0,

1316 
	mV4L2_MPEG_AUDIO_EMPHASIS_50_DIV_15_uS
 = 1,

1317 
	mV4L2_MPEG_AUDIO_EMPHASIS_CCITT_J17
 = 2,

1319 
	#V4L2_CID_MPEG_AUDIO_CRC
 (
V4L2_CID_MPEG_BASE
+108)

	)

1320 
	ev4l2_m≥g_audio_¸c
 {

1321 
	mV4L2_MPEG_AUDIO_CRC_NONE
 = 0,

1322 
	mV4L2_MPEG_AUDIO_CRC_CRC16
 = 1,

1324 
	#V4L2_CID_MPEG_AUDIO_MUTE
 (
V4L2_CID_MPEG_BASE
+109)

	)

1325 
	#V4L2_CID_MPEG_AUDIO_AAC_BITRATE
 (
V4L2_CID_MPEG_BASE
+110)

	)

1326 
	#V4L2_CID_MPEG_AUDIO_AC3_BITRATE
 (
V4L2_CID_MPEG_BASE
+111)

	)

1327 
	ev4l2_m≥g_audio_ac3_bôøã
 {

1328 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_32K
 = 0,

1329 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_40K
 = 1,

1330 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_48K
 = 2,

1331 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_56K
 = 3,

1332 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_64K
 = 4,

1333 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_80K
 = 5,

1334 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_96K
 = 6,

1335 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_112K
 = 7,

1336 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_128K
 = 8,

1337 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_160K
 = 9,

1338 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_192K
 = 10,

1339 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_224K
 = 11,

1340 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_256K
 = 12,

1341 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_320K
 = 13,

1342 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_384K
 = 14,

1343 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_448K
 = 15,

1344 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_512K
 = 16,

1345 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_576K
 = 17,

1346 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_640K
 = 18,

1350 
	#V4L2_CID_MPEG_VIDEO_ENCODING
 (
V4L2_CID_MPEG_BASE
+200)

	)

1351 
	ev4l2_m≥g_video_ícodög
 {

1352 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_1
 = 0,

1353 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_2
 = 1,

1354 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_4_AVC
 = 2,

1356 
	#V4L2_CID_MPEG_VIDEO_ASPECT
 (
V4L2_CID_MPEG_BASE
+201)

	)

1357 
	ev4l2_m≥g_video_a•e˘
 {

1358 
	mV4L2_MPEG_VIDEO_ASPECT_1x1
 = 0,

1359 
	mV4L2_MPEG_VIDEO_ASPECT_4x3
 = 1,

1360 
	mV4L2_MPEG_VIDEO_ASPECT_16x9
 = 2,

1361 
	mV4L2_MPEG_VIDEO_ASPECT_221x100
 = 3,

1363 
	#V4L2_CID_MPEG_VIDEO_B_FRAMES
 (
V4L2_CID_MPEG_BASE
+202)

	)

1364 
	#V4L2_CID_MPEG_VIDEO_GOP_SIZE
 (
V4L2_CID_MPEG_BASE
+203)

	)

1365 
	#V4L2_CID_MPEG_VIDEO_GOP_CLOSURE
 (
V4L2_CID_MPEG_BASE
+204)

	)

1366 
	#V4L2_CID_MPEG_VIDEO_PULLDOWN
 (
V4L2_CID_MPEG_BASE
+205)

	)

1367 
	#V4L2_CID_MPEG_VIDEO_BITRATE_MODE
 (
V4L2_CID_MPEG_BASE
+206)

	)

1368 
	ev4l2_m≥g_video_bôøã_mode
 {

1369 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_VBR
 = 0,

1370 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_CBR
 = 1,

1372 
	#V4L2_CID_MPEG_VIDEO_BITRATE
 (
V4L2_CID_MPEG_BASE
+207)

	)

1373 
	#V4L2_CID_MPEG_VIDEO_BITRATE_PEAK
 (
V4L2_CID_MPEG_BASE
+208)

	)

1374 
	#V4L2_CID_MPEG_VIDEO_TEMPORAL_DECIMATION
 (
V4L2_CID_MPEG_BASE
+209)

	)

1375 
	#V4L2_CID_MPEG_VIDEO_MUTE
 (
V4L2_CID_MPEG_BASE
+210)

	)

1376 
	#V4L2_CID_MPEG_VIDEO_MUTE_YUV
 (
V4L2_CID_MPEG_BASE
+211)

	)

1377 
	#V4L2_CID_MPEG_VIDEO_DECODER_SLICE_INTERFACE
 (
V4L2_CID_MPEG_BASE
+212)

	)

1378 
	#V4L2_CID_MPEG_VIDEO_DECODER_MPEG4_DEBLOCK_FILTER
 (
V4L2_CID_MPEG_BASE
+213)

	)

1379 
	#V4L2_CID_MPEG_VIDEO_CYCLIC_INTRA_REFRESH_MB
 (
V4L2_CID_MPEG_BASE
+214)

	)

1380 
	#V4L2_CID_MPEG_VIDEO_FRAME_RC_ENABLE
 (
V4L2_CID_MPEG_BASE
+215)

	)

1381 
	#V4L2_CID_MPEG_VIDEO_HEADER_MODE
 (
V4L2_CID_MPEG_BASE
+216)

	)

1382 
	ev4l2_m≥g_video_hódî_mode
 {

1383 
	mV4L2_MPEG_VIDEO_HEADER_MODE_SEPARATE
 = 0,

1384 
	mV4L2_MPEG_VIDEO_HEADER_MODE_JOINED_WITH_1ST_FRAME
 = 1,

1387 
	#V4L2_CID_MPEG_VIDEO_MAX_REF_PIC
 (
V4L2_CID_MPEG_BASE
+217)

	)

1388 
	#V4L2_CID_MPEG_VIDEO_MB_RC_ENABLE
 (
V4L2_CID_MPEG_BASE
+218)

	)

1389 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MAX_BYTES
 (
V4L2_CID_MPEG_BASE
+219)

	)

1390 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MAX_MB
 (
V4L2_CID_MPEG_BASE
+220)

	)

1391 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MODE
 (
V4L2_CID_MPEG_BASE
+221)

	)

1392 
	ev4l2_m≥g_video_mu…i_¶i˚_mode
 {

1393 
	mV4L2_MPEG_VIDEO_MULTI_SLICE_MODE_SINGLE
 = 0,

1394 
	mV4L2_MPEG_VIDEO_MULTI_SICE_MODE_MAX_MB
 = 1,

1395 
	mV4L2_MPEG_VIDEO_MULTI_SICE_MODE_MAX_BYTES
 = 2,

1397 
	#V4L2_CID_MPEG_VIDEO_VBV_SIZE
 (
V4L2_CID_MPEG_BASE
+222)

	)

1398 
	#V4L2_CID_MPEG_VIDEO_H263_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+300)

	)

1399 
	#V4L2_CID_MPEG_VIDEO_H263_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+301)

	)

1400 
	#V4L2_CID_MPEG_VIDEO_H263_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+302)

	)

1401 
	#V4L2_CID_MPEG_VIDEO_H263_MIN_QP
 (
V4L2_CID_MPEG_BASE
+303)

	)

1402 
	#V4L2_CID_MPEG_VIDEO_H263_MAX_QP
 (
V4L2_CID_MPEG_BASE
+304)

	)

1403 
	#V4L2_CID_MPEG_VIDEO_H264_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+350)

	)

1404 
	#V4L2_CID_MPEG_VIDEO_H264_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+351)

	)

1405 
	#V4L2_CID_MPEG_VIDEO_H264_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+352)

	)

1406 
	#V4L2_CID_MPEG_VIDEO_H264_MIN_QP
 (
V4L2_CID_MPEG_BASE
+353)

	)

1407 
	#V4L2_CID_MPEG_VIDEO_H264_MAX_QP
 (
V4L2_CID_MPEG_BASE
+354)

	)

1408 
	#V4L2_CID_MPEG_VIDEO_H264_8X8_TRANSFORM
 (
V4L2_CID_MPEG_BASE
+355)

	)

1409 
	#V4L2_CID_MPEG_VIDEO_H264_CPB_SIZE
 (
V4L2_CID_MPEG_BASE
+356)

	)

1410 
	#V4L2_CID_MPEG_VIDEO_H264_ENTROPY_MODE
 (
V4L2_CID_MPEG_BASE
+357)

	)

1411 
	ev4l2_m≥g_video_h264_íå›y_mode
 {

1412 
	mV4L2_MPEG_VIDEO_H264_ENTROPY_MODE_CAVLC
 = 0,

1413 
	mV4L2_MPEG_VIDEO_H264_ENTROPY_MODE_CABAC
 = 1,

1415 
	#V4L2_CID_MPEG_VIDEO_H264_I_PERIOD
 (
V4L2_CID_MPEG_BASE
+358)

	)

1416 
	#V4L2_CID_MPEG_VIDEO_H264_LEVEL
 (
V4L2_CID_MPEG_BASE
+359)

	)

1417 
	ev4l2_m≥g_video_h264_Àvñ
 {

1418 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_0
 = 0,

1419 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1B
 = 1,

1420 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_1
 = 2,

1421 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_2
 = 3,

1422 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_3
 = 4,

1423 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_0
 = 5,

1424 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_1
 = 6,

1425 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_2
 = 7,

1426 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_0
 = 8,

1427 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_1
 = 9,

1428 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_2
 = 10,

1429 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_0
 = 11,

1430 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_1
 = 12,

1431 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_2
 = 13,

1432 
	mV4L2_MPEG_VIDEO_H264_LEVEL_5_0
 = 14,

1433 
	mV4L2_MPEG_VIDEO_H264_LEVEL_5_1
 = 15,

1435 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_ALPHA
 (
V4L2_CID_MPEG_BASE
+360)

	)

1436 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_BETA
 (
V4L2_CID_MPEG_BASE
+361)

	)

1437 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_MODE
 (
V4L2_CID_MPEG_BASE
+362)

	)

1438 
	ev4l2_m≥g_video_h264_lo›_fûãr_mode
 {

1439 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_ENABLED
 = 0,

1440 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_DISABLED
 = 1,

1441 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_DISABLED_AT_SLICE_BOUNDARY
 = 2,

1443 
	#V4L2_CID_MPEG_VIDEO_H264_PROFILE
 (
V4L2_CID_MPEG_BASE
+363)

	)

1444 
	ev4l2_m≥g_video_h264_¥ofûe
 {

1445 
	mV4L2_MPEG_VIDEO_H264_PROFILE_BASELINE
 = 0,

1446 
	mV4L2_MPEG_VIDEO_H264_PROFILE_CONSTRAINED_BASELINE
 = 1,

1447 
	mV4L2_MPEG_VIDEO_H264_PROFILE_MAIN
 = 2,

1448 
	mV4L2_MPEG_VIDEO_H264_PROFILE_EXTENDED
 = 3,

1449 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH
 = 4,

1450 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_10
 = 5,

1451 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_422
 = 6,

1452 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_444_PREDICTIVE
 = 7,

1453 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_10_INTRA
 = 8,

1454 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_422_INTRA
 = 9,

1455 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_444_INTRA
 = 10,

1456 
	mV4L2_MPEG_VIDEO_H264_PROFILE_CAVLC_444_INTRA
 = 11,

1457 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_BASELINE
 = 12,

1458 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_HIGH
 = 13,

1459 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_HIGH_INTRA
 = 14,

1460 
	mV4L2_MPEG_VIDEO_H264_PROFILE_STEREO_HIGH
 = 15,

1461 
	mV4L2_MPEG_VIDEO_H264_PROFILE_MULTIVIEW_HIGH
 = 16,

1463 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_EXT_SAR_HEIGHT
 (
V4L2_CID_MPEG_BASE
+364)

	)

1464 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_EXT_SAR_WIDTH
 (
V4L2_CID_MPEG_BASE
+365)

	)

1465 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_SAR_ENABLE
 (
V4L2_CID_MPEG_BASE
+366)

	)

1466 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_SAR_IDC
 (
V4L2_CID_MPEG_BASE
+367)

	)

1467 
	ev4l2_m≥g_video_h264_vui_ßr_idc
 {

1468 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_UNSPECIFIED
 = 0,

1469 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_1x1
 = 1,

1470 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_12x11
 = 2,

1471 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_10x11
 = 3,

1472 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_16x11
 = 4,

1473 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_40x33
 = 5,

1474 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_24x11
 = 6,

1475 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_20x11
 = 7,

1476 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_32x11
 = 8,

1477 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_80x33
 = 9,

1478 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_18x11
 = 10,

1479 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_15x11
 = 11,

1480 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_64x33
 = 12,

1481 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_160x99
 = 13,

1482 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_4x3
 = 14,

1483 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_3x2
 = 15,

1484 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_2x1
 = 16,

1485 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_EXTENDED
 = 17,

1487 
	#V4L2_CID_MPEG_VIDEO_MPEG4_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+400)

	)

1488 
	#V4L2_CID_MPEG_VIDEO_MPEG4_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+401)

	)

1489 
	#V4L2_CID_MPEG_VIDEO_MPEG4_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+402)

	)

1490 
	#V4L2_CID_MPEG_VIDEO_MPEG4_MIN_QP
 (
V4L2_CID_MPEG_BASE
+403)

	)

1491 
	#V4L2_CID_MPEG_VIDEO_MPEG4_MAX_QP
 (
V4L2_CID_MPEG_BASE
+404)

	)

1492 
	#V4L2_CID_MPEG_VIDEO_MPEG4_LEVEL
 (
V4L2_CID_MPEG_BASE
+405)

	)

1493 
	ev4l2_m≥g_video_m≥g4_Àvñ
 {

1494 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_0
 = 0,

1495 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_0B
 = 1,

1496 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_1
 = 2,

1497 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_2
 = 3,

1498 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_3
 = 4,

1499 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_3B
 = 5,

1500 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_4
 = 6,

1501 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_5
 = 7,

1503 
	#V4L2_CID_MPEG_VIDEO_MPEG4_PROFILE
 (
V4L2_CID_MPEG_BASE
+406)

	)

1504 
	ev4l2_m≥g_video_m≥g4_¥ofûe
 {

1505 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE
 = 0,

1506 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_SIMPLE
 = 1,

1507 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_CORE
 = 2,

1508 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE_SCALABLE
 = 3,

1509 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_CODING_EFFICIENCY
 = 4,

1511 
	#V4L2_CID_MPEG_VIDEO_MPEG4_QPEL
 (
V4L2_CID_MPEG_BASE
+407)

	)

1514 
	#V4L2_CID_MPEG_CX2341X_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x1000)

	)

1515 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+0)

	)

1516 
	ev4l2_m≥g_cx2341x_video_•©ül_fûãr_mode
 {

1517 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_MANUAL
 = 0,

1518 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_AUTO
 = 1,

1520 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+1)

	)

1521 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+2)

	)

1522 
	ev4l2_m≥g_cx2341x_video_luma_•©ül_fûãr_ty≥
 {

1523 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1524 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1525 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_VERT
 = 2,

1526 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_HV_SEPARABLE
 = 3,

1527 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_SYM_NON_SEPARABLE
 = 4,

1529 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+3)

	)

1530 
	ev4l2_m≥g_cx2341x_video_chroma_•©ül_fûãr_ty≥
 {

1531 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1532 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1534 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+4)

	)

1535 
	ev4l2_m≥g_cx2341x_video_ãmp‹Æ_fûãr_mode
 {

1536 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_MANUAL
 = 0,

1537 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_AUTO
 = 1,

1539 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+5)

	)

1540 
	#V4L2_CID_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+6)

	)

1541 
	ev4l2_m≥g_cx2341x_video_medün_fûãr_ty≥
 {

1542 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_OFF
 = 0,

1543 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR
 = 1,

1544 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_VERT
 = 2,

1545 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR_VERT
 = 3,

1546 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_DIAG
 = 4,

1548 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+7)

	)

1549 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+8)

	)

1550 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+9)

	)

1551 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+10)

	)

1552 
	#V4L2_CID_MPEG_CX2341X_STREAM_INSERT_NAV_PACKETS
 (
V4L2_CID_MPEG_CX2341X_BASE
+11)

	)

1555 
	#V4L2_CID_MPEG_MFC51_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x1100)

	)

1557 
	#V4L2_CID_MPEG_MFC51_VIDEO_DECODER_H264_DISPLAY_DELAY
 (
V4L2_CID_MPEG_MFC51_BASE
+0)

	)

1558 
	#V4L2_CID_MPEG_MFC51_VIDEO_DECODER_H264_DISPLAY_DELAY_ENABLE
 (
V4L2_CID_MPEG_MFC51_BASE
+1)

	)

1559 
	#V4L2_CID_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE
 (
V4L2_CID_MPEG_MFC51_BASE
+2)

	)

1560 
	ev4l2_m≥g_mfc51_video_‰ame_skù_mode
 {

1561 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_DISABLED
 = 0,

1562 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_LEVEL_LIMIT
 = 1,

1563 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_BUF_LIMIT
 = 2,

1565 
	#V4L2_CID_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE
 (
V4L2_CID_MPEG_MFC51_BASE
+3)

	)

1566 
	ev4l2_m≥g_mfc51_video_f‹˚_‰ame_ty≥
 {

1567 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_DISABLED
 = 0,

1568 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_I_FRAME
 = 1,

1569 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_NOT_CODED
 = 2,

1571 
	#V4L2_CID_MPEG_MFC51_VIDEO_PADDING
 (
V4L2_CID_MPEG_MFC51_BASE
+4)

	)

1572 
	#V4L2_CID_MPEG_MFC51_VIDEO_PADDING_YUV
 (
V4L2_CID_MPEG_MFC51_BASE
+5)

	)

1573 
	#V4L2_CID_MPEG_MFC51_VIDEO_RC_FIXED_TARGET_BIT
 (
V4L2_CID_MPEG_MFC51_BASE
+6)

	)

1574 
	#V4L2_CID_MPEG_MFC51_VIDEO_RC_REACTION_COEFF
 (
V4L2_CID_MPEG_MFC51_BASE
+7)

	)

1575 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_ACTIVITY
 (
V4L2_CID_MPEG_MFC51_BASE
+50)

	)

1576 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_DARK
 (
V4L2_CID_MPEG_MFC51_BASE
+51)

	)

1577 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_SMOOTH
 (
V4L2_CID_MPEG_MFC51_BASE
+52)

	)

1578 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_STATIC
 (
V4L2_CID_MPEG_MFC51_BASE
+53)

	)

1579 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_NUM_REF_PIC_FOR_P
 (
V4L2_CID_MPEG_MFC51_BASE
+54)

	)

1582 
	#V4L2_CID_CAMERA_CLASS_BASE
 (
V4L2_CTRL_CLASS_CAMERA
 | 0x900)

	)

1583 
	#V4L2_CID_CAMERA_CLASS
 (
V4L2_CTRL_CLASS_CAMERA
 | 1)

	)

1585 
	#V4L2_CID_EXPOSURE_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+1)

	)

1586 
	ev4l2_exposuª_auto_ty≥
 {

1587 
	mV4L2_EXPOSURE_AUTO
 = 0,

1588 
	mV4L2_EXPOSURE_MANUAL
 = 1,

1589 
	mV4L2_EXPOSURE_SHUTTER_PRIORITY
 = 2,

1590 
	mV4L2_EXPOSURE_APERTURE_PRIORITY
 = 3

1592 
	#V4L2_CID_EXPOSURE_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+2)

	)

1593 
	#V4L2_CID_EXPOSURE_AUTO_PRIORITY
 (
V4L2_CID_CAMERA_CLASS_BASE
+3)

	)

1595 
	#V4L2_CID_PAN_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+4)

	)

1596 
	#V4L2_CID_TILT_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+5)

	)

1597 
	#V4L2_CID_PAN_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+6)

	)

1598 
	#V4L2_CID_TILT_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+7)

	)

1600 
	#V4L2_CID_PAN_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+8)

	)

1601 
	#V4L2_CID_TILT_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+9)

	)

1603 
	#V4L2_CID_FOCUS_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+10)

	)

1604 
	#V4L2_CID_FOCUS_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+11)

	)

1605 
	#V4L2_CID_FOCUS_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+12)

	)

1607 
	#V4L2_CID_ZOOM_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+13)

	)

1608 
	#V4L2_CID_ZOOM_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+14)

	)

1609 
	#V4L2_CID_ZOOM_CONTINUOUS
 (
V4L2_CID_CAMERA_CLASS_BASE
+15)

	)

1611 
	#V4L2_CID_PRIVACY
 (
V4L2_CID_CAMERA_CLASS_BASE
+16)

	)

1613 
	#V4L2_CID_IRIS_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+17)

	)

1614 
	#V4L2_CID_IRIS_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+18)

	)

1617 
	#V4L2_CID_FM_TX_CLASS_BASE
 (
V4L2_CTRL_CLASS_FM_TX
 | 0x900)

	)

1618 
	#V4L2_CID_FM_TX_CLASS
 (
V4L2_CTRL_CLASS_FM_TX
 | 1)

	)

1620 
	#V4L2_CID_RDS_TX_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 1)

	)

1621 
	#V4L2_CID_RDS_TX_PI
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 2)

	)

1622 
	#V4L2_CID_RDS_TX_PTY
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 3)

	)

1623 
	#V4L2_CID_RDS_TX_PS_NAME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 5)

	)

1624 
	#V4L2_CID_RDS_TX_RADIO_TEXT
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 6)

	)

1626 
	#V4L2_CID_AUDIO_LIMITER_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 64)

	)

1627 
	#V4L2_CID_AUDIO_LIMITER_RELEASE_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 65)

	)

1628 
	#V4L2_CID_AUDIO_LIMITER_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 66)

	)

1630 
	#V4L2_CID_AUDIO_COMPRESSION_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 80)

	)

1631 
	#V4L2_CID_AUDIO_COMPRESSION_GAIN
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 81)

	)

1632 
	#V4L2_CID_AUDIO_COMPRESSION_THRESHOLD
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 82)

	)

1633 
	#V4L2_CID_AUDIO_COMPRESSION_ATTACK_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 83)

	)

1634 
	#V4L2_CID_AUDIO_COMPRESSION_RELEASE_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 84)

	)

1636 
	#V4L2_CID_PILOT_TONE_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 96)

	)

1637 
	#V4L2_CID_PILOT_TONE_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 97)

	)

1638 
	#V4L2_CID_PILOT_TONE_FREQUENCY
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 98)

	)

1640 
	#V4L2_CID_TUNE_PREEMPHASIS
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 112)

	)

1641 
	ev4l2_¥ìmphasis
 {

1642 
	mV4L2_PREEMPHASIS_DISABLED
 = 0,

1643 
	mV4L2_PREEMPHASIS_50_uS
 = 1,

1644 
	mV4L2_PREEMPHASIS_75_uS
 = 2,

1646 
	#V4L2_CID_TUNE_POWER_LEVEL
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 113)

	)

1647 
	#V4L2_CID_TUNE_ANTENNA_CAPACITOR
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 114)

	)

1650 
	#V4L2_CID_FLASH_CLASS_BASE
 (
V4L2_CTRL_CLASS_FLASH
 | 0x900)

	)

1651 
	#V4L2_CID_FLASH_CLASS
 (
V4L2_CTRL_CLASS_FLASH
 | 1)

	)

1653 
	#V4L2_CID_FLASH_LED_MODE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 1)

	)

1654 
	ev4l2_Êash_Àd_mode
 {

1655 
	mV4L2_FLASH_LED_MODE_NONE
,

1656 
	mV4L2_FLASH_LED_MODE_FLASH
,

1657 
	mV4L2_FLASH_LED_MODE_TORCH
,

1660 
	#V4L2_CID_FLASH_STROBE_SOURCE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 2)

	)

1661 
	ev4l2_Êash_°robe_sour˚
 {

1662 
	mV4L2_FLASH_STROBE_SOURCE_SOFTWARE
,

1663 
	mV4L2_FLASH_STROBE_SOURCE_EXTERNAL
,

1666 
	#V4L2_CID_FLASH_STROBE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 3)

	)

1667 
	#V4L2_CID_FLASH_STROBE_STOP
 (
V4L2_CID_FLASH_CLASS_BASE
 + 4)

	)

1668 
	#V4L2_CID_FLASH_STROBE_STATUS
 (
V4L2_CID_FLASH_CLASS_BASE
 + 5)

	)

1670 
	#V4L2_CID_FLASH_TIMEOUT
 (
V4L2_CID_FLASH_CLASS_BASE
 + 6)

	)

1671 
	#V4L2_CID_FLASH_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 7)

	)

1672 
	#V4L2_CID_FLASH_TORCH_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 8)

	)

1673 
	#V4L2_CID_FLASH_INDICATOR_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 9)

	)

1675 
	#V4L2_CID_FLASH_FAULT
 (
V4L2_CID_FLASH_CLASS_BASE
 + 10)

	)

1676 
	#V4L2_FLASH_FAULT_OVER_VOLTAGE
 (1 << 0)

	)

1677 
	#V4L2_FLASH_FAULT_TIMEOUT
 (1 << 1)

	)

1678 
	#V4L2_FLASH_FAULT_OVER_TEMPERATURE
 (1 << 2)

	)

1679 
	#V4L2_FLASH_FAULT_SHORT_CIRCUIT
 (1 << 3)

	)

1681 
	#V4L2_CID_FLASH_CHARGE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 11)

	)

1682 
	#V4L2_CID_FLASH_READY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 12)

	)

1687 
	sv4l2_tu√r
 {

1688 
__u32
 
	mödex
;

1689 
__u8
 
	m«me
[32];

1690 
v4l2_tu√r_ty≥
 
	mty≥
;

1691 
__u32
 
	mˇ∑bûôy
;

1692 
__u32
 
	møngñow
;

1693 
__u32
 
	møngehigh
;

1694 
__u32
 
	mrxsubch™s
;

1695 
__u32
 
	maudmode
;

1696 
__s32
 
	msig«l
;

1697 
__s32
 
	mafc
;

1698 
__u32
 
	mª£rved
[4];

1701 
	sv4l2_moduœt‹
 {

1702 
__u32
 
	mödex
;

1703 
__u8
 
	m«me
[32];

1704 
__u32
 
	mˇ∑bûôy
;

1705 
__u32
 
	møngñow
;

1706 
__u32
 
	møngehigh
;

1707 
__u32
 
	mtxsubch™s
;

1708 
__u32
 
	mª£rved
[4];

1712 
	#V4L2_TUNER_CAP_LOW
 0x0001

	)

1713 
	#V4L2_TUNER_CAP_NORM
 0x0002

	)

1714 
	#V4L2_TUNER_CAP_STEREO
 0x0010

	)

1715 
	#V4L2_TUNER_CAP_LANG2
 0x0020

	)

1716 
	#V4L2_TUNER_CAP_SAP
 0x0020

	)

1717 
	#V4L2_TUNER_CAP_LANG1
 0x0040

	)

1718 
	#V4L2_TUNER_CAP_RDS
 0x0080

	)

1719 
	#V4L2_TUNER_CAP_RDS_BLOCK_IO
 0x0100

	)

1720 
	#V4L2_TUNER_CAP_RDS_CONTROLS
 0x0200

	)

1723 
	#V4L2_TUNER_SUB_MONO
 0x0001

	)

1724 
	#V4L2_TUNER_SUB_STEREO
 0x0002

	)

1725 
	#V4L2_TUNER_SUB_LANG2
 0x0004

	)

1726 
	#V4L2_TUNER_SUB_SAP
 0x0004

	)

1727 
	#V4L2_TUNER_SUB_LANG1
 0x0008

	)

1728 
	#V4L2_TUNER_SUB_RDS
 0x0010

	)

1731 
	#V4L2_TUNER_MODE_MONO
 0x0000

	)

1732 
	#V4L2_TUNER_MODE_STEREO
 0x0001

	)

1733 
	#V4L2_TUNER_MODE_LANG2
 0x0002

	)

1734 
	#V4L2_TUNER_MODE_SAP
 0x0002

	)

1735 
	#V4L2_TUNER_MODE_LANG1
 0x0003

	)

1736 
	#V4L2_TUNER_MODE_LANG1_LANG2
 0x0004

	)

1738 
	sv4l2_‰equícy
 {

1739 
__u32
 
	mtu√r
;

1740 
v4l2_tu√r_ty≥
 
	mty≥
;

1741 
__u32
 
	m‰equícy
;

1742 
__u32
 
	mª£rved
[8];

1745 
	sv4l2_hw_‰eq_£ek
 {

1746 
__u32
 
	mtu√r
;

1747 
v4l2_tu√r_ty≥
 
	mty≥
;

1748 
__u32
 
	m£ek_upw¨d
;

1749 
__u32
 
	mwøp_¨ound
;

1750 
__u32
 
	m•acög
;

1751 
__u32
 
	mª£rved
[7];

1758 
	sv4l2_rds_d©a
 {

1759 
__u8
 
	mlsb
;

1760 
__u8
 
	mmsb
;

1761 
__u8
 
	mblock
;

1762 } 
__©åibuã__
 ((
∑cked
));

1764 
	#V4L2_RDS_BLOCK_MSK
 0x7

	)

1765 
	#V4L2_RDS_BLOCK_A
 0

	)

1766 
	#V4L2_RDS_BLOCK_B
 1

	)

1767 
	#V4L2_RDS_BLOCK_C
 2

	)

1768 
	#V4L2_RDS_BLOCK_D
 3

	)

1769 
	#V4L2_RDS_BLOCK_C_ALT
 4

	)

1770 
	#V4L2_RDS_BLOCK_INVALID
 7

	)

1772 
	#V4L2_RDS_BLOCK_CORRECTED
 0x40

	)

1773 
	#V4L2_RDS_BLOCK_ERROR
 0x80

	)

1778 
	sv4l2_audio
 {

1779 
__u32
 
	mödex
;

1780 
__u8
 
	m«me
[32];

1781 
__u32
 
	mˇ∑bûôy
;

1782 
__u32
 
	mmode
;

1783 
__u32
 
	mª£rved
[2];

1787 
	#V4L2_AUDCAP_STEREO
 0x00001

	)

1788 
	#V4L2_AUDCAP_AVL
 0x00002

	)

1791 
	#V4L2_AUDMODE_AVL
 0x00001

	)

1793 
	sv4l2_audioout
 {

1794 
__u32
 
	mödex
;

1795 
__u8
 
	m«me
[32];

1796 
__u32
 
	mˇ∑bûôy
;

1797 
__u32
 
	mmode
;

1798 
__u32
 
	mª£rved
[2];

1807 
	#V4L2_ENC_IDX_FRAME_I
 (0)

	)

1808 
	#V4L2_ENC_IDX_FRAME_P
 (1)

	)

1809 
	#V4L2_ENC_IDX_FRAME_B
 (2)

	)

1810 
	#V4L2_ENC_IDX_FRAME_MASK
 (0xf)

	)

1812 
	sv4l2_íc_idx_íåy
 {

1813 
__u64
 
	moff£t
;

1814 
__u64
 
	m±s
;

1815 
__u32
 
	mÀngth
;

1816 
__u32
 
	mÊags
;

1817 
__u32
 
	mª£rved
[2];

1820 
	#V4L2_ENC_IDX_ENTRIES
 (64)

	)

1821 
	sv4l2_íc_idx
 {

1822 
__u32
 
	míåõs
;

1823 
__u32
 
	míåõs_ˇp
;

1824 
__u32
 
	mª£rved
[4];

1825 
v4l2_íc_idx_íåy
 
	míåy
[
V4L2_ENC_IDX_ENTRIES
];

1829 
	#V4L2_ENC_CMD_START
 (0)

	)

1830 
	#V4L2_ENC_CMD_STOP
 (1)

	)

1831 
	#V4L2_ENC_CMD_PAUSE
 (2)

	)

1832 
	#V4L2_ENC_CMD_RESUME
 (3)

	)

1835 
	#V4L2_ENC_CMD_STOP_AT_GOP_END
 (1 << 0)

	)

1837 
	sv4l2_ícodî_cmd
 {

1838 
__u32
 
	mcmd
;

1839 
__u32
 
	mÊags
;

1842 
__u32
 
	md©a
[8];

1843 } 
	møw
;

1857 
	sv4l2_vbi_f‹m©
 {

1858 
__u32
 
	mßm∂ög_øã
;

1859 
__u32
 
	moff£t
;

1860 
__u32
 
	mßm∂es_≥r_löe
;

1861 
__u32
 
	mßm∂e_f‹m©
;

1862 
__s32
 
	m°¨t
[2];

1863 
__u32
 
	mcou¡
[2];

1864 
__u32
 
	mÊags
;

1865 
__u32
 
	mª£rved
[2];

1869 
	#V4L2_VBI_UNSYNC
 (1 << 0)

	)

1870 
	#V4L2_VBI_INTERLACED
 (1 << 1)

	)

1879 
	sv4l2_¶i˚d_vbi_f‹m©
 {

1880 
__u16
 
	m£rvi˚_£t
;

1885 
__u16
 
	m£rvi˚_löes
[2][24];

1886 
__u32
 
	mio_size
;

1887 
__u32
 
	mª£rved
[2];

1892 
	#V4L2_SLICED_TELETEXT_B
 (0x0001)

	)

1894 
	#V4L2_SLICED_VPS
 (0x0400)

	)

1896 
	#V4L2_SLICED_CAPTION_525
 (0x1000)

	)

1898 
	#V4L2_SLICED_WSS_625
 (0x4000)

	)

1900 
	#V4L2_SLICED_VBI_525
 (
V4L2_SLICED_CAPTION_525
)

	)

1901 
	#V4L2_SLICED_VBI_625
 (
V4L2_SLICED_TELETEXT_B
 | 
V4L2_SLICED_VPS
 | 
V4L2_SLICED_WSS_625
)

	)

1903 
	sv4l2_¶i˚d_vbi_ˇp
 {

1904 
__u16
 
	m£rvi˚_£t
;

1909 
__u16
 
	m£rvi˚_löes
[2][24];

1910 
v4l2_buf_ty≥
 
	mty≥
;

1911 
__u32
 
	mª£rved
[3];

1914 
	sv4l2_¶i˚d_vbi_d©a
 {

1915 
__u32
 
	mid
;

1916 
__u32
 
	mfõld
;

1917 
__u32
 
	mlöe
;

1918 
__u32
 
	mª£rved
;

1919 
__u8
 
	md©a
[48];

1939 
	#V4L2_MPEG_VBI_IVTV_TELETEXT_B
 (1)

	)

1940 
	#V4L2_MPEG_VBI_IVTV_CAPTION_525
 (4)

	)

1941 
	#V4L2_MPEG_VBI_IVTV_WSS_625
 (5)

	)

1942 
	#V4L2_MPEG_VBI_IVTV_VPS
 (7)

	)

1944 
	sv4l2_m≥g_vbi_ôv0_löe
 {

1945 
__u8
 
	mid
;

1946 
__u8
 
	md©a
[42];

1947 } 
__©åibuã__
 ((
∑cked
));

1949 
	sv4l2_m≥g_vbi_ôv0
 {

1950 
__À32
 
	mlöemask
[2];

1951 
v4l2_m≥g_vbi_ôv0_löe
 
	mlöe
[35];

1952 } 
__©åibuã__
 ((
∑cked
));

1954 
	sv4l2_m≥g_vbi_ITV0
 {

1955 
v4l2_m≥g_vbi_ôv0_löe
 
	mlöe
[36];

1956 } 
__©åibuã__
 ((
∑cked
));

1958 
	#V4L2_MPEG_VBI_IVTV_MAGIC0
 "ôv0"

	)

1959 
	#V4L2_MPEG_VBI_IVTV_MAGIC1
 "ITV0"

	)

1961 
	sv4l2_m≥g_vbi_fmt_ivtv
 {

1962 
__u8
 
	mmagic
[4];

1964 
v4l2_m≥g_vbi_ôv0
 
	môv0
;

1965 
v4l2_m≥g_vbi_ITV0
 
	mITV0
;

1967 } 
__©åibuã__
 ((
∑cked
));

1980 
	sv4l2_∂™e_pix_f‹m©
 {

1981 
__u32
 
	msizeimage
;

1982 
__u16
 
	mbyã•îlöe
;

1983 
__u16
 
	mª£rved
[7];

1984 } 
__©åibuã__
 ((
∑cked
));

1996 
	sv4l2_pix_f‹m©_m∂™e
 {

1997 
__u32
 
	mwidth
;

1998 
__u32
 
	mheight
;

1999 
__u32
 
	mpixñf‹m©
;

2000 
v4l2_fõld
 
	mfõld
;

2001 
v4l2_cﬁ‹•a˚
 
	mcﬁ‹•a˚
;

2003 
v4l2_∂™e_pix_f‹m©
 
	m∂™e_fmt
[
VIDEO_MAX_PLANES
];

2004 
__u8
 
	mnum_∂™es
;

2005 
__u8
 
	mª£rved
[11];

2006 } 
__©åibuã__
 ((
∑cked
));

2018 
	sv4l2_f‹m©
 {

2019 
v4l2_buf_ty≥
 
	mty≥
;

2021 
v4l2_pix_f‹m©
 
	mpix
;

2022 
v4l2_pix_f‹m©_m∂™e
 
	mpix_mp
;

2023 
v4l2_wödow
 
	mwö
;

2024 
v4l2_vbi_f‹m©
 
	mvbi
;

2025 
v4l2_¶i˚d_vbi_f‹m©
 
	m¶i˚d
;

2026 
__u8
 
	møw_d©a
[200];

2027 } 
	mfmt
;

2032 
	sv4l2_°ªam∑rm
 {

2033 
v4l2_buf_ty≥
 
	mty≥
;

2035 
v4l2_ˇ±uª∑rm
 
	mˇ±uª
;

2036 
v4l2_ouçuç¨m
 
	mouçut
;

2037 
__u8
 
	møw_d©a
[200];

2038 } 
	m∑rm
;

2045 
	#V4L2_EVENT_ALL
 0

	)

2046 
	#V4L2_EVENT_VSYNC
 1

	)

2047 
	#V4L2_EVENT_EOS
 2

	)

2048 
	#V4L2_EVENT_CTRL
 3

	)

2049 
	#V4L2_EVENT_FRAME_SYNC
 4

	)

2050 
	#V4L2_EVENT_PRIVATE_START
 0x08000000

	)

2053 
	sv4l2_evít_vsync
 {

2055 
__u8
 
	mfõld
;

2056 } 
__©åibuã__
 ((
∑cked
));

2059 
	#V4L2_EVENT_CTRL_CH_VALUE
 (1 << 0)

	)

2060 
	#V4L2_EVENT_CTRL_CH_FLAGS
 (1 << 1)

	)

2062 
	sv4l2_evít_˘æ
 {

2063 
__u32
 
	mch™ges
;

2064 
__u32
 
	mty≥
;

2066 
__s32
 
	mvÆue
;

2067 
__s64
 
	mvÆue64
;

2069 
__u32
 
	mÊags
;

2070 
__s32
 
	mmöimum
;

2071 
__s32
 
	mmaximum
;

2072 
__s32
 
	m°ï
;

2073 
__s32
 
	mdeÁu…_vÆue
;

2076 
	sv4l2_evít_‰ame_sync
 {

2077 
__u32
 
	m‰ame_£quí˚
;

2080 
	sv4l2_evít
 {

2081 
__u32
 
	mty≥
;

2083 
v4l2_evít_vsync
 
	mvsync
;

2084 
v4l2_evít_˘æ
 
	m˘æ
;

2085 
v4l2_evít_‰ame_sync
 
	m‰ame_sync
;

2086 
__u8
 
	md©a
[64];

2087 } 
	mu
;

2088 
__u32
 
	m≥ndög
;

2089 
__u32
 
	m£quí˚
;

2090 
time•ec
 
	mtime°amp
;

2091 
__u32
 
	mid
;

2092 
__u32
 
	mª£rved
[8];

2095 
	#V4L2_EVENT_SUB_FL_SEND_INITIAL
 (1 << 0)

	)

2096 
	#V4L2_EVENT_SUB_FL_ALLOW_FEEDBACK
 (1 << 1)

	)

2098 
	sv4l2_evít_subs¸ùti⁄
 {

2099 
__u32
 
	mty≥
;

2100 
__u32
 
	mid
;

2101 
__u32
 
	mÊags
;

2102 
__u32
 
	mª£rved
[5];

2114 
	#V4L2_CHIP_MATCH_HOST
 0

	)

2115 
	#V4L2_CHIP_MATCH_I2C_DRIVER
 1

	)

2116 
	#V4L2_CHIP_MATCH_I2C_ADDR
 2

	)

2117 
	#V4L2_CHIP_MATCH_AC97
 3

	)

2119 
	sv4l2_dbg_m©ch
 {

2120 
__u32
 
	mty≥
;

2122 
__u32
 
	maddr
;

2123 
	m«me
[32];

2125 } 
__©åibuã__
 ((
∑cked
));

2127 
	sv4l2_dbg_ªgi°î
 {

2128 
v4l2_dbg_m©ch
 
	mm©ch
;

2129 
__u32
 
	msize
;

2130 
__u64
 
	mªg
;

2131 
__u64
 
	mvÆ
;

2132 } 
__©åibuã__
 ((
∑cked
));

2135 
	sv4l2_dbg_chù_idít
 {

2136 
v4l2_dbg_m©ch
 
	mm©ch
;

2137 
__u32
 
	midít
;

2138 
__u32
 
	mªvisi⁄
;

2139 } 
__©åibuã__
 ((
∑cked
));

2150 
	sv4l2_¸óã_buf„rs
 {

2151 
__u32
 
	mödex
;

2152 
__u32
 
	mcou¡
;

2153 
v4l2_mem‹y
 
	mmem‹y
;

2154 
v4l2_f‹m©
 
	mf‹m©
;

2155 
__u32
 
	mª£rved
[8];

2162 
	#VIDIOC_QUERYCAP
 
	`_IOR
('V', 0, 
v4l2_ˇ∑bûôy
)

	)

2163 
	#VIDIOC_RESERVED
 
	`_IO
('V', 1)

	)

2164 
	#VIDIOC_ENUM_FMT
 
	`_IOWR
('V', 2, 
v4l2_fmtdesc
)

	)

2165 
	#VIDIOC_G_FMT
 
	`_IOWR
('V', 4, 
v4l2_f‹m©
)

	)

2166 
	#VIDIOC_S_FMT
 
	`_IOWR
('V', 5, 
v4l2_f‹m©
)

	)

2167 
	#VIDIOC_REQBUFS
 
	`_IOWR
('V', 8, 
v4l2_ªque°buf„rs
)

	)

2168 
	#VIDIOC_QUERYBUF
 
	`_IOWR
('V', 9, 
v4l2_buf„r
)

	)

2169 
	#VIDIOC_G_FBUF
 
	`_IOR
('V', 10, 
v4l2_‰amebuf„r
)

	)

2170 
	#VIDIOC_S_FBUF
 
	`_IOW
('V', 11, 
v4l2_‰amebuf„r
)

	)

2171 
	#VIDIOC_OVERLAY
 
	`_IOW
('V', 14, )

	)

2172 
	#VIDIOC_QBUF
 
	`_IOWR
('V', 15, 
v4l2_buf„r
)

	)

2173 
	#VIDIOC_DQBUF
 
	`_IOWR
('V', 17, 
v4l2_buf„r
)

	)

2174 
	#VIDIOC_STREAMON
 
	`_IOW
('V', 18, )

	)

2175 
	#VIDIOC_STREAMOFF
 
	`_IOW
('V', 19, )

	)

2176 
	#VIDIOC_G_PARM
 
	`_IOWR
('V', 21, 
v4l2_°ªam∑rm
)

	)

2177 
	#VIDIOC_S_PARM
 
	`_IOWR
('V', 22, 
v4l2_°ªam∑rm
)

	)

2178 
	#VIDIOC_G_STD
 
	`_IOR
('V', 23, 
v4l2_°d_id
)

	)

2179 
	#VIDIOC_S_STD
 
	`_IOW
('V', 24, 
v4l2_°d_id
)

	)

2180 
	#VIDIOC_ENUMSTD
 
	`_IOWR
('V', 25, 
v4l2_°™d¨d
)

	)

2181 
	#VIDIOC_ENUMINPUT
 
	`_IOWR
('V', 26, 
v4l2_öput
)

	)

2182 
	#VIDIOC_G_CTRL
 
	`_IOWR
('V', 27, 
v4l2_c⁄åﬁ
)

	)

2183 
	#VIDIOC_S_CTRL
 
	`_IOWR
('V', 28, 
v4l2_c⁄åﬁ
)

	)

2184 
	#VIDIOC_G_TUNER
 
	`_IOWR
('V', 29, 
v4l2_tu√r
)

	)

2185 
	#VIDIOC_S_TUNER
 
	`_IOW
('V', 30, 
v4l2_tu√r
)

	)

2186 
	#VIDIOC_G_AUDIO
 
	`_IOR
('V', 33, 
v4l2_audio
)

	)

2187 
	#VIDIOC_S_AUDIO
 
	`_IOW
('V', 34, 
v4l2_audio
)

	)

2188 
	#VIDIOC_QUERYCTRL
 
	`_IOWR
('V', 36, 
v4l2_quîy˘æ
)

	)

2189 
	#VIDIOC_QUERYMENU
 
	`_IOWR
('V', 37, 
v4l2_quîymíu
)

	)

2190 
	#VIDIOC_G_INPUT
 
	`_IOR
('V', 38, )

	)

2191 
	#VIDIOC_S_INPUT
 
	`_IOWR
('V', 39, )

	)

2192 
	#VIDIOC_G_OUTPUT
 
	`_IOR
('V', 46, )

	)

2193 
	#VIDIOC_S_OUTPUT
 
	`_IOWR
('V', 47, )

	)

2194 
	#VIDIOC_ENUMOUTPUT
 
	`_IOWR
('V', 48, 
v4l2_ouçut
)

	)

2195 
	#VIDIOC_G_AUDOUT
 
	`_IOR
('V', 49, 
v4l2_audioout
)

	)

2196 
	#VIDIOC_S_AUDOUT
 
	`_IOW
('V', 50, 
v4l2_audioout
)

	)

2197 
	#VIDIOC_G_MODULATOR
 
	`_IOWR
('V', 54, 
v4l2_moduœt‹
)

	)

2198 
	#VIDIOC_S_MODULATOR
 
	`_IOW
('V', 55, 
v4l2_moduœt‹
)

	)

2199 
	#VIDIOC_G_FREQUENCY
 
	`_IOWR
('V', 56, 
v4l2_‰equícy
)

	)

2200 
	#VIDIOC_S_FREQUENCY
 
	`_IOW
('V', 57, 
v4l2_‰equícy
)

	)

2201 
	#VIDIOC_CROPCAP
 
	`_IOWR
('V', 58, 
v4l2_¸›ˇp
)

	)

2202 
	#VIDIOC_G_CROP
 
	`_IOWR
('V', 59, 
v4l2_¸›
)

	)

2203 
	#VIDIOC_S_CROP
 
	`_IOW
('V', 60, 
v4l2_¸›
)

	)

2204 
	#VIDIOC_G_JPEGCOMP
 
	`_IOR
('V', 61, 
v4l2_j≥gcom¥essi⁄
)

	)

2205 
	#VIDIOC_S_JPEGCOMP
 
	`_IOW
('V', 62, 
v4l2_j≥gcom¥essi⁄
)

	)

2206 
	#VIDIOC_QUERYSTD
 
	`_IOR
('V', 63, 
v4l2_°d_id
)

	)

2207 
	#VIDIOC_TRY_FMT
 
	`_IOWR
('V', 64, 
v4l2_f‹m©
)

	)

2208 
	#VIDIOC_ENUMAUDIO
 
	`_IOWR
('V', 65, 
v4l2_audio
)

	)

2209 
	#VIDIOC_ENUMAUDOUT
 
	`_IOWR
('V', 66, 
v4l2_audioout
)

	)

2210 
	#VIDIOC_G_PRIORITY
 
	`_IOR
('V', 67, 
v4l2_¥i‹ôy
)

	)

2211 
	#VIDIOC_S_PRIORITY
 
	`_IOW
('V', 68, 
v4l2_¥i‹ôy
)

	)

2212 
	#VIDIOC_G_SLICED_VBI_CAP
 
	`_IOWR
('V', 69, 
v4l2_¶i˚d_vbi_ˇp
)

	)

2213 
	#VIDIOC_LOG_STATUS
 
	`_IO
('V', 70)

	)

2214 
	#VIDIOC_G_EXT_CTRLS
 
	`_IOWR
('V', 71, 
v4l2_ext_c⁄åﬁs
)

	)

2215 
	#VIDIOC_S_EXT_CTRLS
 
	`_IOWR
('V', 72, 
v4l2_ext_c⁄åﬁs
)

	)

2216 
	#VIDIOC_TRY_EXT_CTRLS
 
	`_IOWR
('V', 73, 
v4l2_ext_c⁄åﬁs
)

	)

2218 
	#VIDIOC_ENUM_FRAMESIZES
 
	`_IOWR
('V', 74, 
v4l2_‰msizìnum
)

	)

2219 
	#VIDIOC_ENUM_FRAMEINTERVALS
 
	`_IOWR
('V', 75, 
v4l2_‰mivÆíum
)

	)

2220 
	#VIDIOC_G_ENC_INDEX
 
	`_IOR
('V', 76, 
v4l2_íc_idx
)

	)

2221 
	#VIDIOC_ENCODER_CMD
 
	`_IOWR
('V', 77, 
v4l2_ícodî_cmd
)

	)

2222 
	#VIDIOC_TRY_ENCODER_CMD
 
	`_IOWR
('V', 78, 
v4l2_ícodî_cmd
)

	)

2229 
	#VIDIOC_DBG_S_REGISTER
 
	`_IOW
('V', 79, 
v4l2_dbg_ªgi°î
)

	)

2230 
	#VIDIOC_DBG_G_REGISTER
 
	`_IOWR
('V', 80, 
v4l2_dbg_ªgi°î
)

	)

2234 
	#VIDIOC_DBG_G_CHIP_IDENT
 
	`_IOWR
('V', 81, 
v4l2_dbg_chù_idít
)

	)

2237 
	#VIDIOC_S_HW_FREQ_SEEK
 
	`_IOW
('V', 82, 
v4l2_hw_‰eq_£ek
)

	)

2238 
	#VIDIOC_ENUM_DV_PRESETS
 
	`_IOWR
('V', 83, 
v4l2_dv_íum_¥e£t
)

	)

2239 
	#VIDIOC_S_DV_PRESET
 
	`_IOWR
('V', 84, 
v4l2_dv_¥e£t
)

	)

2240 
	#VIDIOC_G_DV_PRESET
 
	`_IOWR
('V', 85, 
v4l2_dv_¥e£t
)

	)

2241 
	#VIDIOC_QUERY_DV_PRESET
 
	`_IOR
('V', 86, 
v4l2_dv_¥e£t
)

	)

2242 
	#VIDIOC_S_DV_TIMINGS
 
	`_IOWR
('V', 87, 
v4l2_dv_timögs
)

	)

2243 
	#VIDIOC_G_DV_TIMINGS
 
	`_IOWR
('V', 88, 
v4l2_dv_timögs
)

	)

2244 
	#VIDIOC_DQEVENT
 
	`_IOR
('V', 89, 
v4l2_evít
)

	)

2245 
	#VIDIOC_SUBSCRIBE_EVENT
 
	`_IOW
('V', 90, 
v4l2_evít_subs¸ùti⁄
)

	)

2246 
	#VIDIOC_UNSUBSCRIBE_EVENT
 
	`_IOW
('V', 91, 
v4l2_evít_subs¸ùti⁄
)

	)

2250 
	#VIDIOC_CREATE_BUFS
 
	`_IOWR
('V', 92, 
v4l2_¸óã_buf„rs
)

	)

2251 
	#VIDIOC_PREPARE_BUF
 
	`_IOWR
('V', 93, 
v4l2_buf„r
)

	)

2256 
	#BASE_VIDIOC_PRIVATE
 192

	)

	@/usr/include/math.h

23 #i‚def 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


32 
	~<bôs/huge_vÆ.h
>

33 #ifde‡
__USE_ISOC99


34 
	~<bôs/huge_vÆf.h
>

35 
	~<bôs/huge_vÆl.h
>

38 
	~<bôs/öf.h
>

41 
	~<bôs/«n.h
>

45 
	~<bôs/m©hdef.h
>

52 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

53 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

54 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

55 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

56 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

57 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

58 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

59 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

60 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

61 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

62 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

63 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

65 
	#_MdoubÀ_
 

	)

66 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

67 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<bôs/m©hˇŒs.h
>

70 #unde‡
_MdoubÀ_


71 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


72 #unde‡
_MdoubÀ_END_NAMESPACE


73 #unde‡
__MATH_PRECNAME


75 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


81 #i‚de‡
_MÊﬂt_


82 
	#_MÊﬂt_
 

	)

84 
	#_MdoubÀ_
 
_MÊﬂt_


	)

85 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

86 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<bôs/m©hˇŒs.h
>

89 #unde‡
_MdoubÀ_


90 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


91 #unde‡
_MdoubÀ_END_NAMESPACE


92 #unde‡
__MATH_PRECNAME


94 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

95 || 
deföed
 
__LDBL_COMPAT


96 #ifde‡
__LDBL_COMPAT


98 #ifde‡
__USE_ISOC99


99 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

101 #ifde‡
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

103 
__∆dbl_√xâow¨df
)

104 
	`__©åibuã__
 ((
__c⁄°__
));

105 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

106 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

107 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

108 (
__x
, 
__y
),

109 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

113 #unde‡
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

115 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

116 
¨gs
, 
Æüs
)

	)

117 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

118 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

124 #i‚de‡
_Ml⁄g_doubÀ_


125 
	#_Ml⁄g_doubÀ_
 

	)

127 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

128 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

129 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<bôs/m©hˇŒs.h
>

133 #unde‡
_MdoubÀ_


134 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


135 #unde‡
_MdoubÀ_END_NAMESPACE


136 #unde‡
__MATH_PRECNAME


141 #unde‡
__MATHDECL_1


142 #unde‡
__MATHDECL


143 #unde‡
__MATHCALL


146 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


148 
signgam
;

153 #ifde‡
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifde‡
__NO_LONG_DOUBLE_MATH


210 
	#Â˛assify
(
x
) \

211 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

213 
	#Â˛assify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__Â˛assifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

221 #ifde‡
__NO_LONG_DOUBLE_MATH


222 
	#signbô
(
x
) \

223 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

225 
	#signbô
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signbôf
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

233 #ifde‡
__NO_LONG_DOUBLE_MATH


234 
	#isföôe
(
x
) \

235 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

237 
	#isföôe
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__föôef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

245 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

249 #ifde‡
__NO_LONG_DOUBLE_MATH


250 
	#i¢™
(
x
) \

251 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

253 
	#i¢™
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢™f
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

261 #ifde‡
__NO_LONG_DOUBLE_MATH


262 
	#isöf
(
x
) \

263 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

265 
	#isöf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isöff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #i‚de‡
__FAST_MATH__


280 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifde‡
__USE_GNU


287 #ifde‡
__NO_LONG_DOUBLE_MATH


288 
	#issig«lög
(
x
) \

289 ( (
x
Ë= (Ë? 
	`__issig«lögf
 (xË: 
	`__issig«lög
 (x))

	)

291 
	#issig«lög
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issig«lögf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issig«lög
 (
x
Ë: 
	`__issig«lögl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifde‡
__USE_SVID


323 #ifde‡
__˝lu•lus


324 
__ex˚±i⁄


326 
ex˚±i⁄


329 
ty≥
;

330 *
«me
;

331 
¨g1
;

332 
¨g2
;

333 
ªtvÆ
;

334 
	}
};

336 #ifde‡
__˝lu•lus


337 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

339 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifde‡
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifde‡
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

417 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

418 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

419 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

420 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

421 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

425 #ifde‡
__USE_EXTERN_INLINES


426 
	~<bôs/m©hölöe.h
>

431 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<bôs/m©h-föôe.h
>

435 #ifde‡
__USE_ISOC99


439 #i‚de‡
isgª©î


440 
	#isgª©î
(
x
, 
y
) \

441 (
__exãnsi⁄__
 \

442 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

443 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

447 #i‚de‡
isgª©îequÆ


448 
	#isgª©îequÆ
(
x
, 
y
) \

449 (
__exãnsi⁄__
 \

450 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

451 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

455 #i‚de‡
i¶ess


456 
	#i¶ess
(
x
, 
y
) \

457 (
__exãnsi⁄__
 \

458 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

459 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

463 #i‚de‡
i¶es£quÆ


464 
	#i¶es£quÆ
(
x
, 
y
) \

465 (
__exãnsi⁄__
 \

466 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

467 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

471 #i‚de‡
i¶essgª©î


472 
	#i¶essgª©î
(
x
, 
y
) \

473 (
__exãnsi⁄__
 \

474 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

475 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

479 #i‚de‡
isun‹dîed


480 
	#isun‹dîed
(
u
, 
v
) \

481 (
__exãnsi⁄__
 \

482 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

483 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/semaphore.h

18 #i‚de‡
_SEMAPHORE_H


19 
	#_SEMAPHORE_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<sys/ty≥s.h
>

23 #ifde‡
__USE_XOPEN2K


24 
	#__√ed_time•ec


	)

25 
	~<time.h
>

29 
	~<bôs/£m≠h‹e.h
>

32 
__BEGIN_DECLS


36 
	$£m_öô
 (
£m_t
 *
__£m
, 
__psh¨ed
, 
__vÆue
)

37 
__THROW
;

39 
	$£m_de°roy
 (
£m_t
 *
__£m
Ë
__THROW
;

42 
£m_t
 *
	$£m_›í
 (c⁄° *
__«me
, 
__oÊag
, ...Ë
__THROW
;

45 
	$£m_˛o£
 (
£m_t
 *
__£m
Ë
__THROW
;

48 
	$£m_u∆ök
 (c⁄° *
__«me
Ë
__THROW
;

54 
	`£m_waô
 (
£m_t
 *
__£m
);

56 #ifde‡
__USE_XOPEN2K


61 
	`£m_timedwaô
 (
£m_t
 *
__ª°ri˘
 
__£m
,

62 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
);

66 
	$£m_åywaô
 (
£m_t
 *
__£m
Ë
__THROWNL
;

69 
	$£m_po°
 (
£m_t
 *
__£m
Ë
__THROWNL
;

72 
	$£m_gëvÆue
 (
£m_t
 *
__ª°ri˘
 
__£m
, *__ª°ri˘ 
__svÆ
)

73 
__THROW
;

76 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

144 #i‡
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
Ë¯## 
L


	)

146 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

148 
	#__INT64_C
(
c
Ë¯## 
LL


	)

149 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i‡
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i‡
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i‡
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i‡
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i‡
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i‡
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #i‚de‡
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
Ë
	)
c

279 
	#INT16_C
(
c
Ë
	)
c

280 
	#INT32_C
(
c
Ë
	)
c

281 #i‡
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
Ë¯## 
L


	)

284 
	#INT64_C
(
c
Ë¯## 
LL


	)

288 
	#UINT8_C
(
c
Ë
	)
c

289 
	#UINT16_C
(
c
Ë
	)
c

290 
	#UINT32_C
(
c
Ë¯## 
U


	)

291 #i‡
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
Ë¯## 
UL


	)

294 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

298 #i‡
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
Ë¯## 
L


	)

300 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

302 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

303 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifde‡
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__exãnsi⁄__
 
__a
;

423 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

424 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

425 
	$î™d48_r
 (
__xsubi
[3],

426 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

427 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

431 *
__ª°ri˘
 
__ªsu…
)

432 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

433 
	$ƒ™d48_r
 (
__xsubi
[3],

434 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

435 *
__ª°ri˘
 
__ªsu…
)

436 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

439 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

442 
	$jønd48_r
 (
__xsubi
[3],

443 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

444 *
__ª°ri˘
 
__ªsu…
)

445 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

448 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

449 
__THROW
 
	`__n⁄nuŒ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

454 
	$lc⁄g48_r
 (
__∑øm
[7],

455 
dønd48_d©a
 *
__buf„r
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

462 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


463 
	#__mÆloc_™d_ˇŒoc_deföed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

468 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

469 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

483 
	$‰ì
 (*
__±r
Ë
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$c‰ì
 (*
__±r
Ë
__THROW
;

491 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


492 
	~<Æloˇ.h
>

495 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

496 || 
deföed
 
__USE_BSD


498 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

501 #ifde‡
__USE_XOPEN2K


503 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

504 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

507 #ifde‡
__USE_ISOC11


509 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

510 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

519 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

521 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


523 #ifde‡
__˝lu•lus


524 "C++" 
	`©_quick_exô
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

527 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

536 
__THROW
 
	`__n⁄nuŒ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

545 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


549 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

551 
__END_NAMESPACE_STD


553 #ifde‡
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

565 
__END_NAMESPACE_STD


567 #ifde‡
__USE_GNU


570 *
	$£cuª_gëív
 (c⁄° *
__«me
)

571 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

574 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


578 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


584 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

585 
__THROW
 
	`__n⁄nuŒ
 ((2));

588 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$˛óªnv
 (Ë
__THROW
;

599 #i‡
deföed
 
__USE_MISC
 \

600 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

759 #ifde‡
__USE_EXTERN_INLINES


760 
	~<bôs/°dlib-b£¨ch.h
>

765 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

766 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

767 #ifde‡
__USE_GNU


768 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

769 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

770 
	`__n⁄nuŒ
 ((1, 4));

775 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

776 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

777 
__END_NAMESPACE_STD


779 #ifde‡
__USE_ISOC99


780 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

781 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__numî
, 
__díom
)

790 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

792 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

793 
__END_NAMESPACE_STD


795 #ifde‡
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

798 
__díom
)

799 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

800 
__END_NAMESPACE_C99


804 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

805 || 
deföed
 
__USE_SVID


812 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

813 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

818 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

819 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

824 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

825 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

828 #ifde‡
__USE_MISC


830 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

831 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

833 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

834 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

835 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

836 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

837 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

842 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

843 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

844 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

846 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

847 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

854 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

855 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

856 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

866 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

867 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

870 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

874 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

875 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

877 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

878 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifde‡
__USE_SVID


888 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


899 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

900 *c⁄° *
__ª°ri˘
 
__tokís
,

901 **
__ª°ri˘
 
__vÆuï
)

902 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

906 #ifde‡
__USE_XOPEN


908 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

914 #ifde‡
__USE_XOPEN2KXSI


916 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

919 #ifde‡
__USE_XOPEN


924 
	$gø¡±
 (
__fd
Ë
__THROW
;

928 
	$u∆ock±
 (
__fd
Ë
__THROW
;

933 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

936 #ifde‡
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

941 
__THROW
 
	`__n⁄nuŒ
 ((2));

944 
	`gë±
 ();

947 #ifde‡
__USE_BSD


951 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

952 
__THROW
 
	`__n⁄nuŒ
 ((1));

955 
	~<bôs/°dlib-Êﬂt.h
>

958 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


959 
	~<bôs/°dlib.h
>

961 #ifde‡
__LDBL_COMPAT


962 
	~<bôs/°dlib-ldbl.h
>

966 #unde‡
__√ed_mÆloc_™d_ˇŒoc


968 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

39 #i‡
deföed
 
__˝lu•lus
 && (__˝lu•lu†>199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

47 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

50 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

51 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


58 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

69 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

73 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #ifde‡
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


91  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifde‡
__USE_GNU


104 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

107 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

110 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

111 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

115 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

118 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

133 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

137 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

138 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

141 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

144 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

151 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

154 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

155 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

156 
__THROW
 
	`__n⁄nuŒ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifde‡
__USE_XOPEN2K8


163 
	~<xloˇÀ.h
>

166 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

167 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

169 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

170 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

173 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

174 || 
deföed
 
__USE_XOPEN2K8


176 *
	$°rdup
 (c⁄° *
__s
)

177 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

183 #i‡
deföed
 
__USE_XOPEN2K8


184 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

185 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

188 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


190 
	#°rdu∑
(
s
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

196 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

197 
	}
}))

	)

200 
	#°∫du∑
(
s
, 
n
) \

201 (
__exãnsi⁄__
 \

203 c⁄° *
__ﬁd
 = (
s
); \

204 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

205 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

206 
__√w
[
__Àn
] = '\0'; \

207 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
°rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

218 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

221 #ifde‡
__OPTIMIZE__


222 
__exã∫_Æways_ölöe
 *

223 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


225  
__buûtö_°rchr
 (
__s
, 
__c
);

228 
__exã∫_Æways_ölöe
 const *

229 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


231  
__buûtö_°rchr
 (
__s
, 
__c
);

236 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

237 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

240 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`°ºchr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

245 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

248 #ifde‡
__OPTIMIZE__


249 
__exã∫_Æways_ölöe
 *

250 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


252  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

255 
__exã∫_Æways_ölöe
 const *

256 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


258  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

264 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifde‡
__USE_GNU


271 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

274 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

278 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

289 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

290 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

292 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

296 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

298 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

300 #ifde‡
__OPTIMIZE__


301 
__exã∫_Æways_ölöe
 *

302 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


304  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

307 
__exã∫_Æways_ölöe
 const *

308 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


310  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

313 
	}
}

315 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

316 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

319 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

323 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

324 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 const *

335 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 c⁄° *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

370 c⁄° *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (c⁄° *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 const *

482 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (c⁄° *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 const *

510 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (c⁄° *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

530 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

534 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

535 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

538 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

546 
__loˇÀ_t
 
__loc
)

547 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

549 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

550 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

558 c⁄° *
__ª°ri˘
 
__dñim
)

559 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

567 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

575 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

576 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

578 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

585 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

588 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 #i‚de‡
ba£«me


598 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£«me
 (*
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

601 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

604 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

610 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

611 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

612 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


632 
	~<bôs/°rög.h
>

635 
	~<bôs/°rög2.h
>

638 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


640 
	~<bôs/°rög3.h
>

644 
__END_DECLS


	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifde‡
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #ñi‡
deföed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #ñi‡
deföed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_BSD


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_BSD


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

637 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

638 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


639 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

646 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

648 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


660 
	$£çgΩ
 (Ë
__THROW
;

667 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

669 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


671 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

675 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

678 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

681 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

689 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

702 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


705 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

708 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


710 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

719 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


722 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

725 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


727 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

730 #ifde‡
__USE_GNU


733 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

734 
__THROW
;

738 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

739 
__THROW
;

743 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

744 
__THROW
 
__wur
;

748 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

758 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

759 || 
deföed
 
__USE_BSD


764 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

770 *
	$ây«me
 (
__fd
Ë
__THROW
;

774 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

775 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

779 
	$ißây
 (
__fd
Ë
__THROW
;

781 #i‡
deföed
 
__USE_BSD
 \

782 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

785 
	$ây¶Ÿ
 (Ë
__THROW
;

790 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

793 #ifde‡
__USE_ATFILE


796 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

797 c⁄° *
__to
, 
__Êags
)

798 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

801 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


803 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

804 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

809 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

810 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

811 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

814 #ifde‡
__USE_ATFILE


816 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

817 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

820 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

821 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

822 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

826 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

828 #ifde‡
__USE_ATFILE


830 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

831 
__THROW
 
	`__n⁄nuŒ
 ((2));

835 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

839 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

842 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

849 *
	`gëlogö
 ();

850 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


857 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__√ed_gë›t


	)

871 
	~<gë›t.h
>

875 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


879 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

883 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

886 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

887 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

891 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

897 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

899 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

900 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

906 
	$vh™gup
 (Ë
__THROW
;

909 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

917 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sˇÀ
)

919 
__THROW
 
	`__n⁄nuŒ
 ((1));

925 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

929 *
	$gëu£rshñl
 (Ë
__THROW
;

930 
	$ídu£rshñl
 (Ë
__THROW
;

931 
	$£tu£rshñl
 (Ë
__THROW
;

937 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

941 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

944 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

948 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifde‡
__USE_GNU


962 
	$syncfs
 (
__fd
Ë
__THROW
;

966 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


969 
	`gëho°id
 ();

972 
	$sync
 (Ë
__THROW
;

975 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


978 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

983 
	$gëdèbÀsize
 (Ë
__THROW
;

989 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


992 #i‚de‡
__USE_FILE_OFFSET64


993 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

994 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

996 #ifde‡
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
åunˇã
,

998 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

999 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1001 
	#åunˇã
 
åunˇã64


	)

1004 #ifde‡
__USE_LARGEFILE64


1005 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1006 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1011 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX199309
 \

1012 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1015 #i‚de‡
__USE_FILE_OFFSET64


1016 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1018 #ifde‡
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1020 
·runˇã64
Ë
__wur
;

1022 
	#·runˇã
 
·runˇã64


	)

1025 #ifde‡
__USE_LARGEFILE64


1026 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1032 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1033 || 
deföed
 
__USE_MISC


1037 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1043 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1047 #ifde‡
__USE_MISC


1058 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1063 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #i‚de‡
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1083 #ifde‡
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1085 
lockf64
Ë
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifde‡
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1096 #ifde‡
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1102 (
__exãnsi⁄__
 \

1103 ({ 
__ªsu…
; \

1104 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1105 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1106 
__ªsu…
; 
	}
}))

	)

1109 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1112 
fd©async
 (
__fûdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1121 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1125 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

1126 
__THROW
 
	`__n⁄nuŒ
 ((1));

1133 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1134 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1140 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1142 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1147 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1148 
	~<bôs/uni°d.h
>

1151 
__END_DECLS


	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifde‡
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifde‡
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/xine.h

39 #i‚de‡
HAVE_XINE_H


40 
	#HAVE_XINE_H


	)

42 #ifde‡
__˝lu•lus


46 
	~<sys/ty≥s.h
>

47 
	~<sys/time.h
>

48 
	~<time.h
>

49 
	~<°d¨g.h
>

51 #ifde‡
WIN32


52 
	~<wödows.h
>

53 
	~<wödowsx.h
>

56 #ifde‡
XINE_COMPILE


57 
	~<öây≥s.h
>

58 
	~"©åibuãs.h
"

60 
	~<xöe/os_ty≥s.h
>

61 
	~<xöe/©åibuãs.h
>

83 
xöe_s
 
	txöe_t
;

84 
xöe_°ªam_s
 
	txöe_°ªam_t
;

85 
xöe_audio_p‹t_s
 
	txöe_audio_p‹t_t
;

86 
xöe_video_p‹t_s
 
	txöe_video_p‹t_t
;

88 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


90 
xöe_audio_p‹t_t
 
	txöe_ao_drivî_t
 
	tXINE_DEPRECATED
;

91 
xöe_video_p‹t_t
 
	txöe_vo_drivî_t
 
	tXINE_DEPRECATED
;

104 c⁄° *
xöe_gë_vîsi⁄_°rög
 (Ë
XINE_PROTECTED
;

105 
xöe_gë_vîsi⁄
 (*
maj‹
, *
mö‹
, *
sub
Ë
XINE_PROTECTED
;

109 
xöe_check_vîsi⁄
 (
maj‹
, 
mö‹
, 
sub
Ë
XINE_PROTECTED
;

112 
	#XINE_MAJOR_VERSION
 1

	)

113 
	#XINE_MINOR_VERSION
 1

	)

114 
	#XINE_SUB_VERSION
 21

	)

115 
	#XINE_VERSION
 "1.1.21"

	)

133 
xöe_t
 *
xöe_√w
 (Ë
XINE_PROTECTED
;

138 
xöe_£t_Êags
 (
xöe_t
 *, Ë
XINE_PROTECTED
 
__©åibuã__
((
wók
));

139 
	#XINE_FLAG_NO_WRITE_CACHE
 1

	)

144 
xöe_öô
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

161 
xöe_audio_p‹t_t
 *
xöe_›í_audio_drivî
 (
xöe_t
 *
£lf
, c⁄° *
id
,

162 *
d©a
Ë
XINE_PROTECTED
;

163 
xöe_video_p‹t_t
 *
xöe_›í_video_drivî
 (
xöe_t
 *
£lf
, c⁄° *
id
,

164 
visuÆ
, *
d©a
Ë
XINE_PROTECTED
;

166 
xöe_˛o£_audio_drivî
 (
xöe_t
 *
£lf
, 
xöe_audio_p‹t_t
 *
drivî
Ë
XINE_PROTECTED
;

167 
xöe_˛o£_video_drivî
 (
xöe_t
 *
£lf
, 
xöe_video_p‹t_t
 *
drivî
Ë
XINE_PROTECTED
;

170 
	#XINE_VISUAL_TYPE_NONE
 0

	)

171 
	#XINE_VISUAL_TYPE_X11
 1

	)

172 
	#XINE_VISUAL_TYPE_X11_2
 10

	)

173 
	#XINE_VISUAL_TYPE_AA
 2

	)

174 
	#XINE_VISUAL_TYPE_FB
 3

	)

175 
	#XINE_VISUAL_TYPE_GTK
 4

	)

176 
	#XINE_VISUAL_TYPE_DFB
 5

	)

177 
	#XINE_VISUAL_TYPE_PM
 6

	)

178 
	#XINE_VISUAL_TYPE_DIRECTX
 7

	)

179 
	#XINE_VISUAL_TYPE_CACA
 8

	)

180 
	#XINE_VISUAL_TYPE_MACOSX
 9

	)

181 
	#XINE_VISUAL_TYPE_XCB
 11

	)

182 
	#XINE_VISUAL_TYPE_RAW
 12

	)

188 
xöe_exô
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

206 
xöe_°ªam_t
 *
xöe_°ªam_√w
 (
xöe_t
 *
£lf
,

207 
xöe_audio_p‹t_t
 *
ao
, 
xöe_video_p‹t_t
 *
vo
Ë
XINE_PROTECTED
;

227 
xöe_°ªam_ma°î_¶ave
(
xöe_°ªam_t
 *
ma°î
, xöe_°ªam_à*
¶ave
,

228 
af„˘i⁄
Ë
XINE_PROTECTED
;

232 
	#XINE_MASTER_SLAVE_PLAY
 (1<<0)

	)

234 
	#XINE_MASTER_SLAVE_STOP
 (1<<1)

	)

236 
	#XINE_MASTER_SLAVE_SPEED
 (1<<2)

	)

246 
xöe_›í
 (
xöe_°ªam_t
 *
°ªam
, c⁄° *
mæ
Ë
XINE_PROTECTED
;

258 
xöe_∂ay
 (
xöe_°ªam_t
 *
°ªam
, 
°¨t_pos
, 
°¨t_time
Ë
XINE_PROTECTED
;

267 
xöe_åick_mode
 (
xöe_°ªam_t
 *
°ªam
, 
mode
, 
vÆue
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

270 
	#XINE_TRICK_MODE_OFF
 0

	)

271 
	#XINE_TRICK_MODE_SEEK_TO_POSITION
 1

	)

272 
	#XINE_TRICK_MODE_SEEK_TO_TIME
 2

	)

273 
	#XINE_TRICK_MODE_FAST_FORWARD
 3

	)

274 
	#XINE_TRICK_MODE_FAST_REWIND
 4

	)

280 
xöe_°›
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

286 
xöe_˛o£
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

292 
xöe_eje˘
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

298 
xöe_di•o£
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

303 
xöe_ígöe_£t_∑øm
(
xöe_t
 *
£lf
, 
∑øm
, 
vÆue
Ë
XINE_PROTECTED
;

304 
xöe_ígöe_gë_∑øm
(
xöe_t
 *
£lf
, 
∑øm
Ë
XINE_PROTECTED
;

306 
	#XINE_ENGINE_PARAM_VERBOSITY
 1

	)

312 
xöe_£t_∑øm
 (
xöe_°ªam_t
 *
°ªam
, 
∑øm
, 
vÆue
Ë
XINE_PROTECTED
;

313 
xöe_gë_∑øm
 (
xöe_°ªam_t
 *
°ªam
, 
∑øm
Ë
XINE_PROTECTED
;

318 
	#XINE_PARAM_SPEED
 1

	)

319 
	#XINE_PARAM_AV_OFFSET
 2

	)

320 
	#XINE_PARAM_AUDIO_CHANNEL_LOGICAL
 3

	)

321 
	#XINE_PARAM_SPU_CHANNEL
 4

	)

322 
	#XINE_PARAM_VIDEO_CHANNEL
 5

	)

323 
	#XINE_PARAM_AUDIO_VOLUME
 6

	)

324 
	#XINE_PARAM_AUDIO_MUTE
 7

	)

325 
	#XINE_PARAM_AUDIO_COMPR_LEVEL
 8

	)

326 
	#XINE_PARAM_AUDIO_AMP_LEVEL
 9

	)

327 
	#XINE_PARAM_AUDIO_REPORT_LEVEL
 10

	)

328 
	#XINE_PARAM_VERBOSITY
 11

	)

329 
	#XINE_PARAM_SPU_OFFSET
 12

	)

330 
	#XINE_PARAM_IGNORE_VIDEO
 13

	)

331 
	#XINE_PARAM_IGNORE_AUDIO
 14

	)

332 
	#XINE_PARAM_IGNORE_SPU
 15

	)

333 
	#XINE_PARAM_BROADCASTER_PORT
 16

	)

334 
	#XINE_PARAM_METRONOM_PREBUFFER
 17

	)

335 
	#XINE_PARAM_EQ_30HZ
 18

	)

336 
	#XINE_PARAM_EQ_60HZ
 19

	)

337 
	#XINE_PARAM_EQ_125HZ
 20

	)

338 
	#XINE_PARAM_EQ_250HZ
 21

	)

339 
	#XINE_PARAM_EQ_500HZ
 22

	)

340 
	#XINE_PARAM_EQ_1000HZ
 23

	)

341 
	#XINE_PARAM_EQ_2000HZ
 24

	)

342 
	#XINE_PARAM_EQ_4000HZ
 25

	)

343 
	#XINE_PARAM_EQ_8000HZ
 26

	)

344 
	#XINE_PARAM_EQ_16000HZ
 27

	)

345 
	#XINE_PARAM_AUDIO_CLOSE_DEVICE
 28

	)

346 
	#XINE_PARAM_AUDIO_AMP_MUTE
 29

	)

347 
	#XINE_PARAM_FINE_SPEED
 30

	)

348 
	#XINE_PARAM_EARLY_FINISHED_EVENT
 31

	)

349 
	#XINE_PARAM_GAPLESS_SWITCH
 32

	)

350 
	#XINE_PARAM_DELAY_FINISHED_EVENT
 33

	)

359 
	#XINE_SPEED_PAUSE
 0

	)

360 
	#XINE_SPEED_SLOW_4
 1

	)

361 
	#XINE_SPEED_SLOW_2
 2

	)

362 
	#XINE_SPEED_NORMAL
 4

	)

363 
	#XINE_SPEED_FAST_2
 8

	)

364 
	#XINE_SPEED_FAST_4
 16

	)

367 
	#XINE_FINE_SPEED_NORMAL
 1000000

	)

370 
	#XINE_PARAM_VO_DEINTERLACE
 0x01000000

	)

371 
	#XINE_PARAM_VO_ASPECT_RATIO
 0x01000001

	)

372 
	#XINE_PARAM_VO_HUE
 0x01000002

	)

373 
	#XINE_PARAM_VO_SATURATION
 0x01000003

	)

374 
	#XINE_PARAM_VO_CONTRAST
 0x01000004

	)

375 
	#XINE_PARAM_VO_BRIGHTNESS
 0x01000005

	)

376 
	#XINE_PARAM_VO_GAMMA
 0x0100000¯

	)

377 
	#XINE_PARAM_VO_ZOOM_X
 0x01000008

	)

378 
	#XINE_PARAM_VO_ZOOM_Y
 0x0100000d

	)

379 
	#XINE_PARAM_VO_PAN_SCAN
 0x01000009

	)

380 
	#XINE_PARAM_VO_TVMODE
 0x0100000®

	)

381 
	#XINE_PARAM_VO_WINDOW_WIDTH
 0x0100000‡

	)

382 
	#XINE_PARAM_VO_WINDOW_HEIGHT
 0x01000010

	)

383 
	#XINE_PARAM_VO_CROP_LEFT
 0x01000020

	)

384 
	#XINE_PARAM_VO_CROP_RIGHT
 0x01000021

	)

385 
	#XINE_PARAM_VO_CROP_TOP
 0x01000022

	)

386 
	#XINE_PARAM_VO_CROP_BOTTOM
 0x01000023

	)

389 
	#XINE_VO_ZOOM_STEP
 100

	)

390 
	#XINE_VO_ZOOM_MAX
 400

	)

391 
	#XINE_VO_ZOOM_MIN
 -85

	)

394 
	#XINE_VO_ASPECT_AUTO
 0

	)

395 
	#XINE_VO_ASPECT_SQUARE
 1

	)

396 
	#XINE_VO_ASPECT_4_3
 2

	)

397 
	#XINE_VO_ASPECT_ANAMORPHIC
 3

	)

398 
	#XINE_VO_ASPECT_DVB
 4

	)

399 
	#XINE_VO_ASPECT_NUM_RATIOS
 5

	)

400 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


401 
	#XINE_VO_ASPECT_PAN_SCAN
 41

	)

402 
	#XINE_VO_ASPECT_DONT_TOUCH
 42

	)

408 
	#XINE_DEMUX_DEFAULT_STRATEGY
 0

	)

410 
	#XINE_DEMUX_REVERT_STRATEGY
 1

	)

412 
	#XINE_DEMUX_CONTENT_STRATEGY
 2

	)

414 
	#XINE_DEMUX_EXTENSION_STRATEGY
 3

	)

417 
	#XINE_VERBOSITY_NONE
 0

	)

418 
	#XINE_VERBOSITY_LOG
 1

	)

419 
	#XINE_VERBOSITY_DEBUG
 2

	)

449 
xöe_gë_cuºít_‰ame
 (
xöe_°ªam_t
 *
°ªam
,

450 *
width
, *
height
,

451 *
øtio_code
, *
f‹m©
,

452 
uöt8_t
 *
img
Ë
XINE_PROTECTED
;

454 
xöe_gë_cuºít_‰ame_s
 (
xöe_°ªam_t
 *
°ªam
,

455 *
width
, *
height
,

456 *
øtio_code
, *
f‹m©
,

457 
uöt8_t
 *
img
, *
img_size
Ë
XINE_PROTECTED
;

459 
xöe_gë_cuºít_‰ame_Æloc
 (
xöe_°ªam_t
 *
°ªam
,

460 *
width
, *
height
,

461 *
øtio_code
, *
f‹m©
,

462 
uöt8_t
 **
img
, *
img_size
Ë
XINE_PROTECTED
;

466 
width
;

467 
height
;

468 
¸›_À·
;

469 
¸›_right
;

470 
¸›_t›
;

471 
¸›_bŸtom
;

472 
øtio_code
;

473 
öãæa˚d
;

474 
f‹m©
;

475 
img_size
;

476 
uöt8_t
 *
img
;

477 } 
	txöe_cuºít_‰ame_d©a_t
;

479 
	#XINE_FRAME_DATA_ALLOCATE_IMG
 (1<<0)

	)

481 
xöe_gë_cuºít_‰ame_d©a
 (
xöe_°ªam_t
 *
°ªam
,

482 
xöe_cuºít_‰ame_d©a_t
 *
d©a
,

483 
Êags
Ë
XINE_PROTECTED
;

486 
	#XINE_IMGFMT_YV12
 (('2'<<24)|('1'<<16)|('V'<<8)|'Y')

	)

487 
	#XINE_IMGFMT_YUY2
 (('2'<<24)|('Y'<<16)|('U'<<8)|'Y')

	)

488 
	#XINE_IMGFMT_XVMC
 (('C'<<24)|('M'<<16)|('v'<<8)|'X')

	)

489 
	#XINE_IMGFMT_XXMC
 (('C'<<24)|('M'<<16)|('x'<<8)|'X')

	)

495 
öt64_t
 
xöe_gë_cuºít_v±s
(
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

502 #ifde‡
XINE_ENABLE_EXPERIMENTAL_FEATURES


517 
xöe_video_p‹t_t
 *
xöe_√w_‰amegøb_video_p‹t
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

521 
öt64_t
 
v±s
;

522 
öt64_t
 
duøti⁄
;

523 
width
, 
height
;

524 
cﬁ‹•a˚
;

525 
a•e˘_øtio
;

527 
pos_°ªam
;

528 
pos_time
;

530 
uöt8_t
 *
d©a
;

531 *
xöe_‰ame
;

533 
‰ame_numbî
;

534 } 
	txöe_video_‰ame_t
;

536 
xöe_gë_√xt_video_‰ame
 (
xöe_video_p‹t_t
 *
p‹t
,

537 
xöe_video_‰ame_t
 *
‰ame
Ë
XINE_PROTECTED
;

539 
xöe_‰ì_video_‰ame
 (
xöe_video_p‹t_t
 *
p‹t
, 
xöe_video_‰ame_t
 *
‰ame
Ë
XINE_PROTECTED
;

541 
xöe_audio_p‹t_t
 *
xöe_√w_‰amegøb_audio_p‹t
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

545 
öt64_t
 
v±s
;

546 
num_ßm∂es
;

547 
ßm∂e_øã
;

548 
num_ch™√ls
;

549 
bôs_≥r_ßm∂e
;

551 
off_t
 
pos_°ªam
;

552 
pos_time
;

554 
uöt8_t
 *
d©a
;

555 *
xöe_‰ame
;

556 } 
	txöe_audio_‰ame_t
;

558 
xöe_gë_√xt_audio_‰ame
 (
xöe_audio_p‹t_t
 *
p‹t
,

559 
xöe_audio_‰ame_t
 *
‰ame
Ë
XINE_PROTECTED
;

561 
xöe_‰ì_audio_‰ame
 (
xöe_audio_p‹t_t
 *
p‹t
, 
xöe_audio_‰ame_t
 *
‰ame
Ë
XINE_PROTECTED
;

567 
xöe_gë_video_‰ame
 (
xöe_°ªam_t
 *
°ªam
,

568 
time°amp
,

569 *
width
, *
height
,

570 *
øtio_code
,

571 *
duøti⁄
,

572 *
f‹m©
,

573 
uöt8_t
 *
img
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

592 
xöe_po°_s
 
	txöe_po°_t
;

594 
	sxöe_po°_s
 {

600 
xöe_audio_p‹t_t
 **
audio_öput
;

606 
xöe_video_p‹t_t
 **
video_öput
;

611 
ty≥
;

625 
xöe_po°_t
 *
xöe_po°_öô
(
xöe_t
 *
xöe
, c⁄° *
«me
,

626 
öputs
,

627 
xöe_audio_p‹t_t
 **
audio_èrgë
,

628 
xöe_video_p‹t_t
 **
video_èrgë
Ë
XINE_PROTECTED
;

631 c⁄° *c⁄° *
xöe_li°_po°_∂ugös
(
xöe_t
 *
xöe
Ë
XINE_PROTECTED
;

634 c⁄° *c⁄° *
xöe_li°_po°_∂ugös_ty≥d
(
xöe_t
 *
xöe
, 
ty≥
Ë
XINE_PROTECTED
;

645 
xöe_po°_ö_s
 
	txöe_po°_ö_t
;

646 
xöe_po°_out_s
 
	txöe_po°_out_t
;

648 
	sxöe_po°_ö_s
 {

651 c⁄° *
«me
;

654 
ty≥
;

658 *
d©a
;

662 
	sxöe_po°_out_s
 {

665 c⁄° *
«me
;

668 
ty≥
;

672 *
d©a
;

683 (*
ªwúe
Ë(
xöe_po°_out_t
 *
£lf
, *
d©a
);

688 c⁄° *c⁄° *
xöe_po°_li°_öputs
(
xöe_po°_t
 *
£lf
Ë
XINE_PROTECTED
;

691 c⁄° *c⁄° *
xöe_po°_li°_ouçuts
(
xöe_po°_t
 *
£lf
Ë
XINE_PROTECTED
;

694 
xöe_po°_ö_t
 *
xöe_po°_öput
(
xöe_po°_t
 *
£lf
, c⁄° *
«me
Ë
XINE_PROTECTED
;

697 
xöe_po°_out_t
 *
xöe_po°_ouçut
(
xöe_po°_t
 *
£lf
, c⁄° *
«me
Ë
XINE_PROTECTED
;

703 
xöe_po°_wúe
(
xöe_po°_out_t
 *
sour˚
, 
xöe_po°_ö_t
 *
èrgë
Ë
XINE_PROTECTED
;

714 
xöe_po°_wúe_video_p‹t
(
xöe_po°_out_t
 *
sour˚
, 
xöe_video_p‹t_t
 *
vo
Ë
XINE_PROTECTED
;

725 
xöe_po°_wúe_audio_p‹t
(
xöe_po°_out_t
 *
sour˚
, 
xöe_audio_p‹t_t
 *
ao
Ë
XINE_PROTECTED
;

730 
xöe_po°_out_t
 * 
xöe_gë_video_sour˚
(
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

731 
xöe_po°_out_t
 * 
xöe_gë_audio_sour˚
(
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

738 
xöe_po°_di•o£
(
xöe_t
 *
xöe
, 
xöe_po°_t
 *
£lf
Ë
XINE_PROTECTED
;

742 
	#XINE_POST_TYPE_VIDEO_FILTER
 0x010000

	)

743 
	#XINE_POST_TYPE_VIDEO_VISUALIZATION
 0x010001

	)

744 
	#XINE_POST_TYPE_VIDEO_COMPOSE
 0x010002

	)

745 
	#XINE_POST_TYPE_AUDIO_FILTER
 0x020000

	)

746 
	#XINE_POST_TYPE_AUDIO_VISUALIZATION
 0x020001

	)

755 
	#XINE_POST_DATA_VIDEO
 0

	)

761 
	#XINE_POST_DATA_AUDIO
 1

	)

767 
	#XINE_POST_DATA_INT
 3

	)

773 
	#XINE_POST_DATA_DOUBLE
 4

	)

778 
	#XINE_POST_DATA_PARAMETERS
 5

	)

782 
ty≥
;

783 *
«me
;

784 
size
;

785 
off£t
;

786 **
íum_vÆues
;

787 
ønge_mö
;

788 
ønge_max
;

789 
ªad⁄ly
;

790 *
des¸ùti⁄
;

791 } 
	txöe_po°_≠i_∑ømëî_t
;

795 
°ru˘_size
;

796 
xöe_po°_≠i_∑ømëî_t
 *
∑ømëî
;

797 } 
	txöe_po°_≠i_des¸_t
;

804 (*
£t_∑ømëîs
Ë(
xöe_po°_t
 *
£lf
, *
∑øms
);

809 (*
gë_∑ømëîs
Ë(
xöe_po°_t
 *
£lf
, *
∑øms
);

814 
xöe_po°_≠i_des¸_t
 * (*
gë_∑øm_des¸
) ();

821 * (*
gë_hñp
) ();

822 } 
	txöe_po°_≠i_t
;

825 
	#POST_PARAM_TYPE_LAST
 0

	)

826 
	#POST_PARAM_TYPE_INT
 1

	)

827 
	#POST_PARAM_TYPE_DOUBLE
 2

	)

828 
	#POST_PARAM_TYPE_CHAR
 3

	)

829 
	#POST_PARAM_TYPE_STRING
 4

	)

830 
	#POST_PARAM_TYPE_STRINGLIST
 5

	)

831 
	#POST_PARAM_TYPE_BOOL
 6

	)

843 
xöe_gë_log_£˘i⁄_cou¡
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

846 c⁄° *c⁄° *
xöe_gë_log_«mes
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

849 
xöe_log
 (
xöe_t
 *
£lf
, 
buf
,

850 c⁄° *
f‹m©
, ...Ë
XINE_FORMAT_PRINTF
(3, 4Ë
XINE_PROTECTED
;

851 
xöe_vlog
(
xöe_t
 *
£lf
, 
buf
,

852 c⁄° *
f‹m©
, 
va_li°
 
¨gs
Ë
XINE_FORMAT_PRINTF
(3, 0Ë
XINE_PROTECTED
;

855 *c⁄° *
xöe_gë_log
 (
xöe_t
 *
£lf
, 
buf
Ë
XINE_PROTECTED
;

858 (*
xöe_log_cb_t
Ë(*
	tu£r_d©a
, 
	t£˘i⁄
);

859 
xöe_ªgi°î_log_cb
 (
xöe_t
 *
£lf
, 
xöe_log_cb_t
 
cb
,

860 *
u£r_d©a
Ë
XINE_PROTECTED
;

867 
xöe_gë_îr‹
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

870 
xöe_gë_°©us
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

875 
	#XINE_STATUS_IDLE
 0

	)

876 
	#XINE_STATUS_STOP
 1

	)

877 
	#XINE_STATUS_PLAY
 2

	)

878 
	#XINE_STATUS_QUIT
 3

	)

883 
	#XINE_ERROR_NONE
 0

	)

884 
	#XINE_ERROR_NO_INPUT_PLUGIN
 1

	)

885 
	#XINE_ERROR_NO_DEMUX_PLUGIN
 2

	)

886 
	#XINE_ERROR_DEMUX_FAILED
 3

	)

887 
	#XINE_ERROR_MALFORMED_MRL
 4

	)

888 
	#XINE_ERROR_INPUT_FAILED
 5

	)

898 
xöe_gë_audio_œng
 (
xöe_°ªam_t
 *
°ªam
, 
ch™√l
,

899 *
œng
Ë
XINE_PROTECTED
;

900 
xöe_gë_•u_œng
 (
xöe_°ªam_t
 *
°ªam
, 
ch™√l
,

901 *
œng
Ë
XINE_PROTECTED
;

902 
	#XINE_LANG_MAX
 32

	)

914 
xöe_gë_pos_Àngth
 (
xöe_°ªam_t
 *
°ªam
,

915 *
pos_°ªam
,

916 *
pos_time
,

917 *
Àngth_time
)

918 
XINE_PROTECTED
;

927 
uöt32_t
 
xöe_gë_°ªam_öfo
 (
xöe_°ªam_t
 *
°ªam
, 
öfo
Ë
XINE_PROTECTED
;

928 c⁄° *
xöe_gë_mëa_öfo
 (
xöe_°ªam_t
 *
°ªam
, 
öfo
Ë
XINE_PROTECTED
;

931 
	#XINE_STREAM_INFO_BITRATE
 0

	)

932 
	#XINE_STREAM_INFO_SEEKABLE
 1

	)

933 
	#XINE_STREAM_INFO_VIDEO_WIDTH
 2

	)

934 
	#XINE_STREAM_INFO_VIDEO_HEIGHT
 3

	)

935 
	#XINE_STREAM_INFO_VIDEO_RATIO
 4

	)

936 
	#XINE_STREAM_INFO_VIDEO_CHANNELS
 5

	)

937 
	#XINE_STREAM_INFO_VIDEO_STREAMS
 6

	)

938 
	#XINE_STREAM_INFO_VIDEO_BITRATE
 7

	)

939 
	#XINE_STREAM_INFO_VIDEO_FOURCC
 8

	)

940 
	#XINE_STREAM_INFO_VIDEO_HANDLED
 9

	)

941 
	#XINE_STREAM_INFO_FRAME_DURATION
 10

	)

942 
	#XINE_STREAM_INFO_AUDIO_CHANNELS
 11

	)

943 
	#XINE_STREAM_INFO_AUDIO_BITS
 12

	)

944 
	#XINE_STREAM_INFO_AUDIO_SAMPLERATE
 13

	)

945 
	#XINE_STREAM_INFO_AUDIO_BITRATE
 14

	)

946 
	#XINE_STREAM_INFO_AUDIO_FOURCC
 15

	)

947 
	#XINE_STREAM_INFO_AUDIO_HANDLED
 16

	)

948 
	#XINE_STREAM_INFO_HAS_CHAPTERS
 17

	)

949 
	#XINE_STREAM_INFO_HAS_VIDEO
 18

	)

950 
	#XINE_STREAM_INFO_HAS_AUDIO
 19

	)

951 
	#XINE_STREAM_INFO_IGNORE_VIDEO
 20

	)

952 
	#XINE_STREAM_INFO_IGNORE_AUDIO
 21

	)

953 
	#XINE_STREAM_INFO_IGNORE_SPU
 22

	)

954 
	#XINE_STREAM_INFO_VIDEO_HAS_STILL
 23

	)

955 
	#XINE_STREAM_INFO_MAX_AUDIO_CHANNEL
 24

	)

956 
	#XINE_STREAM_INFO_MAX_SPU_CHANNEL
 25

	)

957 
	#XINE_STREAM_INFO_AUDIO_MODE
 26

	)

958 
	#XINE_STREAM_INFO_SKIPPED_FRAMES
 27

	)

959 
	#XINE_STREAM_INFO_DISCARDED_FRAMES
 28

	)

960 
	#XINE_STREAM_INFO_VIDEO_AFD
 29

	)

961 
	#XINE_STREAM_INFO_DVD_TITLE_NUMBER
 30

	)

962 
	#XINE_STREAM_INFO_DVD_TITLE_COUNT
 31

	)

963 
	#XINE_STREAM_INFO_DVD_CHAPTER_NUMBER
 32

	)

964 
	#XINE_STREAM_INFO_DVD_CHAPTER_COUNT
 33

	)

965 
	#XINE_STREAM_INFO_DVD_ANGLE_NUMBER
 34

	)

966 
	#XINE_STREAM_INFO_DVD_ANGLE_COUNT
 35

	)

969 
	#XINE_VIDEO_AFD_NOT_PRESENT
 -1

	)

970 
	#XINE_VIDEO_AFD_RESERVED_0
 0

	)

971 
	#XINE_VIDEO_AFD_RESERVED_1
 1

	)

972 
	#XINE_VIDEO_AFD_BOX_16_9_TOP
 2

	)

973 
	#XINE_VIDEO_AFD_BOX_14_9_TOP
 3

	)

974 
	#XINE_VIDEO_AFD_BOX_GT_16_9_CENTRE
 4

	)

975 
	#XINE_VIDEO_AFD_RESERVED_5
 5

	)

976 
	#XINE_VIDEO_AFD_RESERVED_6
 6

	)

977 
	#XINE_VIDEO_AFD_RESERVED_7
 7

	)

978 
	#XINE_VIDEO_AFD_SAME_AS_FRAME
 8

	)

979 
	#XINE_VIDEO_AFD_4_3_CENTRE
 9

	)

980 
	#XINE_VIDEO_AFD_16_9_CENTRE
 10

	)

981 
	#XINE_VIDEO_AFD_14_9_CENTRE
 11

	)

982 
	#XINE_VIDEO_AFD_RESERVED_12
 12

	)

983 
	#XINE_VIDEO_AFD_4_3_PROTECT_14_9
 13

	)

984 
	#XINE_VIDEO_AFD_16_9_PROTECT_14_9
 14

	)

985 
	#XINE_VIDEO_AFD_16_9_PROTECT_4_3
 15

	)

988 
	#XINE_META_INFO_TITLE
 0

	)

989 
	#XINE_META_INFO_COMMENT
 1

	)

990 
	#XINE_META_INFO_ARTIST
 2

	)

991 
	#XINE_META_INFO_GENRE
 3

	)

992 
	#XINE_META_INFO_ALBUM
 4

	)

993 
	#XINE_META_INFO_YEAR
 5

	)

994 
	#XINE_META_INFO_VIDEOCODEC
 6

	)

995 
	#XINE_META_INFO_AUDIOCODEC
 7

	)

996 
	#XINE_META_INFO_SYSTEMLAYER
 8

	)

997 
	#XINE_META_INFO_INPUT_PLUGIN
 9

	)

998 
	#XINE_META_INFO_CDINDEX_DISCID
 10

	)

999 
	#XINE_META_INFO_TRACK_NUMBER
 11

	)

1000 
	#XINE_META_INFO_COMPOSER
 12

	)

1002 
	#XINE_META_INFO_PUBLISHER
 13

	)

1003 
	#XINE_META_INFO_COPYRIGHT
 14

	)

1004 
	#XINE_META_INFO_LICENSE
 15

	)

1005 
	#XINE_META_INFO_ARRANGER
 16

	)

1006 
	#XINE_META_INFO_LYRICIST
 17

	)

1007 
	#XINE_META_INFO_AUTHOR
 18

	)

1008 
	#XINE_META_INFO_CONDUCTOR
 19

	)

1009 
	#XINE_META_INFO_PERFORMER
 20

	)

1010 
	#XINE_META_INFO_ENSEMBLE
 21

	)

1011 
	#XINE_META_INFO_OPUS
 22

	)

1012 
	#XINE_META_INFO_PART
 23

	)

1013 
	#XINE_META_INFO_PARTNUMBER
 24

	)

1014 
	#XINE_META_INFO_LOCATION
 25

	)

1016 
	#XINE_META_INFO_DISCNUMBER
 26

	)

1032 *
‹igö
;

1033 *
mæ
;

1034 *
lök
;

1035 
uöt32_t
 
ty≥
;

1036 
off_t
 
size
;

1037 } 
	txöe_mæ_t
;

1040 
	#XINE_MRL_TYPE_unknown
 (0 << 0)

	)

1041 
	#XINE_MRL_TYPE_dvd
 (1 << 0)

	)

1042 
	#XINE_MRL_TYPE_vcd
 (1 << 1)

	)

1043 
	#XINE_MRL_TYPE_√t
 (1 << 2)

	)

1044 
	#XINE_MRL_TYPE_πp
 (1 << 3)

	)

1045 
	#XINE_MRL_TYPE_°dö
 (1 << 4)

	)

1046 
	#XINE_MRL_TYPE_cda
 (1 << 5)

	)

1047 
	#XINE_MRL_TYPE_fûe
 (1 << 6)

	)

1048 
	#XINE_MRL_TYPE_fûe_fifo
 (1 << 7)

	)

1049 
	#XINE_MRL_TYPE_fûe_ch¨dev
 (1 << 8)

	)

1050 
	#XINE_MRL_TYPE_fûe_dúe˘‹y
 (1 << 9)

	)

1051 
	#XINE_MRL_TYPE_fûe_blockdev
 (1 << 10)

	)

1052 
	#XINE_MRL_TYPE_fûe_n‹mÆ
 (1 << 11)

	)

1053 
	#XINE_MRL_TYPE_fûe_symlök
 (1 << 12)

	)

1054 
	#XINE_MRL_TYPE_fûe_sock
 (1 << 13)

	)

1055 
	#XINE_MRL_TYPE_fûe_exec
 (1 << 14)

	)

1056 
	#XINE_MRL_TYPE_fûe_backup
 (1 << 15)

	)

1057 
	#XINE_MRL_TYPE_fûe_hiddí
 (1 << 16)

	)

1060 c⁄° *c⁄° *
xöe_gë_browßbÀ_öput_∂ugö_ids
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1070 
xöe_mæ_t
 **
xöe_gë_brow£_mæs
 (
xöe_t
 *
£lf
,

1071 c⁄° *
∂ugö_id
,

1072 c⁄° *
°¨t_mæ
,

1073 *
num_mæs
Ë
XINE_PROTECTED
;

1076 c⁄° *c⁄° *
xöe_gë_aut›œy_öput_∂ugö_ids
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1079 **
xöe_gë_aut›œy_mæs
 (
xöe_t
 *
£lf
,

1080 c⁄° *
∂ugö_id
,

1081 *
num_mæs
Ë
XINE_PROTECTED
;

1087 *
xöe_gë_fûe_exãnsi⁄s
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1092 *
xöe_gë_mime_ty≥s
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1098 *
xöe_gë_demux_f‹_mime_ty≥
 (
xöe_t
 *
£lf
, c⁄° *
mime_ty≥
Ë
XINE_PROTECTED
;

1101 c⁄° *
xöe_gë_öput_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1102 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1103 c⁄° *
xöe_gë_demux_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1104 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1105 c⁄° *
xöe_gë_•u_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1106 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1107 c⁄° *
xöe_gë_audio_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1108 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1109 c⁄° *
xöe_gë_video_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1110 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1111 c⁄° *
xöe_gë_audio_drivî_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1112 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1113 c⁄° *
xöe_gë_video_drivî_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1114 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1115 c⁄° *
xöe_gë_po°_∂ugö_des¸ùti⁄
 (
xöe_t
 *
£lf
,

1116 c⁄° *
∂ugö_id
Ë
XINE_PROTECTED
;

1119 c⁄° *c⁄° *
xöe_li°_audio_ouçut_∂ugös
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1120 c⁄° *c⁄° *
xöe_li°_video_ouçut_∂ugös
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1122 c⁄° *c⁄° *
xöe_li°_video_ouçut_∂ugös_ty≥d
 (
xöe_t
 *
£lf
, 
uöt64_t
 
ty≥mask
Ë
XINE_PROTECTED
;

1125 c⁄° *c⁄° *
xöe_li°_demuxî_∂ugös
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1128 c⁄° *c⁄° *
xöe_li°_öput_∂ugös
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1131 c⁄° *c⁄° *
xöe_li°_•u_∂ugös
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1134 c⁄° *c⁄° *
xöe_li°_audio_decodî_∂ugös
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1135 c⁄° *c⁄° *
xöe_li°_video_decodî_∂ugös
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1138 
xöe_∂ugös_g¨bage_cﬁÀ˘‹
(
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1145 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


1147 
xöe_gui_£nd_vo_d©a
 (
xöe_°ªam_t
 *
£lf
,

1148 
ty≥
, *
d©a
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

1152 
xöe_p‹t_£nd_gui_d©a
 (
xöe_video_p‹t_t
 *
vo
,

1153 
ty≥
, *
d©a
Ë
XINE_PROTECTED
;

1158 
x
,
y
,
w
,
h
;

1160 } 
	tx11_ª˘™gÀ_t
;

1170 *
di•œy
;

1171 
s¸ìn
;

1174 
d
;

1176 *
u£r_d©a
;

1197 (*
de°_size_cb
Ë(*
u£r_d©a
,

1198 
video_width
, 
video_height
,

1199 
video_pixñ_a•e˘
,

1200 *
de°_width
, *
de°_height
,

1201 *
de°_pixñ_a•e˘
);

1228 (*
‰ame_ouçut_cb
Ë(*
u£r_d©a
,

1229 
video_width
, 
video_height
,

1230 
video_pixñ_a•e˘
,

1231 *
de°_x
, *
de°_y
,

1232 *
de°_width
, *
de°_height
,

1233 *
de°_pixñ_a•e˘
,

1234 *
wö_x
, *
wö_y
);

1246 (*
lock_di•œy
Ë(*
u£r_d©a
);

1258 (*
u∆ock_di•œy
Ë(*
u£r_d©a
);

1260 } 
	tx11_visuÆ_t
;

1270 *
c⁄√˘i⁄
;

1271 *
s¸ìn
;

1274 
wödow
;

1276 *
u£r_d©a
;

1297 (*
de°_size_cb
Ë(*
u£r_d©a
,

1298 
video_width
, 
video_height
,

1299 
video_pixñ_a•e˘
,

1300 *
de°_width
, *
de°_height
,

1301 *
de°_pixñ_a•e˘
);

1328 (*
‰ame_ouçut_cb
Ë(*
u£r_d©a
,

1329 
video_width
, 
video_height
,

1330 
video_pixñ_a•e˘
,

1331 *
de°_x
, *
de°_y
,

1332 *
de°_width
, *
de°_height
,

1333 *
de°_pixñ_a•e˘
,

1334 *
wö_x
, *
wö_y
);

1336 } 
	txcb_visuÆ_t
;

1342 
	#XINE_VORAW_YV12
 1

	)

1343 
	#XINE_VORAW_YUY2
 2

	)

1344 
	#XINE_VORAW_RGB
 4

	)

1347 
	#XINE_VORAW_MAX_OVL
 16

	)

1351 
uöt8_t
 *
ovl_rgba
;

1352 
ovl_w
, 
ovl_h
;

1353 
ovl_x
, 
ovl_y
;

1354 } 
	tøw_ovîœy_t
;

1361 *
u£r_d©a
;

1371 
suµ‹ãd_f‹m©s
;

1388 (*
øw_ouçut_cb
Ë(*
u£r_d©a
, 
‰ame_f‹m©
,

1389 
‰ame_width
, 
‰ame_height
,

1390 
‰ame_a•e˘
,

1391 *
d©a0
, *
d©a1
, *
d©a2
);

1398 (*
øw_ovîœy_cb
Ë(*
u£r_d©a
, 
num_ovl
,

1399 
øw_ovîœy_t
 *
ovîœys_¨øy
);

1400 } 
	tøw_visuÆ_t
;

1413 (*
‰ame_ouçut_cb
Ë(*
u£r_d©a
,

1414 
video_width
, 
video_height
,

1415 
video_pixñ_a•e˘
,

1416 *
de°_x
, *
de°_y
,

1417 *
de°_width
, *
de°_height
,

1418 *
de°_pixñ_a•e˘
,

1419 *
wö_x
, *
wö_y
);

1421 *
u£r_d©a
;

1423 } 
	tfb_visuÆ_t
;

1425 #ifde‡
WIN32


1434 
HWND
 
WndHnd
;

1435 
HINSTANCE
 
HIn°
;

1436 
RECT
 
WndRe˘
;

1438 
FuŒS¸ìn
;

1439 
HBRUSH
 
Brush
;

1440 
COLORREF
 
Cﬁ‹Key
;

1442 } 
	twö32_visuÆ_t
;

1448 
	#GUI_WIN32_MOVED_OR_RESIZED
 0

	)

1456 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


1458 
	#XINE_GUI_SEND_COMPLETION_EVENT
 1

	)

1462 
	#XINE_GUI_SEND_DRAWABLE_CHANGED
 2

	)

1465 
	#XINE_GUI_SEND_EXPOSE_EVENT
 3

	)

1468 
	#XINE_GUI_SEND_TRANSLATE_GUI_TO_VIDEO
 4

	)

1471 
	#XINE_GUI_SEND_VIDEOWIN_VISIBLE
 5

	)

1476 
	#XINE_GUI_SEND_SELECT_VISUAL
 8

	)

1479 
	#XINE_GUI_SEND_WILL_DESTROY_DRAWABLE
 9

	)

1486 
	#XINE_HEALTH_CHECK_OK
 0

	)

1487 
	#XINE_HEALTH_CHECK_FAIL
 1

	)

1488 
	#XINE_HEALTH_CHECK_UNSUPPORTED
 2

	)

1489 
	#XINE_HEALTH_CHECK_NO_SUCH_CHECK
 3

	)

1491 
	#CHECK_KERNEL
 0

	)

1492 
	#CHECK_MTRR
 1

	)

1493 
	#CHECK_CDROM
 2

	)

1494 
	#CHECK_DVDROM
 3

	)

1495 
	#CHECK_DMA
 4

	)

1496 
	#CHECK_X
 5

	)

1497 
	#CHECK_XV
 6

	)

1499 
	sxöe_hó…h_check_s
 {

1500 
°©us
;

1501 c⁄° * 
cdrom_dev
;

1502 c⁄° * 
dvd_dev
;

1503 * 
msg
;

1504 * 
tôÀ
;

1505 * 
ex∂™©i⁄
;

1508 
xöe_hó…h_check_s
 
	txöe_hó…h_check_t
;

1509 
xöe_hó…h_check_t
* 
xöe_hó…h_check
(xöe_hó…h_check_t*, 
check_num
Ë
XINE_PROTECTED
;

1520 
	#XINE_CONFIG_TYPE_UNKNOWN
 0

	)

1521 
	#XINE_CONFIG_TYPE_RANGE
 1

	)

1522 
	#XINE_CONFIG_TYPE_STRING
 2

	)

1523 
	#XINE_CONFIG_TYPE_ENUM
 3

	)

1524 
	#XINE_CONFIG_TYPE_NUM
 4

	)

1525 
	#XINE_CONFIG_TYPE_BOOL
 5

	)

1528 
	#XINE_CONFIG_STRING_IS_STRING
 0

	)

1529 
	#XINE_CONFIG_STRING_IS_FILENAME
 1

	)

1530 
	#XINE_CONFIG_STRING_IS_DEVICE_NAME
 2

	)

1531 
	#XINE_CONFIG_STRING_IS_DIRECTORY_NAME
 3

	)

1533 
xöe_cfg_íåy_s
 
	txöe_cfg_íåy_t
;

1535 (*
xöe_c⁄fig_cb_t
Ë(*
	tu£r_d©a
,

1536 
	txöe_cfg_íåy_t
 *
	tíåy
);

1537 
	sxöe_cfg_íåy_s
 {

1538 c⁄° *
key
;

1540 
ty≥
;

1543 *
unknown_vÆue
;

1546 *
°r_vÆue
;

1547 *
°r_deÁu…
;

1548 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


1549 *
°r_°icky
;

1551 *
dummy
;

1558 
num_vÆue
;

1559 
num_deÁu…
;

1562 
ønge_mö
;

1563 
ønge_max
;

1566 **
íum_vÆues
;

1572 c⁄° *
des¸ùti⁄
;

1573 c⁄° *
hñp
;

1576 
exp_Àvñ
;

1586 
xöe_c⁄fig_cb_t
 
ˇŒback
;

1587 *
ˇŒback_d©a
;

1591 c⁄° *
xöe_c⁄fig_ªgi°î_°rög
 (
xöe_t
 *
£lf
,

1592 c⁄° *
key
,

1593 c⁄° *
def_vÆue
,

1594 c⁄° *
des¸ùti⁄
,

1595 c⁄° *
hñp
,

1596 
exp_Àvñ
,

1597 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1598 *
cb_d©a
Ë
XINE_PROTECTED
;

1600 c⁄° *
xöe_c⁄fig_ªgi°î_fûíame
 (
xöe_t
 *
£lf
,

1601 c⁄° *
key
,

1602 c⁄° *
def_vÆue
,

1603 
ªq_ty≥
,

1604 c⁄° *
des¸ùti⁄
,

1605 c⁄° *
hñp
,

1606 
exp_Àvñ
,

1607 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1608 *
cb_d©a
Ë
XINE_PROTECTED
;

1610 
xöe_c⁄fig_ªgi°î_ønge
 (
xöe_t
 *
£lf
,

1611 c⁄° *
key
,

1612 
def_vÆue
,

1613 
mö
, 
max
,

1614 c⁄° *
des¸ùti⁄
,

1615 c⁄° *
hñp
,

1616 
exp_Àvñ
,

1617 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1618 *
cb_d©a
Ë
XINE_PROTECTED
;

1620 
xöe_c⁄fig_ªgi°î_íum
 (
xöe_t
 *
£lf
,

1621 c⁄° *
key
,

1622 
def_vÆue
,

1623 **
vÆues
,

1624 c⁄° *
des¸ùti⁄
,

1625 c⁄° *
hñp
,

1626 
exp_Àvñ
,

1627 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1628 *
cb_d©a
Ë
XINE_PROTECTED
;

1630 
xöe_c⁄fig_ªgi°î_num
 (
xöe_t
 *
£lf
,

1631 c⁄° *
key
,

1632 
def_vÆue
,

1633 c⁄° *
des¸ùti⁄
,

1634 c⁄° *
hñp
,

1635 
exp_Àvñ
,

1636 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1637 *
cb_d©a
Ë
XINE_PROTECTED
;

1639 
xöe_c⁄fig_ªgi°î_boﬁ
 (
xöe_t
 *
£lf
,

1640 c⁄° *
key
,

1641 
def_vÆue
,

1642 c⁄° *
des¸ùti⁄
,

1643 c⁄° *
hñp
,

1644 
exp_Àvñ
,

1645 
xöe_c⁄fig_cb_t
 
ch™ged_cb
,

1646 *
cb_d©a
Ë
XINE_PROTECTED
;

1656 
xöe_c⁄fig_gë_fú°_íåy
 (
xöe_t
 *
£lf
, 
xöe_cfg_íåy_t
 *
íåy
Ë
XINE_PROTECTED
;

1659 
xöe_c⁄fig_gë_√xt_íåy
 (
xöe_t
 *
£lf
, 
xöe_cfg_íåy_t
 *
íåy
Ë
XINE_PROTECTED
;

1662 
xöe_c⁄fig_lookup_íåy
 (
xöe_t
 *
£lf
, c⁄° *
key
,

1663 
xöe_cfg_íåy_t
 *
íåy
Ë
XINE_PROTECTED
;

1671 
xöe_c⁄fig_upd©e_íåy
 (
xöe_t
 *
£lf
,

1672 c⁄° 
xöe_cfg_íåy_t
 *
íåy
Ë
XINE_PROTECTED
;

1678 c⁄° *
ﬁd_«me
, *
√w_«me
;

1679 } 
	txöe_c⁄fig_íåy_å™¶©i⁄_t
;

1681 
xöe_c⁄fig_£t_å™¶©i⁄_u£r
 (c⁄° 
xöe_c⁄fig_íåy_å™¶©i⁄_t
 *Ë
XINE_PROTECTED
;

1686 
xöe_c⁄fig_lﬂd
 (
xöe_t
 *
£lf
, c⁄° *
cfg_fûíame
Ë
XINE_PROTECTED
;

1687 
xöe_c⁄fig_ßve
 (
xöe_t
 *
£lf
, c⁄° *
cfg_fûíame
Ë
XINE_PROTECTED
;

1688 
xöe_c⁄fig_ª£t
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
;

1713 
	#XINE_EVENT_UI_PLAYBACK_FINISHED
 1

	)

1714 
	#XINE_EVENT_UI_CHANNELS_CHANGED
 2

	)

1715 
	#XINE_EVENT_UI_SET_TITLE
 3

	)

1716 
	#XINE_EVENT_UI_MESSAGE
 4

	)

1717 
	#XINE_EVENT_FRAME_FORMAT_CHANGE
 5

	)

1718 
	#XINE_EVENT_AUDIO_LEVEL
 6

	)

1719 
	#XINE_EVENT_QUIT
 7

	)

1720 
	#XINE_EVENT_PROGRESS
 8

	)

1721 
	#XINE_EVENT_MRL_REFERENCE
 9

	)

1722 
	#XINE_EVENT_UI_NUM_BUTTONS
 10

	)

1723 
	#XINE_EVENT_SPU_BUTTON
 11

	)

1724 
	#XINE_EVENT_DROPPED_FRAMES
 12

	)

1725 
	#XINE_EVENT_MRL_REFERENCE_EXT
 13

	)

1726 
	#XINE_EVENT_AUDIO_AMP_LEVEL
 14

	)

1727 
	#XINE_EVENT_NBC_STATS
 15

	)

1731 
	#XINE_EVENT_INPUT_MOUSE_BUTTON
 101

	)

1732 
	#XINE_EVENT_INPUT_MOUSE_MOVE
 102

	)

1733 
	#XINE_EVENT_INPUT_MENU1
 103

	)

1734 
	#XINE_EVENT_INPUT_MENU2
 104

	)

1735 
	#XINE_EVENT_INPUT_MENU3
 105

	)

1736 
	#XINE_EVENT_INPUT_MENU4
 106

	)

1737 
	#XINE_EVENT_INPUT_MENU5
 107

	)

1738 
	#XINE_EVENT_INPUT_MENU6
 108

	)

1739 
	#XINE_EVENT_INPUT_MENU7
 109

	)

1740 
	#XINE_EVENT_INPUT_UP
 110

	)

1741 
	#XINE_EVENT_INPUT_DOWN
 111

	)

1742 
	#XINE_EVENT_INPUT_LEFT
 112

	)

1743 
	#XINE_EVENT_INPUT_RIGHT
 113

	)

1744 
	#XINE_EVENT_INPUT_SELECT
 114

	)

1745 
	#XINE_EVENT_INPUT_NEXT
 115

	)

1746 
	#XINE_EVENT_INPUT_PREVIOUS
 116

	)

1747 
	#XINE_EVENT_INPUT_ANGLE_NEXT
 117

	)

1748 
	#XINE_EVENT_INPUT_ANGLE_PREVIOUS
 118

	)

1749 
	#XINE_EVENT_INPUT_BUTTON_FORCE
 119

	)

1750 
	#XINE_EVENT_INPUT_NUMBER_0
 120

	)

1751 
	#XINE_EVENT_INPUT_NUMBER_1
 121

	)

1752 
	#XINE_EVENT_INPUT_NUMBER_2
 122

	)

1753 
	#XINE_EVENT_INPUT_NUMBER_3
 123

	)

1754 
	#XINE_EVENT_INPUT_NUMBER_4
 124

	)

1755 
	#XINE_EVENT_INPUT_NUMBER_5
 125

	)

1756 
	#XINE_EVENT_INPUT_NUMBER_6
 126

	)

1757 
	#XINE_EVENT_INPUT_NUMBER_7
 127

	)

1758 
	#XINE_EVENT_INPUT_NUMBER_8
 128

	)

1759 
	#XINE_EVENT_INPUT_NUMBER_9
 129

	)

1760 
	#XINE_EVENT_INPUT_NUMBER_10_ADD
 130

	)

1763 
	#XINE_EVENT_SET_V4L2
 200

	)

1764 
	#XINE_EVENT_PVR_SAVE
 201

	)

1765 
	#XINE_EVENT_PVR_REPORT_NAME
 202

	)

1766 
	#XINE_EVENT_PVR_REALTIME
 203

	)

1767 
	#XINE_EVENT_PVR_PAUSE
 204

	)

1768 
	#XINE_EVENT_SET_MPEG_DATA
 205

	)

1771 
	#XINE_EVENT_VDR_RED
 300

	)

1772 
	#XINE_EVENT_VDR_GREEN
 301

	)

1773 
	#XINE_EVENT_VDR_YELLOW
 302

	)

1774 
	#XINE_EVENT_VDR_BLUE
 303

	)

1775 
	#XINE_EVENT_VDR_PLAY
 304

	)

1776 
	#XINE_EVENT_VDR_PAUSE
 305

	)

1777 
	#XINE_EVENT_VDR_STOP
 306

	)

1778 
	#XINE_EVENT_VDR_RECORD
 307

	)

1779 
	#XINE_EVENT_VDR_FASTFWD
 308

	)

1780 
	#XINE_EVENT_VDR_FASTREW
 309

	)

1781 
	#XINE_EVENT_VDR_POWER
 310

	)

1782 
	#XINE_EVENT_VDR_CHANNELPLUS
 311

	)

1783 
	#XINE_EVENT_VDR_CHANNELMINUS
 312

	)

1784 
	#XINE_EVENT_VDR_SCHEDULE
 313

	)

1785 
	#XINE_EVENT_VDR_CHANNELS
 314

	)

1786 
	#XINE_EVENT_VDR_TIMERS
 315

	)

1787 
	#XINE_EVENT_VDR_RECORDINGS
 316

	)

1788 
	#XINE_EVENT_VDR_SETUP
 317

	)

1789 
	#XINE_EVENT_VDR_COMMANDS
 318

	)

1790 
	#XINE_EVENT_VDR_BACK
 319

	)

1791 
	#XINE_EVENT_VDR_USER1
 320

	)

1792 
	#XINE_EVENT_VDR_USER2
 321

	)

1793 
	#XINE_EVENT_VDR_USER3
 322

	)

1794 
	#XINE_EVENT_VDR_USER4
 323

	)

1795 
	#XINE_EVENT_VDR_USER5
 324

	)

1796 
	#XINE_EVENT_VDR_USER6
 325

	)

1797 
	#XINE_EVENT_VDR_USER7
 326

	)

1798 
	#XINE_EVENT_VDR_USER8
 327

	)

1799 
	#XINE_EVENT_VDR_USER9
 328

	)

1800 
	#XINE_EVENT_VDR_VOLPLUS
 329

	)

1801 
	#XINE_EVENT_VDR_VOLMINUS
 330

	)

1802 
	#XINE_EVENT_VDR_MUTE
 331

	)

1803 
	#XINE_EVENT_VDR_AUDIO
 332

	)

1804 
	#XINE_EVENT_VDR_INFO
 333

	)

1805 
	#XINE_EVENT_VDR_CHANNELPREVIOUS
 334

	)

1806 
	#XINE_EVENT_VDR_SUBTITLES
 335

	)

1807 
	#XINE_EVENT_VDR_USER0
 336

	)

1809 
	#XINE_EVENT_VDR_SETVIDEOWINDOW
 350

	)

1810 
	#XINE_EVENT_VDR_FRAMESIZECHANGED
 351

	)

1811 
	#XINE_EVENT_VDR_SELECTAUDIO
 352

	)

1812 
	#XINE_EVENT_VDR_TRICKSPEEDMODE
 353

	)

1813 
	#XINE_EVENT_VDR_PLUGINSTARTED
 354

	)

1814 
	#XINE_EVENT_VDR_DISCONTINUITY
 355

	)

1817 
	#XINE_EVENT_POST_TVTIME_FILMMODE_CHANGE
 400

	)

1823 
ty≥
;

1824 
xöe_°ªam_t
 *
°ªam
;

1826 *
d©a
;

1827 
d©a_Àngth
;

1830 
timevÆ
 
tv
;

1831 } 
	txöe_evít_t
;

1837 
xöe_evít_t
 
evít
;

1838 
uöt8_t
 
buâ⁄
;

1839 
uöt16_t
 
x
,
y
;

1840 } 
	txöe_öput_d©a_t
;

1846 
num_buâ⁄s
;

1847 
°r_Àn
;

1848 
°r
[256];

1849 } 
	txöe_ui_d©a_t
;

1859 
xöe_ui_d©a_t
 
com∑tibûôy
;

1862 
ty≥
;

1867 
ex∂™©i⁄
;

1870 
num_∑ømëîs
;

1871 
∑ømëîs
;

1879 
mesßges
[1];

1880 } 
	txöe_ui_mesßge_d©a_t
;

1887 
width
;

1888 
height
;

1891 
a•e˘
;

1892 
∑n_sˇn
;

1893 } 
	txöe_f‹m©_ch™ge_d©a_t
;

1899 
À·
;

1900 
right
;

1901 
muã
;

1902 } 
	txöe_audio_Àvñ_d©a_t
;

1908 c⁄° *
des¸ùti⁄
;

1909 
≥r˚¡
;

1910 } 
	txöe_¥ogªss_d©a_t
;

1916 
v_≥r˚¡
;

1917 
öt64_t
 
v_ªmaöög
;

1918 
öt64_t
 
v_bôøã
;

1919 
v_ö_disc
;

1920 
a_≥r˚¡
;

1921 
öt64_t
 
a_ªmaöög
;

1922 
öt64_t
 
a_bôøã
;

1923 
a_ö_disc
;

1924 
buf„rög
;

1925 
íabÀd
;

1926 
ty≥
;

1927 } 
	txöe_nbc_°©s_d©a_t
;

1958 
Æã∫©ive
;

1959 
mæ
[1];

1960 } 
	txöe_mæ_ª„ªn˚_d©a_t
 
	tXINE_DEPRECATED
;

1963 
Æã∫©ive
;

1964 
uöt32_t
 
°¨t_time
, 
duøti⁄
;

1965 
uöt32_t
 
•¨e
[20];

1966 c⁄° 
mæ
[1];

1968 } 
	txöe_mæ_ª„ªn˚_d©a_ext_t
;

1975 
öput
;

1976 
ch™√l
;

1977 
ødio
;

1978 
uöt32_t
 
‰equícy
;

1979 
uöt32_t
 
å™smissi⁄
;

1982 
uöt32_t
 
‰amî©e_numî©‹
;

1983 
uöt32_t
 
‰amî©e_díomö©‹
;

1984 
uöt32_t
 
‰amñöes
;

1985 
uöt64_t
 
°™d¨d_id
;

1986 
uöt32_t
 
cﬁ‹°™d¨d
;

1987 
uöt32_t
 
cﬁ‹subˇºõr
;

1988 
‰ame_width
;

1989 
‰ame_height
;

1994 
uöt32_t
 
•¨e
[20];

1997 
öt32_t
 
£ssi⁄_id
;

1999 } 
	txöe_£t_v4l2_d©a_t
;

2008 
bôøã_vbr
;

2009 
bôøã_món
;

2010 
bôøã_≥ak
;

2011 
g›_size
;

2012 
g›_˛osuª
;

2013 
b_‰ames
;

2014 
a•e˘_øtio
;

2019 
uöt32_t
 
•¨e
[20];

2021 } 
	txöe_£t_m≥g_d©a_t
;

2024 
dúe˘i⁄
;

2025 
öt32_t
 
buâ⁄
;

2026 } 
	txöe_•u_buâ⁄_t
;

2028 #ifde‡
XINE_ENABLE_EXPERIMENTAL_FEATURES


2041 
mode
;

2042 
id
;

2043 
«me
[256];

2044 } 
	txöe_pvr_ßve_d©a_t
;

2051 
mode
;

2052 } 
	txöe_pvr_ªÆtime_t
;

2059 
mode
;

2060 } 
	txöe_pvr_∑u£_t
;

2071 
skù≥d_‰ames
;

2072 
skù≥d_thªshﬁd
;

2073 
disˇrded_‰ames
;

2074 
disˇrded_thªshﬁd
;

2075 } 
	txöe_dr›≥d_‰ames_t
;

2089 
	#XINE_MSG_NO_ERROR
 0

	)

2090 
	#XINE_MSG_GENERAL_WARNING
 1

	)

2091 
	#XINE_MSG_UNKNOWN_HOST
 2

	)

2092 
	#XINE_MSG_UNKNOWN_DEVICE
 3

	)

2093 
	#XINE_MSG_NETWORK_UNREACHABLE
 4

	)

2094 
	#XINE_MSG_CONNECTION_REFUSED
 5

	)

2095 
	#XINE_MSG_FILE_NOT_FOUND
 6

	)

2096 
	#XINE_MSG_READ_ERROR
 7

	)

2097 
	#XINE_MSG_LIBRARY_LOAD_ERROR
 8

	)

2098 
	#XINE_MSG_ENCRYPTED_SOURCE
 9

	)

2099 
	#XINE_MSG_SECURITY
 10

	)

2100 
	#XINE_MSG_AUDIO_OUT_UNAVAILABLE
 11

	)

2101 
	#XINE_MSG_PERMISSION_ERROR
 12

	)

2102 
	#XINE_MSG_FILE_EMPTY
 13

	)

2105 
xöe_evít_queue_s
 
	txöe_evít_queue_t
;

2114 
xöe_evít_queue_t
 *
xöe_evít_√w_queue
 (
xöe_°ªam_t
 *
°ªam
Ë
XINE_PROTECTED
;

2115 
xöe_evít_di•o£_queue
 (
xöe_evít_queue_t
 *
queue
Ë
XINE_PROTECTED
;

2123 
xöe_evít_t
 *
xöe_evít_gë
 (
xöe_evít_queue_t
 *
queue
Ë
XINE_PROTECTED
;

2124 
xöe_evít_t
 *
xöe_evít_waô
 (
xöe_evít_queue_t
 *
queue
Ë
XINE_PROTECTED
;

2125 
xöe_evít_‰ì
 (
xöe_evít_t
 *
evít
Ë
XINE_PROTECTED
;

2135 (*
xöe_evít_li°íî_cb_t
Ë(*
	tu£r_d©a
,

2136 c⁄° 
	txöe_evít_t
 *
	tevít
);

2137 
xöe_evít_¸óã_li°íî_thªad
 (
xöe_evít_queue_t
 *
queue
,

2138 
xöe_evít_li°íî_cb_t
 
ˇŒback
,

2139 *
u£r_d©a
Ë
XINE_PROTECTED
;

2147 
xöe_evít_£nd
 (
xöe_°ªam_t
 *
°ªam
, c⁄° 
xöe_evít_t
 *
evít
Ë
XINE_PROTECTED
;

2154 
	#XINE_TEXT_PALETTE_SIZE
 11

	)

2156 
	#XINE_OSD_TEXT1
 (0 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2157 
	#XINE_OSD_TEXT2
 (1 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2158 
	#XINE_OSD_TEXT3
 (2 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2159 
	#XINE_OSD_TEXT4
 (3 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2160 
	#XINE_OSD_TEXT5
 (4 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2161 
	#XINE_OSD_TEXT6
 (5 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2162 
	#XINE_OSD_TEXT7
 (6 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2163 
	#XINE_OSD_TEXT8
 (7 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2164 
	#XINE_OSD_TEXT9
 (8 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2165 
	#XINE_OSD_TEXT10
 (9 * 
XINE_TEXT_PALETTE_SIZE
)

	)

2168 
	#XINE_TEXTPALETTE_WHITE_BLACK_TRANSPARENT
 0

	)

2170 
	#XINE_TEXTPALETTE_WHITE_NONE_TRANSPARENT
 1

	)

2172 
	#XINE_TEXTPALETTE_WHITE_NONE_TRANSLUCID
 2

	)

2174 
	#XINE_TEXTPALETTE_YELLOW_BLACK_TRANSPARENT
 3

	)

2176 
	#XINE_OSD_CAP_FREETYPE2
 0x0001

	)

2177 
	#XINE_OSD_CAP_UNSCALED
 0x0002

	)

2179 
xöe_osd_s
 
	txöe_osd_t
;

2181 
xöe_osd_t
 *
xöe_osd_√w
 (
xöe_°ªam_t
 *
£lf
, 
x
, 
y
,

2182 
width
, 
height
Ë
XINE_PROTECTED
;

2183 
uöt32_t
 
xöe_osd_gë_ˇ∑bûôõs
 (
xöe_osd_t
 *
£lf
Ë
XINE_PROTECTED
;

2184 
xöe_osd_døw_poöt
 (
xöe_osd_t
 *
£lf
, 
x
, 
y
, 
cﬁ‹
Ë
XINE_PROTECTED
;

2186 
xöe_osd_døw_löe
 (
xöe_osd_t
 *
£lf
, 
x1
, 
y1
,

2187 
x2
, 
y2
, 
cﬁ‹
Ë
XINE_PROTECTED
;

2188 
xöe_osd_døw_ª˘
 (
xöe_osd_t
 *
£lf
, 
x1
, 
y1
,

2189 
x2
, 
y2
,

2190 
cﬁ‹
, 
fûÀd
 ) 
XINE_PROTECTED
;

2192 
xöe_osd_døw_ãxt
 (
xöe_osd_t
 *
£lf
, 
x1
, 
y1
,

2193 c⁄° *
ãxt
, 
cﬁ‹_ba£
Ë
XINE_PROTECTED
;

2194 
xöe_osd_døw_bôm≠
 (
xöe_osd_t
 *
£lf
, 
uöt8_t
 *
bôm≠
,

2195 
x1
, 
y1
, 
width
, 
height
,

2196 
uöt8_t
 *
∑Àâe_m≠
Ë
XINE_PROTECTED
;

2199 
xöe_osd_gë_ãxt_size
 (
xöe_osd_t
 *
£lf
, c⁄° *
ãxt
,

2200 *
width
, *
height
Ë
XINE_PROTECTED
;

2203 
xöe_osd_£t_f⁄t
 (
xöe_osd_t
 *
£lf
, c⁄° *
f⁄äame
,

2204 
size
Ë
XINE_PROTECTED
;

2210 
xöe_osd_£t_ícodög
(
xöe_osd_t
 *
£lf
, c⁄° *
ícodög
Ë
XINE_PROTECTED
;

2212 
xöe_osd_£t_posôi⁄
 (
xöe_osd_t
 *
£lf
, 
x
, 
y
Ë
XINE_PROTECTED
;

2213 
xöe_osd_show
 (
xöe_osd_t
 *
£lf
, 
öt64_t
 
v±s
Ë
XINE_PROTECTED
;

2214 
xöe_osd_show_unsˇÀd
 (
xöe_osd_t
 *
£lf
, 
öt64_t
 
v±s
Ë
XINE_PROTECTED
;

2215 
xöe_osd_hide
 (
xöe_osd_t
 *
£lf
, 
öt64_t
 
v±s
Ë
XINE_PROTECTED
;

2217 
xöe_osd_˛ór
 (
xöe_osd_t
 *
£lf
Ë
XINE_PROTECTED
;

2233 
xöe_osd_£t_ãxt_∑Àâe
 (
xöe_osd_t
 *
£lf
,

2234 
∑Àâe_numbî
,

2235 
cﬁ‹_ba£
 ) 
XINE_PROTECTED
;

2237 
xöe_osd_gë_∑Àâe
 (
xöe_osd_t
 *
£lf
, 
uöt32_t
 *
cﬁ‹
,

2238 
uöt8_t
 *
å™s
Ë
XINE_PROTECTED
;

2239 
xöe_osd_£t_∑Àâe
 (
xöe_osd_t
 *
£lf
,

2240 c⁄° 
uöt32_t
 *c⁄° 
cﬁ‹
,

2241 c⁄° 
uöt8_t
 *c⁄° 
å™s
 ) 
XINE_PROTECTED
;

2247 
xöe_osd_‰ì
 (
xöe_osd_t
 *
£lf
Ë
XINE_PROTECTED
;

2250 #i‚de‡
XINE_DISABLE_DEPRECATED_FEATURES


2260 
XINE_TVSYSTEM_PAL
 = 0,

2261 
XINE_TVSYSTEM_NTSC


2262 } 
	txöe_tvsy°em
 
	tXINE_DEPRECATED
;

2265 
xöe_tvmode_öô
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2268 
xöe_tvmode_u£
(
xöe_t
 *
£lf
, 
u£_tvmode
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2271 
xöe_tvmode_£t_tvsy°em
(
xöe_t
 *
£lf
, 
xöe_tvsy°em
 
sy°em
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2280 
xöe_tvmode_swôch
 (
xöe_t
 *
£lf
, 
ty≥
, 
width
, 
height
, 
Âs
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2285 
xöe_tvmode_size
 (
xöe_t
 *
£lf
, *
width
, *
height
,

2286 *
pixñøtio
, *
Âs
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2289 
xöe_tvmode_exô
 (
xöe_t
 *
£lf
Ë
XINE_PROTECTED
 
XINE_DEPRECATED
;

2293 #ifde‡
__˝lu•lus


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/dc1394/camera.h

21 
	~<dc1394/log.h
>

22 
	~<°dio.h
>

24 #i‚de‡
__DC1394_CAMERA_H__


25 
	#__DC1394_CAMERA_H__


	)

42 
	mDC1394_IIDC_VERSION_1_04
 = 544,

43 
	mDC1394_IIDC_VERSION_1_20
,

44 
	mDC1394_IIDC_VERSION_PTGREY
,

45 
	mDC1394_IIDC_VERSION_1_30
,

46 
	mDC1394_IIDC_VERSION_1_31
,

47 
	mDC1394_IIDC_VERSION_1_32
,

48 
	mDC1394_IIDC_VERSION_1_33
,

49 
	mDC1394_IIDC_VERSION_1_34
,

50 
	mDC1394_IIDC_VERSION_1_35
,

51 
	mDC1394_IIDC_VERSION_1_36
,

52 
	mDC1394_IIDC_VERSION_1_37
,

53 
	mDC1394_IIDC_VERSION_1_38
,

54 
	mDC1394_IIDC_VERSION_1_39


55 } 
	tdc1394iidc_vîsi⁄_t
;

56 
	#DC1394_IIDC_VERSION_MIN
 
DC1394_IIDC_VERSION_1_04


	)

57 
	#DC1394_IIDC_VERSION_MAX
 
DC1394_IIDC_VERSION_1_39


	)

58 
	#DC1394_IIDC_VERSION_NUM
 (
DC1394_IIDC_VERSION_MAX
 - 
DC1394_IIDC_VERSION_MIN
 + 1)

	)

66 
	mDC1394_POWER_CLASS_NONE
=608,

67 
	mDC1394_POWER_CLASS_PROV_MIN_15W
,

68 
	mDC1394_POWER_CLASS_PROV_MIN_30W
,

69 
	mDC1394_POWER_CLASS_PROV_MIN_45W
,

70 
	mDC1394_POWER_CLASS_USES_MAX_1W
,

71 
	mDC1394_POWER_CLASS_USES_MAX_3W
,

72 
	mDC1394_POWER_CLASS_USES_MAX_6W
,

73 
	mDC1394_POWER_CLASS_USES_MAX_10W


74 } 
	tdc1394powî_˛ass_t
;

75 
	#DC1394_POWER_CLASS_MIN
 
DC1394_POWER_CLASS_NONE


	)

76 
	#DC1394_POWER_CLASS_MAX
 
DC1394_POWER_CLASS_USES_MAX_10W


	)

77 
	#DC1394_POWER_CLASS_NUM
 (
DC1394_POWER_CLASS_MAX
 - 
DC1394_POWER_CLASS_MIN
 + 1)

	)

85 
	mDC1394_PHY_DELAY_MAX_144_NS
=640,

86 
	mDC1394_PHY_DELAY_UNKNOWN_0
,

87 
	mDC1394_PHY_DELAY_UNKNOWN_1
,

88 
	mDC1394_PHY_DELAY_UNKNOWN_2


89 } 
	tdc1394phy_dñay_t
;

90 
	#DC1394_PHY_DELAY_MIN
 
DC1394_PHY_DELAY_MAX_144_NS


	)

91 
	#DC1394_PHY_DELAY_MAX
 
DC1394_PHY_DELAY_UNKNOWN_0


	)

92 
	#DC1394_PHY_DELAY_NUM
 (
DC1394_PHY_DELAY_MAX
 - 
DC1394_PHY_DELAY_MIN
 + 1)

	)

100 
	s__dc1394_ˇmîa


103 
uöt64_t
 
	mguid
;

104 
	munô
;

105 
uöt32_t
 
	munô_•ec_ID
;

106 
uöt32_t
 
	munô_sw_vîsi⁄
;

107 
uöt32_t
 
	munô_sub_sw_vîsi⁄
;

108 
uöt32_t
 
	mcomm™d_ªgi°îs_ba£
;

109 
uöt32_t
 
	munô_dúe˘‹y
;

110 
uöt32_t
 
	munô_dïídít_dúe˘‹y
;

111 
uöt64_t
 
	madv™˚d_„©uªs_c§
;

112 
uöt64_t
 
	mPIO_c⁄åﬁ_c§
;

113 
uöt64_t
 
	mSIO_c⁄åﬁ_c§
;

114 
uöt64_t
 
	m°robe_c⁄åﬁ_c§
;

115 
uöt64_t
 
	mf‹m©7_c§
[
DC1394_VIDEO_MODE_FORMAT7_NUM
];

116 
dc1394iidc_vîsi⁄_t
 
	miidc_vîsi⁄
;

117 * 
	mvíd‹
;

118 * 
	mmodñ
;

119 
uöt32_t
 
	mvíd‹_id
;

120 
uöt32_t
 
	mmodñ_id
;

121 
dc1394boﬁ_t
 
	mbmode_ˇ∑bÀ
;

122 
dc1394boﬁ_t
 
	m⁄e_shŸ_ˇ∑bÀ
;

123 
dc1394boﬁ_t
 
	mmu…i_shŸ_ˇ∑bÀ
;

124 
dc1394boﬁ_t
 
	mˇn_swôch_⁄_off
;

125 
dc1394boﬁ_t
 
	mhas_vmode_îr‹_°©us
;

126 
dc1394boﬁ_t
 
	mhas_„©uª_îr‹_°©us
;

127 
	mmax_mem_ch™√l
;

130 
uöt32_t
 
	mÊags
;

132 } 
	tdc1394ˇmîa_t
;

142 
uöt16_t
 
	munô
;

143 
uöt64_t
 
	mguid
;

144 } 
	tdc1394ˇmîa_id_t
;

151 
	s__dc1394ˇmîa_li°_t


153 
uöt32_t
 
	mnum
;

154 
dc1394ˇmîa_id_t
 *
	mids
;

155 } 
	tdc1394ˇmîa_li°_t
;

157 
__dc1394_t
 
	tdc1394_t
;

159 #ifde‡
__˝lu•lus


170 
dc1394_t
* 
dc1394_√w
 ();

175 
dc1394_‰ì
 (
dc1394_t
 *
dc1394
);

185 
dc1394îr‹_t
 
dc1394_ˇmîa_£t_brﬂdˇ°
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 
pwr
);

186 
dc1394îr‹_t
 
dc1394_ˇmîa_gë_brﬂdˇ°
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 *
pwr
);

196 
dc1394îr‹_t
 
dc1394_ª£t_bus
(
dc1394ˇmîa_t
 *
ˇmîa
);

197 
dc1394îr‹_t
 
dc1394_ªad_cy˛e_timî
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

198 
uöt32_t
 * 
cy˛e_timî
, 
uöt64_t
 * 
loˇl_time
);

203 
dc1394îr‹_t
 
dc1394_ˇmîa_gë_node
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
node
,

204 
uöt32_t
 * 
gíî©i⁄
);

214 
dc1394îr‹_t
 
dc1394_ˇmîa_íumî©e
(
dc1394_t
 *
dc1394
, 
dc1394ˇmîa_li°_t
 **
li°
);

219 
dc1394_ˇmîa_‰ì_li°
(
dc1394ˇmîa_li°_t
 *
li°
);

224 
dc1394ˇmîa_t
 * 
dc1394_ˇmîa_√w
(
dc1394_t
 *
dc1394
, 
uöt64_t
 
guid
);

229 
dc1394ˇmîa_t
 * 
dc1394_ˇmîa_√w_unô
(
dc1394_t
 *
dc1394
, 
uöt64_t
 
guid
, 
unô
);

234 
dc1394_ˇmîa_‰ì
(
dc1394ˇmîa_t
 *
ˇmîa
);

239 
dc1394îr‹_t
 
dc1394_ˇmîa_¥öt_öfo
(
dc1394ˇmîa_t
 *
ˇmîa
, 
FILE
 *
fd
);

241 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/capture.h

22 
	~<dc1394/log.h
>

23 
	~<dc1394/video.h
>

25 #i‚de‡
__DC1394_CAPTURE_H__


26 
	#__DC1394_CAPTURE_H__


	)

42 
	mDC1394_CAPTURE_POLICY_WAIT
=672,

43 
	mDC1394_CAPTURE_POLICY_POLL


44 } 
	tdc1394ˇ±uª_pﬁicy_t
;

45 
	#DC1394_CAPTURE_POLICY_MIN
 
DC1394_CAPTURE_POLICY_WAIT


	)

46 
	#DC1394_CAPTURE_POLICY_MAX
 
DC1394_CAPTURE_POLICY_POLL


	)

47 
	#DC1394_CAPTURE_POLICY_NUM
 (
DC1394_CAPTURE_POLICY_MAX
 - 
DC1394_CAPTURE_POLICY_MIN
 + 1)

	)

53 
	#DC1394_CAPTURE_FLAGS_CHANNEL_ALLOC
 0x00000001U

	)

54 
	#DC1394_CAPTURE_FLAGS_BANDWIDTH_ALLOC
 0x00000002U

	)

55 
	#DC1394_CAPTURE_FLAGS_DEFAULT
 0x00000004U

	)

56 
	#DC1394_CAPTURE_FLAGS_AUTO_ISO
 0x00000008U

	)

58 #ifde‡
__˝lu•lus


69 
dc1394îr‹_t
 
dc1394_ˇ±uª_£tup
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
num_dma_buf„rs
, uöt32_à
Êags
);

74 
dc1394îr‹_t
 
dc1394_ˇ±uª_°›
(
dc1394ˇmîa_t
 *
ˇmîa
);

79 
dc1394_ˇ±uª_gë_fûío
 (
dc1394ˇmîa_t
 * 
ˇmîa
);

85 
dc1394îr‹_t
 
dc1394_ˇ±uª_dequeue
(
dc1394ˇmîa_t
 * 
ˇmîa
, 
dc1394ˇ±uª_pﬁicy_t
 
pﬁicy
, 
dc1394video_‰ame_t
 **
‰ame
);

90 
dc1394îr‹_t
 
dc1394_ˇ±uª_íqueue
(
dc1394ˇmîa_t
 * 
ˇmîa
, 
dc1394video_‰ame_t
 * 
‰ame
);

100 
dc1394boﬁ_t
 
dc1394_ˇ±uª_is_‰ame_c‹ru±
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

101 
dc1394video_‰ame_t
 * 
‰ame
);

103 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/control.h

23 
	~<dc1394/log.h
>

25 #i‚de‡
__DC1394_CONTROL_H__


26 
	#__DC1394_CONTROL_H__


	)

44 
	mDC1394_TRIGGER_MODE_0
= 384,

45 
	mDC1394_TRIGGER_MODE_1
,

46 
	mDC1394_TRIGGER_MODE_2
,

47 
	mDC1394_TRIGGER_MODE_3
,

48 
	mDC1394_TRIGGER_MODE_4
,

49 
	mDC1394_TRIGGER_MODE_5
,

50 
	mDC1394_TRIGGER_MODE_14
,

51 
	mDC1394_TRIGGER_MODE_15


52 } 
	tdc1394åiggî_mode_t
;

53 
	#DC1394_TRIGGER_MODE_MIN
 
DC1394_TRIGGER_MODE_0


	)

54 
	#DC1394_TRIGGER_MODE_MAX
 
DC1394_TRIGGER_MODE_15


	)

55 
	#DC1394_TRIGGER_MODE_NUM
 (
DC1394_TRIGGER_MODE_MAX
 - 
DC1394_TRIGGER_MODE_MIN
 + 1)

	)

61 
	mDC1394_FEATURE_BRIGHTNESS
= 416,

62 
	mDC1394_FEATURE_EXPOSURE
,

63 
	mDC1394_FEATURE_SHARPNESS
,

64 
	mDC1394_FEATURE_WHITE_BALANCE
,

65 
	mDC1394_FEATURE_HUE
,

66 
	mDC1394_FEATURE_SATURATION
,

67 
	mDC1394_FEATURE_GAMMA
,

68 
	mDC1394_FEATURE_SHUTTER
,

69 
	mDC1394_FEATURE_GAIN
,

70 
	mDC1394_FEATURE_IRIS
,

71 
	mDC1394_FEATURE_FOCUS
,

72 
	mDC1394_FEATURE_TEMPERATURE
,

73 
	mDC1394_FEATURE_TRIGGER
,

74 
	mDC1394_FEATURE_TRIGGER_DELAY
,

75 
	mDC1394_FEATURE_WHITE_SHADING
,

76 
	mDC1394_FEATURE_FRAME_RATE
,

77 
	mDC1394_FEATURE_ZOOM
,

78 
	mDC1394_FEATURE_PAN
,

79 
	mDC1394_FEATURE_TILT
,

80 
	mDC1394_FEATURE_OPTICAL_FILTER
,

81 
	mDC1394_FEATURE_CAPTURE_SIZE
,

82 
	mDC1394_FEATURE_CAPTURE_QUALITY


83 } 
	tdc1394„©uª_t
;

84 
	#DC1394_FEATURE_MIN
 
DC1394_FEATURE_BRIGHTNESS


	)

85 
	#DC1394_FEATURE_MAX
 
DC1394_FEATURE_CAPTURE_QUALITY


	)

86 
	#DC1394_FEATURE_NUM
 (
DC1394_FEATURE_MAX
 - 
DC1394_FEATURE_MIN
 + 1)

	)

92 
	mDC1394_TRIGGER_SOURCE_0
= 576,

93 
	mDC1394_TRIGGER_SOURCE_1
,

94 
	mDC1394_TRIGGER_SOURCE_2
,

95 
	mDC1394_TRIGGER_SOURCE_3
,

96 
	mDC1394_TRIGGER_SOURCE_SOFTWARE


97 } 
	tdc1394åiggî_sour˚_t
;

98 
	#DC1394_TRIGGER_SOURCE_MIN
 
DC1394_TRIGGER_SOURCE_0


	)

99 
	#DC1394_TRIGGER_SOURCE_MAX
 
DC1394_TRIGGER_SOURCE_SOFTWARE


	)

100 
	#DC1394_TRIGGER_SOURCE_NUM
 (
DC1394_TRIGGER_SOURCE_MAX
 - 
DC1394_TRIGGER_SOURCE_MIN
 + 1)

	)

106 
	mDC1394_TRIGGER_ACTIVE_LOW
= 704,

107 
	mDC1394_TRIGGER_ACTIVE_HIGH


108 } 
	tdc1394åiggî_pﬁ¨ôy_t
;

109 
	#DC1394_TRIGGER_ACTIVE_MIN
 
DC1394_TRIGGER_ACTIVE_LOW


	)

110 
	#DC1394_TRIGGER_ACTIVE_MAX
 
DC1394_TRIGGER_ACTIVE_HIGH


	)

111 
	#DC1394_TRIGGER_ACTIVE_NUM
 (
DC1394_TRIGGER_ACTIVE_MAX
 - 
DC1394_TRIGGER_ACTIVE_MIN
 + 1)

	)

117 
	mDC1394_FEATURE_MODE_MANUAL
= 736,

118 
	mDC1394_FEATURE_MODE_AUTO
,

119 
	mDC1394_FEATURE_MODE_ONE_PUSH_AUTO


120 } 
	tdc1394„©uª_mode_t
;

121 
	#DC1394_FEATURE_MODE_MIN
 
DC1394_FEATURE_MODE_MANUAL


	)

122 
	#DC1394_FEATURE_MODE_MAX
 
DC1394_FEATURE_MODE_ONE_PUSH_AUTO


	)

123 
	#DC1394_FEATURE_MODE_NUM
 (
DC1394_FEATURE_MODE_MAX
 - 
DC1394_FEATURE_MODE_MIN
 + 1)

	)

130 
uöt32_t
 
	mnum
;

131 
dc1394„©uª_mode_t
 
	mmodes
[
DC1394_FEATURE_MODE_NUM
];

132 } 
	tdc1394„©uª_modes_t
;

139 
uöt32_t
 
	mnum
;

140 
dc1394åiggî_mode_t
 
	mmodes
[
DC1394_TRIGGER_MODE_NUM
];

141 } 
	tdc1394åiggî_modes_t
;

148 
uöt32_t
 
	mnum
;

149 
dc1394åiggî_sour˚_t
 
	msour˚s
[
DC1394_TRIGGER_SOURCE_NUM
];

150 } 
	tdc1394åiggî_sour˚s_t
;

157 
	s__dc1394„©uª_öfo_t_°ru˘


159 
dc1394„©uª_t
 
	mid
;

160 
dc1394boﬁ_t
 
	mavaûabÀ
;

161 
dc1394boﬁ_t
 
	mabsﬁuã_ˇ∑bÀ
;

162 
dc1394boﬁ_t
 
	mªadout_ˇ∑bÀ
;

163 
dc1394boﬁ_t
 
	m⁄_off_ˇ∑bÀ
;

164 
dc1394boﬁ_t
 
	mpﬁ¨ôy_ˇ∑bÀ
;

165 
dc1394swôch_t
 
	mis_⁄
;

166 
dc1394„©uª_mode_t
 
	mcuºít_mode
;

167 
dc1394„©uª_modes_t
 
	mmodes
;

168 
dc1394åiggî_modes_t
 
	måiggî_modes
;

169 
dc1394åiggî_mode_t
 
	måiggî_mode
;

170 
dc1394åiggî_pﬁ¨ôy_t
 
	måiggî_pﬁ¨ôy
;

171 
dc1394åiggî_sour˚s_t
 
	måiggî_sour˚s
;

172 
dc1394åiggî_sour˚_t
 
	måiggî_sour˚
;

173 
uöt32_t
 
	mmö
;

174 
uöt32_t
 
	mmax
;

175 
uöt32_t
 
	mvÆue
;

176 
uöt32_t
 
	mBU_vÆue
;

177 
uöt32_t
 
	mRV_vÆue
;

178 
uöt32_t
 
	mB_vÆue
;

179 
uöt32_t
 
	mR_vÆue
;

180 
uöt32_t
 
	mG_vÆue
;

181 
uöt32_t
 
	mèrgë_vÆue
;

183 
dc1394swôch_t
 
	mabs_c⁄åﬁ
;

184 
	mabs_vÆue
;

185 
	mabs_max
;

186 
	mabs_mö
;

188 } 
	tdc1394„©uª_öfo_t
;

193 
	s__dc1394„©uª£t_t


195 
dc1394„©uª_öfo_t
 
	m„©uª
[
DC1394_FEATURE_NUM
];

196 } 
	tdc1394„©uª£t_t
;

198 #ifde‡
__˝lu•lus


209 
dc1394îr‹_t
 
dc1394_„©uª_gë_Æl
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª£t_t
 *
„©uªs
);

214 
dc1394îr‹_t
 
dc1394_„©uª_gë
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_öfo_t
 *
„©uª
);

219 
dc1394îr‹_t
 
dc1394_„©uª_¥öt
(
dc1394„©uª_öfo_t
 *
„©uª
, 
FILE
 *
fd
);

224 
dc1394îr‹_t
 
dc1394_„©uª_¥öt_Æl
(
dc1394„©uª£t_t
 *
„©uªs
, 
FILE
 *
fd
);

229 
dc1394îr‹_t
 
dc1394_„©uª_whôebÆ™˚_gë_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
u_b_vÆue
, uöt32_à*
v_r_vÆue
);

234 
dc1394îr‹_t
 
dc1394_„©uª_whôebÆ™˚_£t_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
u_b_vÆue
, uöt32_à
v_r_vÆue
);

239 
dc1394îr‹_t
 
dc1394_„©uª_ãm≥øtuª_gë_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
èrgë_ãm≥øtuª
, uöt32_à*
ãm≥øtuª
);

244 
dc1394îr‹_t
 
dc1394_„©uª_ãm≥øtuª_£t_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
èrgë_ãm≥øtuª
);

249 
dc1394îr‹_t
 
dc1394_„©uª_whôeshadög_gë_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
r_vÆue
, uöt32_à*
g_vÆue
, uöt32_à*
b_vÆue
);

254 
dc1394îr‹_t
 
dc1394_„©uª_whôeshadög_£t_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
r_vÆue
, uöt32_à
g_vÆue
, uöt32_à
b_vÆue
);

259 
dc1394îr‹_t
 
dc1394_„©uª_gë_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
uöt32_t
 *
vÆue
);

264 
dc1394îr‹_t
 
dc1394_„©uª_£t_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
uöt32_t
 
vÆue
);

269 
dc1394îr‹_t
 
dc1394_„©uª_is_¥e£¡
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394boﬁ_t
 *
vÆue
);

274 
dc1394îr‹_t
 
dc1394_„©uª_is_ªadabÀ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394boﬁ_t
 *
vÆue
);

279 
dc1394îr‹_t
 
dc1394_„©uª_gë_bound¨õs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
uöt32_t
 *
mö
, uöt32_à*
max
);

284 
dc1394îr‹_t
 
dc1394_„©uª_is_swôchabÀ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394boﬁ_t
 *
vÆue
);

289 
dc1394îr‹_t
 
dc1394_„©uª_gë_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394swôch_t
 *
pwr
);

294 
dc1394îr‹_t
 
dc1394_„©uª_£t_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394swôch_t
 
pwr
);

299 
dc1394îr‹_t
 
dc1394_„©uª_gë_modes
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394„©uª_modes_t
 *
modes
);

304 
dc1394îr‹_t
 
dc1394_„©uª_gë_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394„©uª_mode_t
 *
mode
);

309 
dc1394îr‹_t
 
dc1394_„©uª_£t_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394„©uª_mode_t
 
mode
);

314 
dc1394îr‹_t
 
dc1394_„©uª_has_absﬁuã_c⁄åﬁ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394boﬁ_t
 *
vÆue
);

319 
dc1394îr‹_t
 
dc1394_„©uª_gë_absﬁuã_bound¨õs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, *
mö
, *
max
);

324 
dc1394îr‹_t
 
dc1394_„©uª_gë_absﬁuã_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, *
vÆue
);

329 
dc1394îr‹_t
 
dc1394_„©uª_£t_absﬁuã_vÆue
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
vÆue
);

334 
dc1394îr‹_t
 
dc1394_„©uª_gë_absﬁuã_c⁄åﬁ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394swôch_t
 *
pwr
);

339 
dc1394îr‹_t
 
dc1394_„©uª_£t_absﬁuã_c⁄åﬁ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394„©uª_t
 
„©uª
, 
dc1394swôch_t
 
pwr
);

348 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_£t_pﬁ¨ôy
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_pﬁ¨ôy_t
 
pﬁ¨ôy
);

353 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_gë_pﬁ¨ôy
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_pﬁ¨ôy_t
 *
pﬁ¨ôy
);

358 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_has_pﬁ¨ôy
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 *
pﬁ¨ôy_ˇ∑bÀ
);

363 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_£t_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 
pwr
);

368 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_gë_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 *
pwr
);

373 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_£t_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_mode_t
 
mode
);

378 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_gë_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_mode_t
 *
mode
);

383 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_£t_sour˚
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_sour˚_t
 
sour˚
);

388 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_gë_sour˚
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_sour˚_t
 *
sour˚
);

393 
dc1394îr‹_t
 
dc1394_exã∫Æ_åiggî_gë_suµ‹ãd_sour˚s
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394åiggî_sour˚s_t
 *
sour˚s
);

398 
dc1394îr‹_t
 
dc1394_so·w¨e_åiggî_£t_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 
pwr
);

403 
dc1394îr‹_t
 
dc1394_so·w¨e_åiggî_gë_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 *
pwr
);

412 
dc1394îr‹_t
 
dc1394_pio_£t
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
vÆue
);

417 
dc1394îr‹_t
 
dc1394_pio_gë
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
vÆue
);

426 
dc1394îr‹_t
 
dc1394_ˇmîa_ª£t
(
dc1394ˇmîa_t
 *
ˇmîa
);

431 
dc1394îr‹_t
 
dc1394_ˇmîa_£t_powî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 
pwr
);

436 
dc1394îr‹_t
 
dc1394_mem‹y_busy
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 *
vÆue
);

444 
dc1394îr‹_t
 
dc1394_mem‹y_ßve
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
ch™√l
);

449 
dc1394îr‹_t
 
dc1394_mem‹y_lﬂd
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
ch™√l
);

452 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/conversions.h

23 
	~<dc1394/log.h
>

25 #i‚de‡
__DC1394_CONVERSIONS_H__


26 
	#__DC1394_CONVERSIONS_H__


	)

37 
	#ª°ri˘
 
__ª°ri˘


	)

45 
	mDC1394_BAYER_METHOD_NEAREST
=0,

46 
	mDC1394_BAYER_METHOD_SIMPLE
,

47 
	mDC1394_BAYER_METHOD_BILINEAR
,

48 
	mDC1394_BAYER_METHOD_HQLINEAR
,

49 
	mDC1394_BAYER_METHOD_DOWNSAMPLE
,

50 
	mDC1394_BAYER_METHOD_EDGESENSE
,

51 
	mDC1394_BAYER_METHOD_VNG
,

52 
	mDC1394_BAYER_METHOD_AHD


53 } 
	tdc1394bayî_mëhod_t
;

54 
	#DC1394_BAYER_METHOD_MIN
 
DC1394_BAYER_METHOD_NEAREST


	)

55 
	#DC1394_BAYER_METHOD_MAX
 
DC1394_BAYER_METHOD_AHD


	)

56 
	#DC1394_BAYER_METHOD_NUM
 (
DC1394_BAYER_METHOD_MAX
-
DC1394_BAYER_METHOD_MIN
+1)

	)

62 
	mDC1394_STEREO_METHOD_INTERLACED
=0,

63 
	mDC1394_STEREO_METHOD_FIELD


64 } 
	tdc1394°îeo_mëhod_t
;

65 
	#DC1394_STEREO_METHOD_MIN
 
DC1394_STEREO_METHOD_INTERLACED


	)

66 
	#DC1394_STEREO_METHOD_MAX
 
DC1394_STEREO_METHOD_FIELD


	)

67 
	#DC1394_STEREO_METHOD_NUM
 (
DC1394_STEREO_METHOD_MAX
-
DC1394_STEREO_METHOD_MIN
+1)

	)

72 
	#YUV2RGB
(
y
, 
u
, 
v
, 
r
, 
g
, 
b
) {\

73 
r
 = 
y
 + ((
v
*1436) >> 10);\

74 
g
 = 
y
 - ((
u
*352 + 
v
*731) >> 10);\

75 
b
 = 
y
 + ((
u
*1814) >> 10);\

76 
r
 =Ñ < 0 ? 0 :Ñ;\

77 
g
 = g < 0 ? 0 : g;\

78 
b
 = b < 0 ? 0 : b;\

79 
r
 =Ñ > 255 ? 255 :Ñ;\

80 
g
 = g > 255 ? 255 : g;\

81 
b
 = b > 255 ? 255 : b; }

	)

84 
	#RGB2YUV
(
r
, 
g
, 
b
, 
y
, 
u
, 
v
) {\

85 
y
 = (306*
r
 + 601*
g
 + 117*
b
) >> 10;\

86 
u
 = ((-172*
r
 - 340*
g
 + 512*
b
) >> 10) + 128;\

87 
v
 = ((512*
r
 - 429*
g
 - 83*
b
) >> 10) + 128;\

88 
y
 = y < 0 ? 0 : y;\

89 
u
 = u < 0 ? 0 : u;\

90 
v
 = v < 0 ? 0 : v;\

91 
y
 = y > 255 ? 255 : y;\

92 
u
 = u > 255 ? 255 : u;\

93 
v
 = v > 255 ? 255 : v; }

	)

95 #ifde‡
__˝lu•lus


106 
dc1394îr‹_t


107 
dc1394_c⁄vît_to_YUV422
(
uöt8_t
 *
§c
, uöt8_à*
de°
, 
uöt32_t
 
width
, uöt32_à
height
, uöt32_à
byã_‹dî
,

108 
dc1394cﬁ‹_codög_t
 
sour˚_codög
, 
uöt32_t
 
bôs
);

113 
dc1394îr‹_t


114 
dc1394_c⁄vît_to_MONO8
(
uöt8_t
 *
§c
, uöt8_à*
de°
, 
uöt32_t
 
width
, uöt32_à
height
, uöt32_à
byã_‹dî
,

115 
dc1394cﬁ‹_codög_t
 
sour˚_codög
, 
uöt32_t
 
bôs
);

120 
dc1394îr‹_t


121 
dc1394_c⁄vît_to_RGB8
(
uöt8_t
 *
§c
, uöt8_à*
de°
, 
uöt32_t
 
width
, uöt32_à
height
, uöt32_à
byã_‹dî
,

122 
dc1394cﬁ‹_codög_t
 
sour˚_codög
, 
uöt32_t
 
bôs
);

131 
dc1394îr‹_t


132 
dc1394_deöãæa˚_°îeo
(
uöt8_t
 *
§c
, uöt8_à*
de°
, 
uöt32_t
 
width
, uöt32_à
height
);

167 
dc1394îr‹_t


168 
dc1394_bayî_decodög_8bô
(c⁄° 
uöt8_t
 *
bayî
, uöt8_à*
rgb
,

169 
uöt32_t
 
width
, uöt32_à
height
, 
dc1394cﬁ‹_fûãr_t
 
tûe
,

170 
dc1394bayî_mëhod_t
 
mëhod
);

175 
dc1394îr‹_t


176 
dc1394_bayî_decodög_16bô
(c⁄° 
uöt16_t
 *
bayî
, uöt16_à*
rgb
,

177 
uöt32_t
 
width
, uöt32_à
height
, 
dc1394cﬁ‹_fûãr_t
 
tûe
,

178 
dc1394bayî_mëhod_t
 
mëhod
, 
uöt32_t
 
bôs
);

190 
dc1394îr‹_t


191 
dc1394_c⁄vît_‰ames
(
dc1394video_‰ame_t
 *
ö
, dc1394video_‰ame_à*
out
);

203 
dc1394îr‹_t


204 
dc1394_debayî_‰ames
(
dc1394video_‰ame_t
 *
ö
, dc1394video_‰ame_à*
out
, 
dc1394bayî_mëhod_t
 
mëhod
);

211 
dc1394îr‹_t


212 
dc1394_deöãæa˚_°îeo_‰ames
(
dc1394video_‰ame_t
 *
ö
, dc1394video_‰ame_à*
out
, 
dc1394°îeo_mëhod_t
 
mëhod
);

214 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/format7.h

23 
	~<dc1394/log.h
>

24 
	~<dc1394/video.h
>

26 #i‚de‡
__DC1394_FORMAT7_H__


27 
	#__DC1394_FORMAT7_H__


	)

38 
	s__dc1394f‹m©7mode_t


40 
dc1394boﬁ_t
 
	m¥e£¡
;

42 
uöt32_t
 
	msize_x
;

43 
uöt32_t
 
	msize_y
;

44 
uöt32_t
 
	mmax_size_x
;

45 
uöt32_t
 
	mmax_size_y
;

47 
uöt32_t
 
	mpos_x
;

48 
uöt32_t
 
	mpos_y
;

50 
uöt32_t
 
	munô_size_x
;

51 
uöt32_t
 
	munô_size_y
;

52 
uöt32_t
 
	munô_pos_x
;

53 
uöt32_t
 
	munô_pos_y
;

55 
dc1394cﬁ‹_codögs_t
 
	mcﬁ‹_codögs
;

56 
dc1394cﬁ‹_codög_t
 
	mcﬁ‹_codög
;

58 
uöt32_t
 
	mpixnum
;

60 
uöt32_t
 
	m∑ckë_size
;

61 
uöt32_t
 
	munô_∑ckë_size
;

62 
uöt32_t
 
	mmax_∑ckë_size
;

64 
uöt64_t
 
	mtŸÆ_byãs
;

66 
dc1394cﬁ‹_fûãr_t
 
	mcﬁ‹_fûãr
;

68 } 
	tdc1394f‹m©7mode_t
;

74 
	s__dc1394f‹m©7mode£t_t


76 
dc1394f‹m©7mode_t
 
	mmode
[
DC1394_VIDEO_MODE_FORMAT7_NUM
];

77 } 
	tdc1394f‹m©7mode£t_t
;

80 
	#DC1394_QUERY_FROM_CAMERA
 -1

	)

81 
	#DC1394_USE_MAX_AVAIL
 -2

	)

82 
	#DC1394_USE_RECOMMENDED
 -3

	)

84 #ifde‡
__˝lu•lus


97 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_max_image_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
h_size
,uöt32_à*
v_size
);

102 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_unô_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
h_unô
, uöt32_à*
v_unô
);

107 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_image_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
width
, uöt32_à*
height
);

112 
dc1394îr‹_t
 
dc1394_f‹m©7_£t_image_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 
width
, uöt32_à
height
);

119 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_image_posôi⁄
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
À·
, uöt32_à*
t›
);

124 
dc1394îr‹_t
 
dc1394_f‹m©7_£t_image_posôi⁄
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 
À·
, uöt32_à
t›
);

129 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_unô_posôi⁄
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
h_unô_pos
, uöt32_à*
v_unô_pos
);

136 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_cﬁ‹_codög
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codög_t
 *
cﬁ‹_codög
);

141 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_cﬁ‹_codögs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codögs_t
 *
codögs
);

146 
dc1394îr‹_t
 
dc1394_f‹m©7_£t_cﬁ‹_codög
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codög_t
 
cﬁ‹_codög
);

151 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_cﬁ‹_fûãr
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_fûãr_t
 *
cﬁ‹_fûãr
);

158 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_∑ckë_∑ømëîs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
unô_byãs
, uöt32_à*
max_byãs
);

163 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_∑ckë_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
∑ckë_size
);

168 
dc1394îr‹_t
 
dc1394_f‹m©7_£t_∑ckë_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 
∑ckë_size
);

173 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_ªcommíded_∑ckë_size
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
∑ckë_size
);

178 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_∑ckës_≥r_‰ame
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
µf
);

185 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_d©a_dïth
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
d©a_dïth
);

190 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_‰ame_öãrvÆ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, *
öãrvÆ
);

195 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_pixñ_numbî
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt32_t
 *
pixnum
);

200 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_tŸÆ_byãs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
uöt64_t
 *
tŸÆ_byãs
);

207 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_mode£t
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394f‹m©7mode£t_t
 *
öfo
);

212 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_mode_öfo
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394f‹m©7mode_t
 *
f7_mode
);

218 
dc1394îr‹_t
 
dc1394_f‹m©7_£t_roi
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codög_t
 
cﬁ‹_codög
,

219 
öt32_t
 
∑ckë_size
, i¡32_à
À·
, i¡32_à
t›
, i¡32_à
width
, i¡32_à
height
);

224 
dc1394îr‹_t
 
dc1394_f‹m©7_gë_roi
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codög_t
 *
cﬁ‹_codög
,

225 
uöt32_t
 *
∑ckë_size
, uöt32_à*
À·
, uöt32_à*
t›
, uöt32_à*
width
, uöt32_à*
height
);

227 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/iso.h

23 #i‚de‡
__DC1394_ISO_H__


24 
	#__DC1394_ISO_H__


	)

34 
	~<dc1394/log.h
>

36 #ifde‡
__˝lu•lus


56 
dc1394îr‹_t
 
dc1394_iso_£t_≥rsi°
 (
dc1394ˇmîa_t
 * 
ˇmîa
);

83 
dc1394îr‹_t
 
dc1394_iso_Æloˇã_ch™√l
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

84 
uöt64_t
 
ch™√ls_Ælowed
, * 
ch™√l
);

100 
dc1394îr‹_t
 
dc1394_iso_ªÀa£_ch™√l
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

101 
ch™√l
);

122 
dc1394îr‹_t
 
dc1394_iso_Æloˇã_b™dwidth
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

123 
b™dwidth_unôs
);

144 
dc1394îr‹_t
 
dc1394_iso_ªÀa£_b™dwidth
 (
dc1394ˇmîa_t
 * 
ˇmîa
,

145 
b™dwidth_unôs
);

161 
dc1394îr‹_t
 
dc1394_iso_ªÀa£_Æl
 (
dc1394ˇmîa_t
 * 
ˇmîa
);

163 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/log.h

45 
	~<dc1394/dc1394.h
>

47 #i‚de‡
__DC1394_LOG_H__


48 
	#__DC1394_LOG_H__


	)

65 
	mDC1394_SUCCESS
 = 0,

66 
	mDC1394_FAILURE
 = -1,

67 
	mDC1394_NOT_A_CAMERA
 = -2,

68 
	mDC1394_FUNCTION_NOT_SUPPORTED
 = -3,

69 
	mDC1394_CAMERA_NOT_INITIALIZED
 = -4,

70 
	mDC1394_MEMORY_ALLOCATION_FAILURE
 = -5,

71 
	mDC1394_TAGGED_REGISTER_NOT_FOUND
 = -6,

72 
	mDC1394_NO_ISO_CHANNEL
 = -7,

73 
	mDC1394_NO_BANDWIDTH
 = -8,

74 
	mDC1394_IOCTL_FAILURE
 = -9,

75 
	mDC1394_CAPTURE_IS_NOT_SET
 = -10,

76 
	mDC1394_CAPTURE_IS_RUNNING
 = -11,

77 
	mDC1394_RAW1394_FAILURE
 = -12,

78 
	mDC1394_FORMAT7_ERROR_FLAG_1
 = -13,

79 
	mDC1394_FORMAT7_ERROR_FLAG_2
 = -14,

80 
	mDC1394_INVALID_ARGUMENT_VALUE
 = -15,

81 
	mDC1394_REQ_VALUE_OUTSIDE_RANGE
 = -16,

82 
	mDC1394_INVALID_FEATURE
 = -17,

83 
	mDC1394_INVALID_VIDEO_FORMAT
 = -18,

84 
	mDC1394_INVALID_VIDEO_MODE
 = -19,

85 
	mDC1394_INVALID_FRAMERATE
 = -20,

86 
	mDC1394_INVALID_TRIGGER_MODE
 = -21,

87 
	mDC1394_INVALID_TRIGGER_SOURCE
 = -22,

88 
	mDC1394_INVALID_ISO_SPEED
 = -23,

89 
	mDC1394_INVALID_IIDC_VERSION
 = -24,

90 
	mDC1394_INVALID_COLOR_CODING
 = -25,

91 
	mDC1394_INVALID_COLOR_FILTER
 = -26,

92 
	mDC1394_INVALID_CAPTURE_POLICY
 = -27,

93 
	mDC1394_INVALID_ERROR_CODE
 = -28,

94 
	mDC1394_INVALID_BAYER_METHOD
 = -29,

95 
	mDC1394_INVALID_VIDEO1394_DEVICE
 = -30,

96 
	mDC1394_INVALID_OPERATION_MODE
 = -31,

97 
	mDC1394_INVALID_TRIGGER_POLARITY
 = -32,

98 
	mDC1394_INVALID_FEATURE_MODE
 = -33,

99 
	mDC1394_INVALID_LOG_TYPE
 = -34,

100 
	mDC1394_INVALID_BYTE_ORDER
 = -35,

101 
	mDC1394_INVALID_STEREO_METHOD
 = -36,

102 
	mDC1394_BASLER_NO_MORE_SFF_CHUNKS
 = -37,

103 
	mDC1394_BASLER_CORRUPTED_SFF_CHUNK
 = -38,

104 
	mDC1394_BASLER_UNKNOWN_SFF_CHUNK
 = -39

105 } 
	tdc1394îr‹_t
;

106 
	#DC1394_ERROR_MIN
 
DC1394_BASLER_UNKNOWN_SFF_CHUNK


	)

107 
	#DC1394_ERROR_MAX
 
DC1394_SUCCESS


	)

108 
	#DC1394_ERROR_NUM
 (
DC1394_ERROR_MAX
-
DC1394_ERROR_MIN
+1)

	)

119 
	mDC1394_LOG_ERROR
=768,

120 
	mDC1394_LOG_WARNING
,

121 
	mDC1394_LOG_DEBUG


122 } 
	tdc1394log_t
;

123 
	#DC1394_LOG_MIN
 
DC1394_LOG_ERROR


	)

124 
	#DC1394_LOG_MAX
 
DC1394_LOG_DEBUG


	)

125 
	#DC1394_LOG_NUM
 (
DC1394_LOG_MAX
 - 
DC1394_LOG_MIN
 + 1)

	)

127 #i‡! 
deföed
 (
_MSC_VER
)

132 
	#DC1394_WRN
(
îr
,
mesßge
) \

134 i‡((
îr
>0)||”º<=-
DC1394_ERROR_NUM
)) \

135 
îr
=
DC1394_INVALID_ERROR_CODE
; \

137 i‡(
îr
!=
DC1394_SUCCESS
) { \

138 
	`dc1394_log_w¨nög
("%s: in %s (%s,Üine %d): %s\n", \

139 
	`dc1394_îr‹_gë_°rög
(
îr
), \

140 
__FUNCTION__
, 
__FILE__
, 
__LINE__
, 
mesßge
); \

142 } 0);

	)

144 
	#DC1394_ERR
(
îr
,
mesßge
) \

146 i‡((
îr
>0)||”º<=-
DC1394_ERROR_NUM
)) \

147 
îr
=
DC1394_INVALID_ERROR_CODE
; \

149 i‡(
îr
!=
DC1394_SUCCESS
) { \

150 
	`dc1394_log_îr‹
("%s: in %s (%s,Üine %d): %s\n", \

151 
	`dc1394_îr‹_gë_°rög
(
îr
), \

152 
__FUNCTION__
, 
__FILE__
, 
__LINE__
, 
mesßge
); \

155 } 0);

	)

157 
	#DC1394_ERR_RTN
(
îr
,
mesßge
) \

159 i‡((
îr
>0)||”º<=-
DC1394_ERROR_NUM
)) \

160 
îr
=
DC1394_INVALID_ERROR_CODE
; \

162 i‡(
îr
!=
DC1394_SUCCESS
) { \

163 
	`dc1394_log_îr‹
("%s: in %s (%s,Üine %d): %s\n", \

164 
	`dc1394_îr‹_gë_°rög
(
îr
), \

165 
__FUNCTION__
, 
__FILE__
, 
__LINE__
, 
mesßge
); \

166  
îr
; \

168 } 0);

	)

170 
	#DC1394_ERR_CLN
(
îr
,
˛ónup
,
mesßge
) \

172 i‡((
îr
>0)||”º<=-
DC1394_ERROR_NUM
)) \

173 
îr
=
DC1394_INVALID_ERROR_CODE
; \

175 i‡(
îr
!=
DC1394_SUCCESS
) { \

176 
	`dc1394_log_îr‹
("%s: in %s (%s,Üine %d): %s\n", \

177 
	`dc1394_îr‹_gë_°rög
(
îr
), \

178 
__FUNCTION__
, 
__FILE__
, 
__LINE__
, 
mesßge
); \

179 
˛ónup
; \

182 } 0);

	)

184 
	#DC1394_ERR_CLN_RTN
(
îr
,
˛ónup
,
mesßge
) \

186 i‡((
îr
>0)||”º<=-
DC1394_ERROR_NUM
)) \

187 
îr
=
DC1394_INVALID_ERROR_CODE
; \

189 i‡(
îr
!=
DC1394_SUCCESS
) { \

190 
	`dc1394_log_îr‹
("%s: in %s (%s,Üine %d): %s\n", \

191 
	`dc1394_îr‹_gë_°rög
(
îr
), \

192 
__FUNCTION__
, 
__FILE__
, 
__LINE__
, 
mesßge
); \

193 
˛ónup
; \

194  
îr
; \

196 } 0);

	)

201 #ifde‡
__˝lu•lus


213 
dc1394îr‹_t
 
dc1394_log_ªgi°î_h™dÀr
(
dc1394log_t
 
ty≥
, (*
log_h™dÀr
)(dc1394log_tÅype,

214 c⁄° *
mesßge
, * 
u£r
), * user);

221 
dc1394îr‹_t
 
dc1394_log_£t_deÁu…_h™dÀr
(
dc1394log_t
 
ty≥
);

230 
dc1394_log_îr‹
(c⁄° *
f‹m©
,...);

239 
dc1394_log_w¨nög
(c⁄° *
f‹m©
,...);

249 
dc1394_log_debug
(c⁄° *
f‹m©
,...);

251 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/register.h

23 #i‚de‡
__DC1394_REGISTER_H__


24 
	#__DC1394_REGISTER_H__


	)

34 #ifde‡
__˝lu•lus


41 
dc1394îr‹_t
 
dc1394_gë_ªgi°îs
 (
dc1394ˇmîa_t
 *
ˇmîa
,

42 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

47 
ölöe
 
dc1394îr‹_t
 
dc1394_gë_ªgi°î
 (
dc1394ˇmîa_t
 *
ˇmîa
,

48 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
)

50  
dc1394_gë_ªgi°îs
 (
ˇmîa
, 
off£t
, 
vÆue
, 1);

56 
dc1394îr‹_t
 
dc1394_£t_ªgi°îs
 (
dc1394ˇmîa_t
 *
ˇmîa
,

57 
uöt64_t
 
off£t
, c⁄° 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

62 
ölöe
 
dc1394îr‹_t
 
dc1394_£t_ªgi°î
 (
dc1394ˇmîa_t
 *
ˇmîa
,

63 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
)

65  
dc1394_£t_ªgi°îs
 (
ˇmîa
, 
off£t
, &
vÆue
, 1);

76 
dc1394îr‹_t
 
dc1394_gë_c⁄åﬁ_ªgi°îs
 (
dc1394ˇmîa_t
 *
ˇmîa
,

77 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

82 
ölöe
 
dc1394îr‹_t
 
dc1394_gë_c⁄åﬁ_ªgi°î
 (
dc1394ˇmîa_t
 *
ˇmîa
,

83 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
)

85  
dc1394_gë_c⁄åﬁ_ªgi°îs
 (
ˇmîa
, 
off£t
, 
vÆue
, 1);

91 
dc1394îr‹_t
 
dc1394_£t_c⁄åﬁ_ªgi°îs
 (
dc1394ˇmîa_t
 *
ˇmîa
,

92 
uöt64_t
 
off£t
, c⁄° 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

97 
ölöe
 
dc1394îr‹_t
 
dc1394_£t_c⁄åﬁ_ªgi°î
 (
dc1394ˇmîa_t
 *
ˇmîa
,

98 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
)

100  
dc1394_£t_c⁄åﬁ_ªgi°îs
 (
ˇmîa
, 
off£t
, &
vÆue
, 1);

111 
dc1394îr‹_t


112 
dc1394_gë_adv_c⁄åﬁ_ªgi°îs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

117 
ölöe
 
dc1394îr‹_t


118 
dc1394_gë_adv_c⁄åﬁ_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
)

120  
dc1394_gë_adv_c⁄åﬁ_ªgi°îs
(
ˇmîa
, 
off£t
, 
vÆue
, 1);

126 
dc1394îr‹_t


127 
dc1394_£t_adv_c⁄åﬁ_ªgi°îs
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
,

128 c⁄° 
uöt32_t
 *
vÆue
, uöt32_à
num_ªgs
);

133 
ölöe
 
dc1394îr‹_t


134 
dc1394_£t_adv_c⁄åﬁ_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
)

136  
dc1394_£t_adv_c⁄åﬁ_ªgi°îs
(
ˇmîa
, 
off£t
, &
vÆue
, 1);

147 
dc1394îr‹_t


148 
dc1394_gë_f‹m©7_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
mode
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
);

153 
dc1394îr‹_t


154 
dc1394_£t_f‹m©7_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
mode
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
);

164 
dc1394îr‹_t


165 
dc1394_gë_absﬁuã_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
„©uª
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
);

170 
dc1394îr‹_t


171 
dc1394_£t_absﬁuã_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
„©uª
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
);

181 
dc1394îr‹_t


182 
dc1394_gë_PIO_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
);

187 
dc1394îr‹_t


188 
dc1394_£t_PIO_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
);

198 
dc1394îr‹_t


199 
dc1394_gë_SIO_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
);

204 
dc1394îr‹_t


205 
dc1394_£t_SIO_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
);

215 
dc1394îr‹_t


216 
dc1394_gë_°robe_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 *
vÆue
);

221 
dc1394îr‹_t


222 
dc1394_£t_°robe_ªgi°î
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt64_t
 
off£t
, 
uöt32_t
 
vÆue
);

225 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/types.h

23 #i‚de‡
__DC1394_TYPES_H__


24 
	#__DC1394_TYPES_H__


	)

32 
	~<°döt.h
>

38 
	mDC1394_VIDEO_MODE_160x120_YUV444
= 64,

39 
	mDC1394_VIDEO_MODE_320x240_YUV422
,

40 
	mDC1394_VIDEO_MODE_640x480_YUV411
,

41 
	mDC1394_VIDEO_MODE_640x480_YUV422
,

42 
	mDC1394_VIDEO_MODE_640x480_RGB8
,

43 
	mDC1394_VIDEO_MODE_640x480_MONO8
,

44 
	mDC1394_VIDEO_MODE_640x480_MONO16
,

45 
	mDC1394_VIDEO_MODE_800x600_YUV422
,

46 
	mDC1394_VIDEO_MODE_800x600_RGB8
,

47 
	mDC1394_VIDEO_MODE_800x600_MONO8
,

48 
	mDC1394_VIDEO_MODE_1024x768_YUV422
,

49 
	mDC1394_VIDEO_MODE_1024x768_RGB8
,

50 
	mDC1394_VIDEO_MODE_1024x768_MONO8
,

51 
	mDC1394_VIDEO_MODE_800x600_MONO16
,

52 
	mDC1394_VIDEO_MODE_1024x768_MONO16
,

53 
	mDC1394_VIDEO_MODE_1280x960_YUV422
,

54 
	mDC1394_VIDEO_MODE_1280x960_RGB8
,

55 
	mDC1394_VIDEO_MODE_1280x960_MONO8
,

56 
	mDC1394_VIDEO_MODE_1600x1200_YUV422
,

57 
	mDC1394_VIDEO_MODE_1600x1200_RGB8
,

58 
	mDC1394_VIDEO_MODE_1600x1200_MONO8
,

59 
	mDC1394_VIDEO_MODE_1280x960_MONO16
,

60 
	mDC1394_VIDEO_MODE_1600x1200_MONO16
,

61 
	mDC1394_VIDEO_MODE_EXIF
,

62 
	mDC1394_VIDEO_MODE_FORMAT7_0
,

63 
	mDC1394_VIDEO_MODE_FORMAT7_1
,

64 
	mDC1394_VIDEO_MODE_FORMAT7_2
,

65 
	mDC1394_VIDEO_MODE_FORMAT7_3
,

66 
	mDC1394_VIDEO_MODE_FORMAT7_4
,

67 
	mDC1394_VIDEO_MODE_FORMAT7_5
,

68 
	mDC1394_VIDEO_MODE_FORMAT7_6
,

69 
	mDC1394_VIDEO_MODE_FORMAT7_7


70 } 
	tdc1394video_mode_t
;

71 
	#DC1394_VIDEO_MODE_MIN
 
DC1394_VIDEO_MODE_160x120_YUV444


	)

72 
	#DC1394_VIDEO_MODE_MAX
 
DC1394_VIDEO_MODE_FORMAT7_7


	)

73 
	#DC1394_VIDEO_MODE_NUM
 (
DC1394_VIDEO_MODE_MAX
 - 
DC1394_VIDEO_MODE_MIN
 + 1)

	)

76 
	#DC1394_VIDEO_MODE_FORMAT7_MIN
 
DC1394_VIDEO_MODE_FORMAT7_0


	)

77 
	#DC1394_VIDEO_MODE_FORMAT7_MAX
 
DC1394_VIDEO_MODE_FORMAT7_7


	)

78 
	#DC1394_VIDEO_MODE_FORMAT7_NUM
 (
DC1394_VIDEO_MODE_FORMAT7_MAX
 - 
DC1394_VIDEO_MODE_FORMAT7_MIN
 + 1)

	)

84 
	mDC1394_COLOR_CODING_MONO8
= 352,

85 
	mDC1394_COLOR_CODING_YUV411
,

86 
	mDC1394_COLOR_CODING_YUV422
,

87 
	mDC1394_COLOR_CODING_YUV444
,

88 
	mDC1394_COLOR_CODING_RGB8
,

89 
	mDC1394_COLOR_CODING_MONO16
,

90 
	mDC1394_COLOR_CODING_RGB16
,

91 
	mDC1394_COLOR_CODING_MONO16S
,

92 
	mDC1394_COLOR_CODING_RGB16S
,

93 
	mDC1394_COLOR_CODING_RAW8
,

94 
	mDC1394_COLOR_CODING_RAW16


95 } 
	tdc1394cﬁ‹_codög_t
;

96 
	#DC1394_COLOR_CODING_MIN
 
DC1394_COLOR_CODING_MONO8


	)

97 
	#DC1394_COLOR_CODING_MAX
 
DC1394_COLOR_CODING_RAW16


	)

98 
	#DC1394_COLOR_CODING_NUM
 (
DC1394_COLOR_CODING_MAX
 - 
DC1394_COLOR_CODING_MIN
 + 1)

	)

109 
	mDC1394_COLOR_FILTER_RGGB
 = 512,

110 
	mDC1394_COLOR_FILTER_GBRG
,

111 
	mDC1394_COLOR_FILTER_GRBG
,

112 
	mDC1394_COLOR_FILTER_BGGR


113 } 
	tdc1394cﬁ‹_fûãr_t
;

114 
	#DC1394_COLOR_FILTER_MIN
 
DC1394_COLOR_FILTER_RGGB


	)

115 
	#DC1394_COLOR_FILTER_MAX
 
DC1394_COLOR_FILTER_BGGR


	)

116 
	#DC1394_COLOR_FILTER_NUM
 (
DC1394_COLOR_FILTER_MAX
 - 
DC1394_COLOR_FILTER_MIN
 + 1)

	)

124 
	mDC1394_BYTE_ORDER_UYVY
=800,

125 
	mDC1394_BYTE_ORDER_YUYV


126 } 
	tdc1394byã_‹dî_t
;

127 
	#DC1394_BYTE_ORDER_MIN
 
DC1394_BYTE_ORDER_UYVY


	)

128 
	#DC1394_BYTE_ORDER_MAX
 
DC1394_BYTE_ORDER_YUYV


	)

129 
	#DC1394_BYTE_ORDER_NUM
 (
DC1394_BYTE_ORDER_MAX
 - 
DC1394_BYTE_ORDER_MIN
 + 1)

	)

136 
uöt32_t
 
	mnum
;

137 
dc1394cﬁ‹_codög_t
 
	mcodögs
[
DC1394_COLOR_CODING_NUM
];

138 } 
	tdc1394cﬁ‹_codögs_t
;

145 
uöt32_t
 
	mnum
;

146 
dc1394video_mode_t
 
	mmodes
[
DC1394_VIDEO_MODE_NUM
];

147 } 
	tdc1394video_modes_t
;

153 
	mDC1394_FALSE
= 0,

154 
	mDC1394_TRUE


155 } 
	tdc1394boﬁ_t
;

161 
	mDC1394_OFF
= 0,

162 
	mDC1394_ON


163 } 
	tdc1394swôch_t
;

	@/usr/include/dc1394/utils.h

23 #i‚de‡
__DC1394_UTILS_H__


24 
	#__DC1394_UTILS_H__


	)

34 #ifde‡
__˝lu•lus


41 
dc1394îr‹_t
 
dc1394_gë_image_size_‰om_video_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
video_mode
, uöt32_à*
width
, uöt32_à*
height
);

46 
dc1394îr‹_t
 
dc1394_‰amî©e_as_Êﬂt
(
dc1394‰amî©e_t
 
‰amî©e_íum
, *
‰amî©e
);

52 
dc1394îr‹_t
 
dc1394_gë_cﬁ‹_codög_d©a_dïth
(
dc1394cﬁ‹_codög_t
 
cﬁ‹_codög
, 
uöt32_t
 * 
bôs
);

58 
dc1394îr‹_t
 
dc1394_gë_cﬁ‹_codög_bô_size
(
dc1394cﬁ‹_codög_t
 
cﬁ‹_codög
, 
uöt32_t
* 
bôs
);

63 
dc1394îr‹_t
 
dc1394_gë_cﬁ‹_codög_‰om_video_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394cﬁ‹_codög_t
 *
cﬁ‹_codög
);

68 
dc1394îr‹_t
 
dc1394_is_cﬁ‹
(
dc1394cﬁ‹_codög_t
 
cﬁ‹_mode
, 
dc1394boﬁ_t
 *
is_cﬁ‹
);

73 
dc1394boﬁ_t
 
dc1394_is_video_mode_sˇœbÀ
(
dc1394video_mode_t
 
video_mode
);

78 
dc1394boﬁ_t
 
dc1394_is_video_mode_°ûl_image
(
dc1394video_mode_t
 
video_mode
);

83 
dc1394boﬁ_t
 
dc1394_is_ßme_ˇmîa
(
dc1394ˇmîa_id_t
 
id1
, dc1394ˇmîa_id_à
id2
);

88 c⁄° * 
dc1394_„©uª_gë_°rög
(
dc1394„©uª_t
 
„©uª
);

93 c⁄° * 
dc1394_îr‹_gë_°rög
(
dc1394îr‹_t
 
îr‹
);

98 
uöt16_t
 
dc1394_checksum_¸c16
 (c⁄° 
uöt8_t
* 
buf„r
, 
uöt32_t
 
buf„r_size
);

100 #ifde‡
__˝lu•lus


	@/usr/include/dc1394/video.h

23 
	~<dc1394/log.h
>

31 #i‚de‡
__DC1394_VIDEO_H__


32 
	#__DC1394_VIDEO_H__


	)

42 
	mDC1394_ISO_SPEED_100
= 0,

43 
	mDC1394_ISO_SPEED_200
,

44 
	mDC1394_ISO_SPEED_400
,

45 
	mDC1394_ISO_SPEED_800
,

46 
	mDC1394_ISO_SPEED_1600
,

47 
	mDC1394_ISO_SPEED_3200


48 } 
	tdc1394•ìd_t
;

49 
	#DC1394_ISO_SPEED_MIN
 
DC1394_ISO_SPEED_100


	)

50 
	#DC1394_ISO_SPEED_MAX
 
DC1394_ISO_SPEED_3200


	)

51 
	#DC1394_ISO_SPEED_NUM
 (
DC1394_ISO_SPEED_MAX
 - 
DC1394_ISO_SPEED_MIN
 + 1)

	)

61 
	mDC1394_FRAMERATE_1_875
= 32,

62 
	mDC1394_FRAMERATE_3_75
,

63 
	mDC1394_FRAMERATE_7_5
,

64 
	mDC1394_FRAMERATE_15
,

65 
	mDC1394_FRAMERATE_30
,

66 
	mDC1394_FRAMERATE_60
,

67 
	mDC1394_FRAMERATE_120
,

68 
	mDC1394_FRAMERATE_240


69 } 
	tdc1394‰amî©e_t
;

70 
	#DC1394_FRAMERATE_MIN
 
DC1394_FRAMERATE_1_875


	)

71 
	#DC1394_FRAMERATE_MAX
 
DC1394_FRAMERATE_240


	)

72 
	#DC1394_FRAMERATE_NUM
 (
DC1394_FRAMERATE_MAX
 - 
DC1394_FRAMERATE_MIN
 + 1)

	)

81 
	mDC1394_OPERATION_MODE_LEGACY
 = 480,

82 
	mDC1394_OPERATION_MODE_1394B


83 } 
	tdc1394›î©i⁄_mode_t
;

84 
	#DC1394_OPERATION_MODE_MIN
 
DC1394_OPERATION_MODE_LEGACY


	)

85 
	#DC1394_OPERATION_MODE_MAX
 
DC1394_OPERATION_MODE_1394B


	)

86 
	#DC1394_OPERATION_MODE_NUM
 (
DC1394_OPERATION_MODE_MAX
 - 
DC1394_OPERATION_MODE_MIN
 + 1)

	)

94 
uöt32_t
 
	mnum
;

95 
dc1394‰amî©e_t
 
	m‰amî©es
[
DC1394_FRAMERATE_NUM
];

96 } 
	tdc1394‰amî©es_t
;

107 
	s__dc1394_video_‰ame


109 * 
	mimage
;

111 
uöt32_t
 
	msize
[2];

112 
uöt32_t
 
	mposôi⁄
[2];

113 
dc1394cﬁ‹_codög_t
 
	mcﬁ‹_codög
;

114 
dc1394cﬁ‹_fûãr_t
 
	mcﬁ‹_fûãr
;

115 
uöt32_t
 
	myuv_byã_‹dî
;

116 
uöt32_t
 
	md©a_dïth
;

118 
uöt32_t
 
	m°ride
;

119 
dc1394video_mode_t
 
	mvideo_mode
;

120 
uöt64_t
 
	mtŸÆ_byãs
;

122 
uöt32_t
 
	mimage_byãs
;

123 
uöt32_t
 
	m∑ddög_byãs
;

124 
uöt32_t
 
	m∑ckë_size
;

125 
uöt32_t
 
	m∑ckës_≥r_‰ame
;

126 
uöt64_t
 
	mtime°amp
;

128 
uöt32_t
 
	m‰ames_behöd
;

129 
dc1394ˇmîa_t
 *
	mˇmîa
;

130 
uöt32_t
 
	mid
;

131 
uöt64_t
 
	mÆloˇãd_image_byãs
;

132 
dc1394boﬁ_t
 
	mlôée_ídün
;

134 
dc1394boﬁ_t
 
	md©a_ö_∑ddög
;

136 } 
	tdc1394video_‰ame_t
;

138 #ifde‡
__˝lu•lus


149 
dc1394îr‹_t
 
dc1394_video_gë_suµ‹ãd_modes
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_modes_t
 *
video_modes
);

154 
dc1394îr‹_t
 
dc1394_video_gë_suµ‹ãd_‰amî©es
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
, 
dc1394‰amî©es_t
 *
‰amî©es
);

159 
dc1394îr‹_t
 
dc1394_video_gë_‰amî©e
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394‰amî©e_t
 *
‰amî©e
);

164 
dc1394îr‹_t
 
dc1394_video_£t_‰amî©e
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394‰amî©e_t
 
‰amî©e
);

169 
dc1394îr‹_t
 
dc1394_video_gë_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 *
video_mode
);

174 
dc1394îr‹_t
 
dc1394_video_£t_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394video_mode_t
 
video_mode
);

179 
dc1394îr‹_t
 
dc1394_video_gë_›î©i⁄_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394›î©i⁄_mode_t
 *
mode
);

184 
dc1394îr‹_t
 
dc1394_video_£t_›î©i⁄_mode
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394›î©i⁄_mode_t
 
mode
);

189 
dc1394îr‹_t
 
dc1394_video_gë_iso_•ìd
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394•ìd_t
 *
•ìd
);

194 
dc1394îr‹_t
 
dc1394_video_£t_iso_•ìd
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394•ìd_t
 
•ìd
);

199 
dc1394îr‹_t
 
dc1394_video_gë_iso_ch™√l
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 * 
ch™√l
);

204 
dc1394îr‹_t
 
dc1394_video_£t_iso_ch™√l
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
ch™√l
);

209 
dc1394îr‹_t
 
dc1394_video_gë_d©a_dïth
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
dïth
);

214 
dc1394îr‹_t
 
dc1394_video_£t_å™smissi⁄
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 
pwr
);

219 
dc1394îr‹_t
 
dc1394_video_gë_å™smissi⁄
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 *
pwr
);

224 
dc1394îr‹_t
 
dc1394_video_£t_⁄e_shŸ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394swôch_t
 
pwr
);

229 
dc1394îr‹_t
 
dc1394_video_gë_⁄e_shŸ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 *
is_⁄
);

234 
dc1394îr‹_t
 
dc1394_video_£t_mu…i_shŸ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 
numFømes
, 
dc1394swôch_t
 
pwr
);

239 
dc1394îr‹_t
 
dc1394_video_gë_mu…i_shŸ
(
dc1394ˇmîa_t
 *
ˇmîa
, 
dc1394boﬁ_t
 *
is_⁄
, 
uöt32_t
 *
numFømes
);

250 
dc1394îr‹_t
 
dc1394_video_gë_b™dwidth_ußge
(
dc1394ˇmîa_t
 *
ˇmîa
, 
uöt32_t
 *
b™dwidth
);

252 #ifde‡
__˝lu•lus


	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #unde‡
__USE_ISOC11


102 #unde‡
__USE_ISOC99


103 #unde‡
__USE_ISOC95


104 #unde‡
__USE_ISOCXX11


105 #unde‡
__USE_POSIX


106 #unde‡
__USE_POSIX2


107 #unde‡
__USE_POSIX199309


108 #unde‡
__USE_POSIX199506


109 #unde‡
__USE_XOPEN


110 #unde‡
__USE_XOPEN_EXTENDED


111 #unde‡
__USE_UNIX98


112 #unde‡
__USE_XOPEN2K


113 #unde‡
__USE_XOPEN2KXSI


114 #unde‡
__USE_XOPEN2K8


115 #unde‡
__USE_XOPEN2K8XSI


116 #unde‡
__USE_LARGEFILE


117 #unde‡
__USE_LARGEFILE64


118 #unde‡
__USE_FILE_OFFSET64


119 #unde‡
__USE_BSD


120 #unde‡
__USE_SVID


121 #unde‡
__USE_MISC


122 #unde‡
__USE_ATFILE


123 #unde‡
__USE_GNU


124 #unde‡
__USE_REENTRANT


125 #unde‡
__USE_FORTIFY_LEVEL


126 #unde‡
__KERNEL_STRICT_NAMES


130 #i‚de‡
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

143 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

150 #ifde‡
_GNU_SOURCE


151 #unde‡
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #unde‡
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #unde‡
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #unde‡
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #unde‡
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #unde‡
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #unde‡
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #unde‡
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #unde‡
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #unde‡
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #unde‡
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #unde‡
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

180 || (!
deföed
 
	g__STRICT_ANSI__
 \

181 && !
deföed
 
	g_ISOC99_SOURCE
 \

182 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

183 && !
deföed
 
	g_XOPEN_SOURCE
 \

184 && !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
))

185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #unde‡
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #unde‡
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #i‡(
deföed
 
_ISOC11_SOURCE
 \

195 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

201 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

207 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

216 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifde‡
_DEFAULT_SOURCE


224 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #unde‡
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #unde‡
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #unde‡
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #unde‡
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #unde‡
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #unde‡
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

285 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #unde‡
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #unde‡
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifde‡
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifde‡
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifde‡
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #i‡
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<°dc-¥edef.h
>

360 #unde‡
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

369 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

372 #i‚de‡
__ASSEMBLER__


373 #i‚de‡
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

388 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

389 && 
deföed
 
	g__exã∫_ölöe


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

19 #i‚de‡
_GETOPT_H


21 #i‚de‡
__√ed_gë›t


22 
	#_GETOPT_H
 1

	)

32 #i‡!
deföed
 
__GNU_LIBRARY__


33 
	~<˘y≥.h
>

36 #i‚de‡
__THROW


37 #i‚de‡
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

40 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__˝lu•lus


57 *
›èrg
;

71 
›töd
;

76 
›ãº
;

80 
›t›t
;

82 #i‚de‡
__√ed_gë›t


104 
	s›ti⁄


106 c⁄° *
	g«me
;

109 
	ghas_¨g
;

110 *
	gÊag
;

111 
	gvÆ
;

116 
	#no_¨gumít
 0

	)

117 
	#ªquúed_¨gumít
 1

	)

118 
	#›ti⁄Æ_¨gumít
 2

	)

146 #ifde‡
__GNU_LIBRARY__


150 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

151 
__THROW
;

153 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

154 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


158 #ifde‡
__REDIRECT


159 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

160 c⁄° *
__sh‹t›ts
),

161 
__posix_gë›t
);

163 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

164 c⁄° *
__sh‹t›ts
Ë
__THROW
;

165 
	#gë›t
 
__posix_gë›t


	)

169 
gë›t
 ();

172 #i‚de‡
__√ed_gë›t


173 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

174 c⁄° *
__sh‹t›ts
,

175 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

176 
__THROW
;

177 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

178 c⁄° *
__sh‹t›ts
,

179 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

180 
__THROW
;

184 #ifdef 
__˝lu•lus


189 #unde‡
__√ed_gë›t


	@/usr/include/inttypes.h

22 #i‚de‡
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<°döt.h
>

30 #i‚de‡
____gwch¨_t_deföed


31 #ifde‡
__˝lu•lus


32 
	#__gwch¨_t
 
wch¨_t


	)

33 #ñi‡
deföed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

36 
	#__√ed_wch¨_t


	)

37 
	~<°ddef.h
>

38 
wch¨_t
 
	t__gwch¨_t
;

40 
	#____gwch¨_t_deföed
 1

	)

43 #i‡
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Œ"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #i‡
__WORDSIZE
 == 64

273 
	mquŸ
;

274 
	mªm
;

275 } 
	timaxdiv_t
;

282 
__exãnsi⁄__
 
	mquŸ
;

283 
__exãnsi⁄__
 
	mªm
;

284 } 
	timaxdiv_t
;

290 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

294 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

297 
ötmax_t
 
	$°πoimax
 (c⁄° *
__ª°ri˘
 
__≈å
,

298 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

301 
uötmax_t
 
	$°πoumax
 (c⁄° *
__ª°ri˘
 
__≈å
,

302 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

305 
ötmax_t
 
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

306 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

307 
__THROW
;

310 
uötmax_t
 
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

311 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

312 
__THROW
;

314 #ifde‡
__USE_EXTERN_INLINES


316 #i‡
__WORDSIZE
 == 64

318 
	$__°πﬁ_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

319 **
__ª°ri˘
 
__íd±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

323 
__exã∫_ölöe
 
ötmax_t


324 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

325 
ba£
))

327  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

328 
	}
}

330 
	$__°πoul_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 ** 
__ª°ri˘
 
__íd±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

335 
__exã∫_ölöe
 
uötmax_t


336 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

337 
ba£
))

339  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc°ﬁ_öã∫Æ
 (c⁄° 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

343 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

347 
__exã∫_ölöe
 
ötmax_t


348 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

349 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

351  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc°oul_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

355 
__ª°ri˘
 
__≈å
,

356 
__gwch¨_t
 **

357 
__ª°ri˘
 
__íd±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

361 
__exã∫_ölöe
 
uötmax_t


362 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

363 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

365  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

366 
	}
}

370 
__exãnsi⁄__


371 
	$__°πﬁl_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

372 **
__ª°ri˘
 
__íd±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

376 
__exã∫_ölöe
 
ötmax_t


377 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

378 
ba£
))

380  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

381 
	}
}

383 
__exãnsi⁄__


384 
	$__°πouŒ_öã∫Æ
 (const *

385 
__ª°ri˘
 
__≈å
,

387 
__ª°ri˘
 
__íd±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

392 
__exã∫_ölöe
 
uötmax_t


393 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

394 
ba£
))

396  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

397 
	}
}

399 
__exãnsi⁄__


400 
	$__wc°ﬁl_öã∫Æ
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

401 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

405 
__exã∫_ölöe
 
ötmax_t


406 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

407 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

409  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

410 
	}
}

413 
__exãnsi⁄__


414 
	$__wc°ouŒ_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

415 
__ª°ri˘
 
__≈å
,

416 
__gwch¨_t
 **

417 
__ª°ri˘
 
__íd±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

422 
__exã∫_ölöe
 
uötmax_t


423 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

424 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

426  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/libio.h

28 #i‚de‡
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_c⁄fig.h
>

33 
	#_IO_Âos_t
 
_G_Âos_t


	)

34 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li°
 
_G_va_li°


	)

45 
	#_IO_wöt_t
 
wöt_t


	)

48 
	#__√ed___va_li°


	)

49 
	~<°d¨g.h
>

50 #ifde‡
__GNUC_VA_LIST


51 #unde‡
_IO_va_li°


52 
	#_IO_va_li°
 
__gnuc_va_li°


	)

55 #i‚de‡
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #i‚de‡
EOF


62 
	#EOF
 (-1)

	)

64 #i‚de‡
NULL


65 #i‡
deföed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuŒ
)

	)

69 #i‡!
deföed
(
__˝lu•lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifde‡
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifde‡
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifde‡
_IO_MTSAFE_IO


148 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<bôs/°dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¨kî
 {

161 
_IO_m¨kî
 *
	m_√xt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

169 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

170 
	mpublic
:

171 
°ªamm¨kî
(
°ªambuf
 *
sb
);

172 ~
°ªamm¨kî
();

173 
ßvög
(Ë{  
	m_•os
 == -2; }

174 
dñè
(
°ªamm¨kî
&);

175 
dñè
();

180 
	e__codecvt_ªsu…


182 
	m__codecvt_ok
,

183 
	m__codecvt_∑πül
,

184 
	m__codecvt_îr‹
,

185 
	m__codecvt_noc⁄v


188 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

194 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

195 
	m__mb°©e_t
 *,

196 c⁄° 
	mwch¨_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 **, *,

200 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

201 
	m__mb°©e_t
 *, *,

203 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

204 
	m__mb°©e_t
 *,

206 c⁄° **, 
	mwch¨_t
 *,

207 
	mwch¨_t
 *, wchar_t **);

208 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

211 c⁄° *, c⁄° *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

214 
_IO_ic⁄v_t
 
	m__cd_ö
;

215 
_IO_ic⁄v_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¨_t
 *
	m_IO_ªad_±r
;

222 
wch¨_t
 *
	m_IO_ªad_íd
;

223 
wch¨_t
 *
	m_IO_ªad_ba£
;

224 
wch¨_t
 *
	m_IO_wrôe_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_±r
;

226 
wch¨_t
 *
	m_IO_wrôe_íd
;

227 
wch¨_t
 *
	m_IO_buf_ba£
;

228 
wch¨_t
 *
	m_IO_buf_íd
;

230 
wch¨_t
 *
	m_IO_ßve_ba£
;

231 
wch¨_t
 *
	m_IO_backup_ba£
;

233 
wch¨_t
 *
	m_IO_ßve_íd
;

235 
__mb°©e_t
 
	m_IO_°©e
;

236 
__mb°©e_t
 
	m_IO_œ°_°©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¨_t
 
	m_sh‹tbuf
[1];

241 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

245 
	s_IO_FILE
 {

246 
	m_Êags
;

247 
	#_IO_fûe_Êags
 
_Êags


	)

251 * 
	m_IO_ªad_±r
;

252 * 
	m_IO_ªad_íd
;

253 * 
	m_IO_ªad_ba£
;

254 * 
	m_IO_wrôe_ba£
;

255 * 
	m_IO_wrôe_±r
;

256 * 
	m_IO_wrôe_íd
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_íd
;

260 *
	m_IO_ßve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_ßve_íd
;

264 
_IO_m¨kî
 *
	m_m¨kîs
;

266 
_IO_FILE
 *
	m_chaö
;

268 
	m_fûío
;

270 
	m_blksize
;

272 
	m_Êags2
;

274 
_IO_off_t
 
	m_ﬁd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cﬁumn
;

279 sig√d 
	m_vèbÀ_off£t
;

280 
	m_sh‹tbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifde‡
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com∂ëe


290 
_IO_FILE
 
	m_fûe
;

292 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_‰ìªs_li°
;

299 *
	m_‰ìªs_buf
;

300 
size_t
 
	m_‰ìªs_size
;

302 *
	m__∑d1
;

303 *
	m__∑d2
;

304 *
	m__∑d3
;

305 *
	m__∑d4
;

306 
size_t
 
	m__∑d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

314 #i‚de‡
__˝lu•lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_∂us
;

320 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

323 #i‚de‡
_LIBC


324 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

325 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

326 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

328 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

329 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

338 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

346 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_˛o£_‚
 (*
	t__cookõ
);

361 #ifde‡
_GNU_SOURCE


363 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

364 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

365 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

366 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

371 
__io_ªad_‚
 *
	mªad
;

372 
__io_wrôe_‚
 *
	mwrôe
;

373 
__io_£ek_‚
 *
	m£ek
;

374 
__io_˛o£_‚
 *
	m˛o£
;

375 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

376 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

378 
	g_IO_cookõ_fûe
;

381 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

382 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

386 #ifde‡
__˝lu•lus


390 
__undîÊow
 (
_IO_FILE
 *);

391 
__uÊow
 (
_IO_FILE
 *);

392 
__ovîÊow
 (
_IO_FILE
 *, );

393 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

395 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

399 #i‡ 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

402 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

405 
	#_IO_gëc_u∆ocked
(
_Â
) \

406 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

407 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

408 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

409 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

410 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

411 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

412 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

413 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

414 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

415 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

417 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_gëwc_u∆ocked
(
_Â
) \

419 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

420 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

421 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

422 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

423 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

424 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

425 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

426 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

427 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

428 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

431 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

432 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

434 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

436 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

437 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

439 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

443 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

445 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

446 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

449 #ifde‡
_IO_MTSAFE_IO


450 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

451 
	#_IO_Êockfûe
(
_Â
) \

452 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

453 
	#_IO_fu∆ockfûe
(
_Â
) \

454 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

456 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

457 
	#_IO_Êockfûe
(
_Â
Ë

	)

458 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

459 
	#_IO_·rylockfûe
(
_Â
Ë

	)

460 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

464 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

465 
_IO_va_li°
, *
__ª°ri˘
);

466 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

467 
_IO_va_li°
);

468 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

476 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

478 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

479 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

480 #i‡
__GNUC__
 >= 2

483 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


484 
	~<shlib-com∑t.h
>

485 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

487 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

488 c⁄° 
_IO_°dö_u£d
;

489 
wók_exã∫
 (
_IO_°dö_u£d
);

492 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


493 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

497 
	#_IO_fwide
(
__Â
, 
__mode
) \

498 ({ 
__ªsu…
 = (
__mode
); \

499 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

501 i‡((
__Â
)->
_mode
 == 0) \

503 (
__Â
)->
_mode
 = -1; \

504 
__ªsu…
 = (
__Â
)->
_mode
; \

506 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

507 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

509 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

510 
__ªsu…
; })

	)

513 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

514 
_IO_va_li°
, *
__ª°ri˘
);

515 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

516 
_IO_va_li°
);

517 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

518 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

521 #ifde‡
__LDBL_COMPAT


522 
	~<bôs/libio-ldbl.h
>

525 #ifde‡
__˝lu•lus


	@/usr/include/libv4l1-videodev.h

2 #i‚de‡
__LINUX_VIDEODEV_H


3 
	#__LINUX_VIDEODEV_H


	)

5 #ifde‡
löux


6 
	~<löux/io˘l.h
>

9 #i‡
deföed
(
__FªeBSD__
Ë|| deföed(
__FªeBSD_kî√l__
)

10 
	~<sys/io˘l.h
>

13 
	~<°döt.h
>

15 
	#VID_TYPE_CAPTURE
 1

	)

16 
	#VID_TYPE_TUNER
 2

	)

17 
	#VID_TYPE_TELETEXT
 4

	)

18 
	#VID_TYPE_OVERLAY
 8

	)

19 
	#VID_TYPE_CHROMAKEY
 16

	)

20 
	#VID_TYPE_CLIPPING
 32

	)

21 
	#VID_TYPE_FRAMERAM
 64

	)

22 
	#VID_TYPE_SCALES
 128

	)

23 
	#VID_TYPE_MONOCHROME
 256

	)

24 
	#VID_TYPE_SUBCAPTURE
 512

	)

25 
	#VID_TYPE_MPEG_DECODER
 1024

	)

26 
	#VID_TYPE_MPEG_ENCODER
 2048

	)

27 
	#VID_TYPE_MJPEG_DECODER
 4096

	)

28 
	#VID_TYPE_MJPEG_ENCODER
 8192

	)

30 
	svideo_ˇ∑bûôy


32 
	m«me
[32];

33 
	mty≥
;

34 
	mch™√ls
;

35 
	maudios
;

36 
	mmaxwidth
;

37 
	mmaxheight
;

38 
	mmöwidth
;

39 
	mmöheight
;

43 
	svideo_ch™√l


45 
	mch™√l
;

46 
	m«me
[32];

47 
	mtu√rs
;

48 
uöt32_t
 
	mÊags
;

49 
	#VIDEO_VC_TUNER
 1

	)

50 
	#VIDEO_VC_AUDIO
 2

	)

51 
uöt16_t
 
	mty≥
;

52 
	#VIDEO_TYPE_TV
 1

	)

53 
	#VIDEO_TYPE_CAMERA
 2

	)

54 
uöt16_t
 
	mn‹m
;

57 
	svideo_tu√r


59 
	mtu√r
;

60 
	m«me
[32];

61 
	møngñow
, 
	møngehigh
;

62 
uöt32_t
 
	mÊags
;

63 
	#VIDEO_TUNER_PAL
 1

	)

64 
	#VIDEO_TUNER_NTSC
 2

	)

65 
	#VIDEO_TUNER_SECAM
 4

	)

66 
	#VIDEO_TUNER_LOW
 8

	)

67 
	#VIDEO_TUNER_NORM
 16

	)

68 
	#VIDEO_TUNER_STEREO_ON
 128

	)

69 
	#VIDEO_TUNER_RDS_ON
 256

	)

70 
	#VIDEO_TUNER_MBS_ON
 512

	)

71 
uöt16_t
 
	mmode
;

72 
	#VIDEO_MODE_PAL
 0

	)

73 
	#VIDEO_MODE_NTSC
 1

	)

74 
	#VIDEO_MODE_SECAM
 2

	)

75 
	#VIDEO_MODE_AUTO
 3

	)

76 
uöt16_t
 
	msig«l
;

79 
	svideo_pi˘uª


81 
uöt16_t
 
	mbrighäess
;

82 
uöt16_t
 
	mhue
;

83 
uöt16_t
 
	mcﬁour
;

84 
uöt16_t
 
	mc⁄åa°
;

85 
uöt16_t
 
	mwhôíess
;

86 
uöt16_t
 
	mdïth
;

87 
uöt16_t
 
	m∑Àâe
;

88 
	#VIDEO_PALETTE_GREY
 1

	)

89 
	#VIDEO_PALETTE_HI240
 2

	)

90 
	#VIDEO_PALETTE_RGB565
 3

	)

91 
	#VIDEO_PALETTE_RGB24
 4

	)

92 
	#VIDEO_PALETTE_RGB32
 5

	)

93 
	#VIDEO_PALETTE_RGB555
 6

	)

94 
	#VIDEO_PALETTE_YUV422
 7

	)

95 
	#VIDEO_PALETTE_YUYV
 8

	)

96 
	#VIDEO_PALETTE_UYVY
 9

	)

97 
	#VIDEO_PALETTE_YUV420
 10

	)

98 
	#VIDEO_PALETTE_YUV411
 11

	)

99 
	#VIDEO_PALETTE_RAW
 12

	)

100 
	#VIDEO_PALETTE_YUV422P
 13

	)

101 
	#VIDEO_PALETTE_YUV411P
 14

	)

102 
	#VIDEO_PALETTE_YUV420P
 15

	)

103 
	#VIDEO_PALETTE_YUV410P
 16

	)

104 
	#VIDEO_PALETTE_PLANAR
 13

	)

105 
	#VIDEO_PALETTE_COMPONENT
 7

	)

108 
	svideo_audio


110 
	maudio
;

111 
uöt16_t
 
	mvﬁume
;

112 
uöt16_t
 
	mbass
, 
	måebÀ
;

113 
uöt32_t
 
	mÊags
;

114 
	#VIDEO_AUDIO_MUTE
 1

	)

115 
	#VIDEO_AUDIO_MUTABLE
 2

	)

116 
	#VIDEO_AUDIO_VOLUME
 4

	)

117 
	#VIDEO_AUDIO_BASS
 8

	)

118 
	#VIDEO_AUDIO_TREBLE
 16

	)

119 
	#VIDEO_AUDIO_BALANCE
 32

	)

120 
	m«me
[16];

121 
	#VIDEO_SOUND_MONO
 1

	)

122 
	#VIDEO_SOUND_STEREO
 2

	)

123 
	#VIDEO_SOUND_LANG1
 4

	)

124 
	#VIDEO_SOUND_LANG2
 8

	)

125 
uöt16_t
 
	mmode
;

126 
uöt16_t
 
	mbÆ™˚
;

127 
uöt16_t
 
	m°ï
;

130 
	svideo_˛ù


132 
öt32_t
 
	mx
,
	my
;

133 
öt32_t
 
	mwidth
, 
	mheight
;

134 
video_˛ù
 *
	m√xt
;

137 
	svideo_wödow


139 
uöt32_t
 
	mx
,
	my
;

140 
uöt32_t
 
	mwidth
,
	mheight
;

141 
uöt32_t
 
	mchromakey
;

142 
uöt32_t
 
	mÊags
;

143 
video_˛ù
 *
	m˛ùs
;

144 
	m˛ùcou¡
;

145 
	#VIDEO_WINDOW_INTERLACE
 1

	)

146 
	#VIDEO_WINDOW_CHROMAKEY
 16

	)

147 
	#VIDEO_CLIP_BITMAP
 -1

	)

149 
	#VIDEO_CLIPMAP_SIZE
 (128 * 625)

	)

152 
	svideo_buf„r


154 *
	mba£
;

155 
	mheight
,
	mwidth
;

156 
	mdïth
;

157 
	mbyã•îlöe
;

160 
	svideo_mm≠


162 
	m‰ame
;

163 
	mheight
,
	mwidth
;

164 
	mf‹m©
;

167 
	svideo_mbuf


169 
	msize
;

170 
	m‰ames
;

171 
	moff£ts
[32];

174 
	svbi_f‹m©
 {

175 
uöt32_t
 
	mßm∂ög_øã
;

176 
uöt32_t
 
	mßm∂es_≥r_löe
;

177 
uöt32_t
 
	mßm∂e_f‹m©
;

178 
öt32_t
 
	m°¨t
[2];

179 
uöt32_t
 
	mcou¡
[2];

180 
uöt32_t
 
	mÊags
;

181 
	#VBI_UNSYNC
 1

	)

182 
	#VBI_INTERLACED
 2

	)

185 
	#VIDIOCGCAP
 
	`_IOR
('v',1,
video_ˇ∑bûôy
Ë

	)

186 
	#VIDIOCGCHAN
 
	`_IOWR
('v',2,
video_ch™√l
Ë

	)

187 
	#VIDIOCSCHAN
 
	`_IOW
('v',3,
video_ch™√l
Ë

	)

188 
	#VIDIOCGTUNER
 
	`_IOWR
('v',4,
video_tu√r
Ë

	)

189 
	#VIDIOCSTUNER
 
	`_IOW
('v',5,
video_tu√r
Ë

	)

190 
	#VIDIOCGPICT
 
	`_IOR
('v',6,
video_pi˘uª
Ë

	)

191 
	#VIDIOCSPICT
 
	`_IOW
('v',7,
video_pi˘uª
Ë

	)

192 
	#VIDIOCCAPTURE
 
	`_IOW
('v',8,Ë

	)

193 
	#VIDIOCGWIN
 
	`_IOR
('v',9, 
video_wödow
Ë

	)

194 
	#VIDIOCSWIN
 
	`_IOW
('v',10, 
video_wödow
Ë

	)

195 
	#VIDIOCGFBUF
 
	`_IOR
('v',11, 
video_buf„r
Ë

	)

196 
	#VIDIOCSFBUF
 
	`_IOW
('v',12, 
video_buf„r
Ë

	)

197 
	#VIDIOCGFREQ
 
	`_IOR
('v',14, Ë

	)

198 
	#VIDIOCSFREQ
 
	`_IOW
('v',15, Ë

	)

199 
	#VIDIOCGAUDIO
 
	`_IOR
('v',16, 
video_audio
Ë

	)

200 
	#VIDIOCSAUDIO
 
	`_IOW
('v',17, 
video_audio
Ë

	)

201 
	#VIDIOCSYNC
 
	`_IOW
('v',18, Ë

	)

202 
	#VIDIOCMCAPTURE
 
	`_IOW
('v',19, 
video_mm≠
Ë

	)

203 
	#VIDIOCGMBUF
 
	`_IOR
('v',20, 
video_mbuf
Ë

	)

204 
	#VIDIOCGVBIFMT
 
	`_IOR
('v',28, 
vbi_f‹m©
Ë

	)

205 
	#VIDIOCSVBIFMT
 
	`_IOW
('v',29, 
vbi_f‹m©
Ë

	)

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@/usr/include/xine/attributes.h

26 #i‚de‡
ATTRIBUTE_H_


27 
	#ATTRIBUTE_H_


	)

29 #ifde‡
XINE_COMPILE


30 
	~"c⁄figuª.h
"

32 #i‡
__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 95 )

33 
	#SUPPORT_ATTRIBUTE_PACKED
 1

	)

36 #i‡
__GNUC__
 > 3 || (__GNUC__ =3 && 
__GNUC_MINOR__
 >= 3 )

37 
	#SUPPORT_ATTRIBUTE_DEPRECATED
 1

	)

38 
	#SUPPORT_ATTRIBUTE_FORMAT
 1

	)

39 
	#SUPPORT_ATTRIBUTE_FORMAT_ARG
 1

	)

40 
	#SUPPORT_ATTRIBUTE_MALLOC
 1

	)

41 
	#SUPPORT_ATTRIBUTE_UNUSED
 1

	)

42 
	#SUPPORT_ATTRIBUTE_CONST
 1

	)

45 #i‡
__GNUC__
 >= 4

46 
	#SUPPORT_ATTRIBUTE_VISIBILITY_DEFAULT
 1

	)

47 #i‡
__ELF__


48 
	#SUPPORT_ATTRIBUTE_VISIBILITY_PROTECTED
 1

	)

50 
	#SUPPORT_ATTRIBUTE_SENTINEL
 1

	)

55 #ifde‡
ATTRIBUTE_ALIGNED_MAX


56 
	#ATTR_ALIGN
(
Æign
Ë
	`__©åibuã__
 ((
	`__Æig√d__
 ((
ATTRIBUTE_ALIGNED_MAX
 <álignË? ATTRIBUTE_ALIGNED_MAX :álign)))

	)

58 
	#ATTR_ALIGN
(
Æign
)

	)

62 #i‡
deföed
(
XINE_LIBRARY_COMPILE
Ë&& deföed(
SUPPORT_ATTRIBUTE_VISIBILITY_PROTECTED
)

63 
	#XINE_PROTECTED
 
	`__©åibuã__
((
	`__visibûôy__
("¥Ÿe˘ed")))

	)

64 #ñi‡
deföed
(
XINE_LIBRARY_COMPILE
Ë&& deföed(
SUPPORT_ATTRIBUTE_VISIBILITY_DEFAULT
)

65 
	#XINE_PROTECTED
 
	`__©åibuã__
((
	`__visibûôy__
("deÁu…")))

	)

67 
	#XINE_PROTECTED


	)

70 #ifde‡
SUPPORT_ATTRIBUTE_SENTINEL


71 
	#XINE_SENTINEL
 
	`__©åibuã__
((
__£¡öñ__
))

	)

73 
	#XINE_SENTINEL


	)

76 #i‡
deföed
(
SUPPORT_ATTRIBUTE_DEPRECATED
Ë&& !deföed(
XINE_COMPILE
)

77 
	#XINE_DEPRECATED
 
	`__©åibuã__
((
__dïªˇãd__
))

	)

79 
	#XINE_DEPRECATED


	)

82 #i‚de‡
__©å_unu£d


83 #ifde‡
SUPPORT_ATTRIBUTE_UNUSED


84 
	#__©å_unu£d
 
	`__©åibuã__
((
__unu£d__
))

	)

86 
	#__©å_unu£d


	)

91 #ifde‡
SUPPORT_ATTRIBUTE_FORMAT


92 
	#XINE_FORMAT_PRINTF
(
fmt
,
v¨
Ë
	`__©åibuã__
((
	`__f‹m©__
(
__¥ötf__
, fmt, v¨)))

	)

93 
	#XINE_FORMAT_SCANF
(
fmt
,
v¨
Ë
	`__©åibuã__
((
	`__f‹m©__
(
__sˇnf__
, fmt, v¨)))

	)

95 
	#XINE_FORMAT_PRINTF
(
fmt
,
v¨
)

	)

96 
	#XINE_FORMAT_SCANF
(
fmt
,
v¨
)

	)

98 #ifde‡
SUPPORT_ATTRIBUTE_FORMAT_ARG


99 
	#XINE_FORMAT_PRINTF_ARG
(
fmt
Ë
	`__©åibuã__
((
	`__f‹m©_¨g__
(fmt)))

	)

101 
	#XINE_FORMAT_PRINTF_ARG
(
fmt
)

	)

104 #ifde‡
SUPPORT_ATTRIBUTE_MALLOC


105 
	#XINE_MALLOC
 
	`__©åibuã__
((
__mÆloc__
))

	)

107 
	#XINE_MALLOC


	)

110 #ifde‡
SUPPORT_ATTRIBUTE_PACKED


111 
	#XINE_PACKED
 
	`__©åibuã__
((
__∑cked__
))

	)

113 
	#XINE_PACKED


	)

116 #ifde‡
SUPPORT_ATTRIBUTE_CONST


117 
	#XINE_CONST
 
	`__©åibuã__
((
__c⁄°__
))

	)

119 
	#XINE_CONST


	)

	@/usr/include/xine/os_types.h

27 #i‚de‡
XINE_OS_TYPES_H


28 
	#XINE_OS_TYPES_H


	)

30 #i‡
deföed
(
_WIN32
Ë&& !deföed(
__GNUC__
)

33 
__öt8
 
	töt8_t
;

34 
	t__öt8
 
	tuöt8_t
;

35 
__öt16
 
	töt16_t
;

36 
	t__öt16
 
	tuöt16_t
;

37 
__öt32
 
	töt32_t
;

38 
	t__öt32
 
	tuöt32_t
;

39 
__öt64
 
	töt64_t
;

40 
	t__öt64
 
	tuöt64_t
;

42 #ñi‡
deföed
(
__MACOS__
)

44 
	~<sys/ty≥s.h
>

45 
SI¡8
 
	töt8_t
;

46 
UI¡8
 
	tuöt8_t
;

47 
SI¡16
 
	töt16_t
;

48 
UI¡16
 
	tuöt16_t
;

49 
SI¡32
 
	töt32_t
;

50 
UI¡32
 
	tuöt32_t
;

51 
SI¡64
 
	töt64_t
;

52 
UI¡64
 
	tuöt64_t
;

54 #ñi‡
deföed
(
__MACOSX__
)

56 
	~<sys/ty≥s.h
>

57 
u_öt8_t
 
	tuöt8_t
;

58 
u_öt16_t
 
	tuöt16_t
;

59 
u_öt32_t
 
	tuöt32_t
;

60 
u_öt64_t
 
	tuöt64_t
;

62 #ñi‡
deföed
 (
__EMX__
)

65 sig√d 
	töt8_t
;

66 
	tuöt8_t
;

67 
	töt16_t
;

68 
	tuöt16_t
;

69 
	töt32_t
;

70 
	tuöt32_t
;

71 
	töt64_t
;

72 
	töt64_t
;

74 #ñi‡
deföed
 (
DJGPP
)

77 sig√d 
	töt8_t
;

78 
	tuöt8_t
;

79 
	töt16_t
;

80 
	tuöt16_t
;

81 
	töt32_t
;

82 
	tuöt32_t
;

83 
	töt64_t
;

84 
	tuöt64_t
;

86 #ñi‡
deföed
(
R5900
)

89 sig√d 
	töt8_t
;

90 
	tuöt8_t
;

91 
	töt16_t
;

92 
	töt16_t
;

93 
	töt32_t
;

94 
	tuöt32_t
;

95 
	töt64_t
;

96 
	töt64_t
;

105 
	~<öây≥s.h
>

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/ctype.h

22 #i‚def 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	g__BEGIN_DECLS


30 #i‚de‡
_ISbô


39 
	~<ídün.h
>

40 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

43 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

48 
	m_ISuµî
 = 
_ISbô
 (0),

49 
	m_ISlowî
 = 
_ISbô
 (1),

50 
	m_ISÆpha
 = 
_ISbô
 (2),

51 
	m_ISdigô
 = 
_ISbô
 (3),

52 
	m_ISxdigô
 = 
_ISbô
 (4),

53 
	m_IS•a˚
 = 
_ISbô
 (5),

54 
	m_IS¥öt
 = 
_ISbô
 (6),

55 
	m_ISgøph
 = 
_ISbô
 (7),

56 
	m_ISbœnk
 = 
_ISbô
 (8),

57 
	m_IS˙ål
 = 
_ISbô
 (9),

58 
	m_ISpun˘
 = 
_ISbô
 (10),

59 
	m_ISÆnum
 = 
_ISbô
 (11)

79 c⁄° **
	$__˘y≥_b_loc
 ()

80 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

81 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

83 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

87 #i‚de‡
__˝lu•lus


88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

90 #ñi‡
deföed
 
__USE_EXTERN_INLINES


91 
	#__is˘y≥_f
(
ty≥
) \

92 
__exã∫_ölöe
 \

93 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

95  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

96 
	}

	)
}

99 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

100 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

102 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__ex˘y≥
 (
iß um
);

111 
__ex˘y≥
 (
ißÕha
);

112 
__ex˘y≥
 (
is˙ål
);

113 
__ex˘y≥
 (
isdigô
);

114 
__ex˘y≥
 (
i¶owî
);

115 
__ex˘y≥
 (
isgøph
);

116 
__ex˘y≥
 (
i•röt
);

117 
__ex˘y≥
 (
i•un˘
);

118 
__ex˘y≥
 (
is•a˚
);

119 
__ex˘y≥
 (
isuµî
);

120 
__ex˘y≥
 (
isxdigô
);

124 
	$tﬁowî
 (
__c
Ë
__THROW
;

127 
	$touµî
 (
__c
Ë
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__ex˘y≥
 (
isbœnk
);

138 
__END_NAMESPACE_C99


141 #ifde‡
__USE_GNU


143 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

146 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


150 
	$ißscii
 (
__c
Ë
__THROW
;

154 
	$tﬂscii
 (
__c
Ë
__THROW
;

158 
	`__ex˘y≥
 (
_touµî
);

159 
	`__ex˘y≥
 (
_tﬁowî
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

164 (
__exãnsi⁄__
 \

165 ({ 
__ªs
; \

166 i‡( (
c
) > 1) \

168 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

174 
__ªs
 = 
f
 
¨gs
; \

177 
__ªs
 = (
a
)[(Ë(
c
)]; \

178 
__ªs
; 
	}
}))

	)

180 #i‡!
deföed
 
__NO_CTYPE


181 #ifde‡
__is˘y≥_f


182 
	$__is˘y≥_f
 (
Ænum
)

183 
	$__is˘y≥_f
 (
Æpha
)

184 
	$__is˘y≥_f
 (
˙ål
)

185 
	$__is˘y≥_f
 (
digô
)

186 
	$__is˘y≥_f
 (
lowî
)

187 
	$__is˘y≥_f
 (
gøph
)

188 
	$__is˘y≥_f
 (
¥öt
)

189 
	$__is˘y≥_f
 (
pun˘
)

190 
	$__is˘y≥_f
 (
•a˚
)

191 
	$__is˘y≥_f
 (
uµî
)

192 
	$__is˘y≥_f
 (
xdigô
)

193 #ifde‡
__USE_ISOC99


194 
	$__is˘y≥_f
 (
bœnk
)

196 #ñi‡
deföed
 
__is˘y≥


197 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

198 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

199 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

200 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

201 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

202 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

203 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

204 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

205 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

206 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

207 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

208 #ifde‡
__USE_ISOC99


209 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

213 #ifde‡
__USE_EXTERN_INLINES


214 
__exã∫_ölöe
 

215 
	`__NTH
 (
	$tﬁowî
 (
__c
))

217  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

218 
	}
}

220 
__exã∫_ölöe
 

221 
__NTH
 (
	$touµî
 (
__c
))

223  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

224 
	}
}

227 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


228 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

229 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

232 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


233 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

234 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

236 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

237 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

243 #ifde‡
__USE_XOPEN2K8


257 
	~<xloˇÀ.h
>

261 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

262 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

264 
	#__ex˘y≥_l
(
«me
) \

265 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

271 
__ex˘y≥_l
 (
iß um_l
);

272 
__ex˘y≥_l
 (
ißÕha_l
);

273 
__ex˘y≥_l
 (
is˙ål_l
);

274 
__ex˘y≥_l
 (
isdigô_l
);

275 
__ex˘y≥_l
 (
i¶owî_l
);

276 
__ex˘y≥_l
 (
isgøph_l
);

277 
__ex˘y≥_l
 (
i•röt_l
);

278 
__ex˘y≥_l
 (
i•un˘_l
);

279 
__ex˘y≥_l
 (
is•a˚_l
);

280 
__ex˘y≥_l
 (
isuµî_l
);

281 
__ex˘y≥_l
 (
isxdigô_l
);

283 
__ex˘y≥_l
 (
isbœnk_l
);

287 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

288 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

291 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

294 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


295 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

296 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

297 
	#__touµî_l
(
c
, 
loˇÀ
) \

298 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

299 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

300 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

304 #i‚de‡
__NO_CTYPE


305 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

306 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

307 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

308 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

309 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

310 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

311 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

312 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

313 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

314 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

315 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

317 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


320 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

321 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

324 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

325 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

326 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

327 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

328 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

329 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

330 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

331 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

332 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

333 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

334 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

336 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

338 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


339 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

340 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

74 
	#htﬁe64
(
x
Ë(x)

	)

75 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

76 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #unde‡
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #unde‡
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #unde‡
__FDELT


31 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

33 #unde‡
__FDMASK


34 
	#__FDMASK
(
d
Ë(1UL << ((dË% 
__NFDBITS
))

	)

37 
	mfds_bôs
 [
__FDSET_LONGS
];

38 } 
	t__kî√l_fd_£t
;

41 (*
	t__kî√l_sigh™dÀr_t
)();

44 
	t__kî√l_key_t
;

45 
	t__kî√l_mqd_t
;

47 
	~<asm/posix_ty≥s.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/linux/stddef.h

1 #i‚de‡
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #unde‡
NULL


7 #i‡
deföed
(
__˝lu•lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@
1
.
1
/usr/include
91
2156
include/opencv2/videoio/cap_ios.h
include/opencv2/videoio/videoio_c.h
perf/perf_input.cpp
perf/perf_main.cpp
perf/perf_output.cpp
src/cap.cpp
src/cap_OPEL.cpp
src/cap_cmu.cpp
src/cap_dc1394.cpp
src/cap_dc1394_v2.cpp
src/cap_dshow.cpp
src/cap_ffmpeg.cpp
src/cap_giganetix.cpp
src/cap_gphoto2.cpp
src/cap_gstreamer.cpp
src/cap_images.cpp
src/cap_intelperc.cpp
src/cap_libv4l.cpp
src/cap_mjpeg_decoder.cpp
src/cap_mjpeg_encoder.cpp
src/cap_msmf.cpp
src/cap_openni.cpp
src/cap_openni2.cpp
src/cap_pvapi.cpp
src/cap_qt.cpp
src/cap_unicap.cpp
src/cap_v4l.cpp
src/cap_vfw.cpp
src/cap_winrt/CaptureFrameGrabber.cpp
src/cap_winrt/MediaStreamSink.cpp
src/cap_winrt_bridge.cpp
src/cap_winrt_capture.cpp
src/cap_winrt_video.cpp
src/cap_ximea.cpp
src/cap_xine.cpp
test/test_basic_props.cpp
test/test_ffmpeg.cpp
test/test_fourcc.cpp
test/test_framecount.cpp
test/test_main.cpp
test/test_positioning.cpp
test/test_video_io.cpp
test/test_video_pos.cpp
/usr/include/assert.h
/usr/include/dc1394/dc1394.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/libraw1394/raw1394.h
/usr/include/libv4l1.h
/usr/include/libv4l2.h
/usr/include/linux/videodev2.h
/usr/include/math.h
/usr/include/semaphore.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/wchar.h
/usr/include/xine.h
/usr/include/alloca.h
/usr/include/dc1394/camera.h
/usr/include/dc1394/capture.h
/usr/include/dc1394/control.h
/usr/include/dc1394/conversions.h
/usr/include/dc1394/format7.h
/usr/include/dc1394/iso.h
/usr/include/dc1394/log.h
/usr/include/dc1394/register.h
/usr/include/dc1394/types.h
/usr/include/dc1394/utils.h
/usr/include/dc1394/video.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/libio.h
/usr/include/libv4l1-videodev.h
/usr/include/linux/ioctl.h
/usr/include/linux/types.h
/usr/include/wctype.h
/usr/include/xine/attributes.h
/usr/include/xine/os_types.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/linux/posix_types.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/linux/stddef.h
